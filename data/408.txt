from keras.models import Sequential
from keras.layers.core import Reshape, Activation, Dropout
from keras.layers import LSTM, Merge, Dense
def build_lstm_model():
    image_feature_size          = 1000
    word_feature_size           = 4096
    number_of_LSTM              = 3
    number_of_hidden_units_lstm = 512
    max_length_questions        = 30
    number_of_dense_layers      = 2
    number_of_hidden_units      = 1024
    activation_function         = 'tanh'
    dropout_pct                 = 0.5
    model_image = Sequential()
    model_language = Sequential()
    model = Sequential()
    model.add(LSTM(number_of_hidden_units_lstm, return_sequences=True, input_shape=(101, 5096)))
    model.add(Dense(number_of_hidden_units))
    model.add(Activation(activation_function))
    model.add(Dropout(dropout_pct))
    for _ in range(number_of_dense_layers):
        model.add(Dense(number_of_hidden_units, kernel_initializer='uniform'))
        model.add(Activation(activation_function))
    model.add(Dense(2))
    model.add(Activation('softmax'))
    return model
    