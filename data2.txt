from __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  100000 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader1  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list1  EQUAL  list PARELEFT  PARERIGHT  EOM
testX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y1  EQUAL  traindata DOT iloc[] EOM
y_test1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
testX  EQUAL  sequence DOT pad_sequences PARELEFT testX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
csv_logger  EQUAL  CSVLogger PARELEFT  COMMA separator EQUAL  COMMA  append EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  nb_epoch EQUAL  COMMA  show_accuracy EQUAL  COMMA validation_split EQUAL  COMMA callbacks EQUAL [] PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten COMMA  Activation COMMA  Merge COMMA  Add COMMA  merge COMMA  Conv1D COMMA  MaxPooling1D COMMA  LeakyReLU COMMA  CuDNNLSTM COMMA  CuDNNGRU EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D COMMA  UpSampling2D EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT core import Reshape EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
from keras DOT regularizers import l2 EOM
def Convolutional PARELEFT input_shape COMMA  n_classes COMMA  print_info  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT input_shape  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters  EQUAL  COMMA  kernel_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters  EQUAL  COMMA  kernel_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters  EQUAL  COMMA  kernel_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
if print_info: EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def Convolutional2DRecurrent PARELEFT input_shape COMMA  n_classes COMMA  GPU EQUAL  COMMA  print_info  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT input_shape  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT filters  EQUAL  COMMA  kernel_size  EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if GPU: EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 300 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT 300 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
if GPU: EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
if print_info: EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def Convolutional1DRecurrent PARELEFT input_shape COMMA  n_classes COMMA  GPU EQUAL  COMMA  print_info  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT input_shape  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters  EQUAL  COMMA  kernel_size  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
if GPU: EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 300 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT 300 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
if GPU: EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
if print_info: EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def ConvolutionalDeepRecurrent PARELEFT input_shape COMMA  n_classes COMMA  GPU EQUAL  COMMA  print_info  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT input_shape  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters  EQUAL  COMMA  kernel_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters  EQUAL  COMMA  kernel_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters  EQUAL  COMMA  kernel_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  COMMA  strides EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
if GPU: EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 60 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT 60 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
if GPU: EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_classes COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
if print_info: EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def MotionDetection PARELEFT input_shape COMMA  n_classes COMMA  print_info  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT input_shape  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters  EQUAL  COMMA rnel_size  EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 600 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_classes COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
if print_info: EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT metrics import  PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  2000 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader1  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list1  EQUAL  list PARELEFT  PARERIGHT  EOM
testX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y1  EQUAL  testdata DOT iloc[] EOM
y_test1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  2000 EOM
testX  EQUAL  sequence DOT pad_sequences PARELEFT testX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
import os EOM
for file in os DOT listdir PARELEFT  PARERIGHT : EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
y_pred  EQUAL  model DOT predict_classes PARELEFT  PARERIGHT  EOM
accuracy  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
recall  EQUAL  recall_score PARELEFT y_test1 COMMA  y_pred  COMMA  average EQUAL  PARERIGHT  EOM
precision  EQUAL  precision_score PARELEFT y_test1 COMMA  y_pred  COMMA  average EQUAL  PARERIGHT  EOM
f1  EQUAL  f1_score PARELEFT y_test1 COMMA  y_pred COMMA  average EQUAL  PARERIGHT  EOM
class TextMod PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT fc_dimension  EQUAL  fc_dimension EOM
self DOT vocab  EQUAL  vocab EOM
def build_model PARELEFT  PARERIGHT : EOM
from keras DOT models import Model EOM
from keras DOT layers import Embedding COMMA  Input COMMA  Dense COMMA  Dropout COMMA  LSTM COMMA  Lambda COMMA  multiply EOM
lstm_cells  EQUAL  512 EOM
fc_common_embedding_size  EQUAL  512 EOM
activation  EQUAL  EOM
dropout  EQUAL  0 DOT 5 EOM
emb_dim  EQUAL  200 EOM
vocab_size  EQUAL  self DOT vocab[] EOM
output_classes  EQUAL  self DOT vocab[] EOM
fc_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
fc_norm  EQUAL  Lambda PARELEFT l2_norm COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
img_fc  EQUAL  Dense PARELEFT fc_common_embedding_size COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
img_drop  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
language_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
l_in  EQUAL  Embedding PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  input_length EQUAL  COMMA ask_zero EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_fc  EQUAL  LSTM PARELEFT lstm_cells COMMA  return_sequences EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_norm_fc  EQUAL  Lambda PARELEFT l2_norm COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_drop_fc  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
v_q_fc  EQUAL  Dense PARELEFT fc_common_embedding_size COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
fc_merged  EQUAL  multiply PARELEFT  PARERIGHT  EOM
fc_merged_norm  EQUAL  Lambda PARELEFT l2_norm COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
fc_merged_dense  EQUAL  Dense PARELEFT output_classes COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
fc_merged_drop  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
fc_out  EQUAL  Dense PARELEFT output_classes COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
class SpeechMod PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT img_dim  EQUAL  img_dim EOM
def build_model PARELEFT  PARERIGHT : EOM
from keras DOT layers import BatchNormalization COMMA  Activation COMMA  Merge EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Lambda EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT pooling import MaxPooling1D EOM
from keras DOT layers DOT recurrent import LSTM EOM
common_embedding_size  EQUAL  512 EOM
activation  EQUAL  EOM
dropout  EQUAL  0 DOT 5 EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Lambda PARELEFT l2_norm COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Dense PARELEFT common_embedding_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
speech_model DOT add PARELEFT Conv1D PARELEFT 32 COMMA  64 COMMA  strides EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  32 COMMA  strides EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  16 COMMA  strides EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Conv1D PARELEFT 256 COMMA  8 COMMA  strides EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Conv1D PARELEFT 512 COMMA  4 COMMA  strides EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT LSTM PARELEFT common_embedding_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Lambda PARELEFT l2_norm COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Dense PARELEFT common_embedding_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
speech_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Lambda PARELEFT l2_norm COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT common_embedding_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def l2_norm PARELEFT  PARERIGHT : EOM
epsilon  EQUAL  1e-4 EOM
x_normed  EQUAL  K DOT sqrt PARELEFT K DOT sum PARELEFT K DOT square PARELEFT  PARERIGHT  COMMA  axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  PARERIGHT  EOM
x  EQUAL  x /  PARELEFT  PARERIGHT  EOM
return ximport numpy as np EOM
import h5py as h5 EOM
from sklearn import manifold EOM
import os EOM
import datetime EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Merge COMMA  Reshape EOM
from keras DOT regularizers import l2 COMMA  activity_l2 COMMA  l1 COMMA  activity_l1 EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
os DOT chdir PARELEFT  PARERIGHT  EOM
with h5 DOT File PARELEFT  PARERIGHT  as f1: EOM
video_train  EQUAL  f1[][] DOT transpose PARELEFT  PARERIGHT  EOM
audio_train  EQUAL  f1[][] DOT transpose PARELEFT  PARERIGHT  EOM
label_train  EQUAL  f1[][] DOT transpose PARELEFT  PARERIGHT  EOM
label_train  EQUAL  label_train DOT squeeze PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
with h5 DOT File PARELEFT  PARERIGHT  as f2: EOM
video_test  EQUAL  f2[][] DOT transpose PARELEFT  PARERIGHT  EOM
audio_test  EQUAL  f2[][] DOT transpose PARELEFT  PARERIGHT  EOM
label_test  EQUAL  f2[][] DOT transpose PARELEFT  PARERIGHT  EOM
label_test  EQUAL  label_test DOT squeeze PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
X_test  EQUAL  np DOT hstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  label_train EOM
y_test  EQUAL  label_test EOM
y_train  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
mlp  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
mlp DOT add PARELEFT Dense PARELEFT 250 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
mlp DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
mlp DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
mlp DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
mlp DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
clas  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
clas DOT add PARELEFT Dense PARELEFT 30 COMMA input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
clas DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
clas DOT add PARELEFT BatchNormalization PARELEFT mode EQUAL  PARERIGHT  PARERIGHT  EOM
clas DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
clas DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
clas DOT add PARELEFT BatchNormalization PARELEFT mode EQUAL  PARERIGHT  PARERIGHT  EOM
clas DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
clas DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer  EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
import numpy as np EOM
import time EOM
import csv EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA Merge EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
import copy EOM
data_dim  EQUAL  1 EOM
timesteps  EQUAL  13 EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
in_dimension  EQUAL  3 EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
from keras DOT utils DOT visualize_util import plot COMMA  to_graph EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT import os EOM
import numpy as np EOM
import keras EOM
import donkeycar as dk EOM
from donkeycar DOT parts DOT keras import KerasPilot EOM
class KerasRNN_LSTM PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  seq_length EQUAL  COMMA  num_outputs EQUAL  COMMA  *args COMMA  **kwargs PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  rnn_lstm PARELEFT seq_length EQUAL  COMMA  num_outputs EQUAL  PARERIGHT  EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT img_seq  EQUAL  [] EOM
def run PARELEFT  PARERIGHT : EOM
while len PARELEFT  PARERIGHT  < self DOT seq_length: EOM
self DOT img_seq DOT append PARELEFT  PARERIGHT  EOM
self DOT img_seq  EQUAL  self DOT img_seq[] EOM
self DOT img_seq DOT append PARELEFT  PARERIGHT  EOM
img_arr  EQUAL  np DOT array PARELEFT  PARERIGHT  DOT reshape PARELEFT  PARERIGHT  EOM
outputs  EQUAL  self DOT model DOT predict PARELEFT  PARERIGHT  EOM
steering  EQUAL  outputs[][] EOM
throttle  EQUAL  outputs[][] EOM
return steering COMMA  throttle EOM
def rnn_lstm_one PARELEFT seq_length EQUAL  COMMA  num_outputs EQUAL  COMMA  image_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT : EOM
from numpy DOT random import seed EOM
seed PARELEFT  PARERIGHT  EOM
from tensorflow import set_random_seed EOM
set_random_seed PARELEFT  PARERIGHT  EOM
from keras DOT layers import Input COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution2D COMMA  MaxPooling2D COMMA  Reshape COMMA  BatchNormalization COMMA  Merge EOM
from keras DOT layers import Activation COMMA  Dropout COMMA  Flatten COMMA  Cropping2D COMMA  Lambda EOM
from keras DOT layers DOT merge import concatenate EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed as TD EOM
img_seq_shape  EQUAL   PARELEFT  PARERIGHT  + image_shape EOM
img_in  EQUAL  Input PARELEFT batch_shape  EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
x  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Convolution2D PARELEFT 24 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Convolution2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Convolution2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Convolution2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Dense PARELEFT 100 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dense PARELEFT 50 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dense PARELEFT num_outputs COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
return x EOM
def rnn_lstm PARELEFT seq_length EQUAL  COMMA  num_outputs EQUAL  COMMA  image_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT : EOM
from keras DOT layers import Input COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution2D COMMA  MaxPooling2D COMMA  Reshape COMMA  BatchNormalization COMMA  Merge EOM
from keras DOT layers import Activation COMMA  Dropout COMMA  Flatten COMMA  Cropping2D COMMA  Lambda EOM
from keras DOT layers DOT merge import concatenate EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed as TD EOM
img_seq_shape  EQUAL   PARELEFT  PARERIGHT  + image_shape EOM
img_in  EQUAL  Input PARELEFT batch_shape  EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
x  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Convolution2D PARELEFT 24 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Convolution2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Convolution2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Convolution2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Dense PARELEFT 100 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT TD PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT add PARELEFT Dense PARELEFT num_outputs COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
x DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
return x EOM
from __future__ import print_function EOM
import os EOM
from keras DOT models import Sequential EOM
from keras DOT models import load_model EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Activation EOM
from keras DOT layers import LSTM EOM
from getdata import GetData EOM
from logger import Logger EOM
log  EQUAL  Logger PARELEFT  PARERIGHT  EOM
class Model PARELEFT  PARERIGHT : EOM
gd DOT get_dataset PARELEFT  PARERIGHT  EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT maxlen  EQUAL  self DOT gd DOT preprocess DOT __defaults__[] EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
def lstm_ PARELEFT self COMMA  units EQUAL  PARERIGHT : EOM
log DOT info PARELEFT  PARERIGHT  EOM
os DOT mkdir PARELEFT  PARERIGHT  EOM
log DOT info PARELEFT  PARERIGHT  EOM
if os DOT path DOT exists PARELEFT  PARERIGHT : EOM
if os DOT path DOT exists PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT : EOM
log DOT info PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  load_model PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT summary PARELEFT  PARERIGHT  EOM
return self DOT model EOM
else: EOM
log DOT info PARELEFT  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  54 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
adam  EQUAL  keras DOT optimizers DOT Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
from theano DOT tensor DOT shared_randomstreams import RandomStreams EOM
srng  EQUAL  RandomStreams PARELEFT  PARERIGHT  EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  LSTM COMMA  GRU COMMA  Dropout COMMA  Flatten COMMA  Convolution1D COMMA  MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from keras_helper import load_keras_model as load EOM
from keras_helper import save_keras_model as save EOM
base_dir  EQUAL  EOM
def generate_model PARELEFT top_words COMMA  embedding_length COMMA  n_lstm_units EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
if dropout is not None: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
if dropout is not None: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
if __name__ EQUAL  EQUAL : EOM
embedding_length  EQUAL  16 EOM
top_words  EQUAL  EOM
n_lstm_units  EQUAL  100 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  COMMA  seed EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
save PARELEFT model COMMA   DOT format PARELEFT  PARERIGHT  COMMA  base_dir EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from keras DOT optimizers import SGD EOM
from keras DOT optimizers import Adam EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from decimal import Decimal EOM
import operator EOM
from fractions import Fraction EOM
import numpy EOM
from keras DOT datasets import imdb EOM
import AlgebraProblems EOM
import sklearn EOM
from sklearn DOT naive_bayes import GaussianNB EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from sklearn DOT ensemble import RandomForestClassifier EOM
from sklearn import svm EOM
from keras DOT layers import Dropout EOM
from keras DOT preprocessing import sequence EOM
import PrepareInputANN EOM
import PrepareInputLSTM EOM
import numpy as np EOM
import pdb EOM
import csv EOM
def defineModelandOptimizer PARELEFT networkType COMMA  top_words EQUAL  COMMA  max_length EQUAL  COMMA  ninputs EQUAL  PARERIGHT : EOM
if  PARELEFT networkType EQUAL  PARERIGHT : EOM
embedding_vector_length  EQUAL  32 EOM
max_review_length  EQUAL  max_length EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  Adam PARELEFT lr EQUAL  COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  COMMA  epsilon EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
if  PARELEFT networkType EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 30 COMMA input_dim EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 215 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  SGD PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def solve PARELEFT  PARERIGHT : EOM
case  EQUAL  type DOT index PARELEFT max PARELEFT  PARERIGHT  PARERIGHT  EOM
indexes  EQUAL  [] EOM
if  PARELEFT len PARELEFT  PARERIGHT  EQUAL  PARERIGHT : EOM
if  PARELEFT case  EQUAL  PARERIGHT : EOM
return nums[]+nums[] EOM
if  PARELEFT case EQUAL  PARERIGHT : EOM
return max PARELEFT  PARERIGHT -min PARELEFT  PARERIGHT  EOM
if PARELEFT case  EQUAL  PARERIGHT : EOM
return nums[]*nums[] EOM
if  PARELEFT case EQUAL  PARERIGHT : EOM
return max PARELEFT  PARERIGHT /min PARELEFT  PARERIGHT  EOM
def main PARELEFT  PARERIGHT : EOM
X  EQUAL  [] EOM
Y  EQUAL  [] EOM
topWords  EQUAL  150 EOM
maxProblemLength  EQUAL  53 EOM
if  PARELEFT networkType EQUAL  PARERIGHT : EOM
X COMMA Y COMMA words  EQUAL  PrepareInputLSTM DOT load_data PARELEFT top_words EQUAL  PARERIGHT  EOM
X  EQUAL  sequence DOT pad_sequences PARELEFT X COMMA  maxlen EQUAL  PARERIGHT  EOM
else: EOM
if  PARELEFT dataset EQUAL  PARERIGHT : EOM
X COMMA Y COMMA words  EQUAL  AlgebraProblems DOT prepareAlgebraInput PARELEFT  PARERIGHT  EOM
else: EOM
X COMMA Y COMMA words  EQUAL  PrepareInputANN DOT load_ANN PARELEFT  PARERIGHT  EOM
if  PARELEFT  PARERIGHT : EOM
model  EQUAL  defineModelandOptimizer PARELEFT networkType COMMA top_words EQUAL  COMMA max_length EQUAL  COMMA  ninputs EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT X COMMA  to_categorical PARELEFT  PARERIGHT  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
while  PARELEFT  PARERIGHT : EOM
problem  EQUAL  input PARELEFT  EOM
if  PARELEFT networkType  EQUAL  PARERIGHT : EOM
processed  EQUAL  PrepareInputLSTM DOT process PARELEFT  PARERIGHT  EOM
X_test  EQUAL  np DOT array PARELEFT PrepareInputLSTM DOT words_2_ints PARELEFT [] DOT strip PARELEFT  PARERIGHT  DOT split PARELEFT  PARERIGHT ] COMMA words PARERIGHT  PARERIGHT  EOM
X_test  EQUAL   sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
if  PARELEFT networkType  EQUAL  PARERIGHT : EOM
processed  EQUAL  PrepareInputANN DOT process PARELEFT  PARERIGHT  EOM
X_test  EQUAL  np DOT array PARELEFT PrepareInputANN DOT makemap PARELEFT  PARERIGHT  PARERIGHT  EOM
nums  EQUAL  processed[] EOM
problemType  EQUAL  list PARELEFT model DOT predict PARELEFT  PARERIGHT  PARERIGHT [] EOM
problemTypes  EQUAL  [] EOM
ans  EQUAL  problemTypes[] EOM
else: EOM
true_classes  EQUAL  [] EOM
predicted_classes  EQUAL  [] EOM
if  PARELEFT networkType  EQUAL  PARERIGHT : EOM
model  EQUAL  svm DOT SVC PARELEFT  PARERIGHT  EOM
scores  EQUAL  sklearn DOT model_selection DOT cross_val_score PARELEFT model COMMA  X COMMA  Y COMMA  cv EQUAL  PARERIGHT  EOM
else: EOM
kfold  EQUAL  StratifiedKFold PARELEFT Y COMMA  n_folds EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
trueclass  EQUAL  [] EOM
predclass  EQUAL  [] EOM
for train COMMA  test in kfold: EOM
if  PARELEFT networkType EQUAL  PARERIGHT : EOM
model  EQUAL  defineModelandOptimizer PARELEFT networkType COMMA  top_words EQUAL  COMMA  max_length EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X[] COMMA  to_categorical PARELEFT  PARERIGHT  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
if  PARELEFT networkType EQUAL  PARERIGHT : EOM
model  EQUAL  defineModelandOptimizer PARELEFT networkType COMMA  ninputs EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT X[] COMMA  to_categorical PARELEFT  PARERIGHT  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X[] COMMA  to_categorical PARELEFT  PARERIGHT  COMMA  verbose EQUAL  PARERIGHT  EOM
finalloss  EQUAL  model DOT evaluate PARELEFT X[] COMMA  to_categorical PARELEFT  PARERIGHT  COMMA  verbose EQUAL  PARERIGHT  EOM
true_classes  EQUAL  Y[] DOT tolist PARELEFT  PARERIGHT  EOM
trueclass  EQUAL  trueclass + true_classes EOM
predicted_classes  EQUAL  model DOT predict_classes PARELEFT X[] COMMA  len PARELEFT  PARERIGHT  PARERIGHT  DOT tolist PARELEFT  PARERIGHT  EOM
predclass  EQUAL  predclass+ predicted_classes EOM
ct EQUAL  0 EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
if  PARELEFT true_classes[] EQUAL [] PARERIGHT : EOM
ct+ EQUAL 1 EOM
trueclass  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
predclass  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
correctGuesses  EQUAL  0 EOM
wrongGuesses  EQUAL  0 EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
if PARELEFT trueclass[]! EQUAL  PARERIGHT : EOM
if  PARELEFT predclass[] EQUAL [] PARERIGHT : EOM
correctGuesses+ EQUAL 1 EOM
else: EOM
wrongGuesses+ EQUAL 1 EOM
pdb DOT set_trace PARELEFT  PARERIGHT  EOM
if  PARELEFT __name__  EQUAL  PARERIGHT : EOM
main PARELEFT  PARERIGHT from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def build_LSTM_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D EOM
from keras DOT datasets import imdb EOM
top_words  EQUAL  20000 EOM
maxlen  EQUAL  100 EOM
embedding_size  EQUAL  128 EOM
kernel_size  EQUAL  5 EOM
filters  EQUAL  64 EOM
pool_size  EQUAL  4 EOM
lstm_output_size  EQUAL  70 EOM
batch_size  EQUAL  30 EOM
epochs  EQUAL  2 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters COMMA kernel_size COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  BatchNormalization EOM
from keras DOT layers import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
from keras DOT optimizers import adagrad COMMA  adadelta EOM
from keras import regularizers EOM
from keras DOT layers import LSTM EOM
from keras DOT regularizers import l2 EOM
class LSTM_M3: EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT N COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT N COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
self DOT Model  EQUAL  modelfrom keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def build_improved_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_basic_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import Input COMMA  Dense COMMA  Embedding COMMA  Conv2D COMMA  MaxPool2D EOM
from keras DOT layers import Reshape COMMA  Flatten COMMA  Dropout COMMA  Concatenate EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense COMMA  Embedding COMMA  Input COMMA Bidirectional EOM
from keras DOT models import Model EOM
from keras DOT layers import merge EOM
def basic_mlp PARELEFT  PARERIGHT : EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT Embedding PARELEFT vocabulary_size COMMA  word_emb_dim COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT num_hidden_units_lstm COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for i in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def deeper_lstm PARELEFT  PARERIGHT : EOM
inpx1 EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x1 EQUAL Dense PARELEFT 1024 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x1 EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
image_model  EQUAL  Model PARELEFT  PARERIGHT  EOM
image_model DOT summary PARELEFT  PARERIGHT  EOM
inpx0 EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x0 EQUAL Embedding PARELEFT vocabulary_size COMMA  word_emb_dim COMMA  weights EQUAL [] COMMA  trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x1 EQUAL LSTM PARELEFT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x1 EQUAL LSTM PARELEFT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x2 EQUAL LSTM PARELEFT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x2 EQUAL Dense PARELEFT 1024 COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x2 EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
embedding_model  EQUAL  Model PARELEFT  PARERIGHT  EOM
embedding_model DOT summary PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA mode  EQUAL  PARERIGHT  PARERIGHT  EOM
for i in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def visual_lstm PARELEFT  PARERIGHT : EOM
inpx1 EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x1 EQUAL Dense PARELEFT embedding_matrix DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x1 EQUAL Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
image_model  EQUAL  Model PARELEFT  PARERIGHT  EOM
image_model DOT summary PARELEFT  PARERIGHT  EOM
inpx0 EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x0 EQUAL Embedding PARELEFT vocabulary_size COMMA  word_emb_dim COMMA  weights EQUAL [] COMMA  trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x2 EQUAL Dense PARELEFT embedding_matrix DOT shape[] COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x2 EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
embedding_model  EQUAL  Model PARELEFT  PARERIGHT  EOM
embedding_model DOT summary PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA mode  EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_hidden_units_lstm COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def visual_lstm2 PARELEFT  PARERIGHT : EOM
inpx1 EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x1 EQUAL Dense PARELEFT embedding_matrix DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x1 EQUAL Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
image_model  EQUAL  Model PARELEFT  PARERIGHT  EOM
image_model DOT summary PARELEFT  PARERIGHT  EOM
inpx0 EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x0 EQUAL Embedding PARELEFT vocabulary_size COMMA  word_emb_dim COMMA  weights EQUAL [] COMMA  trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x2 EQUAL Dense PARELEFT embedding_matrix DOT shape[] COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x2 EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
embedding_model  EQUAL  Model PARELEFT  PARERIGHT  EOM
embedding_model DOT summary PARELEFT  PARERIGHT  EOM
inpx2 EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x1 EQUAL Dense PARELEFT embedding_matrix DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x3 EQUAL Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
image_model2  EQUAL  Model PARELEFT  PARERIGHT  EOM
image_model2 DOT summary PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA mode  EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class BotPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class ClofusBotPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
import os EOM
os DOT environ[]  EQUAL  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Dropout COMMA  LSTM COMMA  Bidirectional EOM
from keras DOT layers DOT convolutional import MaxPooling1D COMMA  Conv1D EOM
from keras DOT callbacks import EarlyStopping EOM
from keras DOT models import load_model EOM
import numpy as np EOM
import pandas as pd EOM
import functools EOM
from keras import backend as K EOM
import tensorflow as tf EOM
import Doc2Vec EOM
def as_keras_metric PARELEFT  PARERIGHT : EOM
def wrapper PARELEFT  PARERIGHT : EOM
value COMMA  update_op  EQUAL  method PARELEFT  PARERIGHT  EOM
K DOT get_session PARELEFT  PARERIGHT  DOT run PARELEFT tf DOT local_variables_initializer PARELEFT  PARERIGHT  PARERIGHT  EOM
with tf DOT control_dependencies PARELEFT  PARERIGHT : EOM
value  EQUAL  tf DOT identity PARELEFT  PARERIGHT  EOM
return value EOM
return wrapper EOM
def MyLSTM PARELEFT  PARERIGHT : EOM
feature  EQUAL  700 EOM
vec_size  EQUAL  300 EOM
auc_roc  EQUAL  as_keras_metric PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA tivation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 300 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA ptimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
model  EQUAL  MyLSTM PARELEFT  PARERIGHT  EOM
trainData COMMA  trainLabel  EQUAL  Doc2Vec DOT LoadDataTrain PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT trainData COMMA  trainLabel COMMA  validation_split EQUAL  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
X_test  EQUAL  Doc2Vec DOT LoadDataTest PARELEFT  PARERIGHT  EOM
Y_test  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
Doc2Vec DOT SaveResult PARELEFT  PARERIGHT from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten COMMA  LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import Conv1D COMMA  MaxPooling1D EOM
from sklearn DOT metrics import accuracy_score EOM
import numpy as np EOM
import itertools EOM
from scipy DOT signal import butter COMMA  lfilter EOM
def butter_bandpass PARELEFT lowcut COMMA  fs COMMA  order EQUAL  PARERIGHT : EOM
nyq  EQUAL  0 DOT 5 * fs EOM
low  EQUAL  lowcut / nyq EOM
b COMMA  a  EQUAL  butter PARELEFT order COMMA  low COMMA  btype EQUAL  PARERIGHT  EOM
return b COMMA  a EOM
def butter_bandpass_filter PARELEFT data COMMA  lowcut COMMA  fs COMMA  order EQUAL  PARERIGHT : EOM
b COMMA  a  EQUAL  butter_bandpass PARELEFT lowcut COMMA  fs COMMA  order EQUAL  PARERIGHT  EOM
y  EQUAL  lfilter PARELEFT  PARERIGHT  EOM
return y EOM
def conv_classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  kernel_size EQUAL  COMMA  dilation_rate EQUAL  PARERIGHT   PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  kernel_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT rate EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units  EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT rate  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT activation EQUAL  COMMA  units  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  metrics EQUAL [] COMMA  optimizer EQUAL  PARERIGHT  EOM
summary  EQUAL  model DOT summary PARELEFT  PARERIGHT  EOM
return model COMMA  summary EOM
def hybrid_classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  kernel_size EQUAL  PARERIGHT   PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units  EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT rate  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT rate  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  activation EQUAL  COMMA  units  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  metrics EQUAL [] COMMA  optimizer EQUAL  PARERIGHT  EOM
summary  EQUAL  model DOT summary PARELEFT  PARERIGHT  EOM
return model COMMA  summary EOM
def lstm_classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA  return_sequences EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   PARERIGHT   PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT rate  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  activation EQUAL  COMMA  units  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  metrics EQUAL [] COMMA  optimizer EQUAL  PARERIGHT  EOM
summary  EQUAL  model DOT summary PARELEFT  PARERIGHT  EOM
return model COMMA  summary EOM
def expandgrid PARELEFT  PARERIGHT : EOM
product  EQUAL  list PARELEFT itertools DOT product PARELEFT  PARERIGHT  PARERIGHT  EOM
return product EOM
def evaluate PARELEFT  PARERIGHT : EOM
Y_pred  EQUAL  [] EOM
freq_tab  EQUAL  [] EOM
for example in X: EOM
predic  EQUAL  classifier DOT predict PARELEFT  PARERIGHT  EOM
b_count  EQUAL  np DOT bincount PARELEFT  PARERIGHT  EOM
Y_pred DOT append PARELEFT np DOT argmax PARELEFT  PARERIGHT  PARERIGHT  EOM
n_zero  EQUAL  np DOT nonzero PARELEFT  PARERIGHT [] EOM
freq_tab DOT append PARELEFT list PARELEFT zip PARELEFT  PARERIGHT  PARERIGHT   PARERIGHT  EOM
score  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
return score  COMMA  freq_tab EOM
import keras DOT models EOM
from keras DOT layers import Dense EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT constraints import maxnorm COMMA  non_neg EOM
def singlevar_model PARELEFT optimizer EQUAL  COMMA  init EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  input_dim EQUAL  COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def baseline_model PARELEFT optimizer EQUAL  COMMA  init EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Dropout PARELEFT dropout COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  input_dim EQUAL  COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def medium_model PARELEFT optimizer EQUAL  COMMA  init EQUAL  COMMA  dropout EQUAL  COMMA  nvars EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Dropout PARELEFT dropout COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 11 COMMA  input_dim EQUAL  COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 16 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def medium2_model PARELEFT optimizer EQUAL  COMMA  init EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Dropout PARELEFT dropout COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def two_var_medium_model PARELEFT optimizer EQUAL  COMMA  init EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 16 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def xlarge_model PARELEFT optimizer EQUAL  COMMA  init EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Dropout PARELEFT dropout COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 16 COMMA   kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 16 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 16 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT neurons COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  LSTM COMMA  TimeDistributed EOM
from keras DOT optimizers import Adam EOM
from keras import initializers EOM
from weightnorm import AdamWithWeightnorm EOM
import tensorflow as tf EOM
from multiplicative_lstm import MultiplicativeLSTM EOM
from params import * EOM
def tf_softmax_logits PARELEFT  PARERIGHT : EOM
return tf DOT nn DOT softmax_cross_entropy_with_logits PARELEFT logits EQUAL  COMMA  labels EQUAL  PARERIGHT  EOM
def make_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT features COMMA LSTM_SIZE COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MultiplicativeLSTM PARELEFT LSTM_SIZE COMMA unit_forget_bias EQUAL  COMMA implementation EQUAL  COMMA stateful EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT ense PARELEFT features COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  AdamWithWeightnorm PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def make_run_model PARELEFT  PARERIGHT : EOM
run_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
run_model DOT add PARELEFT Embedding PARELEFT features COMMA LSTM_SIZE COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA embeddings_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
run_model DOT add PARELEFT MultiplicativeLSTM PARELEFT LSTM_SIZE COMMA implementation EQUAL  COMMA stateful EQUAL  COMMA return_sequences EQUAL  COMMA kernel_initializer EQUAL  COMMA recurrent_initializer EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
run_model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT features COMMA activation EQUAL  COMMA kernel_initializer EQUAL  COMMA bias_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return run_modelfrom keras DOT preprocessing import sequence EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Embedding EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU COMMA  Flatten COMMA  Convolution1D COMMA  MaxPooling1D EOM
from keras DOT initializers import RandomUniform EOM
from keras import optimizers EOM
def main PARELEFT  PARERIGHT : EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
hidden_units  EQUAL  1000 EOM
dim  EQUAL  1000 EOM
batch_size  EQUAL  256 EOM
initializer  EQUAL  RandomUniform PARELEFT minval EQUAL  COMMA  maxval EQUAL  COMMA  seed EQUAL  PARERIGHT  EOM
sgd  EQUAL  optimizers DOT SGD PARELEFT lr EQUAL  COMMA  clipnorm EQUAL  PARERIGHT  EOM
left  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT hidden_units COMMA  dim COMMA  input_length EQUAL  COMMA  \dropout EQUAL  PARERIGHT  PARERIGHT  EOM
left DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  init EQUAL  COMMA  \nner_init EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
left DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  init EQUAL  COMMA  \nner_init EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
left DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  init EQUAL  COMMA  \nner_init EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
left DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  init EQUAL  COMMA  \nner_init EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
right  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
right DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  init EQUAL  COMMA  \ner_init EQUAL  COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
right DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  init EQUAL  COMMA  \ner_init EQUAL  COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
right DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  init EQUAL  COMMA  \ner_init EQUAL  COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
right DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  init EQUAL  COMMA  \nner_init EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
score COMMA  acc  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA batch_size EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT [] PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  PARERIGHT  EOM
import keras DOT backend as K EOM
def mean_pred PARELEFT  PARERIGHT : EOM
return K DOT mean PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
import numpy as np EOM
data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT data COMMA  labels COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
import keras EOM
import numpy as np EOM
data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
one_hot_labels  EQUAL  keras DOT utils DOT to_categorical PARELEFT labels COMMA  num_classes EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT data COMMA  one_hot_labels COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT optimizers import SGD EOM
import numpy as np EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
import numpy as np EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Conv1D COMMA  GlobalAveragePooling1D COMMA  MaxPooling1D EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT recurrent import SimpleRNN  COMMA  LSTM EOM
from keras DOT optimizers import SGD  COMMA  Adagrad EOM
LSTM_layers  EQUAL  1 EOM
LSTM_units  EQUAL  512 EOM
DNN_layers  EQUAL  3 EOM
DNN_units  EQUAL  512 EOM
question_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_q1  EQUAL  LSTM  PARELEFT  LSTM_units  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  return_sequences EQUAL  PARERIGHT  EOM
question_model DOT add PARELEFT  PARERIGHT  EOM
answer_1_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a1  EQUAL  LSTM  PARELEFT  LSTM_units  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  return_sequences EQUAL  PARERIGHT  EOM
answer_1_model DOT add PARELEFT  PARERIGHT  EOM
answer_2_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a2  EQUAL  LSTM  PARELEFT  LSTM_units  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  return_sequences EQUAL  PARERIGHT  EOM
answer_2_model DOT add PARELEFT  PARERIGHT  EOM
answer_3_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a3  EQUAL  LSTM  PARELEFT  LSTM_units  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  return_sequences EQUAL  PARERIGHT  EOM
answer_3_model DOT add PARELEFT  PARERIGHT  EOM
answer_4_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a4  EQUAL  LSTM  PARELEFT  LSTM_units  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  return_sequences EQUAL  PARERIGHT  EOM
answer_4_model DOT add PARELEFT  PARERIGHT  EOM
answer_5_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a5  EQUAL  LSTM  PARELEFT  LSTM_units  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  return_sequences EQUAL  PARERIGHT  EOM
answer_5_model DOT add PARELEFT  PARERIGHT  EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Reshape PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  dims  EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
layer_DNN_1  EQUAL  Dense PARELEFT DNN_units  COMMA  init  EQUAL  PARERIGHT  EOM
layer_DNN_1_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_DNN_1_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_DNN_2  EQUAL  Dense PARELEFT DNN_units  COMMA  init  EQUAL  PARERIGHT  EOM
layer_DNN_2_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_DNN_2_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_DNN_3  EQUAL  Dense PARELEFT DNN_units  COMMA  init  EQUAL  PARERIGHT  EOM
layer_DNN_3_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_DNN_3_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_out  EQUAL  Dense PARELEFT  PARERIGHT  EOM
layer_softmax  EQUAL  Activation PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
import arrow COMMA bs4 COMMA random EOM
import numexpr as ne EOM
import numpy as np EOM
import pandas as pd EOM
import tushare as ts EOM
import pypinyin EOM
import matplotlib as mpl EOM
from matplotlib import pyplot as plt EOM
from concurrent DOT futures import ProcessPoolExecutor EOM
from concurrent DOT futures import ThreadPoolExecutor EOM
from concurrent DOT futures import as_completed EOM
import keras as ks EOM
from keras import initializers COMMA models COMMA layers EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential COMMA load_model EOM
from keras DOT layers import Dense COMMA  Input COMMA  Dropout COMMA  Embedding COMMA  LSTM COMMA  Bidirectional COMMA Activation COMMA SimpleRNN COMMA Conv1D COMMA MaxPooling1D COMMA  GlobalMaxPooling1D COMMA GlobalAveragePooling1D EOM
from keras DOT optimizers import RMSprop COMMA  SGD EOM
from keras DOT applications DOT resnet50 import preprocess_input COMMA  decode_predictions EOM
import tflearn as tn EOM
import tensorflow as tf EOM
import tensorlayer as tl EOM
import zsys EOM
import ztools as zt EOM
import ztools_tq as ztq EOM
import zpd_talib as zta EOM
import zai_tools as zat EOM
def mlp01 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  name EQUAL  COMMA input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def mlp010 PARELEFT num_in EQUAL  COMMA num_out EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_in*4 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def mlp020 PARELEFT num_in EQUAL  COMMA num_out EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_in*4 COMMA  input_dim EQUAL  COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_out COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def rnn010 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT num_in*4 COMMA kernel_initializer EQUAL  PARELEFT stddev EQUAL  PARERIGHT  COMMA recurrent_initializer EQUAL  PARELEFT gain EQUAL  PARERIGHT  COMMA activation EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_out COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
rmsprop  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def rnn020 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT num_in*8 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_out COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm010 PARELEFT num_in COMMA num_out EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_in*8 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm020typ PARELEFT num_in EQUAL  COMMA num_out EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_in*8 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_out COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
import os EOM
global_model_version  EQUAL  31 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
import keras DOT models as km EOM
import keras as keras EOM
X_train COMMA  y_train COMMA  X_test COMMA  y_test  EQUAL  lstm DOT load_data PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
tbCallBack  EQUAL  keras DOT callbacks DOT TensorBoard PARELEFT log_dir EQUAL  COMMA  histogram_freq EQUAL  COMMA rite_graph EQUAL  COMMA  write_images EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA y_train COMMA batch_size EQUAL  COMMA nb_epoch EQUAL  COMMA validation_split EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  COMMA callbacks EQUAL [] PARERIGHT  EOM
score COMMA  acc  EQUAL  model DOT evaluate PARELEFT X_test COMMA y_test COMMA batch_size EQUAL  PARERIGHT  EOM
import numpy as np EOM
from keras DOT layers import LSTM EOM
from keras DOT models import Sequential EOM
from phased_lstm_keras DOT PhasedLSTM import PhasedLSTM EOM
def main PARELEFT  PARERIGHT : EOM
X  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
Y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT 10 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT summary PARELEFT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT  PARERIGHT  EOM
model_plstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_plstm DOT add PARELEFT PhasedLSTM PARELEFT 10 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_plstm DOT summary PARELEFT  PARERIGHT  EOM
model_plstm DOT compile PARELEFT  PARERIGHT  EOM
model_lstm DOT fit PARELEFT  PARERIGHT  EOM
model_plstm DOT fit PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT import numpy as np EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Bidirectional COMMA  Dropout COMMA  TimeDistributed EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  Flatten COMMA  Conv1D COMMA  CuDNNLSTM COMMA  CuDNNGRU COMMA  MaxPooling1D EOM
from keras DOT callbacks import ModelCheckpoint COMMA  CSVLogger EOM
from keras import regularizers EOM
window_size  EQUAL  300 EOM
def loss_fn PARELEFT  PARERIGHT : EOM
return 1/np DOT log PARELEFT  PARERIGHT  * keras DOT losses DOT binary_crossentropy PARELEFT  PARERIGHT  EOM
n  EQUAL  a DOT strides[] EOM
return np DOT lib DOT stride_tricks DOT as_strided PARELEFT a COMMA  shape EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  writeable EQUAL  PARERIGHT  EOM
def FC PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
init  EQUAL  keras DOT initializers DOT lecun_uniform PARELEFT seed EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 16 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNLSTM PARELEFT 16 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def fit_model PARELEFT  PARERIGHT : EOM
y  EQUAL  Y EOM
optim  EQUAL  keras DOT optimizers DOT Adam PARELEFT lr EQUAL  COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  COMMA  epsilon EQUAL  COMMA  decay EQUAL  COMMA  amsgrad EQUAL  COMMA  clipnorm EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
csv_logger  EQUAL  CSVLogger PARELEFT  COMMA  append EQUAL  COMMA  separator EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
model DOT fit PARELEFT X COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  validation_split EQUAL  COMMA  shuffle EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
def gen_data PARELEFT  PARERIGHT : EOM
true_signal  EQUAL  data[] EOM
false_signal  EQUAL  data[] EOM
true_X  EQUAL  strided_app PARELEFT true_signal COMMA  L EQUAL  COMMA  S EQUAL  PARERIGHT  EOM
false_X  EQUAL  strided_app PARELEFT false_signal COMMA  L EQUAL  COMMA  S EQUAL  PARERIGHT  EOM
true_Y  EQUAL  np DOT ones PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
false_Y  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
X  EQUAL  np DOT concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
Y  EQUAL  np DOT concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
return X COMMA  Y EOM
def main PARELEFT  PARERIGHT : EOM
data  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
X COMMA  Y  EQUAL  gen_data PARELEFT  PARERIGHT  EOM
X  EQUAL  np DOT expand_dims PARELEFT  PARERIGHT  EOM
model  EQUAL  LSTM PARELEFT  PARERIGHT  EOM
fit_model PARELEFT X COMMA  Y COMMA  bs EQUAL  COMMA  nb_epoch EQUAL  COMMA  model EQUAL  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
import keras as ks EOM
import tensorflow as tf EOM
X_train COMMA  y_train COMMA  X_test COMMA  y_test  EQUAL  lstm DOT load_data PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA y_train COMMA batch_size EQUAL  COMMA nb_epoch EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
predictions  EQUAL  lstm DOT predict_sequences_multiple PARELEFT  PARERIGHT  EOM
lstm DOT plot_results_multiple PARELEFT  PARERIGHT from keras DOT layers import Dense COMMA  Flatten COMMA  Dropout COMMA  Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT regularizers import l2 EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT layers import MaxPooling2D COMMA  TimeDistributed EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  Bidirectional EOM
from keras DOT optimizers import Adam EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
from collections import deque EOM
import sys EOM
from keras DOT optimizers import SGD EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  seq_length COMMA aved_model EQUAL  COMMA  features_length EQUAL  PARERIGHT : EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
if self DOT nb_classes > EQUAL  10: EOM
metrics DOT append PARELEFT  PARERIGHT  EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT cnn_rnn PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT crnn PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL  features_length * seq_length EOM
self DOT model  EQUAL  self DOT mlp PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT conv_3d PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def cnn_rnn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA dropout EQUAL  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1024 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT 2 COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2048 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def crnn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT  PARERIGHT  COMMA   name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def mlp PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def conv_3d PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
import numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Embedding COMMA  LSTM COMMA  Bidirectional EOM
from keras DOT datasets import imdb EOM
from keras DOT callbacks import TensorBoard EOM
max_features  EQUAL  5000 EOM
no_classes  EQUAL  1 EOM
max_length  EQUAL  100 EOM
batch_size  EQUAL  32 EOM
embedding_size  EQUAL  64 EOM
dropout_rate  EQUAL  0 DOT 5 EOM
no_epochs  EQUAL  5 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test COMMA  maxlen EQUAL  PARERIGHT  EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT no_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
tensorboard  EQUAL  TensorBoard PARELEFT  PARERIGHT  EOM
LSTM_model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  epochs EQUAL  COMMA  validation_data EQUAL [] COMMA  callbacks  EQUAL [] PARERIGHT import os as os EOM
import pandas as pd EOM
import numpy as np EOM
import pickle as pkl EOM
from sklearn DOT metrics import mean_squared_error as mse EOM
from sklearn DOT model_selection import train_test_split EOM
from datetime import datetime COMMA  timedelta EOM
from sklearn DOT preprocessing import StandardScaler COMMA  LabelEncoder COMMA  MinMaxScaler EOM
import math as ma EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  BatchNormalization COMMA LSTM EOM
from keras DOT optimizers import sgd COMMA rmsprop COMMA adam EOM
from keras DOT initializers import RandomNormal COMMA  RandomUniform EOM
from keras DOT losses import mean_squared_error COMMA  mean_absolute_error EOM
from keras DOT callbacks import CSVLogger EOM
seed  EQUAL  73 EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
class ModelDataLSTM PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
pass EOM
def lstm_model PARELEFT self COMMA  X COMMA b EQUAL  COMMA n EQUAL  COMMA o EQUAL  PARERIGHT : EOM
features  EQUAL  X DOT shape[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT o COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def lstm_fit PARELEFT self COMMA model COMMA X COMMA Xtest COMMA y COMMA b EQUAL  COMMA e EQUAL  PARERIGHT : EOM
model DOT fit PARELEFT X COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
Xpred  EQUAL  model DOT predict PARELEFT X COMMA  batch_size EQUAL  PARERIGHT  EOM
Xtestpred  EQUAL  model DOT predict PARELEFT Xtest COMMA  batch_size EQUAL  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
return Xpred COMMA  Xtestpredfrom keras DOT layers import Dense COMMA  Dropout COMMA  TimeDistributed EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT initializers import Constant EOM
from keras DOT optimizers import Adam COMMA  RMSprop COMMA  SGD EOM
from keras DOT applications import ResNet50 as ResNet EOM
from collections import deque EOM
from keras import backend as K EOM
from keras DOT layers import Activation COMMA  Lambda COMMA  Input COMMA  Concatenate COMMA  Reshape COMMA  Flatten COMMA  concatenate EOM
from keras DOT layers import Input COMMA  Dense COMMA  Activation COMMA  Dropout COMMA  Conv3D COMMA  MaxPooling3D COMMA  Flatten COMMA ZeroPadding3D EOM
from keras DOT layers import concatenate EOM
def get_model PARELEFT features_length COMMA  image_shape COMMA  len_classes COMMA  seq_length COMMA  model_name COMMA  optimizer_name COMMA  learning_rate COMMA  decay COMMA _units COMMA  lstm_dropout COMMA  dense_dropout COMMA  dense_units COMMA  resnet EQUAL  PARERIGHT : EOM
rm  EQUAL  LSTMModel PARELEFT lstm_units COMMA  len_classes COMMA  seq_length COMMA  features_length EQUAL  COMMA rning_rate EQUAL  COMMA  decay EQUAL  COMMA  model_name EQUAL  COMMA  lstm_dropout EQUAL  COMMA timizer_name EQUAL  COMMA  dense_units EQUAL  COMMA  dense_dpo EQUAL  PARERIGHT  EOM
else: EOM
rm  EQUAL  ResNetLSTMModel PARELEFT lstm_units COMMA  len_classes COMMA  seq_length COMMA  image_shape EQUAL  COMMA  decay EQUAL  COMMA arning_rate EQUAL  COMMA  lstm_dropout EQUAL  COMMA  optimizer_name EQUAL  COMMA ense_units EQUAL  COMMA  dense_dropout EQUAL  PARERIGHT  EOM
return rm EOM
def ctc_lambda_func PARELEFT  PARERIGHT : EOM
y_pred COMMA  labels COMMA  input_length COMMA  label_length  EQUAL  args EOM
y_pred  EQUAL  y_pred[] EOM
return K DOT ctc_batch_cost PARELEFT  PARERIGHT  EOM
class ResNetLSTMModel: EOM
def __init__ PARELEFT self COMMA  units COMMA  nb_classes COMMA  seq_length COMMA  model_name EQUAL  COMMA  image_shape EQUAL  PARELEFT  PARERIGHT  COMMA optimizer_name EQUAL  COMMA ning_rate EQUAL  COMMA  decay EQUAL  COMMA  lstm_dropout EQUAL  COMMA  dense_units EQUAL  COMMA  dense_dropout EQUAL  PARERIGHT : EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
self DOT image_shape  EQUAL  image_shape EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
self DOT optimizer_name  EQUAL  optimizer_name EOM
self DOT learning_rate  EQUAL  learning_rate EOM
self DOT decay  EQUAL  decay EOM
self DOT model_name  EQUAL  model_name +  +  + str PARELEFT  PARERIGHT  +  +  + str PARELEFT  PARERIGHT  +  \ EOM
metrics  EQUAL  [] EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT build_resnet PARELEFT  PARERIGHT  EOM
self DOT layer  EQUAL  1 EOM
self DOT direction  EQUAL  EOM
self DOT compile PARELEFT  PARERIGHT  EOM
def build_resnet PARELEFT self COMMA  units COMMA  dropout EQUAL  COMMA  dense_units EQUAL  COMMA  dense_dropout EQUAL  PARERIGHT : EOM
resnet  EQUAL  ResNet PARELEFT include_top EQUAL  COMMA  pooling EQUAL  PARERIGHT  EOM
input_data  EQUAL  Input PARELEFT name EQUAL  COMMA  shape EQUAL  COMMA  dtype EQUAL  PARERIGHT  EOM
labels  EQUAL  Input PARELEFT name EQUAL  COMMA  shape EQUAL [] COMMA  dtype EQUAL  PARERIGHT  EOM
input_length  EQUAL  Input PARELEFT name EQUAL  COMMA  shape EQUAL [] COMMA  dtype EQUAL  PARERIGHT  EOM
label_length  EQUAL  Input PARELEFT name EQUAL  COMMA  shape EQUAL [] COMMA  dtype EQUAL  PARERIGHT  EOM
res_list  EQUAL  [] EOM
for j in range PARELEFT  PARERIGHT : EOM
def slice PARELEFT  PARERIGHT : EOM
return x[] EOM
inner  EQUAL  resnet PARELEFT Lambda PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  PARERIGHT  EOM
res_list DOT append PARELEFT  PARERIGHT  EOM
m  EQUAL  concatenate PARELEFT res_list COMMA  axis EQUAL  PARERIGHT  EOM
inner  EQUAL  Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
inner  EQUAL  TimeDistributed PARELEFT Dense PARELEFT dense_units // 16 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  bias_initializer EQUAL  PARELEFT value EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
y_pred  EQUAL  TimeDistributed PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
loss_out  EQUAL  Lambda PARELEFT ctc_lambda_func COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT direction  EQUAL  EOM
return model EOM
def compile PARELEFT self COMMA  lr EQUAL  PARERIGHT : EOM
if lr is not None: EOM
self DOT learning_rate  EQUAL  lr EOM
if self DOT optimizer_name  EQUAL  EQUAL  : EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
elif self DOT optimizer_name  EQUAL  EQUAL  : EOM
optimizer  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
class LSTMModel: EOM
def __init__ PARELEFT self COMMA  units COMMA  nb_classes COMMA  seq_length COMMA  model_name EQUAL  COMMA  features_length EQUAL  COMMA  optimizer_name EQUAL  COMMA ning_rate EQUAL  COMMA  decay EQUAL  COMMA  lstm_dropout EQUAL  COMMA  dense_units EQUAL  COMMA  dense_dpo EQUAL  PARERIGHT : EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
self DOT optimizer_name  EQUAL  optimizer_name EOM
self DOT learning_rate  EQUAL  learning_rate EOM
self DOT decay  EQUAL  decay EOM
self DOT model_name  EQUAL  model_name +  +  + str PARELEFT  PARERIGHT  +  +  + str PARELEFT  PARERIGHT  +  + \ EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
if model_name  EQUAL  EQUAL  : EOM
m COMMA  l COMMA  d  EQUAL  lstm PARELEFT  PARERIGHT  EOM
elif model_name  EQUAL  EQUAL  : EOM
m COMMA  l COMMA  d  EQUAL  two_layer_lstm PARELEFT  PARERIGHT  EOM
elif model_name  EQUAL  EQUAL  : EOM
m COMMA  l COMMA  d  EQUAL  three_layer_lstm PARELEFT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT {}\ DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model  EQUAL  m EOM
self DOT layer  EQUAL  l EOM
self DOT direction  EQUAL  d EOM
def compile PARELEFT self COMMA  lr EQUAL  PARERIGHT : EOM
if lr is not None: EOM
self DOT learning_rate  EQUAL  lr EOM
if self DOT optimizer_name  EQUAL  EQUAL  : EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
elif self DOT optimizer_name  EQUAL  EQUAL  : EOM
optimizer  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
def two_layer_lstm PARELEFT input_shape COMMA  nb_classes COMMA  units COMMA  dropout EQUAL  COMMA  dense_units EQUAL  COMMA  dense_dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units COMMA  return_sequences EQUAL  COMMA  bias_initializer EQUAL  PARELEFT value EQUAL  PARERIGHT  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  bias_initializer EQUAL  PARELEFT value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT dense_units COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model COMMA  2 COMMA  EOM
def three_layer_lstm PARELEFT input_shape COMMA  nb_classes COMMA  units COMMA  dropout EQUAL  COMMA  dense_units EQUAL  COMMA  dense_dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  bias_initializer EQUAL  PARELEFT value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  bias_initializer EQUAL  PARELEFT value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  bias_initializer EQUAL  PARELEFT value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT dense_units COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model COMMA  3 COMMA  EOM
def lstm PARELEFT input_shape COMMA  nb_classes COMMA  units COMMA  dropout EQUAL  COMMA  dense_units EQUAL  COMMA  dense_dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  bias_initializer EQUAL  PARELEFT value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT dense_units COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model COMMA  1 COMMA  import numpy as np EOM
import keras EOM
from keras DOT models import Sequential COMMA  Graph EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT convolutional import Convolution1D COMMA  MaxPooling1D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT utils import np_utils COMMA  generic_utils EOM
import data_helpers EOM
from w2v import train_word2vec EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
cnn_train COMMA lstm_train COMMA Y_train COMMA cnn_vocabulary COMMA cnn_vocabulary_inv COMMA lstm_vocabulary COMMA lstm_vocabulary_inv  EQUAL  data_helpers DOT load_data PARELEFT  PARERIGHT  EOM
cnn_embedding_weights COMMA lstm_embedding_weights  EQUAL  train_word2vec PARELEFT  PARERIGHT  EOM
shuffle_indices  EQUAL  np DOT random DOT permutation PARELEFT np DOT arange PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
cnn_shuffled  EQUAL  cnn_train[] EOM
lstm_shuffled  EQUAL  lstm_train[] EOM
Y_train  EQUAL  Y_train[] EOM
filter_sizes  EQUAL   PARELEFT  PARERIGHT  EOM
num_filters  EQUAL  150 EOM
hidden_dims  EQUAL  150 EOM
cnn_graph  EQUAL  Graph PARELEFT  PARERIGHT  EOM
cnn_graph DOT add_input PARELEFT name EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
for fsz in filter_sizes: EOM
conv  EQUAL  Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  EOM
pool  EQUAL  MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  EOM
cnn_graph DOT add_node PARELEFT conv COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
cnn_graph DOT add_node PARELEFT pool COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
cnn_graph DOT add_node PARELEFT Flatten PARELEFT  PARERIGHT  COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
if len PARELEFT  PARERIGHT >1: EOM
cnn_graph DOT add_output PARELEFT name EQUAL  COMMA inputs EQUAL [] COMMA merge_mode EQUAL  PARERIGHT  EOM
else: EOM
cnn_graph DOT add_output PARELEFT name EQUAL  COMMA  input EQUAL [] PARERIGHT  EOM
cnn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
cnn DOT add PARELEFT Embedding PARELEFT len PARELEFT  PARERIGHT  COMMA  300 COMMA  input_length EQUAL  COMMA weights EQUAL  PARERIGHT  PARERIGHT  EOM
cnn DOT add PARELEFT Dropout PARELEFT 0 DOT 25 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
cnn DOT add PARELEFT  PARERIGHT  EOM
lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm DOT add PARELEFT Embedding PARELEFT len PARELEFT  PARERIGHT  COMMA  300 COMMA  input_length EQUAL  COMMA weights EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  activation EQUAL  COMMA  inner_activation EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT core DOT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA  Y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA show_accuracy EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
def get_simple_net PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Embedding PARELEFT dictionary_length + 1 COMMA  32 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def get_dropout_net PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Embedding PARELEFT dictionary_length + 1 COMMA  32 COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelimport os EOM
from sklearn DOT externals import joblib EOM
import numpy as np EOM
from copy import deepcopy EOM
from plmodel import PLModel COMMA  DefaultScaler EOM
from sklearn DOT preprocessing import StandardScaler COMMA  MinMaxScaler EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  LSTM COMMA  BatchNormalization EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT initializers import Constant EOM
from keras DOT callbacks import EarlyStopping COMMA  ModelCheckpoint EOM
import tensorflow as tf EOM
from modelcontainer import DefaultModelContainer EOM
class KerasModelContainer PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model EQUAL  COMMA  task EQUAL  COMMA  metric EQUAL  PARERIGHT : EOM
DefaultModelContainer DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  model EOM
if metric in []: EOM
self DOT loss  EQUAL  EOM
self DOT task  EQUAL  EOM
self DOT last_act  EQUAL  EOM
elif metric in []: EOM
self DOT loss  EQUAL  EOM
self DOT task  EQUAL  EOM
self DOT last_act  EQUAL  EOM
elif metric in []: EOM
self DOT loss  EQUAL  EOM
self DOT task  EQUAL  EOM
self DOT last_act  EQUAL  EOM
elif metric in []: EOM
self DOT loss  EQUAL  EOM
self DOT task  EQUAL  EOM
self DOT last_act  EQUAL  EOM
elif  in metric: EOM
self DOT loss  EQUAL  metric EOM
self DOT task  EQUAL  EOM
self DOT last_act  EQUAL  EOM
elif task  EQUAL  EQUAL  : EOM
self DOT loss  EQUAL  EOM
self DOT task  EQUAL  EOM
self DOT last_act  EQUAL  EOM
else: EOM
raise NotImplementedError PARELEFT  DOT format PARELEFT lt EQUAL  COMMA  me EQUAL  PARERIGHT  PARERIGHT  EOM
def build_model PARELEFT  PARERIGHT : EOM
return self DOT model EOM
class KerasMLP PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model EQUAL  COMMA  task EQUAL  COMMA  metric EQUAL  COMMA nse_units EQUAL  COMMA  dropout EQUAL  COMMA  lr EQUAL  PARERIGHT : EOM
KerasModelContainer DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT dense_units  EQUAL  dense_units EOM
self DOT dropout  EQUAL  dropout EOM
self DOT lr  EQUAL  lr EOM
return EOM
def build_model PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  units EQUAL  COMMA  bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  COMMA  loss EQUAL  PARERIGHT  EOM
return self DOT model EOM
class KerasMLP2 PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model EQUAL  COMMA  task EQUAL  COMMA  metric EQUAL  COMMA e_units EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  PARELEFT  PARERIGHT  COMMA  lr EQUAL  PARERIGHT : EOM
KerasModelContainer DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT dense_units  EQUAL  dense_units EOM
self DOT dropout  EQUAL  dropout EOM
self DOT lr  EQUAL  lr EOM
return EOM
def build_model PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  units EQUAL [] COMMA  bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT units EQUAL [] COMMA  bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  COMMA  loss EQUAL  PARERIGHT  EOM
return self DOT model EOM
class KerasLSTM PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model EQUAL  COMMA  task EQUAL  COMMA  metric EQUAL  COMMA _lookback EQUAL  COMMA  lstm_units EQUAL  PARERIGHT : EOM
KerasModelContainer DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT lstm_units  EQUAL  lstm_units EOM
self DOT n_lookback  EQUAL  n_lookback EOM
return EOM
def build_model PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA  activation EQUAL  COMMA  recurrent_activation EQUAL  COMMA ut_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
return self DOT model EOM
class KerasLSTM2 PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model EQUAL  COMMA  task EQUAL  COMMA  metric EQUAL  COMMA lookback EQUAL  COMMA  lstm_units EQUAL  PARELEFT  PARERIGHT  PARERIGHT : EOM
KerasModelContainer DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT lstm_units  EQUAL  lstm_units EOM
self DOT n_lookback  EQUAL  n_lookback EOM
return EOM
def build_model PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT units EQUAL [] COMMA  activation EQUAL  COMMA  recurrent_activation EQUAL  COMMA ut_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT units EQUAL [] COMMA  activation EQUAL  COMMA  recurrent_activation EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
return self DOT model EOM
class KerasLSTM3 PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model EQUAL  COMMA  task EQUAL  COMMA  metric EQUAL  COMMA lookback EQUAL  COMMA  lstm_units EQUAL  COMMA  dense_units EQUAL  PARERIGHT : EOM
KerasModelContainer DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT lstm_units  EQUAL  lstm_units EOM
self DOT dense_units  EQUAL  dense_units EOM
self DOT n_lookback  EQUAL  n_lookback EOM
return EOM
def build_model PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA  activation EQUAL  COMMA  recurrent_activation EQUAL  COMMA ut_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT **{: self DOT dense_units COMMA  : Constant PARELEFT  PARERIGHT  COMMA rnel_initializerglorot_normalactivationrelu EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
return self DOT model EOM
class KerasModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model_container COMMA  nb_epochs EQUAL  COMMA  tmp_dir EQUAL  COMMA  **model_args PARERIGHT : EOM
PLModel DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT model_container  EQUAL  model_container EOM
self DOT nb_epochs  EQUAL  nb_epochs EOM
self DOT fit_res  EQUAL  None EOM
self DOT tmp_dir  EQUAL  tmp_dir EOM
if not os DOT path DOT exists PARELEFT  PARERIGHT : EOM
os DOT makedirs PARELEFT  PARERIGHT  EOM
return EOM
def _fit_and_eval PARELEFT self COMMA  X_train COMMA  y_train COMMA  f_val EQUAL  COMMA  early_stop EQUAL  COMMA  min_delta EQUAL  COMMA  use_best EQUAL  PARERIGHT : EOM
try: EOM
X_train_  EQUAL  self DOT scaler DOT transform PARELEFT  PARERIGHT  EOM
except AttributeError as e: EOM
self DOT fit_scaler PARELEFT  PARERIGHT  EOM
X_train_  EQUAL  self DOT scaler DOT transform PARELEFT  PARERIGHT  EOM
if getattr PARELEFT  PARERIGHT  is None: EOM
self DOT model_container DOT n_lookback  EQUAL  None EOM
if self DOT model is not None and len PARELEFT self DOT model DOT get_input_shape_at PARELEFT  PARERIGHT  PARERIGHT  > 2: EOM
self DOT model_container DOT n_lookback  EQUAL  self DOT model DOT get_input_shape_at PARELEFT  PARERIGHT [] EOM
if self DOT model_container DOT n_lookback is not None: EOM
X_batches COMMA  y_batches  EQUAL  [] COMMA  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
xbatch  EQUAL  X_train_[] EOM
ybatch  EQUAL  y_train[] EOM
X_batches DOT append PARELEFT  PARERIGHT  EOM
y_batches DOT append PARELEFT  PARERIGHT  EOM
X_train_  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
ival  EQUAL  int PARELEFT np DOT floor PARELEFT  PARELEFT  PARERIGHT  * X_train_ DOT shape[] PARERIGHT  PARERIGHT  EOM
X_val COMMA  y_val  EQUAL  X_train_[] COMMA  y_train[] EOM
X_train_ COMMA  y_train  EQUAL  X_train_[] COMMA  y_train[] EOM
callbacks  EQUAL  [] EOM
if early_stop: EOM
callbacks  EQUAL  [] EOM
callbacks DOT append PARELEFT ModelCheckpoint PARELEFT filepath EQUAL  PARELEFT  PARERIGHT  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  PARERIGHT  PARERIGHT  EOM
if self DOT model is None: EOM
self DOT set_model PARELEFT self DOT model_container DOT build_model PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT fit_res  EQUAL  self DOT model DOT fit PARELEFT X_train_ COMMA  y_train COMMA  epochs EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA erbose EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
if use_best: EOM
self DOT model  EQUAL  load_model PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
return self DOT fit_res EOM
def fit PARELEFT  PARERIGHT : EOM
try: EOM
X_train_  EQUAL  self DOT scaler DOT transform PARELEFT  PARERIGHT  EOM
except AttributeError as e: EOM
self DOT fit_scaler PARELEFT  PARERIGHT  EOM
X_train_  EQUAL  self DOT scaler DOT transform PARELEFT  PARERIGHT  EOM
if getattr PARELEFT  PARERIGHT  is None: EOM
self DOT model_container DOT n_lookback  EQUAL  None EOM
if self DOT model is not None and len PARELEFT self DOT model DOT get_input_shape_at PARELEFT  PARERIGHT  PARERIGHT  > 2: EOM
self DOT model_container DOT n_lookback  EQUAL  self DOT model DOT get_input_shape_at PARELEFT  PARERIGHT [] EOM
if self DOT model_container DOT n_lookback is not None: EOM
X_batches COMMA  y_batches  EQUAL  [] COMMA  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
xbatch  EQUAL  X_train_[] EOM
ybatch  EQUAL  y_train[] EOM
X_batches DOT append PARELEFT  PARERIGHT  EOM
y_batches DOT append PARELEFT  PARERIGHT  EOM
X_train_  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
if self DOT model is None: EOM
self DOT set_model PARELEFT self DOT model_container DOT build_model PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT fit_res  EQUAL  self DOT model DOT fit PARELEFT X_train_ COMMA  y_train COMMA  epochs EQUAL  COMMA  validation_split EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
return self DOT fit_res EOM
def predict PARELEFT  PARERIGHT : EOM
if self DOT model is None: EOM
self DOT set_model PARELEFT self DOT model_container DOT build_model PARELEFT  PARERIGHT  PARERIGHT  EOM
X  EQUAL  self DOT scaler DOT transform PARELEFT  PARERIGHT  EOM
if getattr PARELEFT  PARERIGHT  is None: EOM
self DOT model_container DOT n_lookback  EQUAL  None EOM
if self DOT model is not None and len PARELEFT self DOT model DOT get_input_shape_at PARELEFT  PARERIGHT  PARERIGHT  > 2: EOM
self DOT model_container DOT n_lookback  EQUAL  self DOT model DOT get_input_shape_at PARELEFT  PARERIGHT [] EOM
if self DOT model_container DOT n_lookback is not None: EOM
X_batches  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
xbatch  EQUAL  X[] EOM
X_batches DOT append PARELEFT  PARERIGHT  EOM
X  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_pred  EQUAL  self DOT model DOT predict PARELEFT  PARERIGHT  EOM
return y_pred DOT ravel PARELEFT  PARERIGHT  EOM
def predict_proba PARELEFT  PARERIGHT : EOM
pass EOM
def save_model PARELEFT  PARERIGHT : EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
joblib DOT dump PARELEFT self DOT scaler COMMA  model_filepath +  COMMA  compress EQUAL  PARERIGHT  EOM
def load_model PARELEFT  PARERIGHT : EOM
keras_model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
keras_loss  EQUAL  keras_model DOT loss EOM
model_inst  EQUAL  cls PARELEFT KerasModelContainer PARELEFT model EQUAL  COMMA  metric EQUAL  PARERIGHT  PARERIGHT  EOM
model_inst DOT scaler  EQUAL  joblib DOT load PARELEFT  PARERIGHT  EOM
return model_instfrom keras DOT layers DOT core import Dense COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
from keras import optimizers EOM
from keras DOT utils import plot_model EOM
import os EOM
import warnings EOM
def lstm_2 PARELEFT input_shape COMMA  layers_out COMMA  lr EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model_name  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  COMMA output_dim EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers_out[] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return model COMMA  model_name EOM
def lstm_1 PARELEFT input_shape COMMA  layers_out COMMA  lr EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model_name  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  COMMA output_dim EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return model COMMA  model_name EOM
def lstm_bp PARELEFT input_shape COMMA layers_out COMMA lr EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
model_name  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers_out[] COMMA  input_shape EQUAL  COMMA  dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers_out[] COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT layers_out[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  COMMA  loss EQUAL  PARERIGHT  EOM
return model COMMA  model_name EOM
if __name__  EQUAL  EQUAL  : EOM
layer_out  EQUAL  [] EOM
input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
model COMMA model_name EQUAL  lstm_bp PARELEFT  PARERIGHT  EOM
plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT import numpy as np EOM
import pandas as pd EOM
from keras DOT layers import Dense COMMA  Activation EOM
from keras DOT layers import LSTM as lstm_m EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import RMSprop EOM
from ML_models DOT OutputLayerModel_I import OutputLayerModel_I EOM
additionalDim  EQUAL  1 EOM
vecLen  EQUAL  115 EOM
def BuildLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
l EQUAL lstm_m PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT lstm_m PARELEFT 128 COMMA input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
NumOfInstances  EQUAL  len PARELEFT  PARERIGHT  EOM
X  EQUAL  np DOT reshape PARELEFT X COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
x  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
x  EQUAL  X[] EOM
y  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT x COMMA  y COMMA  epochs EQUAL  PARERIGHT  EOM
x  EQUAL  X[] EOM
y  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
scores  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
with open PARELEFT str PARELEFT  PARERIGHT  +  +  COMMA   PARERIGHT  as scoresFP: EOM
for sc in scores: EOM
scoresFP DOT write PARELEFT str PARELEFT  PARERIGHT  +  PARERIGHT  EOM
class LSTM  PARELEFT  PARERIGHT : EOM
def train PARELEFT  PARERIGHT : EOM
thresh EQUAL 1 EOM
NumOfInstances  EQUAL 1 EOM
x  EQUAL  [] EOM
vecLen EQUAL len PARELEFT  PARERIGHT  EOM
x  EQUAL  np DOT reshape PARELEFT x COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT fit PARELEFT x COMMA y COMMA   epochs EQUAL  PARERIGHT  EOM
def execute  PARELEFT  PARERIGHT : EOM
thresh  EQUAL  1 EOM
NumOfInstances  EQUAL  1 EOM
vecLen  EQUAL  len PARELEFT  PARERIGHT  EOM
x  EQUAL  np DOT reshape PARELEFT x COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
scores  EQUAL  self DOT model DOT predict PARELEFT  PARERIGHT  EOM
return scores[] EOM
def __init__  PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT lstm_m PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
self DOT model EQUAL model EOM
BuildLSTM PARELEFT  PARERIGHT  EOM
lstm EQUAL LSTM PARELEFT  PARERIGHT  EOM
lstm DOT train PARELEFT []] PARERIGHT  EOM
lstm DOT execute PARELEFT []] PARERIGHT from keras DOT layers import LSTM COMMA  Dense COMMA  Input COMMA  InputLayer COMMA  Permute COMMA  BatchNormalization COMMA  \ EOM
GRU COMMA  Conv1D COMMA  MaxPooling1D EOM
from keras DOT models import Sequential EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT model_selection import GridSearchCV EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from collections import defaultdict EOM
from src DOT const import * EOM
import csv EOM
INPUT_SHAPE  EQUAL   PARELEFT  PARERIGHT  EOM
LSTM_SIZE  EQUAL  100 EOM
def get_model PARELEFT  PARERIGHT : EOM
lstm_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_model DOT add PARELEFT InputLayer PARELEFT input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT LSTM PARELEFT LSTM_SIZE COMMA dropout EQUAL  COMMA recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Dense PARELEFT NUMBER_OF_PLAYERS COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT summary PARELEFT  PARERIGHT  EOM
lstm_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return lstm_model EOM
def read_new_csv PARELEFT  PARERIGHT : EOM
players_action_dict  EQUAL  defaultdict PARELEFT  PARERIGHT  EOM
action_dict  EQUAL  {} EOM
action_max_id  EQUAL  0 EOM
with open PARELEFT  PARERIGHT  as csvfile: EOM
reader  EQUAL  csv DOT reader PARELEFT csvfile COMMA  delimiter EQUAL  COMMA  quotechar EQUAL  PARERIGHT  EOM
for line_number COMMA  row in enumerate PARELEFT  PARERIGHT : EOM
player_id  EQUAL  row[] EOM
game_list  EQUAL  [] EOM
for action in row[]: EOM
if action in action_dict: EOM
action_id  EQUAL  action_dict[] EOM
else: EOM
action_id  EQUAL  action_max_id EOM
action_dict[]  EQUAL  action_max_id EOM
action_max_id + EQUAL  1 EOM
game_list DOT append PARELEFT  PARERIGHT  EOM
players_action_dict[] DOT append PARELEFT  PARERIGHT  EOM
return players_action_dict COMMA  action_max_id EOM
def split_training_set PARELEFT source_dict COMMA  test_to_train_ratio EQUAL  PARERIGHT : EOM
train_dict  EQUAL  {} EOM
test_dict  EQUAL  {} EOM
for player_name COMMA  player_game in source_dict DOT items PARELEFT  PARERIGHT : EOM
number_of_games  EQUAL  len PARELEFT  PARERIGHT  EOM
split_index  EQUAL  number_of_games - int PARELEFT  PARERIGHT  - 2 EOM
train_game  EQUAL  player_game[] EOM
test_game  EQUAL  player_game[] EOM
train_dict[]  EQUAL  train_game EOM
test_dict[]  EQUAL  test_game EOM
return train_dict COMMA  test_dict EOM
def csv_set_to_keras_batch PARELEFT  PARERIGHT : EOM
batch_input  EQUAL  [] EOM
batch_output  EQUAL  [] EOM
player_id_to_name_dict  EQUAL  {} EOM
for i COMMA  t in enumerate PARELEFT csv_dict DOT items PARELEFT  PARERIGHT  PARERIGHT : EOM
player_id_to_name_dict[]  EQUAL  t[] EOM
for string in t[]: EOM
output_array  EQUAL  np DOT zeros PARELEFT shape EQUAL  COMMA  dtype EQUAL  PARERIGHT  EOM
output_array[]  EQUAL  1 EOM
batch_input DOT append PARELEFT  PARERIGHT  EOM
batch_output DOT append PARELEFT  PARERIGHT  EOM
return batch_input COMMA  batch_output COMMA  player_id_to_name_dict EOM
if __name__  EQUAL  EQUAL  : EOM
top_words  EQUAL  1000 EOM
value COMMA  top_words  EQUAL  read_new_csv PARELEFT  PARERIGHT  EOM
train COMMA  test  EQUAL  split_training_set PARELEFT  PARERIGHT  EOM
X_train COMMA  y_train COMMA  _  EQUAL  csv_set_to_keras_batch PARELEFT  PARERIGHT  EOM
X_test COMMA  y_test COMMA  _  EQUAL  csv_set_to_keras_batch PARELEFT  PARERIGHT  EOM
max_review_length  EQUAL  1000 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 200 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
exit PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT np DOT array PARELEFT  PARERIGHT  COMMA np DOT array PARELEFT  PARERIGHT  COMMA nb_epoch EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import pickle EOM
import numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
from keras DOT callbacks import Callback COMMA  EarlyStopping EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Embedding COMMA  SpatialDropout1D EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU EOM
from keras DOT regularizers import l2 EOM
from keras DOT constraints import maxnorm EOM
from keras DOT datasets import imdb EOM
from qrnn DOT qrnn import QRNN EOM
def regenerate_dataset PARELEFT timesteps EQUAL  PARERIGHT : EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  COMMA   padding EQUAL  COMMA  truncating EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  COMMA   padding EQUAL  COMMA  truncating EQUAL  PARERIGHT  EOM
X_train COMMA  y_train COMMA  X_test COMMA  y_test  EQUAL  X_train[] COMMA  y_train[] COMMA  X_test[] COMMA  y_test[] EOM
return X_train COMMA  y_train COMMA  X_test COMMA  y_test EOM
class TimeHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT times  EQUAL  0 EOM
def on_epoch_begin PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT epoch_time_start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
def on_epoch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT times  EQUAL  time DOT time PARELEFT  PARERIGHT  - self DOT epoch_time_start EOM
time_callback  EQUAL  TimeHistory PARELEFT  PARERIGHT  EOM
def time_lstm PARELEFT  PARERIGHT : EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model_lstm DOT fit PARELEFT *train_set COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA validation_data EQUAL  COMMA erbose EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
return time_callback DOT times EOM
def time_qrnn PARELEFT  PARERIGHT : EOM
model_qrnn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_qrnn DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model_qrnn DOT add PARELEFT QRNN PARELEFT 128 COMMA  window_size EQUAL  PARERIGHT  PARERIGHT  EOM
model_qrnn DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_qrnn DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_qrnn DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model_qrnn DOT fit PARELEFT *train_set COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA validation_data EQUAL  COMMA erbose EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
return time_callback DOT times EOM
max_features  EQUAL  20000 EOM
maxlen  EQUAL  256 EOM
batch_size  EQUAL  32 EOM
epochs  EQUAL  1 EOM
matrice_results  EQUAL  [] EOM
X_train COMMA  y_train COMMA  X_test COMMA  y_test  EQUAL  regenerate_dataset PARELEFT  PARERIGHT  EOM
batch_matrice  EQUAL  [] EOM
t1  EQUAL  time_qrnn PARELEFT batch_size EQUAL  COMMA  train_set EQUAL  PARELEFT  PARERIGHT  COMMA  test_set EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
t2  EQUAL  time_lstm PARELEFT batch_size EQUAL  COMMA  train_set EQUAL  PARELEFT  PARERIGHT  COMMA  test_set EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_matrice DOT append PARELEFT  PARERIGHT  EOM
matrice_results DOT append PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as file: EOM
pickle DOT dump PARELEFT  PARERIGHT from keras DOT layers import LSTM COMMA  Dense COMMA  Input COMMA  InputLayer COMMA  Permute COMMA  BatchNormalization COMMA  \ EOM
GRU COMMA  Conv1D COMMA  MaxPooling1D EOM
from keras DOT models import Sequential COMMA  save_model EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT model_selection import GridSearchCV EOM
from src DOT const import * EOM
from src DOT utils import * EOM
INPUT_SHAPE  EQUAL   PARELEFT  PARERIGHT  EOM
LSTM_SIZE  EQUAL  50 EOM
def get_model PARELEFT  PARERIGHT : EOM
lstm_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_model DOT add PARELEFT InputLayer PARELEFT input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Dense PARELEFT NUMBER_OF_PLAYERS COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT summary PARELEFT  PARERIGHT  EOM
lstm_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return lstm_model EOM
if __name__  EQUAL  EQUAL  : EOM
csv_dict  EQUAL  read_csv_sequence PARELEFT  PARERIGHT  EOM
players_dict COMMA  val_players_dict  EQUAL  split_training_set PARELEFT  PARERIGHT  EOM
batch_input COMMA  batch_input_other_info COMMA  batch_output COMMA  player_id_to_name_dict \ EOM
 EQUAL  csv_sequence_set_to_keras_batch PARELEFT  PARERIGHT  EOM
val_batch_input COMMA  val_batch_input_other_info COMMA  val_batch_output COMMA  _ \ EOM
 EQUAL  csv_sequence_set_to_keras_batch PARELEFT  PARERIGHT  EOM
model  EQUAL  get_model PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT x EQUAL  COMMA y EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
save_model PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Flatten EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
class Data_Obj PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  input_data  EQUAL []] COMMA  output_data  EQUAL [] PARERIGHT : EOM
self DOT in_data  EQUAL  input_data EOM
self DOT out_data  EQUAL  output_data EOM
def data_func PARELEFT  PARERIGHT : EOM
keras_X  EQUAL  [] EOM
keras_Y  EQUAL  [] EOM
temp  EQUAL  [] EOM
filter_size  EQUAL  3 EOM
for data in raw_data: EOM
temp DOT append PARELEFT np DOT asmatrix PARELEFT  PARERIGHT  DOT transpose PARELEFT  PARERIGHT  PARERIGHT  EOM
if data DOT out_data ! EQUAL  None: EOM
keras_Y DOT append PARELEFT np DOT asarray PARELEFT  PARERIGHT  PARERIGHT  EOM
for temp_X in temp: EOM
real_X  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
real_X DOT append PARELEFT  PARERIGHT  EOM
keras_X DOT append PARELEFT np DOT asarray PARELEFT  PARERIGHT  PARERIGHT  EOM
keras_X  EQUAL  np DOT asarray PARELEFT  PARERIGHT  EOM
keras_Y  EQUAL  np DOT asarray PARELEFT  PARERIGHT  EOM
return  PARELEFT  PARERIGHT  EOM
filter_size  EQUAL  3 EOM
cnn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
cnn DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
cnn DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
cnn DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT cnn COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT classif_num COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT keras_training_X COMMA  keras_training_Y COMMA  epochs  EQUAL  COMMA  batch_size  EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
import keras EOM
from keras DOT layers import Convolution2D COMMA  Activation COMMA  MaxPooling2D COMMA  Flatten COMMA  Dense COMMA  LSTM COMMA  Dropout EOM
from keras DOT models import Sequential EOM
from keras DOT regularizers import l2 EOM
def create_compile_cnn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
number_of_time_stamps  EQUAL  20 EOM
number_of_out_channels  EQUAL  10 EOM
number_of_in_channels  EQUAL  55 EOM
model DOT add PARELEFT Convolution2D PARELEFT nb_filter EQUAL  COMMA nb_col EQUAL  COMMA nb_row EQUAL  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  COMMA border_mode EQUAL  COMMA init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT olution2D PARELEFT nb_filter EQUAL  COMMA  nb_row EQUAL  COMMA  nb_col EQUAL  COMMA  border_mode EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def create_compile_lstm_model PARELEFT  PARERIGHT : EOM
model_lstm DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT 2 COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model_lstm EOM
def create_compile_lstm_model_letter PARELEFT  PARERIGHT : EOM
model_lstm DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT 5 COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model_lstm EOM
def create_compile_dense_model PARELEFT  PARERIGHT : EOM
model_lstm DOT add PARELEFT keras DOT layers DOT core DOT Flatten PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model_lstm EOM
def create_small_compile_dense_model PARELEFT  PARERIGHT : EOM
model_lstm DOT add PARELEFT keras DOT layers DOT core DOT Flatten PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model_lstm EOM
def create_small_compile_dense_model_color PARELEFT  PARERIGHT : EOM
model_lstm DOT add PARELEFT keras DOT layers DOT core DOT Flatten PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model_lstm EOM
def create_small_compile_dense_model_color_less_params PARELEFT  PARERIGHT : EOM
model_lstm DOT add PARELEFT keras DOT layers DOT core DOT Flatten PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model_lstmimport pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT __author__  EQUAL __author2__  EQUAL  EOM
from keras DOT models import Model COMMA  Sequential COMMA  load_model EOM
from keras DOT layers import Input COMMA  Dense EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed COMMA  Bidirectional EOM
from keras DOT layers DOT core import RepeatVector EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT noise import GaussianNoise EOM
from keras DOT layers DOT convolutional import Convolution1D EOM
from keras DOT layers DOT pooling import MaxPooling1D EOM
from scipy DOT spatial DOT distance import cosine EOM
import numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
class Sequence2Sequence: EOM
def decode_one_hot PARELEFT  PARERIGHT : EOM
predicted  EQUAL  keras_model DOT predict PARELEFT np DOT array PARELEFT  PARERIGHT  PARERIGHT [] EOM
res  EQUAL  [] EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
argmax  EQUAL  np DOT argmax PARELEFT  PARERIGHT  EOM
if argmax EQUAL  EQUAL max_word_index-1: EOM
res DOT append PARELEFT  PARERIGHT  EOM
break EOM
elif argmax EQUAL  EQUAL max_word_index: pass EOM
else: EOM
if reverse_index[]! EQUAL  and reverse_index[]! EQUAL : EOM
res DOT append PARELEFT  PARERIGHT  EOM
else: EOM
res DOT append PARELEFT  PARERIGHT  EOM
break EOM
return  DOT join PARELEFT  PARERIGHT  EOM
def decode_embedding PARELEFT  PARERIGHT : EOM
predicted  EQUAL  keras_model DOT predict PARELEFT np DOT array PARELEFT  PARERIGHT  PARERIGHT [] EOM
res  EQUAL  [] EOM
pad  EQUAL  np DOT zeros PARELEFT  PARERIGHT -0 DOT 037 EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
aux  EQUAL  w2v_model DOT most_similar PARELEFT []] COMMA  [] COMMA  topn EQUAL  PARERIGHT [] EOM
if cosine PARELEFT  PARERIGHT <aux[]: continue EOM
else: res DOT append PARELEFT  PARERIGHT  EOM
if res[] EQUAL  EQUAL  or res[] EQUAL  EQUAL : break EOM
return  DOT join PARELEFT  PARERIGHT  EOM
def get_seq2seq_model_one_hot PARELEFT  PARERIGHT : EOM
seq2seq_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT GaussianNoise PARELEFT  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT LSTM PARELEFT 950 COMMA  return_sequences EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT compile PARELEFT optimizer EQUAL  COMMA sample_weight_mode EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return seq2seq_model EOM
def get_seq2seq_model_embedding PARELEFT  PARERIGHT : EOM
seq2seq_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT BatchNormalization PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT compile PARELEFT optimizer EQUAL  COMMA sample_weight_mode EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return seq2seq_model EOM
def get_attention_seq2seq_model PARELEFT  PARERIGHT : EOM
input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
activations  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
mask  EQUAL  TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
flat  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
activations  EQUAL  merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  EOM
activations  EQUAL  AveragePooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
activations  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT max_word_index+2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
seq2seq_model DOT compile PARELEFT optimizer EQUAL  COMMA sample_weight_mode EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return seq2seq_model EOM
import keras EOM
from keras DOT datasets import mnist EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dropout COMMA  Flatten COMMA  Dense COMMA  LSTM EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D EOM
from keras import backend as K EOM
from keras DOT utils import np_utils EOM
import scipy DOT io EOM
import numpy as np EOM
num_classes  EQUAL  2 EOM
def build_pred_model PARELEFT input_shape COMMA loss_weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 8 COMMA activation EQUAL  COMMA input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
if loss_weights is not None: EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA metrics EQUAL [] COMMA loss_weights EQUAL  PARERIGHT  EOM
else: EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def build_lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 8 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def train_pred_model PARELEFT model COMMA  x_train COMMA  y_train COMMA  x_test COMMA  y_test COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA  verbose EQUAL  PARERIGHT : EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA verbose EQUAL  COMMA validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def evaluate_model PARELEFT model COMMA cnn_x_test COMMA cnn_y_test COMMA verbose EQUAL  PARERIGHT : EOM
score  EQUAL  model DOT evaluate PARELEFT cnn_x_test COMMA  cnn_y_test COMMA  verbose EQUAL  PARERIGHT  EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  Merge COMMA  Reshape EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import RMSprop COMMA  SGD EOM
from keras DOT layers DOT recurrent import LSTM EOM
def create_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 64 COMMA  15 COMMA  15 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def create_CNN_LSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 64 COMMA  15 COMMA  15 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  subsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT 512 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rmsprop  EQUAL  RMSprop PARELEFT lr EQUAL  COMMA  rho EQUAL  COMMA  epsilon EQUAL  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model_lstmfrom __future__ import print_function EOM
from __future__ import division EOM
from functools import reduce EOM
import re EOM
import tarfile EOM
import math EOM
import numpy as np EOM
from keras DOT utils DOT data_utils import get_file EOM
from keras DOT layers import Merge COMMA  K EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  RepeatVector COMMA  Activation COMMA  Flatten EOM
from keras DOT layers import recurrent COMMA Lambda COMMA merge EOM
from keras DOT models import Sequential EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT layers DOT convolutional import Convolution1D COMMA  MaxPooling1D COMMA  AveragePooling1D EOM
from sklearn DOT metrics import average_precision_score EOM
from keras DOT layers import Bidirectional EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT preprocessing import sequence EOM
from attention import LSTM EOM
from attention_lstm import AttentionLSTM EOM
RNN EQUAL recurrent DOT LSTM EOM
EMBED_SIZE  EQUAL  16 EOM
HIDDEN_SIZE EQUAL  16 EOM
MAX_LEN EQUAL  100 EOM
BATCH_SIZE  EQUAL  16 EOM
EPOCHS  EQUAL  10 EOM
nb_filter  EQUAL  10 EOM
filter_length  EQUAL  5 EOM
def readResult PARELEFT  PARERIGHT : EOM
index EQUAL 0 EOM
p EQUAL n EQUAL tp EQUAL tn EQUAL fp EQUAL fn EQUAL 0 EOM
for prob in results: EOM
if prob>0 DOT 5: EOM
predLabel EQUAL 1 EOM
else: EOM
predLabel EQUAL 0 EOM
if y_test[]>0: EOM
p+ EQUAL 1 EOM
if predLabel>0: EOM
tp+ EQUAL 1 EOM
else: EOM
fn+ EQUAL 1 EOM
else: EOM
n+ EQUAL 1 EOM
if predLabel EQUAL  EQUAL 0: EOM
tn+ EQUAL 1 EOM
else: EOM
fp+ EQUAL 1 EOM
index+ EQUAL 1 EOM
acc EQUAL  PARELEFT  PARERIGHT / PARELEFT  PARERIGHT  EOM
precisionP EQUAL tp/ PARELEFT  PARERIGHT  EOM
precisionN EQUAL tn/ PARELEFT  PARERIGHT  EOM
recallP EQUAL tp/ PARELEFT  PARERIGHT  EOM
recallN EQUAL tn/ PARELEFT  PARERIGHT  EOM
gmean EQUAL math DOT sqrt PARELEFT  PARERIGHT  EOM
f_p EQUAL 2*precisionP*recallP/ PARELEFT  PARERIGHT  EOM
f_n EQUAL 2*precisionN*recallN/ PARELEFT  PARERIGHT  EOM
output EQUAL open PARELEFT  PARERIGHT  EOM
output DOT write PARELEFT  DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
def cnn_prediction PARELEFT  PARERIGHT : EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA b_epoch EQUAL  COMMA  show_accuracy EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
X_pred EQUAL model DOT predict PARELEFT  PARERIGHT  EOM
results EQUAL [] for result in X_pred] EOM
return readResult PARELEFT  PARERIGHT  EOM
def lstm_prediction PARELEFT  PARERIGHT : EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT RNN PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA b_epoch EQUAL  COMMA  show_accuracy EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
X_pred EQUAL model DOT predict PARELEFT  PARERIGHT  EOM
results EQUAL [] for result in X_pred] EOM
return readResult PARELEFT  PARERIGHT  EOM
def buildModel_max PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def buildLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT RNN PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def cnn_combined PARELEFT  PARERIGHT : EOM
X_new_train_list EQUAL [] EOM
X_new_test_list EQUAL [] EOM
for i in range PARELEFT  PARERIGHT : EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train_list[] COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test_list[] COMMA  maxlen EQUAL  PARERIGHT  EOM
X_new_train_list DOT append PARELEFT  PARERIGHT  EOM
X_new_test_list DOT append PARELEFT  PARERIGHT  EOM
firstLayers EQUAL [] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT firstLayers COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_new_train_list COMMA  y_train COMMA  batch_size EQUAL  COMMA nb_epoch EQUAL  PARERIGHT  EOM
X_pred EQUAL model DOT predict PARELEFT  PARERIGHT  EOM
results EQUAL [] for result in X_pred] EOM
return readResult PARELEFT  PARERIGHT  EOM
def cnn_combined2 PARELEFT  PARERIGHT : EOM
X_new_train_list EQUAL [] EOM
X_new_test_list EQUAL [] EOM
for i in range PARELEFT  PARERIGHT : EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train_list[] COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test_list[] COMMA  maxlen EQUAL  PARERIGHT  EOM
X_new_train_list DOT append PARELEFT  PARERIGHT  EOM
X_new_test_list DOT append PARELEFT  PARERIGHT  EOM
preLayer EQUAL None EOM
for i in range PARELEFT  PARERIGHT : EOM
e_layer EQUAL Sequential PARELEFT  PARERIGHT  EOM
e_layer DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
e_layer DOT add PARELEFT RNN PARELEFT  PARERIGHT  PARERIGHT  EOM
if preLayer! EQUAL None: EOM
m_layer EQUAL Sequential PARELEFT  PARERIGHT  EOM
m_layer DOT add PARELEFT Merge PARELEFT  PARERIGHT  PARERIGHT  EOM
m_layer DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
m_layer DOT add PARELEFT RNN PARELEFT  PARERIGHT  PARERIGHT  EOM
e_layer EQUAL m_layer EOM
preLayer EQUAL e_layer EOM
model  EQUAL  e_layer EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_new_train_list COMMA  y_train COMMA  batch_size EQUAL  COMMA nb_epoch EQUAL  PARERIGHT  EOM
X_pred EQUAL model DOT predict PARELEFT  PARERIGHT  EOM
results EQUAL [] for result in X_pred] EOM
return readResult PARELEFT  PARERIGHT  EOM
def cnn_combined3 PARELEFT  PARERIGHT : EOM
X_new_train_list EQUAL [] EOM
X_new_test_list EQUAL [] EOM
for i in range PARELEFT  PARERIGHT : EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train_list[] COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test_list[] COMMA  maxlen EQUAL  PARERIGHT  EOM
X_new_train_list DOT append PARELEFT  PARERIGHT  EOM
X_new_test_list DOT append PARELEFT  PARERIGHT  EOM
lstm_en EQUAL Sequential PARELEFT  PARERIGHT  EOM
lstm_en DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_en DOT add PARELEFT RNN PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_en DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_cn EQUAL Sequential PARELEFT  PARERIGHT  EOM
lstm_cn DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_cn DOT add PARELEFT RNN PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_cn DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_all EQUAL Sequential PARELEFT  PARERIGHT  EOM
lstm_all DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_all DOT add PARELEFT RNN PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_all DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_merge EQUAL Sequential PARELEFT  PARERIGHT  EOM
lstm_merge DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_merge DOT add PARELEFT RNN PARELEFT  PARERIGHT  PARERIGHT  EOM
model EQUAL lstm_merge EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_new_train_list COMMA  y_train COMMA  batch_size EQUAL  COMMA nb_epoch EQUAL  PARERIGHT  EOM
X_pred EQUAL model DOT predict PARELEFT  PARERIGHT  EOM
results EQUAL [] for result in X_pred] EOM
return readResult PARELEFT  PARERIGHT  EOM
def lstm_attention PARELEFT  PARERIGHT : EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
data  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
embedding EQUAL Embedding PARELEFT vocab_size COMMA  EMBED_SIZE COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  EOM
data_embedding EQUAL embedding PARELEFT  PARERIGHT  EOM
dropout  EQUAL  Dropout PARELEFT  PARERIGHT  EOM
data_dropout  EQUAL  dropout PARELEFT  PARERIGHT  EOM
rnn  EQUAL  RNN PARELEFT  PARERIGHT  EOM
data_rnn  EQUAL  RNN PARELEFT  PARERIGHT  EOM
maxpool  EQUAL  Lambda PARELEFT lambda x: K DOT max PARELEFT x COMMA  axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
data_pool  EQUAL  maxpool PARELEFT  PARERIGHT  EOM
rnn EQUAL AttentionLSTM PARELEFT  PARERIGHT import os EOM
global_model_version  EQUAL  37 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import SGD  COMMA  Adagrad EOM
def keras_model PARELEFT  max_seq_length  COMMA  image_vector EQUAL  COMMA  word_vector EQUAL  PARERIGHT : EOM
LSTM_layers  EQUAL  1 EOM
LSTM_units   EQUAL  300 EOM
DNN_layers   EQUAL  3 EOM
DNN_units    EQUAL  32 EOM
question_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_q1  EQUAL  LSTM  PARELEFT  LSTM_units  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  return_sequences EQUAL  PARERIGHT  EOM
question_model DOT add PARELEFT  PARERIGHT  EOM
answer_1_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a1  EQUAL  LSTM  PARELEFT  LSTM_units  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  return_sequences EQUAL  PARERIGHT  EOM
answer_1_model DOT add PARELEFT  PARERIGHT  EOM
answer_2_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a2  EQUAL  beShared_LSTM PARELEFT layer_a1  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
answer_2_model DOT add PARELEFT  PARERIGHT  EOM
answer_3_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a3  EQUAL  beShared_LSTM PARELEFT layer_a1  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
answer_3_model DOT add PARELEFT  PARERIGHT  EOM
answer_4_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a4  EQUAL  beShared_LSTM PARELEFT layer_a1  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
answer_4_model DOT add PARELEFT  PARERIGHT  EOM
answer_5_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_a5  EQUAL  beShared_LSTM PARELEFT layer_a1  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
answer_5_model DOT add PARELEFT  PARERIGHT  EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Reshape PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT   COMMA  dims  EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
layer_DNN_1  EQUAL  Dense PARELEFT DNN_units  COMMA  init  EQUAL  PARERIGHT  EOM
layer_DNN_1_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_DNN_1_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_DNN_2  EQUAL  Dense PARELEFT DNN_units  COMMA  init  EQUAL  PARERIGHT  EOM
layer_DNN_2_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_DNN_2_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_DNN_3  EQUAL  Dense PARELEFT DNN_units  COMMA  init  EQUAL  PARERIGHT  EOM
layer_DNN_3_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_DNN_3_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_out  EQUAL  Dense PARELEFT  PARERIGHT  EOM
layer_softmax  EQUAL  Activation PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Dropout COMMA  Embedding COMMA  LSTM EOM
def createModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT n_values COMMA  hidden_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
if use_dropout: model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
if use_dropout: model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return PARELEFT  PARERIGHT import argparse EOM
def softmax_demo PARELEFT  PARERIGHT : EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT optimizers import SGD EOM
import numpy as np EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
def mlp_demo PARELEFT  PARERIGHT : EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
def vgg_demo PARELEFT  PARERIGHT : EOM
import numpy as np EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
def stack_lstm_demo PARELEFT  PARERIGHT : EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA atch_size EQUAL  COMMA  epochs EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def stateful_lstm_demo PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
batch_size  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA tch_size EQUAL  COMMA  epochs EQUAL  COMMA  shuffle EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  help EQUAL  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
args  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
if args DOT model  EQUAL  EQUAL  : EOM
softmax_demo PARELEFT  PARERIGHT  EOM
elif args DOT model  EQUAL  EQUAL  : EOM
mlp_demo PARELEFT  PARERIGHT  EOM
elif args DOT model  EQUAL  EQUAL  : EOM
vgg_demo PARELEFT  PARERIGHT  EOM
elif args DOT model  EQUAL  EQUAL  : EOM
stack_lstm_demo PARELEFT  PARERIGHT  EOM
elif args DOT model  EQUAL  EQUAL  : EOM
stateful_lstm_demo PARELEFT  PARERIGHT from sklearn DOT feature_extraction DOT text import CountVectorizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from sklearn DOT model_selection import train_test_split EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  LSTM COMMA Dropout COMMA  BatchNormalization EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from keras DOT models import model_from_json EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import Adam EOM
import tensorflow as tf EOM
import numpy as np EOM
import pandas as pd EOM
import random EOM
class modeler: EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT dataset_main  EQUAL  self DOT load_dataset PARELEFT  PARERIGHT  EOM
self DOT max_features  EQUAL 5000 EOM
def load_dataset PARELEFT  PARERIGHT : EOM
data  EQUAL  pd DOT read_csv PARELEFT  PARERIGHT  EOM
data  EQUAL  data[]] EOM
return data EOM
def train_data PARELEFT  PARERIGHT : EOM
tokenizer  EQUAL  Tokenizer PARELEFT nb_words EQUAL  COMMA  split EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
X  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
X  EQUAL  pad_sequences PARELEFT  PARERIGHT  EOM
Y  EQUAL  pd DOT get_dummies PARELEFT  PARERIGHT  DOT values EOM
X_train COMMA  X_test COMMA  Y_train COMMA  Y_test  EQUAL  train_test_split PARELEFT X COMMA Y COMMA  test_size  EQUAL  COMMA  random_state  EQUAL  PARERIGHT  EOM
return X_train COMMA  X_test COMMA  Y_train COMMA  Y_test COMMA X COMMA Y EOM
def build_model PARELEFT  PARERIGHT : EOM
embed_dim  EQUAL  128 EOM
lstm_out  EQUAL  192 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT self DOT max_features COMMA  embed_dim COMMA input_length  EQUAL [] COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_out COMMA  dropout_U EQUAL  COMMA  dropout_W EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 8 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  COMMA metrics  EQUAL [] PARERIGHT  EOM
return model EOM
def start_train PARELEFT  PARERIGHT : EOM
batch_size  EQUAL  32 EOM
X_train COMMA  X_test COMMA  Y_train COMMA  Y_test COMMA  X COMMA  Y  EQUAL  self DOT train_data PARELEFT  PARERIGHT  EOM
model  EQUAL  self DOT build_model PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  nb_epoch  EQUAL  COMMA  batch_size EQUAL  COMMA  verbose  EQUAL  PARERIGHT  EOM
self DOT save PARELEFT  PARERIGHT  EOM
def save PARELEFT  PARERIGHT : EOM
model_json  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
model  EQUAL  modeler PARELEFT  PARERIGHT  EOM
model DOT start_train PARELEFT  PARERIGHT from keras DOT layers import Embedding COMMA  LSTM COMMA  TimeDistributed COMMA  Dense COMMA  Dropout EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
from keras DOT optimizers import Adam EOM
import constant EOM
class Model PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT constant DOT NUM_CHARS COMMA  5 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT constant DOT NUM_TAGS COMMA  activation EQUAL  PARERIGHT  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  modelfrom keras DOT models import Sequential EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
import keras DOT preprocessing DOT sequence as S EOM
from keras DOT utils import to_categorical EOM
from keras DOT layers import Embedding COMMA  Bidirectional COMMA  LSTM COMMA  Dropout COMMA  Dense EOM
import jieba EOM
import json EOM
import numpy as np EOM
vocab_size  EQUAL  350000 EOM
sentence_max_len  EQUAL  100 EOM
class SentimentLSTM: EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT tokenizer  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
self DOT stop_words  EQUAL  [] EOM
self DOT model  EQUAL  None EOM
def load_stop_word PARELEFT self COMMA path EQUAL  PARERIGHT : EOM
with open PARELEFT  PARERIGHT  as f: EOM
for line in f: EOM
content  EQUAL  line DOT strip PARELEFT  PARERIGHT  EOM
self DOT stop_words DOT append PARELEFT content DOT decode PARELEFT  PARERIGHT  PARERIGHT  EOM
def jieba_cut PARELEFT  PARERIGHT : EOM
lcut  EQUAL  jieba DOT lcut PARELEFT  PARERIGHT  EOM
cut  EQUAL  [] EOM
cut  EQUAL   DOT join PARELEFT  PARERIGHT  EOM
return cut EOM
def load_cuted_corpus PARELEFT  PARERIGHT : EOM
f  EQUAL  open PARELEFT  PARERIGHT  EOM
lines  EQUAL  f DOT readlines PARELEFT  PARERIGHT  EOM
texts  EQUAL  [] EOM
labels  EQUAL  [] EOM
for line in lines: EOM
fields  EQUAL  line DOT split PARELEFT  PARERIGHT  EOM
rate  EQUAL  int PARELEFT  PARERIGHT  EOM
if rate EQUAL  EQUAL 0 or rate EQUAL  EQUAL 3: EOM
continue EOM
elif rate < 3: EOM
rate  EQUAL  0 EOM
else: EOM
rate  EQUAL  1 EOM
cont  EQUAL  fields[] EOM
cont  EQUAL   DOT join PARELEFT  PARERIGHT  EOM
texts DOT append PARELEFT  PARERIGHT  EOM
labels DOT append PARELEFT  PARERIGHT  EOM
self DOT tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
f DOT close PARELEFT  PARERIGHT  EOM
return texts COMMA labels EOM
def load_data PARELEFT  PARERIGHT : EOM
x COMMA y  EQUAL  self DOT load_cuted_corpus PARELEFT  PARERIGHT  EOM
x  EQUAL  self DOT tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
x  EQUAL  S DOT pad_sequences PARELEFT x COMMA maxlen EQUAL  PARERIGHT  EOM
y  EQUAL  to_categorical PARELEFT y COMMA num_classes EQUAL  PARERIGHT  EOM
return  PARELEFT  PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
def train PARELEFT self COMMA epochs EQUAL  PARERIGHT : EOM
self DOT model  EQUAL  SentimentLSTM DOT build_model PARELEFT  PARERIGHT  EOM
self DOT model DOT fit PARELEFT text_train COMMA  rate_train COMMA batch_size EQUAL  COMMA epochs EQUAL  PARERIGHT  EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
score  EQUAL  self DOT model DOT evaluate PARELEFT  PARERIGHT  EOM
def load_trained_model PARELEFT  PARERIGHT : EOM
model  EQUAL  SentimentLSTM DOT build_model PARELEFT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def predict_text PARELEFT  PARERIGHT : EOM
if self DOT model  EQUAL  EQUAL  None: EOM
self DOT model  EQUAL  self DOT load_trained_model PARELEFT  PARERIGHT  EOM
self DOT load_stop_word PARELEFT  PARERIGHT  EOM
self DOT load_cuted_corpus PARELEFT  PARERIGHT  EOM
vect  EQUAL  self DOT jieba_cut PARELEFT  PARERIGHT  EOM
vect  EQUAL  vect DOT encode PARELEFT  PARERIGHT  EOM
vect  EQUAL  self DOT tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
return self DOT model DOT predict_classes PARELEFT S DOT pad_sequences PARELEFT np DOT array PARELEFT  PARERIGHT  COMMA 100 PARERIGHT  PARERIGHT  EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  256 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 128 COMMA implementation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def main PARELEFT  PARERIGHT : EOM
lstm  EQUAL  SentimentLSTM PARELEFT  PARERIGHT  EOM
lstm DOT train PARELEFT  PARERIGHT  EOM
while True: EOM
input  EQUAL  raw_input PARELEFT  PARERIGHT  EOM
if input  EQUAL  EQUAL  : EOM
break EOM
if __name__ EQUAL  EQUAL : EOM
main PARELEFT  PARERIGHT from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA Flatten COMMA Concatenate COMMA Input EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT layers DOT convolutional import Conv2D EOM
from keras DOT layers DOT pooling import MaxPooling2D EOM
from keras DOT models import Sequential COMMA Model EOM
from keras DOT utils DOT vis_utils import plot_model EOM
def get_lstm PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT units[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_gru PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT GRU PARELEFT units[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def _get_sae PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT hidden COMMA  input_dim EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_saes PARELEFT  PARERIGHT : EOM
sae2  EQUAL  _get_sae PARELEFT  PARERIGHT  EOM
sae3  EQUAL  _get_sae PARELEFT  PARERIGHT  EOM
saes  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  input_dim EQUAL [] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
models  EQUAL  [] EOM
return models EOM
def get_cnn PARELEFT  PARERIGHT : EOM
model EQUAL Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA filters EQUAL [] COMMA padding EQUAL  COMMA activation EQUAL  COMMA data_format EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA filters EQUAL [] COMMA padding EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA filters EQUAL [] COMMA padding EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT unit[] COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def merge_lstm PARELEFT  PARERIGHT : EOM
input_min EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_min EQUAL LSTM PARELEFT 64 COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_min EQUAL LSTM PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_min EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_min EQUAL Dense PARELEFT 12 COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
input_day EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_day EQUAL LSTM PARELEFT 64 COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_day EQUAL LSTM PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_day EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_day EQUAL Dense PARELEFT 24 COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
input_week EQUAL Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_week EQUAL LSTM PARELEFT 64 COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_week EQUAL LSTM PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_week EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_week EQUAL Dense PARELEFT 7 COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
merge EQUAL Concatenate PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
merge EQUAL Dense PARELEFT unit[] COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model EQUAL Model PARELEFT inputs EQUAL [] COMMA outputs EQUAL [] PARERIGHT  EOM
return model EOM
from keras import backend as K EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Conv1D COMMA  MaxPooling1D COMMA  Dropout COMMA  CuDNNLSTM COMMA  SimpleRNN EOM
from keras DOT layers DOT embeddings import Embedding EOM
import numpy as np EOM
import pandas as pd EOM
import os EOM
os DOT environ[]  EQUAL  EOM
df  EQUAL  pd DOT read_csv PARELEFT file COMMA  usecols EQUAL [] COMMA  error_bad_lines EQUAL  PARERIGHT  EOM
df  EQUAL  df DOT dropna PARELEFT  PARERIGHT  EOM
df  EQUAL  df[] EOM
df  EQUAL  df[] EOM
df DOT head PARELEFT  PARERIGHT  EOM
df DOT groupby PARELEFT  PARERIGHT  DOT count PARELEFT  PARERIGHT  EOM
labels  EQUAL  df[] DOT map PARELEFT lambda x: 1 if int PARELEFT  PARERIGHT  > 3 else 0 PARERIGHT  EOM
K DOT set_session PARELEFT K DOT tf DOT Session PARELEFT config EQUAL  PARELEFT intra_op_parallelism_threads EQUAL  COMMA  inter_op_parallelism_threads EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vocabulary_size  EQUAL  1000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
data  EQUAL  pad_sequences PARELEFT sequences COMMA  maxlen EQUAL  PARERIGHT  EOM
model_rnn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_rnn DOT add PARELEFT Embedding PARELEFT vocabulary_size COMMA  100 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_rnn DOT add PARELEFT SimpleRNN PARELEFT  PARERIGHT  PARERIGHT  EOM
model_rnn DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_rnn DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model_rnn DOT fit PARELEFT data COMMA  np DOT array PARELEFT  PARERIGHT  COMMA  validation_split EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Embedding PARELEFT vocabulary_size COMMA  100 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT CuDNNLSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model_lstm DOT fit PARELEFT data COMMA  np DOT array PARELEFT  PARERIGHT  COMMA  validation_split EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
def create_conv_model PARELEFT  PARERIGHT : EOM
model_conv  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_conv DOT add PARELEFT Embedding PARELEFT vocabulary_size COMMA  100 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_conv DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_conv DOT add PARELEFT Conv1D PARELEFT 64 COMMA  5 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_conv DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model_conv DOT add PARELEFT CuDNNLSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_conv DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_conv DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model_conv EOM
model_conv  EQUAL  create_conv_model PARELEFT  PARERIGHT  EOM
model_conv DOT fit PARELEFT data COMMA  np DOT array PARELEFT  PARERIGHT  COMMA  validation_split EQUAL  COMMA  epochs  EQUAL  PARERIGHT from keras DOT layers import Dense COMMA  LSTM COMMA  Activation COMMA  BatchNormalization COMMA  Dropout COMMA  initializers COMMA  Input EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import SGD COMMA  RMSprop EOM
from keras DOT models import load_model EOM
from keras DOT initializers import Constant EOM
import keras DOT backend as K EOM
from keras DOT utils DOT generic_utils import get_custom_objects EOM
from keras DOT backend DOT tensorflow_backend import _to_tensor EOM
return K DOT relu PARELEFT x COMMA  alpha EQUAL  COMMA  max_value EQUAL  PARERIGHT  EOM
get_custom_objects PARELEFT  PARERIGHT  DOT update PARELEFT {: Activation PARELEFT  PARERIGHT } PARERIGHT  EOM
return -100 DOT  * K DOT mean PARELEFT  PARELEFT  PARERIGHT  * y_pred PARERIGHT  EOM
class WindPuller PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT rate EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT LSTM PARELEFT n_hidden * 4 COMMA  return_sequences EQUAL  COMMA  activation EQUAL  COMMA ecurrent_activation EQUAL  COMMA  kernel_initializer EQUAL  COMMA ecurrent_initializer EQUAL  COMMA  bias_initializer EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT n_hidden COMMA  return_sequences EQUAL  COMMA  activation EQUAL  COMMA ecurrent_activation EQUAL  COMMA  kernel_initializer EQUAL  COMMA ecurrent_initializer EQUAL  COMMA  bias_initializer EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
def fit PARELEFT self COMMA  x COMMA  y COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  verbose EQUAL  COMMA  callbacks EQUAL  COMMA lidation_split EQUAL  COMMA  validation_data EQUAL  COMMA  shuffle EQUAL  COMMA ss_weight EQUAL  COMMA  sample_weight EQUAL  COMMA  initial_epoch EQUAL  COMMA  **kwargs PARERIGHT : EOM
self DOT model DOT fit PARELEFT  PARERIGHT  EOM
def save PARELEFT  PARERIGHT : EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
def load_model PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
return self EOM
def evaluate PARELEFT self COMMA  x COMMA  y COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA ample_weight EQUAL  COMMA  **kwargs PARERIGHT : EOM
return self DOT model DOT evaluate PARELEFT  PARERIGHT  EOM
def predict PARELEFT self COMMA  x COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT : EOM
return self DOT model DOT predict PARELEFT  PARERIGHT  EOM
import numpy as np EOM
import pandas as pd EOM
from nltk DOT corpus import stopwords EOM
from nltk import word_tokenize COMMA  ngrams EOM
from keras DOT preprocessing import text EOM
from sklearn DOT model_selection import train_test_split EOM
train_df  EQUAL  pd DOT read_csv PARELEFT  COMMA encoding EQUAL  PARERIGHT  DOT fillna PARELEFT  PARERIGHT  EOM
train_df DOT head PARELEFT  PARERIGHT  EOM
X  EQUAL  train_df[]] EOM
y  EQUAL  train_df[] EOM
X_train  EQUAL  X DOT copy PARELEFT  PARERIGHT  EOM
q1s  EQUAL  list PARELEFT X_train[] DOT apply PARELEFT lambda x: x DOT encode PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
q2s  EQUAL  list PARELEFT X_train[] DOT apply PARELEFT lambda x: x DOT encode PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
all_questions  EQUAL  q1s + q2s EOM
tok  EQUAL  text DOT Tokenizer PARELEFT nb_words EQUAL  PARERIGHT  EOM
tok DOT fit_on_texts PARELEFT  PARERIGHT  EOM
q1s_tok  EQUAL  tok DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
q2s_tok  EQUAL  tok DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  max PARELEFT [] PARERIGHT  EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT datasets import imdb EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT engine DOT topology import Merge EOM
from keras import backend as K EOM
def log_loss PARELEFT  PARERIGHT : EOM
first_log  EQUAL  K DOT log PARELEFT K DOT clip PARELEFT y_pred COMMA  K DOT epsilon PARELEFT  PARERIGHT  COMMA  None PARERIGHT  PARERIGHT  EOM
second_log  EQUAL  K DOT log PARELEFT K DOT clip PARELEFT 1 DOT -y_pred COMMA  K DOT epsilon PARELEFT  PARERIGHT  COMMA  None PARERIGHT  PARERIGHT  EOM
return K DOT mean PARELEFT -y_true * first_log -  PARELEFT  PARERIGHT  * second_log PARERIGHT  EOM
yt  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
yp  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
q1s_tok  EQUAL  sequence DOT pad_sequences PARELEFT q1s_tok COMMA maxlen EQUAL  PARERIGHT  EOM
q2s_tok  EQUAL  sequence DOT pad_sequences PARELEFT q2s_tok COMMA maxlen EQUAL  PARERIGHT  EOM
model1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model1 DOT add PARELEFT Embedding PARELEFT 6000 COMMA  128 COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model2 DOT add PARELEFT Embedding PARELEFT 6000 COMMA  128 COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
merged_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
merged_model DOT add PARELEFT Merge PARELEFT [] COMMA mode EQUAL  PARERIGHT  PARERIGHT  EOM
merged_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
merged_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
merged_model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
merged_model DOT fit PARELEFT [] COMMA  y EQUAL  COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA rbose EQUAL  COMMA  shuffle EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
merged_model DOT save PARELEFT  PARERIGHT from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class RestaurantPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from rasa_core DOT policies DOT fallback import FallbackPolicy EOM
fallback  EQUAL  FallbackPolicy PARELEFT fallback_action_name EQUAL  COMMA core_threshold EQUAL  COMMA nlu_threshold EQUAL import common EOM
import matplotlib DOT pyplot as plt EOM
import numpy as np EOM
import pandas as pd EOM
from keras import optimizers EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import BatchNormalization EOM
from keras DOT layers DOT core import Dense EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
from scipy DOT ndimage DOT interpolation import shift EOM
from sklearn import preprocessing EOM
def getModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential  PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 1000  COMMA  activation  EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 500  COMMA  activation  EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200  COMMA  activation  EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200  COMMA  activation  EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200  COMMA  activation  EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense  PARELEFT 1 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
rmsprop  EQUAL  optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  rho EQUAL  COMMA  epsilon EQUAL  PARERIGHT  EOM
model DOT compile  PARELEFT loss  EQUAL  COMMA  optimizer  EQUAL  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
file  EQUAL  common DOT readData PARELEFT  PARERIGHT  EOM
scaler  EQUAL  preprocessing DOT MinMaxScaler PARELEFT feature_range EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
data  EQUAL  common DOT preprocessData PARELEFT  PARERIGHT  EOM
train_data COMMA  test_data  EQUAL  common DOT splitData PARELEFT  PARERIGHT  EOM
common DOT plotTestAndTrain PARELEFT  PARERIGHT  EOM
x_train COMMA  y_train COMMA  x_test COMMA  y_test  EQUAL  common DOT prepareForTraining PARELEFT  PARERIGHT  EOM
model  EQUAL  getModel PARELEFT  PARERIGHT  EOM
common DOT train PARELEFT  PARERIGHT  EOM
common DOT test PARELEFT  PARERIGHT  EOM
common DOT predict PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
import keras EOM
def window_transform_series PARELEFT  PARERIGHT : EOM
X  EQUAL  [] EOM
y  EQUAL  [] EOM
for i in range PARELEFT len PARELEFT  PARERIGHT -window_size PARERIGHT : EOM
X DOT append PARELEFT  PARERIGHT  EOM
y DOT append PARELEFT  PARERIGHT  EOM
X  EQUAL  np DOT asarray PARELEFT  PARERIGHT  EOM
X DOT shape  EQUAL   PARELEFT np DOT shape PARELEFT  PARERIGHT [] PARERIGHT  EOM
y  EQUAL  np DOT asarray PARELEFT  PARERIGHT  EOM
y DOT shape  EQUAL   PARELEFT len PARELEFT  PARERIGHT  COMMA 1 PARERIGHT  EOM
return X COMMA y EOM
def build_part1_RNN PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
import keras EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 5 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def cleaned_text PARELEFT  PARERIGHT : EOM
import string EOM
punctuation  EQUAL  [] EOM
alphabet  EQUAL  list PARELEFT  PARERIGHT  EOM
empty  EQUAL  [] EOM
meaningful_chars  EQUAL  alphabet + punctuation + empty EOM
meanless_list  EQUAL  list PARELEFT set PARELEFT  PARERIGHT  - set PARELEFT  PARERIGHT  PARERIGHT  EOM
for meanless_char in meanless_list: EOM
text  EQUAL  text DOT replace PARELEFT  PARERIGHT  EOM
return text EOM
def window_transform_text PARELEFT  PARERIGHT : EOM
inputs  EQUAL  [] EOM
outputs  EQUAL  [] EOM
for i in range PARELEFT len PARELEFT  PARERIGHT -window_size PARERIGHT : EOM
inputs DOT append PARELEFT  PARERIGHT  EOM
outputs DOT append PARELEFT  PARERIGHT  EOM
return inputs COMMA outputs EOM
def build_part2_RNN PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation EOM
from keras DOT layers import LSTM EOM
import keras EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import Callback EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
def on_batch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def neural_net PARELEFT num_sensors COMMA  params COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT rams[] COMMA  init EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if load: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def lstm_net PARELEFT num_sensors COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT tput_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelimport pandas as pd EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT models import Input EOM
from keras DOT models import Model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Merge EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT models import model_from_json EOM
from keras DOT callbacks import ModelCheckpoint EOM
from MyModule import data EOM
from MyModule import evaluate EOM
import os EOM
def build_lstm_models PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA output_dim EQUAL [][] COMMA ctivation EQUAL [] COMMA  recurrent_activation EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL [][] COMMA ctivation EQUAL [] COMMA  recurrent_activation EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def add_multi_dense PARELEFT  PARERIGHT : EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_model PARELEFT model_path COMMA  weight_path COMMA  lstm_config COMMA  dense_config COMMA  time_steps EQUAL  PARERIGHT : EOM
if os DOT path DOT exists PARELEFT  PARERIGHT : EOM
json_string  EQUAL  open PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  EOM
model  EQUAL  model_from_json PARELEFT  PARERIGHT  EOM
else: EOM
lstm_models  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
lstm_models DOT append PARELEFT build_lstm_models PARELEFT  PARERIGHT  PARERIGHT  EOM
sum_lstm_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
sum_lstm_model DOT add PARELEFT Merge PARELEFT lstm_models COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
sum_lstm_model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  activation EQUAL [] COMMA ecurrent_activation EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
sum_lstm_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
date_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
date_model DOT add PARELEFT ense PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA nits EQUAL [][] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  add_multi_dense PARELEFT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
open PARELEFT  PARERIGHT  DOT write PARELEFT model DOT to_json PARELEFT  PARERIGHT  PARERIGHT  EOM
if os DOT path DOT exists PARELEFT  PARERIGHT : EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def train PARELEFT df_raw COMMA  model_path COMMA  weight_path COMMA  lstm_config COMMA  dense_config COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  time_steps EQUAL  COMMA test_split EQUAL  PARERIGHT : EOM
df_date  EQUAL  df_raw DOT pop PARELEFT  PARERIGHT  EOM
df_date  EQUAL  pd DOT concat PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
df_date  EQUAL  pd DOT concat PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
df_date  EQUAL  df_date DOT loc[] EOM
df_raw  EQUAL  data DOT process_sequence_features PARELEFT df_raw COMMA  time_steps EQUAL  PARERIGHT  EOM
df_date_encode  EQUAL  data DOT encoding_features PARELEFT  PARERIGHT  EOM
y_scaled COMMA  y_scaler  EQUAL  data DOT min_max_scale PARELEFT np DOT array PARELEFT df_raw DOT pop PARELEFT  PARERIGHT  PARERIGHT  DOT reshape PARELEFT  PARERIGHT  PARERIGHT  EOM
X_scaled COMMA  X_scaler  EQUAL  data DOT min_max_scale PARELEFT  PARERIGHT  EOM
date_encode  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
train_y  EQUAL  y_scaled[] EOM
test_y  EQUAL  y_scaled[] EOM
train_y  EQUAL  train_y DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
test_y  EQUAL  test_y DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
X_scaled  EQUAL  X_scaled DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
date_encode  EQUAL  date_encode DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_X  EQUAL  [] EOM
test_X  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
train_X DOT append PARELEFT X_scaled[] PARERIGHT  EOM
test_X DOT append PARELEFT X_scaled[] PARERIGHT  EOM
train_X DOT append PARELEFT date_encode[] PARERIGHT  EOM
test_X DOT append PARELEFT date_encode[] PARERIGHT  EOM
model  EQUAL  build_model PARELEFT  PARERIGHT  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT weight_path COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
history  EQUAL  model DOT fit PARELEFT train_X COMMA  train_y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA rbose EQUAL  COMMA  callbacks EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
plt DOT figure PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
pred_y  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
test_y  EQUAL  data DOT inverse_to_original_data PARELEFT train_y DOT reshape PARELEFT  PARERIGHT  COMMA  test_y DOT reshape PARELEFT  PARERIGHT  COMMA  scaler EQUAL  COMMA n_num EQUAL  PARELEFT len PARELEFT  PARERIGHT  *  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
pred_y  EQUAL  data DOT inverse_to_original_data PARELEFT train_y DOT reshape PARELEFT  PARERIGHT  COMMA  pred_y DOT reshape PARELEFT  PARERIGHT  COMMA  scaler EQUAL  COMMA n_num EQUAL  PARELEFT len PARELEFT  PARERIGHT  *  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return test_y COMMA  pred_y EOM
if __name__  EQUAL  EQUAL  : EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
cols  EQUAL  [] EOM
df_raw_data  EQUAL  pd DOT read_csv PARELEFT  COMMA  usecols EQUAL  COMMA  dtype EQUAL  PARERIGHT  EOM
epoch  EQUAL  1000 EOM
batch  EQUAL  1024 EOM
time_step  EQUAL  4 EOM
test_split  EQUAL  0 DOT 4 EOM
lstm_num  EQUAL  6 EOM
lstm_layers  EQUAL  [] EOM
lstm_activation  EQUAL  EOM
lstm_recurrent_activation  EQUAL  EOM
lstm_input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
lstm_dropout  EQUAL  0 DOT 3 EOM
dense_layers  EQUAL  [] EOM
dense_activation  EQUAL  EOM
date_features_shape  EQUAL   PARELEFT  PARERIGHT  EOM
dense_dropout  EQUAL  0 DOT 5 EOM
lstm_conf  EQUAL  {lstm_num COMMA lstm_input_shape COMMA lstm_layers COMMA lstm_activation COMMA lstm_recurrent_activation COMMA lstm_dropout} EOM
dense_conf  EQUAL  {date_features_shape COMMA dense_layers COMMA dense_activation COMMA dense_dropout} EOM
y_true COMMA  y_pred  EQUAL  train PARELEFT df_raw_data COMMA  model_path COMMA  weight_path COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  lstm_config EQUAL  COMMA nse_config EQUAL  COMMA  time_steps EQUAL  COMMA  test_split EQUAL  PARERIGHT  EOM
metrics  EQUAL  evaluate DOT print_metrics PARELEFT  PARERIGHT  EOM
evaluate DOT print_curve PARELEFT  PARERIGHT from keras DOT preprocessing DOT image import ImageDataGenerator EOM
from keras DOT models import Sequential COMMA Model EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D COMMA  Reshape EOM
from keras DOT layers import Activation COMMA  Dropout COMMA  Flatten COMMA  Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT applications DOT vgg16 import VGG16 EOM
class ModelBuilder: EOM
def __init__ PARELEFT  PARERIGHT : EOM
pass EOM
def build_custom PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  COMMA  padding  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 1 COMMA   PARELEFT  PARERIGHT  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def build_vgg16 PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT   PARERIGHT : EOM
vgg  EQUAL  VGG16 PARELEFT include_top  EQUAL  COMMA  weights  EQUAL  COMMA  input_shape EQUAL  COMMA \oling  EQUAL  PARERIGHT  EOM
lstm_input  EQUAL  Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_output  EQUAL  LSTM PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model_output  EQUAL  Dense PARELEFT 1 COMMA  activation  EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
modified_vgg_model  EQUAL  Model PARELEFT input  EQUAL  COMMA  output  EQUAL  PARERIGHT  EOM
vgg DOT summary PARELEFT  PARERIGHT  EOM
return modified_vgg_model EOM
import tensorflow as tf EOM
from tensorflow DOT keras DOT models import Sequential EOM
from tensorflow DOT keras DOT layers import Dense COMMA  Dropout COMMA  LSTM EOM
if __name__  EQUAL  EQUAL  : EOM
mnist  EQUAL  tf DOT keras DOT datasets DOT mnist EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
X_train  EQUAL  x_train/255 DOT 0 EOM
X_test  EQUAL  x_test/255 DOT 0 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation  EQUAL  COMMA return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  tf DOT keras DOT optimizers DOT Adam PARELEFT lr  EQUAL  COMMA  decay  EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA optimizer  EQUAL  COMMA metrics  EQUAL [] COMMA  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs  EQUAL  COMMA alidation_data  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
import numpy as np EOM
import pandas as pd EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Dropout EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from sklearn DOT model_selection import train_test_split EOM
from keras DOT utils import to_categorical EOM
from sklearn DOT model_selection import GridSearchCV EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
def _clstm PARELEFT categorical EQUAL  COMMA  vocab_size EQUAL  COMMA  seq_len EQUAL  COMMA bedding_length EQUAL  COMMA  cnn_filters EQUAL  COMMA  filter_length EQUAL  COMMA l_size EQUAL  COMMA  nodes EQUAL  COMMA  lstm_drop EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
if not embedding_length: EOM
model DOT pop PARELEFT  PARERIGHT  EOM
model DOT pop PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
if not categorical: EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT categorical COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def _lstm PARELEFT categorical EQUAL  COMMA  vocab_size EQUAL  COMMA  seq_len EQUAL  COMMA bedding_length EQUAL  COMMA  nodes EQUAL  COMMA  lstm_drop EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
if not embedding_length: EOM
model DOT pop PARELEFT  PARERIGHT  EOM
model DOT pop PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if not categorical: EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT categorical COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def _cnn PARELEFT categorical EQUAL  COMMA  vocab_size EQUAL  COMMA  seq_len EQUAL  COMMA bedding_length EQUAL  COMMA  cnn_filters EQUAL  COMMA  filter_length EQUAL  COMMA ol_size EQUAL  COMMA  nodes EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
if not embedding_length: EOM
model DOT pop PARELEFT  PARERIGHT  EOM
model DOT pop PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
if not categorical: EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT categorical COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def train_model PARELEFT x COMMA  y COMMA  architecture EQUAL  COMMA  test_fraction EQUAL  COMMA ip_embedding EQUAL  COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA rbose EQUAL  COMMA  save_file EQUAL  COMMA  **kwargs PARERIGHT : EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
if test_fraction: EOM
x COMMA  x_test COMMA  y COMMA  y_test  EQUAL  train_test_split PARELEFT  y COMMA  test_size EQUAL  PARERIGHT  EOM
kwargs[]  EQUAL  int PARELEFT x DOT max PARELEFT  PARERIGHT  + 1 PARERIGHT  EOM
if skip_embedding: EOM
kwargs[]  EQUAL  False EOM
x  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
if test_fraction: EOM
x_test  EQUAL  to_categorical PARELEFT x_test COMMA  num_classes EQUAL [] PARERIGHT  EOM
kwargs[]  EQUAL  int PARELEFT  PARERIGHT  EOM
if not np DOT isscalar PARELEFT  PARERIGHT : EOM
kwargs[]  EQUAL  y DOT shape[] EOM
if architecture  EQUAL  EQUAL  : EOM
model  EQUAL  _clstm PARELEFT  PARERIGHT  EOM
elif architecture  EQUAL  EQUAL  : EOM
model  EQUAL  _lstm PARELEFT  PARERIGHT  EOM
elif architecture  EQUAL  EQUAL  : EOM
model  EQUAL  _cnn PARELEFT  PARERIGHT  EOM
fit_args  EQUAL  {epochs COMMA batch_size COMMA verbose} EOM
if test_fraction: EOM
fit_args[]  EQUAL   PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
if test_fraction: EOM
scores  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
if save_file: EOM
model DOT save PARELEFT  PARERIGHT  EOM
return model EOM
def cross_validate PARELEFT x COMMA  y COMMA  architecture EQUAL  COMMA  save_file EQUAL  COMMA ip_embedding EQUAL  COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA rbose EQUAL  COMMA  k EQUAL  COMMA  params EQUAL  PARERIGHT : EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
params[]  EQUAL  [] EOM
if skip_embedding: EOM
params[]  EQUAL  [] EOM
x  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
params[]  EQUAL  [] EOM
if not np DOT isscalar PARELEFT  PARERIGHT : EOM
params[]  EQUAL  []] EOM
if architecture  EQUAL  EQUAL  : EOM
model  EQUAL  KerasClassifier PARELEFT build_fn EQUAL  COMMA  batch_size EQUAL  COMMA pochs EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
if architecture  EQUAL  EQUAL  : EOM
model  EQUAL  KerasClassifier PARELEFT build_fn EQUAL  COMMA  batch_size EQUAL  COMMA pochs EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
if architecture  EQUAL  EQUAL  : EOM
model  EQUAL  KerasClassifier PARELEFT build_fn EQUAL  COMMA  batch_size EQUAL  COMMA pochs EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
grid_result  EQUAL  grid DOT fit PARELEFT  PARERIGHT  EOM
if save_file: EOM
grid_df  EQUAL  pd DOT DataFrame PARELEFT  PARERIGHT  EOM
grid_df[]  EQUAL  grid_result DOT cv_results_[] EOM
grid_df[]  EQUAL  grid_result DOT cv_results_[] EOM
grid_df DOT to_csv PARELEFT  PARERIGHT  EOM
returnimport keras EOM
import Data EOM
def Model1 PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT input_shape*5 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT input_shape*5 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def Model2 PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT 1 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT 1 COMMA recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT 1 COMMA recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT 1 COMMA recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT 1 COMMA recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT 1 COMMA recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def Model3 PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
LSTM_num  EQUAL  5 EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT LSTM_num COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT LSTM_num COMMA  recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT LSTM_num COMMA  recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT LSTM_num COMMA  recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT LSTM_num COMMA  recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT LSTM_num COMMA  recurrent_dropout EQUAL  COMMA dropout EQUAL  COMMA  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
import os EOM
import numpy as np EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from keras DOT layers import Dense COMMA  Input COMMA  Flatten COMMA  Dropout COMMA  Activation COMMA Masking COMMA Merge COMMA Lambda EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding COMMA TimeDistributed COMMA AveragePooling1D EOM
from keras DOT models import Model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU COMMA Bidirectional EOM
from keras DOT callbacks import EarlyStopping EOM
import keras DOT backend as K EOM
from keras DOT utils import np_utils EOM
import get_data EOM
import sys EOM
MAX_LEN  EQUAL  79 EOM
WORD_DIM  EQUAL  50 EOM
def train_eoe_model_of_lstm PARELEFT  PARERIGHT : EOM
train_X COMMA train_Y COMMA test_X COMMA test_Y  EQUAL  get_data DOT return_eoa_data PARELEFT  PARERIGHT  EOM
mymodel  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
mymodel DOT add PARELEFT LSTM PARELEFT 100 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 4 COMMA activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
mymodel DOT summary PARELEFT  PARERIGHT  EOM
mymodel DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA patience EQUAL  PARERIGHT  EOM
mymodel DOT fit PARELEFT train_X COMMA train_Y COMMA batch_size EQUAL  COMMA validation_split EQUAL  COMMA callbacks EQUAL [] PARERIGHT  EOM
mymodel DOT save PARELEFT  PARERIGHT  EOM
def train_eoe_model_of_GRU PARELEFT  PARERIGHT : EOM
train_X COMMA  train_Y COMMA  test_X COMMA  test_Y  EQUAL  get_data DOT return_eoa_data PARELEFT  PARERIGHT  EOM
mymodel  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
mymodel DOT add PARELEFT GRU PARELEFT 100 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT GRU PARELEFT 100 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
mymodel DOT summary PARELEFT  PARERIGHT  EOM
mymodel DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
mymodel DOT fit PARELEFT train_X COMMA  train_Y COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
mymodel DOT save PARELEFT  PARERIGHT  EOM
def train_eoe_model_of_Blstm PARELEFT  PARERIGHT : EOM
train_X COMMA  train_Y COMMA  test_X COMMA  test_Y  EQUAL  get_data DOT return_eoa_data PARELEFT  PARERIGHT  EOM
mymodel  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
mymodel DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 100 COMMA  return_sequences EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 100 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
mymodel DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
mymodel DOT summary PARELEFT  PARERIGHT  EOM
mymodel DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
mymodel DOT fit PARELEFT train_X COMMA  train_Y COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
mymodel DOT save PARELEFT  PARERIGHT  EOM
def train_eosc_model_of_lstm PARELEFT  PARERIGHT : EOM
train_X_F COMMA  train_X_B COMMA  train_Y COMMA  test_X_F COMMA  test_X_B COMMA  test_Y  EQUAL  get_data DOT get_eosc_data PARELEFT  PARERIGHT  EOM
encoder_a  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
encoder_a DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
encoder_a DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
encoder_a DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
encoder_b  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
encoder_b DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
encoder_b DOT add PARELEFT LSTM PARELEFT 100 COMMA go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
encoder_b DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
decoder  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
decoder DOT add PARELEFT Merge PARELEFT [] COMMA mode EQUAL  PARERIGHT  PARERIGHT  EOM
decoder DOT add PARELEFT Dense PARELEFT 4 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
decoder DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
decoder DOT fit PARELEFT [] COMMA  train_Y COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
decoder DOT save PARELEFT  PARERIGHT  EOM
def train_eosc_model_of_Blstm PARELEFT  PARERIGHT : EOM
train_X_F COMMA  train_X_B COMMA  train_Y COMMA  test_X_F COMMA  test_X_B COMMA  test_Y  EQUAL  get_data DOT get_eosc_data PARELEFT  PARERIGHT  EOM
encoder_a  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
encoder_a DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
encoder_a DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
encoder_a DOT add PARELEFT Lambda PARELEFT lambda x:K DOT mean PARELEFT x COMMA axis EQUAL  PARERIGHT  COMMA output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
encoder_b  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
encoder_b DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  COMMA go_backwards EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
encoder_b DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
encoder_b DOT add PARELEFT Lambda PARELEFT lambda x:K DOT mean PARELEFT x COMMA axis EQUAL  PARERIGHT  COMMA output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
decoder  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
decoder DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
decoder DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
decoder DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
decoder DOT fit PARELEFT [] COMMA  train_Y COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
decoder DOT save PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
train_eosc_model_of_Blstm PARELEFT  PARERIGHT import pickle EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import GRU EOM
xtrain COMMA  xtest COMMA  ytrain COMMA  ytest  EQUAL  pickle DOT load PARELEFT open PARELEFT  PARERIGHT  PARERIGHT  EOM
def lstm_modelization PARELEFT  PARERIGHT : EOM
num_words  EQUAL  10000 EOM
max_review_length  EQUAL  500 EOM
embedding_vecor_length  EQUAL  32 EOM
opt  EQUAL  RMSprop PARELEFT lr EQUAL  COMMA  rho EQUAL  COMMA  epsilon EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT num_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_class COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  Y_test COMMA  verbose EQUAL  PARERIGHT  EOM
return model EOM
def gru_modelization PARELEFT  PARERIGHT : EOM
num_words  EQUAL  10000 EOM
max_review_length  EQUAL  500 EOM
embedding_vecor_length  EQUAL  32 EOM
opt  EQUAL  RMSprop PARELEFT lr EQUAL  COMMA  rho EQUAL  COMMA  epsilon EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT num_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_class COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  Y_test COMMA  verbose EQUAL  PARERIGHT  EOM
return model EOM
def lstm_and_cnn_modelization PARELEFT  PARERIGHT : EOM
num_words  EQUAL  10000 EOM
max_review_length  EQUAL  500 EOM
embedding_vecor_length  EQUAL  32 EOM
opt  EQUAL  RMSprop PARELEFT lr EQUAL  COMMA  rho EQUAL  COMMA  epsilon EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT num_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_class COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  Y_test COMMA  verbose EQUAL  PARERIGHT  EOM
return model EOM
lstm_model  EQUAL  lstm_modelization PARELEFT  PARERIGHT  EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import os EOM
global_model_version  EQUAL  68 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_11  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_11 DOT add PARELEFT  PARERIGHT  EOM
branch_11 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_11 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_11 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_11 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_11 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_11 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_13  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_13 DOT add PARELEFT  PARERIGHT  EOM
branch_13 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_13 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_13 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_13 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_13 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_13 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_15  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_15 DOT add PARELEFT  PARERIGHT  EOM
branch_15 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_15 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_15 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_15 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_15 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_15 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_17  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_17 DOT add PARELEFT  PARERIGHT  EOM
branch_17 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_17 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_17 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_17 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_17 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_17 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_19  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_19 DOT add PARELEFT  PARERIGHT  EOM
branch_19 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_19 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_19 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_19 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_19 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_19 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_21  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_21 DOT add PARELEFT  PARERIGHT  EOM
branch_21 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_21 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_21 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_21 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_21 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_21 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import numpy as np EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
def build_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT neurons COMMA  return_sequences  EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT neurons COMMA  return_sequences  EQUAL  COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT neurons COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  optimizer  EQUAL  COMMA  metrics  EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return modelfrom __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
import numpy as np EOM
from tensorflow DOT python DOT framework import test_util as tf_test_util EOM
from tensorflow DOT python DOT keras DOT _impl import keras EOM
from tensorflow DOT python DOT keras DOT _impl DOT keras import testing_utils EOM
from tensorflow DOT python DOT platform import test EOM
from tensorflow DOT python DOT training DOT rmsprop import RMSPropOptimizer EOM
class LSTMLayerTest PARELEFT  PARERIGHT : EOM
def test_return_sequences_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA return_sequences EOM
def test_static_shape_inference_LSTM PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
inputs  EQUAL  keras DOT layers DOT Dense PARELEFT embedding_dim COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
outputs  EQUAL  model DOT layers[] DOT output EOM
self DOT assertEquals PARELEFT outputs DOT get_shape PARELEFT  PARERIGHT  DOT as_list PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def test_dynamic_behavior_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT RMSPropOptimizer PARELEFT  PARERIGHT  COMMA   PARERIGHT  EOM
x  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_dropout_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA dropout: 0 DOT 1} COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_implementation_mode_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
for mode in []: EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA implementation PARERIGHT  EOM
def test_statefulness_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT 4 COMMA embedding_dim COMMA mask_zero EQUAL  COMMA input_length EQUAL  COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT ts COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  weights EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
out1  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT out1 DOT shape COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
out2  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out1 DOT max PARELEFT  PARERIGHT  COMMA  out2 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
out3  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out2 DOT max PARELEFT  PARERIGHT  COMMA  out3 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
out4  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out3 COMMA  out4 COMMA  atol EQUAL  PARERIGHT  EOM
out5  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out4 DOT max PARELEFT  PARERIGHT  COMMA  out5 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
left_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
left_padded_input[]  EQUAL  0 EOM
left_padded_input[]  EQUAL  0 EOM
out6  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
right_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
right_padded_input[]  EQUAL  0 EOM
right_padded_input[]  EQUAL  0 EOM
out7  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out7 COMMA  out6 COMMA  atol EQUAL  PARERIGHT  EOM
def test_regularizers_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  COMMA activity_regularizer EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  3 PARERIGHT  EOM
x  EQUAL  keras DOT backend DOT variable PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT layer DOT get_losses_for PARELEFT  PARERIGHT  PARERIGHT  COMMA  1 PARERIGHT  EOM
def test_constraints_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
k_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
r_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
b_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  COMMA recurrent_constraint EQUAL  COMMA bias_constraint EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
def test_with_masking_layer_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layer_class PARELEFT units EQUAL  COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_from_config_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
for stateful in  PARELEFT  PARERIGHT : EOM
l1  EQUAL  layer_class PARELEFT units EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
l2  EQUAL  layer_class DOT from_config PARELEFT l1 DOT get_config PARELEFT  PARERIGHT  PARERIGHT  EOM
assert l1 DOT get_config PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL   : output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL [] PARERIGHT  EOM
else: EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_non_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_reset_states_with_values PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  stateful EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
assert len PARELEFT  PARERIGHT   EQUAL       assert layer DOT states[] is not None EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT zeros PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
state_shapes  EQUAL  [] EOM
values  EQUAL  [] EOM
if len PARELEFT  PARERIGHT   EQUAL         values  EQUAL  values[] EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT ones PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
with self DOT assertRaises PARELEFT  PARERIGHT : EOM
layer DOT reset_states PARELEFT [] *  PARELEFT len PARELEFT  PARERIGHT  + 1 PARERIGHT  PARERIGHT  EOM
def test_specify_state_with_masking PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
_  EQUAL  keras DOT layers DOT Masking PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_return_state PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
state  EQUAL  outputs[] EOM
assert len PARELEFT  PARERIGHT   EQUAL       model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
state  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA  state COMMA  atol EQUAL  PARERIGHT  EOM
def test_state_reuse PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
output COMMA  state  EQUAL  outputs[] COMMA  outputs[] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT output COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
outputs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def test_initial_states_as_other_inputs PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
num_states  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
main_inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
inputs  EQUAL  [] + initial_state EOM
layer  EQUAL  layer_class PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
main_inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
test DOT main PARELEFT  PARERIGHT from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT pooling import MaxPooling1D COMMA  AveragePooling1D EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import SimpleRNN EOM
from keras DOT models import Sequential EOM
from keras import optimizers EOM
from keras import regularizers EOM
import numpy as np EOM
from numpy import newaxis EOM
def lstm_model PARELEFT  PARERIGHT : EOM
rmsprop  EQUAL  optimizers DOT RMSprop PARELEFT lr  EQUAL  COMMA  decay  EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  1 COMMA  activation EQUAL  COMMA nel_regularizer  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 32 COMMA  1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA  return_sequences  EQUAL  COMMA  kernel_regularizer  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  imizer  EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def gru_model PARELEFT  PARERIGHT : EOM
rmsprop  EQUAL  optimizers DOT RMSprop PARELEFT lr  EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT units  EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA urn_sequences  EQUAL  COMMA  rnel_regularizer  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT units  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  timizer  EQUAL  PARERIGHT  EOM
return model EOM
def rnn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT units  EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  _sequences  EQUAL  COMMA  kernel_regularizer  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  optimizer  EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def classifier PARELEFT  PARERIGHT : EOM
rmsprop  EQUAL  optimizers DOT RMSprop PARELEFT lr  EQUAL  COMMA decay EQUAL  PARERIGHT  EOM
sgd  EQUAL  optimizers DOT SGD PARELEFT lr  EQUAL  COMMA  momentum  EQUAL  COMMA  decay  EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 32 COMMA  1 COMMA  activation EQUAL  COMMA  rnel_regularizer  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA ics EQUAL [] PARERIGHT  EOM
return model EOM
def predict PARELEFT  PARERIGHT : EOM
return y_pre EOM
def predict_sequence PARELEFT model COMMA  x_test COMMA  pred_len  EQUAL  PARERIGHT : EOM
for i in range PARELEFT  PARERIGHT : EOM
if i  EQUAL  EQUAL  0: EOM
y_pre DOT append PARELEFT model DOT predict PARELEFT  PARERIGHT  PARERIGHT  EOM
else: EOM
y_pre DOT append PARELEFT model DOT predict PARELEFT np DOT insert PARELEFT x_test[][] COMMA pre[] COMMA  axis  EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return np DOT array PARELEFT  PARERIGHT from __future__ import division COMMA  print_function EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Dropout COMMA  RepeatVector EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT recurrent import SimpleRNN EOM
from keras DOT layers DOT recurrent import GRU EOM
from keras DOT models import Sequential EOM
import os EOM
import helper EOM
from argparse import ArgumentParser EOM
parser  EQUAL  ArgumentParser PARELEFT  PARERIGHT  EOM
parser DOT add_argument PARELEFT  PARERIGHT  EOM
args  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
TASK_NBR  EQUAL  5 EOM
EMBED_HIDDEN_SIZE  EQUAL  100 EOM
BATCH_SIZE  EQUAL  32 EOM
NBR_EPOCHS  EQUAL  50 EOM
train_file COMMA  test_file  EQUAL  helper DOT get_files_for_task PARELEFT  PARERIGHT  EOM
data_train  EQUAL  helper DOT get_stories PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
data_test  EQUAL  helper DOT get_stories PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
word2idx  EQUAL  helper DOT build_vocab PARELEFT  PARERIGHT  EOM
vocab_size  EQUAL  len PARELEFT  PARERIGHT  + 1 EOM
story_maxlen COMMA  question_maxlen  EQUAL  helper DOT get_maxlens PARELEFT  PARERIGHT  EOM
Xs_train COMMA  Xq_train COMMA  Y_train  EQUAL  helper DOT vectorize_dualLSTM PARELEFT  PARERIGHT  EOM
Xs_test COMMA  Xq_test COMMA  Y_test  EQUAL  helper DOT vectorize_dualLSTM PARELEFT  PARERIGHT  EOM
story_lstm_word  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
story_lstm_word DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_HIDDEN_SIZE COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
story_lstm_word DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
story_lstm_sentence  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
story_lstm_sentence DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_HIDDEN_SIZE COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
story_lstm_sentence DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
question_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
question_lstm DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_HIDDEN_SIZE COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
question_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
question_lstm DOT add PARELEFT LSTM PARELEFT EMBED_HIDDEN_SIZE COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
question_lstm DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT EMBED_HIDDEN_SIZE COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT vocab_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA  Y_train COMMA  tch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
loss COMMA  acc  EQUAL  model DOT evaluate PARELEFT [] COMMA  Y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
global_model_version  EQUAL  66 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Model COMMA  Sequential COMMA  load_model EOM
from keras DOT optimizers import Nadam COMMA  SGD COMMA  Adam EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D COMMA  Input COMMA  Conv1D COMMA  MaxPooling3D COMMA  Conv3D COMMA  ConvLSTM2D COMMA  LSTM COMMA  AveragePooling2D EOM
from keras DOT layers import Input COMMA  LSTM COMMA  Embedding COMMA  Dense COMMA  LeakyReLU COMMA  Flatten COMMA  Dropout COMMA  SeparableConv2D COMMA  GlobalAveragePooling3D EOM
from keras DOT layers import TimeDistributed COMMA  BatchNormalization EOM
from keras import optimizers EOM
from keras DOT callbacks import EarlyStopping EOM
from keras import regularizers EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model COMMA  frames COMMA  dimensions COMMA  saved_model EQUAL  COMMA  print_model EQUAL  PARERIGHT : EOM
self DOT frames  EQUAL  frames EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT image_dim  EQUAL  tuple PARELEFT  PARERIGHT  EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  + tuple PARELEFT  PARERIGHT  EOM
self DOT print_model  EQUAL  print_model EOM
metrics  EQUAL  [] EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT CNN_LSTM PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT SepCNN_LSTM PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT CONVLSTM PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT CONV3D PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT CONVLSTM_CONV3D PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL  PARERIGHT  EOM
if self DOT print_model  EQUAL  EQUAL  True: EOM
def CNN_LSTM PARELEFT  PARERIGHT : EOM
frames_input  EQUAL  Input PARELEFT shape EQUAL  PARERIGHT  EOM
vision_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
vision_model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
fc2  EQUAL  Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
CNN_LSTM  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
return CNN_LSTM EOM
def SepCNN_LSTM PARELEFT  PARERIGHT : EOM
frames_input  EQUAL  Input PARELEFT shape EQUAL  PARERIGHT  EOM
vision_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
vision_model DOT add PARELEFT SeparableConv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
fc2  EQUAL  Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
CNN_LSTM  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
return CNN_LSTM EOM
def CONVLSTM PARELEFT  PARERIGHT : EOM
CONVLSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA input_shape EQUAL  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return CONVLSTM EOM
def CONV3D PARELEFT  PARERIGHT : EOM
CONV3D  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Conv3D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Conv3D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Conv3D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return CONV3D EOM
def CONVLSTM_CONV3D PARELEFT  PARERIGHT : EOM
CONVLSTM_CON3D  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA input_shape EQUAL  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Conv3D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return CONVLSTM_CON3Dimport keras EOM
from keras DOT layers import * EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT optimizers import * EOM
import numpy as np EOM
import random EOM
from keras DOT regularizers import * EOM
Xs  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
n  EQUAL  300 EOM
def add_comp PARELEFT  PARERIGHT : EOM
return np DOT append PARELEFT  PARERIGHT  EOM
def add_dim PARELEFT  PARERIGHT : EOM
return map PARELEFT  PARERIGHT  EOM
Xs  EQUAL  map PARELEFT  PARERIGHT  EOM
def resize PARELEFT  PARERIGHT : EOM
if len PARELEFT  PARERIGHT  > n: EOM
return sample[] EOM
if len PARELEFT  PARERIGHT  < n: EOM
res  EQUAL  np DOT concatenate PARELEFT  PARELEFT sample COMMA  np DOT zeros PARELEFT  PARELEFT n-len PARELEFT  PARERIGHT  COMMA len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return res EOM
Xs  EQUAL  filter PARELEFT lambda k : len PARELEFT  PARERIGHT  COMMA  Xs PARERIGHT  EOM
Xs  EQUAL  np DOT array PARELEFT map PARELEFT  PARERIGHT  PARERIGHT  EOM
ys  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
Xs COMMA  ys  EQUAL  zip PARELEFT *filter PARELEFT lambda  PARELEFT  PARERIGHT  : j is not None COMMA  zip PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
Xs  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
ys  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
for i COMMA  thing in enumerate PARELEFT  PARERIGHT : EOM
assert np DOT shape PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
n COMMA  l COMMA  d  EQUAL  np DOT shape PARELEFT  PARERIGHT  EOM
def test0 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer  EQUAL  PARELEFT  PARERIGHT  COMMA  b_regularizer  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model EOM
def test1 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 10 COMMA  input_dim  EQUAL  COMMA  input_length  EQUAL  COMMA urn_sequences  EQUAL  COMMA  consume_less EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 10 COMMA  return_sequences  EQUAL  COMMA  consume_less  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 1 COMMA  return_sequences  EQUAL  COMMA  consume_less  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def test3 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def test2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 10 COMMA  return_sequences  EQUAL  COMMA  consume_less EQUAL  PARERIGHT  COMMA shape  EQUAL  PARELEFT  PARERIGHT  COMMA  merge_mode  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 1 COMMA  consume_less  EQUAL  COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def test2_ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 10 COMMA  return_sequences  EQUAL  COMMA  consume_less EQUAL  PARERIGHT  COMMA shape  EQUAL  PARELEFT  PARERIGHT  COMMA  merge_mode  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 10 COMMA  consume_less  EQUAL  COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
sizes DOT append PARELEFT  PARERIGHT  EOM
def bd_layer PARELEFT  PARERIGHT : EOM
fwd  EQUAL  GRU PARELEFT dim COMMA  return_sequences  EQUAL  COMMA  consume_less  EQUAL  COMMA ut_W  EQUAL  COMMA  dropout_U  EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
bck  EQUAL  GRU PARELEFT dim COMMA  return_sequences  EQUAL  COMMA  consume_less  EQUAL  COMMA  go_backwards  EQUAL  COMMA ut_W  EQUAL  COMMA  dropout_U  EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
return Dropout PARELEFT  PARERIGHT  PARELEFT merge PARELEFT [] COMMA  mode  EQUAL  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
next  EQUAL  inputs EOM
for i COMMA  size in enumerate PARELEFT  PARERIGHT : EOM
next  EQUAL  bd_layer PARELEFT  PARERIGHT  EOM
summary  EQUAL  Dense PARELEFT 10 COMMA  activation  EQUAL  PARERIGHT  PARELEFT Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  PARERIGHT  EOM
pred  EQUAL  Dense PARELEFT 1 COMMA  activation  EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
return Model PARELEFT input  EQUAL  COMMA  output  EQUAL  PARERIGHT  EOM
data  EQUAL  list PARELEFT zip PARELEFT  PARERIGHT  PARERIGHT  EOM
random DOT shuffle PARELEFT  PARERIGHT  EOM
Xtr COMMA  ytr  EQUAL  map PARELEFT np DOT array COMMA zip PARELEFT  PARERIGHT  PARERIGHT  EOM
Xte COMMA  yte  EQUAL  map PARELEFT np DOT array COMMA zip PARELEFT  PARERIGHT  PARERIGHT  EOM
RMS  EQUAL  RMSprop PARELEFT lr  EQUAL  PARERIGHT  EOM
model  EQUAL  test4 PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer  EQUAL  COMMA loss EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT Xtr COMMA  ytr COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data  EQUAL  PARELEFT  PARERIGHT  PARERIGHT from keras DOT models import load_model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Merge EOM
from keras DOT layers DOT core import Dense EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
class fifo_array PARELEFT  PARERIGHT : EOM
self DOT max_len  EQUAL  max_length EOM
self DOT arr  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
def add_element PARELEFT  PARERIGHT : EOM
self DOT arr2  EQUAL  np DOT delete PARELEFT  PARERIGHT  EOM
self DOT arr  EQUAL  np DOT reshape PARELEFT  PARERIGHT  EOM
def get_value PARELEFT  PARERIGHT : EOM
return self DOT arr EOM
def change_length PARELEFT  PARERIGHT : EOM
self DOT arr3  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT arr3[]  EQUAL  self DOT arr EOM
self DOT arr  EQUAL  self DOT arr3 EOM
self DOT max_len  EQUAL  new_length EOM
else: EOM
x  EQUAL  [] EOM
self DOT arr4  EQUAL  np DOT delete PARELEFT  PARERIGHT  EOM
self DOT arr  EQUAL  self DOT arr4 EOM
self DOT max_len  EQUAL  new_length EOM
class bcolors: EOM
UNDERLINE  EQUAL  from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
max_features EQUAL 10000 EOM
maxlen  EQUAL  500 EOM
input_train EOM
input_test EOM
input_train DOT shape COMMA  input_test DOT shape EOM
x_train EQUAL sequence DOT pad_sequences PARELEFT input_train COMMA maxlen EQUAL  PARERIGHT  EOM
x_test EQUAL sequence DOT pad_sequences PARELEFT input_test COMMA maxlen EQUAL  PARERIGHT  EOM
x_train DOT shape COMMA x_test DOT shape EOM
from keras DOT models import Sequential EOM
from keras DOT layers import SimpleRNN COMMA  Dense COMMA  Embedding EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
from keras DOT layers import LSTM EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT 1 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT summary PARELEFT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model_lstm DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  64 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Embedding COMMA  LSTM COMMA  Bidirectional COMMA GRU COMMA SimpleRNN EOM
import logging EOM
from keras DOT callbacks import EarlyStopping EOM
def train PARELEFT  PARERIGHT : EOM
embedding_layer  EQUAL  Embedding PARELEFT max_token + 1 COMMA embedding_dims COMMA input_length EQUAL  COMMA weights EQUAL [] COMMA trainable EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA lidation_data EQUAL  PARELEFT  PARERIGHT  COMMA  callbacks EQUAL [] PARERIGHT  EOM
log_format  EQUAL  EOM
logging DOT basicConfig PARELEFT filename EQUAL  COMMA  level EQUAL  COMMA  format EQUAL  PARERIGHT  EOM
logging DOT warning PARELEFT  PARERIGHT  EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
logging DOT warning PARELEFT  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
def train2 PARELEFT  PARERIGHT : EOM
embedding_layer  EQUAL  Embedding PARELEFT max_token + 1 COMMA embedding_dims COMMA input_length EQUAL  COMMA weights EQUAL [] COMMA trainable EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA lidation_data EQUAL  PARELEFT  PARERIGHT  COMMA  callbacks EQUAL [] PARERIGHT  EOM
log_format  EQUAL  EOM
logging DOT basicConfig PARELEFT filename EQUAL  COMMA  level EQUAL  COMMA  format EQUAL  PARERIGHT  EOM
logging DOT warning PARELEFT  PARERIGHT  EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
strlog EQUAL str PARELEFT  PARERIGHT +++str PARELEFT  PARERIGHT ++str PARELEFT  PARERIGHT ++str PARELEFT  PARERIGHT ++str PARELEFT  PARERIGHT  EOM
logging DOT warning PARELEFT  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
def train3 PARELEFT  PARERIGHT : EOM
embedding_layer  EQUAL  Embedding PARELEFT max_token + 1 COMMA embedding_dims COMMA input_length EQUAL  COMMA weights EQUAL [] COMMA trainable EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA lidation_data EQUAL  PARELEFT  PARERIGHT  COMMA  callbacks EQUAL [] PARERIGHT  EOM
log_format  EQUAL  EOM
logging DOT basicConfig PARELEFT filename EQUAL  COMMA  level EQUAL  COMMA  format EQUAL  PARERIGHT  EOM
logging DOT warning PARELEFT  PARERIGHT  EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
logging DOT warning PARELEFT  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT import os EOM
global_model_version  EQUAL  43 EOM
global_batch_size  EQUAL  16 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import RepeatVector COMMA  Input EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT callbacks import EarlyStopping COMMA  History COMMA  TensorBoard EOM
from keras DOT optimizers import Adam EOM
from keras DOT models import Model EOM
def createModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_units COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_units COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_units COMMA  activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_units COMMA  activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT output_dim COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def createModelEncDec PARELEFT num_units EQUAL  COMMA  input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  x_seq_length EQUAL  COMMA  y_seq_length EQUAL  PARERIGHT : EOM
inputs1  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm1  EQUAL  LSTM PARELEFT num_units COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
batchNorm  EQUAL  BatchNormalization PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
dropout  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
denseor  EQUAL  Dense PARELEFT num_units COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm2 COMMA  state_h COMMA  state_c  EQUAL  LSTM PARELEFT num_units COMMA  return_state EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder_states  EQUAL  [] EOM
decIn  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm3  EQUAL  LSTM PARELEFT num_units COMMA  return_sequences EQUAL  COMMA  return_state EQUAL  PARERIGHT  EOM
lstmOut COMMA  _ COMMA  _  EQUAL  lstm3 PARELEFT decIn COMMA  initial_state EQUAL  PARERIGHT  EOM
outDense  EQUAL  TimeDistributed PARELEFT Dense PARELEFT output_dim COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
decoder_outputs  EQUAL  outDense PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL []  COMMA  outputs EQUAL [] PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Embedding COMMA  Conv1D COMMA  Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT core import Flatten EOM
def get_simple_cnn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA embeddings_initializer EQUAL  COMMA trainable EQUAL  COMMA put_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT activation EQUAL  COMMA filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT activation EQUAL  COMMA filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT activation EQUAL  COMMA filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT activation EQUAL  COMMA filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2048 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA   activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def get_RNN PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA embeddings_initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
from keras DOT engine import Input EOM
from keras import backend as K EOM
from keras DOT layers import Concatenate EOM
from keras DOT models import Model EOM
def mix_cnn_rnn PARELEFT  PARERIGHT : EOM
input_text  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
embedding_vec  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA embeddings_initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
cnn_config EQUAL [] EOM
data_aug  EQUAL  [] EOM
for i COMMA  c_conf in enumerate PARELEFT  PARERIGHT : EOM
data_aug DOT append PARELEFT Conv1D PARELEFT kernel_size  EQUAL [] COMMA lters  EQUAL [] COMMA dding  EQUAL [] COMMA name EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  PARERIGHT  EOM
concat_data  EQUAL  Concatenate PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
rnn_result  EQUAL  LSTM PARELEFT 256 COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
rnn_result  EQUAL  LSTM PARELEFT 256 COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
logist  EQUAL  Dense PARELEFT 19 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT input EQUAL  COMMA  output EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  TimeDistributed COMMA  RepeatVector EOM
from keras DOT layers import LSTM as lstm EOM
from keras DOT optimizers import Adam EOM
from keras DOT callbacks import EarlyStopping COMMA  TensorBoard EOM
from keras DOT models import load_model EOM
from keras import regularizers EOM
import pickle EOM
class LSTM: EOM
def buildModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
for l in range PARELEFT  PARERIGHT : EOM
if l  EQUAL  EQUAL  0: EOM
this_shape  EQUAL   PARELEFT  PARERIGHT  EOM
else: EOM
this_shape  EQUAL   PARELEFT  PARERIGHT  EOM
if l  EQUAL  EQUAL  lstm_layers - 1: EOM
this_return  EQUAL  False EOM
else: EOM
this_return  EQUAL  True EOM
model DOT add PARELEFT lstm PARELEFT lstm_units COMMA  input_shape EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
for l in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def train PARELEFT  PARERIGHT : EOM
callback_earlystop  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  COMMA  verbose EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callback_tensorboard  EQUAL  TensorBoard PARELEFT log_dir EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA   validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  callbacks EQUAL [] PARERIGHT  EOM
return model EOM
def saveModel PARELEFT  PARERIGHT : EOM
model DOT save PARELEFT  PARERIGHT  EOM
def loadModel PARELEFT  PARERIGHT : EOM
return load_model PARELEFT  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  58 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
import time EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA  Merge EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
from keras DOT utils DOT visualize_util import plot COMMA  to_graph EOM
from keras DOT regularizers import l2 COMMA  activity_l2 EOM
import copy EOM
def design_model PARELEFT  PARERIGHT : EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
reg  EQUAL  [] EOM
areg  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
nn_reg  EQUAL  [] EOM
nn_areg  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT  EOM
return model_Combine EOM
def design_model_nn PARELEFT  PARERIGHT : EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
nn_reg  EQUAL  [] EOM
nn_areg  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
graph  EQUAL  to_graph PARELEFT model_B COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT  EOM
return model_B EOM
def design_model_lstm PARELEFT  PARERIGHT : EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
reg  EQUAL  [] EOM
areg  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
graph  EQUAL  to_graph PARELEFT model_A COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT  EOM
return model_Afrom keras DOT models import Sequential EOM
from keras DOT preprocessing DOT image import ImageDataGenerator EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT advanced_activations import PReLU EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD COMMA  Adadelta COMMA  Adagrad EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU EOM
from keras DOT layers import Merge EOM
from phcx import * EOM
import numpy as np EOM
import os EOM
from keras DOT utils import np_utils COMMA  generic_utils EOM
def lenet5 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  5 COMMA  5 COMMA  border_mode EQUAL  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 8 COMMA  3 COMMA  3 COMMA  subsample EQUAL  PARELEFT  PARERIGHT  COMMA border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 16 COMMA  3 COMMA  3 COMMA  subsample EQUAL  PARELEFT  PARERIGHT  COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_data PARELEFT  PARERIGHT : EOM
if mode  EQUAL  EQUAL  : EOM
pulsar_file_base  EQUAL  filePath + EOM
rfi_file_base  EQUAL  filePath + EOM
else: EOM
pulsar_file_base  EQUAL  filePath + EOM
rfi_file_base  EQUAL  filePath + EOM
pulsar_files  EQUAL  os DOT listdir PARELEFT  PARERIGHT  EOM
rfi_files  EQUAL  os DOT listdir PARELEFT  PARERIGHT  EOM
cnn_input  EQUAL  np DOT empty PARELEFT  PARELEFT len PARELEFT  PARERIGHT +len PARELEFT  PARERIGHT  COMMA  1 COMMA  16 COMMA  64 PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
lstm_input  EQUAL  np DOT empty PARELEFT  PARELEFT len PARELEFT  PARERIGHT +len PARELEFT  PARERIGHT  COMMA  18 COMMA  64 PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
train_label  EQUAL  []*len PARELEFT  PARERIGHT  EOM
train_label DOT extend PARELEFT []*len PARELEFT  PARERIGHT  PARERIGHT  EOM
trainlabel  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
train_num  EQUAL  0 EOM
for filename in pulsar_files: EOM
cand  EQUAL  Candidate PARELEFT  PARERIGHT  EOM
cnn_input[]  EQUAL  np DOT resize PARELEFT cand DOT subbands COMMA  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_input[]  EQUAL  np DOT resize PARELEFT cand DOT subints COMMA  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_num + EQUAL 1 EOM
for filename in rfi_files: EOM
cand  EQUAL  Candidate PARELEFT  PARERIGHT  EOM
cnn_input[]  EQUAL  np DOT resize PARELEFT cand DOT subbands COMMA  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_input[]  EQUAL  np DOT resize PARELEFT cand DOT subints COMMA  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_num + EQUAL 1 EOM
return cnn_input COMMA lstm_input COMMA trainlabel EOM
def main PARELEFT  PARERIGHT : EOM
model_cnn  EQUAL  lenet5 PARELEFT  PARERIGHT  EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
merged  EQUAL  Merge PARELEFT [] COMMA mode EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
optimizer_ins  EQUAL  SGD PARELEFT lr EQUAL  COMMA  momentum EQUAL  COMMA  decay EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA trics  EQUAL [] PARERIGHT  EOM
model_lstm DOT summary PARELEFT  PARERIGHT  EOM
filePath  EQUAL  EOM
train_data_cnn COMMA train_data_lstm COMMA train_label  EQUAL  get_data PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA  train_label COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
test_data_cnn COMMA test_data_lstm COMMA test_label  EQUAL  get_data PARELEFT  PARERIGHT  EOM
model DOT evaluate PARELEFT [] COMMA test_label COMMA batch_size  EQUAL  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Concatenate COMMA  Dense COMMA  Input EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
in1  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
in2  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
a  EQUAL  Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
b  EQUAL  LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
b  EQUAL  LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
b  EQUAL  LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Concatenate PARELEFT axis EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
x  EQUAL  Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model EOM
import os EOM
import re EOM
import csv EOM
import codecs EOM
import numpy as np EOM
import pandas as pd EOM
from nltk DOT corpus import stopwords EOM
from nltk DOT stem import SnowballStemmer EOM
from string import punctuation EOM
from gensim DOT models import KeyedVectors EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT layers import Dense COMMA  Input COMMA  LSTM COMMA  Embedding COMMA  Dropout COMMA  Activation COMMA  Merge EOM
from keras DOT layers DOT merge import concatenate EOM
from keras DOT layers import Embedding COMMA  Dense COMMA  Dropout COMMA  Reshape COMMA  Merge COMMA  BatchNormalization COMMA  TimeDistributed COMMA  Lambda COMMA  Activation COMMA  LSTM COMMA  Flatten COMMA  Convolution1D COMMA  GRU COMMA  MaxPooling1D EOM
from keras DOT models import Model EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT callbacks import EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT models import Sequential EOM
import sys EOM
from keras DOT regularizers import l2 EOM
from keras DOT callbacks import Callback COMMA  ModelCheckpoint COMMA  EarlyStopping EOM
from keras import initializers EOM
from keras import backend as K EOM
from keras DOT optimizers import SGD EOM
from collections import defaultdict EOM
reload PARELEFT  PARERIGHT  EOM
sys DOT setdefaultencoding PARELEFT  PARERIGHT  EOM
BASE_DIR  EQUAL  EOM
EMBEDDING_FILE  EQUAL  BASE_DIR + EOM
TRAIN_DATA_FILE  EQUAL  EOM
TEST_DATA_FILE  EQUAL  EOM
MAX_SEQUENCE_LENGTH  EQUAL  50 EOM
MAX_NB_WORDS  EQUAL  200000 EOM
EMBEDDING_DIM  EQUAL  300 EOM
VALIDATION_SPLIT  EQUAL  0 DOT 1 EOM
num_lstm  EQUAL  250 EOM
num_dense  EQUAL  150 EOM
rate_drop_lstm  EQUAL  0 DOT 25 EOM
rate_drop_dense  EQUAL  0 DOT 25 EOM
word2vec  EQUAL  KeyedVectors DOT load_word2vec_format PARELEFT EMBEDDING_FILE COMMA  \binary EQUAL  PARERIGHT  EOM
def text_to_wordlist PARELEFT text COMMA  remove_stopwords EQUAL  COMMA  stem_words EQUAL  PARERIGHT : EOM
text  EQUAL  text DOT lower PARELEFT  PARERIGHT  DOT split PARELEFT  PARERIGHT  EOM
if remove_stopwords: EOM
stops  EQUAL  set PARELEFT stopwords DOT words PARELEFT  PARERIGHT  PARERIGHT  EOM
text  EQUAL  [] EOM
text  EQUAL   DOT join PARELEFT  PARERIGHT  EOM
text  EQUAL  re DOT sub PARELEFT  PARERIGHT  EOM
if stem_words: EOM
text  EQUAL  text DOT split PARELEFT  PARERIGHT  EOM
stemmer  EQUAL  SnowballStemmer PARELEFT  PARERIGHT  EOM
stemmed_words  EQUAL  [] EOM
text  EQUAL   DOT join PARELEFT  PARERIGHT  EOM
return PARELEFT  PARERIGHT  EOM
texts_1  EQUAL  [] EOM
texts_2  EQUAL  [] EOM
labels  EQUAL  [] EOM
f1  EQUAL  [] EOM
f2  EQUAL  [] EOM
f3  EQUAL  [] EOM
f4  EQUAL  [] EOM
f5  EQUAL  [] EOM
f6  EQUAL  [] EOM
f7  EQUAL  [] EOM
f8  EQUAL  [] EOM
f9  EQUAL [] EOM
f10  EQUAL  [] EOM
f11 EQUAL [] EOM
f12  EQUAL  [] EOM
f13  EQUAL  [] EOM
f14  EQUAL  [] EOM
f15  EQUAL  [] EOM
with codecs DOT open PARELEFT TRAIN_DATA_FILE COMMA  encoding EQUAL  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT f COMMA  delimiter EQUAL  PARERIGHT  EOM
header  EQUAL  next PARELEFT  PARERIGHT  EOM
for values in reader: EOM
texts_1 DOT append PARELEFT text_to_wordlist PARELEFT  PARERIGHT  PARERIGHT  EOM
texts_2 DOT append PARELEFT text_to_wordlist PARELEFT  PARERIGHT  PARERIGHT  EOM
labels DOT append PARELEFT int PARELEFT  PARERIGHT  PARERIGHT  EOM
f1 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f2 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f3 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f4 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f5 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f6 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f7 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f8 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f9 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f10 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f11 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f12 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f13 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f14 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
f15 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
test_texts_1  EQUAL  [] EOM
test_texts_2  EQUAL  [] EOM
test_ids  EQUAL  [] EOM
tf1  EQUAL  [] EOM
tf2  EQUAL  [] EOM
tf3  EQUAL  [] EOM
tf4  EQUAL  [] EOM
tf5  EQUAL  [] EOM
tf6  EQUAL  [] EOM
tf7  EQUAL  [] EOM
tf8  EQUAL  [] EOM
tf9  EQUAL [] EOM
tf10  EQUAL  [] EOM
tf11 EQUAL [] EOM
tf12  EQUAL  [] EOM
tf13  EQUAL  [] EOM
tf14  EQUAL  [] EOM
tf15  EQUAL  [] EOM
with codecs DOT open PARELEFT TEST_DATA_FILE COMMA  encoding EQUAL  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT f COMMA  delimiter EQUAL  PARERIGHT  EOM
header  EQUAL  next PARELEFT  PARERIGHT  EOM
for values in reader: EOM
test_texts_1 DOT append PARELEFT text_to_wordlist PARELEFT  PARERIGHT  PARERIGHT  EOM
test_texts_2 DOT append PARELEFT text_to_wordlist PARELEFT  PARERIGHT  PARERIGHT  EOM
test_ids DOT append PARELEFT  PARERIGHT  EOM
tf1 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf2 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf3 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf4 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf5 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf6 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf7 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf8 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf9 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf10 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf11 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf12 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf13 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf14 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tf15 DOT append PARELEFT float PARELEFT  PARERIGHT  PARERIGHT  EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences_1  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
sequences_2  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
test_sequences_1  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
test_sequences_2  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
word_index  EQUAL  tokenizer DOT word_index EOM
data_1  EQUAL  pad_sequences PARELEFT sequences_1 COMMA  maxlen EQUAL  PARERIGHT  EOM
data_2  EQUAL  pad_sequences PARELEFT sequences_2 COMMA  maxlen EQUAL  PARERIGHT  EOM
labels  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
test_data_1  EQUAL  pad_sequences PARELEFT test_sequences_1 COMMA  maxlen EQUAL  PARERIGHT  EOM
test_data_2  EQUAL  pad_sequences PARELEFT test_sequences_2 COMMA  maxlen EQUAL  PARERIGHT  EOM
test_ids  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
f_tr  EQUAL  [] EOM
for i1 COMMA i2 COMMA i3 COMMA i4 COMMA i5 COMMA i6 COMMA i7 COMMA i8 COMMA i9 COMMA i10 COMMA i11 COMMA i12 COMMA i13 COMMA i14 COMMA i15 in zip PARELEFT  PARERIGHT : EOM
f_tr DOT append PARELEFT  PARERIGHT  EOM
f_te  EQUAL  [] EOM
for i1 COMMA i2 COMMA i3 COMMA i4 COMMA i5 COMMA i6 COMMA i7 COMMA i8 COMMA i9 COMMA i10 COMMA i11 COMMA i12 COMMA i13 COMMA i14 COMMA i15 in zip PARELEFT  PARERIGHT : EOM
f_te DOT append PARELEFT  PARERIGHT  EOM
f_tr  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
f_te  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
nb_words  EQUAL  min PARELEFT MAX_NB_WORDS COMMA  len PARELEFT  PARERIGHT  PARERIGHT +1 EOM
gembeddings_index  EQUAL  {} EOM
with codecs DOT open PARELEFT  COMMA  encoding EQUAL  PARERIGHT  as f: EOM
for line in f: EOM
values  EQUAL  line DOT split PARELEFT  PARERIGHT  EOM
word  EQUAL  values[] EOM
gembedding  EQUAL  np DOT asarray PARELEFT values[] COMMA  dtype EQUAL  PARERIGHT  EOM
gembeddings_index[]  EQUAL  gembedding EOM
f DOT close PARELEFT  PARERIGHT  EOM
nb_words  EQUAL  len PARELEFT  PARERIGHT  EOM
g_word_embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for word COMMA  i in word_index DOT items PARELEFT  PARERIGHT : EOM
gembedding_vector  EQUAL  gembeddings_index DOT get PARELEFT  PARERIGHT  EOM
if gembedding_vector is not None: EOM
g_word_embedding_matrix[]  EQUAL  gembedding_vector EOM
embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for word COMMA  i in word_index DOT items PARELEFT  PARERIGHT : EOM
if word in word2vec DOT vocab: EOM
embedding_matrix[]  EQUAL  word2vec DOT word_vec PARELEFT  PARERIGHT  EOM
perm  EQUAL  np DOT random DOT permutation PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
idx_train  EQUAL  perm[] EOM
idx_val  EQUAL  perm[] EOM
data_1_train  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
data_2_train  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels_train  EQUAL  np DOT concatenate PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
f_tr1  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
data_1_val  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
data_2_val  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels_val  EQUAL  np DOT concatenate PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
f_v  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
weight_val  EQUAL  np DOT ones PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
if re_weight: EOM
weight_val * EQUAL  0 DOT 472001959 EOM
weight_val[]  EQUAL  1 DOT 309028344 EOM
weights  EQUAL  initializers DOT TruncatedNormal PARELEFT mean EQUAL  COMMA  stddev EQUAL  COMMA  seed EQUAL  PARERIGHT  EOM
bias  EQUAL  bias_initializer EQUAL  EOM
embedding_dim  EQUAL  EMBEDDING_DIM EOM
max_question_len  EQUAL  MAX_SEQUENCE_LENGTH EOM
model1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model1 DOT add PARELEFT Embedding PARELEFT nb_words COMMA EMBEDDING_DIM COMMA ights  EQUAL [] COMMA put_length  EQUAL  COMMA ainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT LSTM PARELEFT num_lstm COMMA dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model2 DOT add PARELEFT Embedding PARELEFT nb_words COMMA EMBEDDING_DIM COMMA ights  EQUAL [] COMMA put_length  EQUAL  COMMA ainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT LSTM PARELEFT num_lstm COMMA dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model3 DOT add PARELEFT Embedding PARELEFT nb_words COMMA EMBEDDING_DIM COMMA ights  EQUAL [] COMMA put_length  EQUAL  COMMA ainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model3 DOT add PARELEFT LSTM PARELEFT num_lstm COMMA dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model4 DOT add PARELEFT Embedding PARELEFT nb_words COMMA EMBEDDING_DIM COMMA ights  EQUAL [] COMMA put_length  EQUAL  COMMA ainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model4 DOT add PARELEFT LSTM PARELEFT num_lstm COMMA dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model5 DOT add PARELEFT Embedding PARELEFT nb_words COMMA embedding_dim COMMA ights  EQUAL [] COMMA put_length  EQUAL  COMMA ainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT Convolution1D PARELEFT filters  EQUAL  COMMA rnel_size  EQUAL  COMMA dding  EQUAL  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT Convolution1D PARELEFT filters  EQUAL  COMMA rnel_size  EQUAL  COMMA dding  EQUAL  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model5 DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model6 DOT add PARELEFT Embedding PARELEFT nb_words COMMA embedding_dim COMMA ights  EQUAL [] COMMA put_length  EQUAL  COMMA ainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT Convolution1D PARELEFT filters  EQUAL  COMMA rnel_size  EQUAL  COMMA dding  EQUAL  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT Convolution1D PARELEFT filters  EQUAL  COMMA rnel_size  EQUAL  COMMA dding  EQUAL  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model6 DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model7 DOT add PARELEFT Embedding PARELEFT nb_words COMMA embedding_dim COMMA ights  EQUAL [] COMMA put_length  EQUAL  COMMA ainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model7 DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model7 DOT add PARELEFT Lambda PARELEFT lambda x: K DOT max PARELEFT x COMMA  axis EQUAL  PARERIGHT  COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model8  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model8 DOT add PARELEFT Embedding PARELEFT nb_words COMMA embedding_dim COMMA ights  EQUAL [] COMMA put_length  EQUAL  COMMA ainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model8 DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model8 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model8 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model8 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model8 DOT add PARELEFT Lambda PARELEFT lambda x: K DOT max PARELEFT x COMMA  axis EQUAL  PARERIGHT  COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model9 DOT add PARELEFT Dense PARELEFT num_dense COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  kernel_initializer EQUAL  COMMA  bias_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
modela  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modela DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
modela DOT add PARELEFT Dense PARELEFT num_dense COMMA  kernel_initializer EQUAL  COMMA  bias_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
modela DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modela DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
modela DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
modelb  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelb DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
modelb DOT add PARELEFT Dense PARELEFT num_dense COMMA  kernel_initializer EQUAL  COMMA  bias_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
modelb DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modelb DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
modelb DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
modelc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelc DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
modelc DOT add PARELEFT Dense PARELEFT num_dense COMMA  kernel_initializer EQUAL  COMMA  bias_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
modelc DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
modelc DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modelc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
modeld  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modeld DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
modeld DOT add PARELEFT Dense PARELEFT num_dense COMMA  kernel_initializer EQUAL  COMMA  bias_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
modeld DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
modeld DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modeld DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_dense*2 COMMA  kernel_initializer EQUAL  COMMA  bias_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_dense COMMA  kernel_initializer EQUAL  COMMA  bias_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
if re_weight: EOM
class_weight  EQUAL  {0: 1 DOT 309028344 COMMA  1: 0 DOT 472001959} EOM
else: EOM
class_weight  EQUAL  None EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
early_stopping  EQUAL EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
bst_model_path  EQUAL  STAMP + EOM
model_checkpoint  EQUAL  ModelCheckpoint PARELEFT bst_model_path COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT [] COMMA  labels_train COMMA  \ata EQUAL  PARELEFT  PARERIGHT  COMMA  \chs EQUAL  COMMA  batch_size EQUAL  COMMA  shuffle EQUAL  COMMA  \ass_weight EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
bst_val_score  EQUAL  min PARELEFT  PARERIGHT  EOM
preds  EQUAL  model DOT predict PARELEFT [] COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
preds + EQUAL  model DOT predict PARELEFT [] COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
preds / EQUAL  2 EOM
submission  EQUAL  pd DOT DataFrame PARELEFT {:test_ids COMMA  :preds DOT ravel PARELEFT  PARERIGHT } PARERIGHT  EOM
submission DOT to_csv PARELEFT  COMMA  index EQUAL  PARERIGHT from keras DOT models import Sequential EOM
from keras import layers EOM
import numpy as np EOM
from six DOT moves import range EOM
import sys EOM
import os EOM
from keras DOT models import load_model EOM
import keras EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Bidirectional EOM
class SenseModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT lstmunits  EQUAL lstmunits EOM
self DOT lstmLayerNum  EQUAL  lstmLayerNum EOM
self DOT DenseUnits  EQUAL  DenseUnits EOM
self DOT charlenth  EQUAL  charlenth EOM
self DOT datalenth  EQUAL  datalenth EOM
self DOT buildmodel PARELEFT  PARERIGHT  EOM
def buildmodel PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT layers DOT LSTM PARELEFT self DOT lstmunits COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT layers DOT LSTM PARELEFT self DOT lstmunits COMMA  return_sequences EQUAL  COMMA activation EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model DOT summary PARELEFT  PARERIGHT  EOM
def trainModel PARELEFT  PARERIGHT : EOM
for cur in range PARELEFT  PARERIGHT : EOM
self DOT model DOT fit PARELEFT x COMMA  y COMMA batch_size EQUAL  COMMA epochs EQUAL  PARERIGHT  EOM
mdname EQUAL savename++str PARELEFT  PARERIGHT  EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL : EOM
a  EQUAL  SenseModel PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
import numpy as np EOM
import time EOM
import csv EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA Merge EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
import copy EOM
data_dim  EQUAL  1 EOM
timesteps  EQUAL  13 EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
in_dimension  EQUAL  3 EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
from keras DOT utils DOT visualize_util import plot COMMA  to_graph EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT optimizers import SGD EOM
import numpy as np EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Conv1D COMMA  GlobalAveragePooling1D COMMA  MaxPooling1D EOM
seq_length  EQUAL  64 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing import sequence EOM
from keras DOT optimizers import SGD COMMA  RMSprop COMMA  Adagrad EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Input EOM
from keras DOT models import Model EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT constraints import unitnorm EOM
from keras DOT layers DOT core import Reshape COMMA  Flatten COMMA  Merge EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D COMMA  Convolution1D COMMA  MaxPooling1D EOM
from sklearn DOT cross_validation import KFold EOM
from keras DOT callbacks import EarlyStopping EOM
from keras DOT regularizers import l2 EOM
import numpy as np EOM
from sklearn import cross_validation EOM
import math EOM
from keras_input_data import make_idx_data EOM
from load_vai import loadVAI EOM
import _pickle as cPickle EOM
from metrics import continuous_metrics EOM
def lstm_cnn PARELEFT  PARERIGHT : EOM
nb_filter  EQUAL  100 EOM
filter_length  EQUAL  5 EOM
pool_length  EQUAL  2 EOM
lstm_output_size  EQUAL  100 EOM
p  EQUAL  0 DOT 25 EOM
region_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
x  EQUAL  Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  weights EQUAL [] COMMA  input_length EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_output  EQUAL  LSTM PARELEFT 64 COMMA  return_sequences EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
region_conv  EQUAL  Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
region_max  EQUAL  MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
region_vector  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
textvector  EQUAL  Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
predictions  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
final_model  EQUAL  Model PARELEFT region_input COMMA  predictions COMMA  name EQUAL  PARERIGHT  EOM
model EQUAL final_model EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
x  EQUAL  cPickle DOT load PARELEFT open PARELEFT  PARERIGHT  PARERIGHT  EOM
revs COMMA  W COMMA  W2 COMMA  word_idx_map COMMA  vocab  EQUAL  x[] COMMA  x[] COMMA  x[] COMMA  x[] COMMA  x[] EOM
sentences EQUAL [] EOM
for rev in revs: EOM
sentence  EQUAL  rev[] EOM
sentences DOT append PARELEFT  PARERIGHT  EOM
idx_data  EQUAL  make_idx_data PARELEFT  PARERIGHT  EOM
column  EQUAL  loadVAI PARELEFT  PARERIGHT  EOM
irony EQUAL column EOM
batch_size  EQUAL  8 EOM
Y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
Y  EQUAL  [] EOM
n_MAE EQUAL 0 EOM
n_Pearson_r EQUAL 0 EOM
n_Spearman_r EQUAL 0 EOM
n_MSE EQUAL 0 EOM
n_R2 EQUAL 0 EOM
n_MSE_sqrt EQUAL 0 EOM
SEED  EQUAL  42 EOM
for i in range PARELEFT  PARERIGHT : EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  cross_validation DOT train_test_split PARELEFT ata COMMA  Y COMMA  test_size EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL lstm_cnn PARELEFT  PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
result  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA validation_data EQUAL  PARELEFT  PARERIGHT  COMMA callbacks EQUAL [] PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
predict  EQUAL  model DOT predict PARELEFT X_test COMMA  batch_size EQUAL  PARERIGHT  DOT reshape PARELEFT  PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT [] EOM
estimate EQUAL continuous_metrics PARELEFT  PARERIGHT  EOM
n_MSE + EQUAL  estimate[] EOM
n_MAE + EQUAL  estimate[] EOM
n_Pearson_r + EQUAL  estimate[] EOM
n_R2 + EQUAL  estimate[] EOM
n_Spearman_r + EQUAL  estimate[] EOM
n_MSE_sqrt + EQUAL  estimate[] EOM
ndigit EQUAL 3 EOM
avg_MSE  EQUAL   round PARELEFT  PARERIGHT  EOM
avg_MAE  EQUAL   round PARELEFT  PARERIGHT  EOM
avg_Pearson_r  EQUAL   round PARELEFT  PARERIGHT  EOM
avg_R2  EQUAL   round PARELEFT  PARERIGHT  EOM
avg_Spearman_r  EQUAL   round PARELEFT  PARERIGHT  EOM
avg_MSE_sqrt  EQUAL   round PARELEFT  PARERIGHT  EOM
from visualize import plot_keras COMMA  draw_hist EOM
import keras EOM
from keras DOT utils import np_utils EOM
from trainer import Trainer EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense EOM
from keras DOT layers DOT core import Dropout EOM
from keras DOT layers DOT core import Activation EOM
from keras DOT layers DOT recurrent import LSTM EOM
class Validator PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT mdfile  EQUAL  EOM
self DOT t  EQUAL  Trainer PARELEFT  PARERIGHT  EOM
def accuracy PARELEFT  PARERIGHT : EOM
xv COMMA  yv  EQUAL  self DOT t DOT genValiData PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
classes  EQUAL  model DOT predict_classes PARELEFT  PARERIGHT  EOM
acc  EQUAL  np_utils DOT accuracy PARELEFT  PARERIGHT  EOM
return acc EOM
if __name__  EQUAL  EQUAL  : EOM
v  EQUAL  Validator PARELEFT  PARERIGHT  EOM
v DOT accuracy PARELEFT  PARERIGHT import os EOM
global_model_version  EQUAL  35 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class RestaurantPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT [] PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  input_length EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
from keras DOT layers import Merge EOM
left_branch  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
left_branch DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
right_branch  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
right_branch DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
final_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
final_model DOT add PARELEFT  PARERIGHT  EOM
final_model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras import Sequential EOM
from keras DOT constraints import nonneg EOM
from keras DOT layers import LSTM COMMA  Dropout COMMA  Dense COMMA  Conv1D COMMA  MaxPooling1D COMMA  GaussianNoise EOM
from keras DOT models import model_from_json EOM
def save_model PARELEFT  PARERIGHT : EOM
model_json  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
def load_model PARELEFT  PARERIGHT : EOM
json_file  EQUAL  open PARELEFT  PARERIGHT  EOM
loaded_model_json  EQUAL  json_file DOT read PARELEFT  PARERIGHT  EOM
json_file DOT close PARELEFT  PARERIGHT  EOM
loaded_model  EQUAL  model_from_json PARELEFT  PARERIGHT  EOM
loaded_model DOT load_weights PARELEFT  PARERIGHT  EOM
return loaded_model EOM
def lstm_sequence_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 150 COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GaussianNoise PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 75 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 125 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 300 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def lstm_simple_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 75 COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 150 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 150 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 250 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 400 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def stateful_lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 75 COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA batch_size EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 150 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def regular_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 150 COMMA activation EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 225 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def conv_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA kernel_size EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 16 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom keras DOT applications DOT vgg19 import VGG19 EOM
from keras DOT preprocessing import image EOM
from keras DOT applications DOT vgg19 import preprocess_input COMMA  decode_predictions EOM
from keras DOT models import Model EOM
import numpy as np EOM
from keras DOT models import load_model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Embedding EOM
from keras DOT layers import Convolution2D COMMA  MaxPooling2D COMMA  TimeDistributed EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  TimeDistributedDense EOM
preds  EQUAL  np DOT zeros PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Convolution2D PARELEFT 32 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT   COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Convolution2D PARELEFT  PARERIGHT  COMMA   name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Convolution2D PARELEFT 64 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Convolution2D PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT load_weights PARELEFT  COMMA  by_name EQUAL  PARERIGHT  EOM
cnn_model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
for l in model DOT layers: EOM
X_train  EQUAL  np DOT random DOT rand PARELEFT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT rand PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT layers import LSTM COMMA  TimeDistributed COMMA  Embedding EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  LSTM EOM
tsteps  EQUAL  1 EOM
batch_size  EQUAL  1 EOM
lstm_embedding_size  EQUAL  64 EOM
lstm_target_size  EQUAL  2 EOM
lstm_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Embedding PARELEFT 40*60 COMMA  128 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT LSTM PARELEFT lstm_embedding_size COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
from keras DOT applications DOT resnet50 import ResNet50 EOM
from keras DOT applications DOT resnet50 import preprocess_input COMMA  decode_predictions EOM
img_path  EQUAL  EOM
img  EQUAL  image DOT load_img PARELEFT img_path COMMA  target_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x  EQUAL  image DOT img_to_array PARELEFT  PARERIGHT  EOM
x  EQUAL  np DOT expand_dims PARELEFT x COMMA  axis EQUAL  PARERIGHT  EOM
x  EQUAL  preprocess_input PARELEFT  PARERIGHT  EOM
base_model  EQUAL  ResNet50 PARELEFT weights EQUAL  COMMA  include_top EQUAL  PARERIGHT  EOM
extract_model  EQUAL  Model PARELEFT input EQUAL  COMMA  output EQUAL  PARELEFT  PARERIGHT  DOT output PARERIGHT  EOM
preds  EQUAL  extract_model DOT predict PARELEFT  PARERIGHT  EOM
for layer in base_model DOT layers: EOM
from keras DOT models import Model COMMA  Sequential EOM
from keras import layers EOM
from keras import backend as K EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras import callbacks EOM
from keras DOT callbacks import TensorBoard EOM
from keras import metrics EOM
from keras import optimizers EOM
def model_v34 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 52 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 24  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v35 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 52 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 24  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v38 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 52 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v39 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v40 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v41 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v42 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v43 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v44 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v45 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v46 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v47 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v48 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v49 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v50 PARELEFT  PARERIGHT : EOM
model  EQUAL  model_v49 PARELEFT  PARERIGHT  EOM
return model EOM
def model_v51 PARELEFT  PARERIGHT : EOM
model  EQUAL  model_v49 PARELEFT  PARERIGHT  EOM
return model EOM
def model_v52 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v53 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v54 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras import backend as K EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D EOM
from keras DOT datasets import imdb EOM
import numpy as np EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT max_features  EQUAL  20000 EOM
self DOT maxlen  EQUAL  5 EOM
self DOT embedding_size  EQUAL  128 EOM
self DOT kernel_size  EQUAL  5 EOM
self DOT filters  EQUAL  64 EOM
self DOT pool_size  EQUAL  4 EOM
self DOT lstm_output_size  EQUAL  70 EOM
self DOT batch_size  EQUAL  30 EOM
self DOT epochs  EQUAL  2 EOM
def make_array PARELEFT  PARERIGHT : EOM
x_input  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
x_input  EQUAL  sequence DOT pad_sequences PARELEFT x_input COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 5 COMMA  4 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  PARERIGHT  EOM
output_array  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def run PARELEFT  PARERIGHT : EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 10 COMMA  3 COMMA  strides EQUAL  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
result_  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
from keras import backend as K EOM
layer_output_0  EQUAL  K DOT function PARELEFT  PARERIGHT  EOM
layer_output  EQUAL  layer_output_0 PARELEFT  PARERIGHT  EOM
layer_output_0  EQUAL  K DOT function PARELEFT  PARERIGHT  EOM
layer_output  EQUAL  layer_output_0 PARELEFT  PARERIGHT  EOM
layer_output_0  EQUAL  K DOT function PARELEFT  PARERIGHT  EOM
layer_output  EQUAL  layer_output_0 PARELEFT  PARERIGHT  EOM
layer_output_0  EQUAL  K DOT function PARELEFT  PARERIGHT  EOM
layer_output  EQUAL  layer_output_0 PARELEFT  PARERIGHT  EOM
def run1 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 5 COMMA  2 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
def build_model2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA output_dim EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_model PARELEFT seq_len COMMA  feature_num EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  Activation EOM
from keras DOT layers import LSTM COMMA  Bidirectional EOM
from theano DOT scalar import float32 EOM
import numpy as np EOM
def lstm_embedding_empty PARELEFT number_of_classes COMMA  max_features EQUAL  COMMA  embedding_size EQUAL  COMMA  lstm_size EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_embedding_pretrained PARELEFT number_of_classes COMMA  index_to_embedding_mapping COMMA  padding_length COMMA tm_size EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT : EOM
embedding_dimension  EQUAL  len PARELEFT  PARERIGHT  EOM
number_of_words  EQUAL  len PARELEFT index_to_embedding_mapping DOT keys PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for index COMMA  embedding in index_to_embedding_mapping DOT items PARELEFT  PARERIGHT : EOM
embedding_matrix[]  EQUAL  embedding EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
embedding_layer  EQUAL  Embedding PARELEFT number_of_words COMMA embedding_dimension COMMA weights EQUAL [] COMMA input_length EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lst_stacked PARELEFT number_of_classes COMMA  index_to_embedding_mapping COMMA  padding_length COMMA  lstm_size_layer1 EQUAL  COMMA tm_size_layer2 EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT : EOM
embedding_dimension  EQUAL  len PARELEFT  PARERIGHT  EOM
number_of_words  EQUAL  len PARELEFT index_to_embedding_mapping DOT keys PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for index COMMA  embedding in index_to_embedding_mapping DOT items PARELEFT  PARERIGHT : EOM
embedding_matrix[]  EQUAL  embedding EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
embedding_layer  EQUAL  Embedding PARELEFT number_of_words COMMA embedding_dimension COMMA weights EQUAL [] COMMA input_length EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size_layer1 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size_layer2 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def blstm PARELEFT number_of_classes COMMA  index_to_embedding_mapping COMMA  padding_length COMMA  lstm_size_layer1 EQUAL  COMMA stm_size_layer2 EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
embedding_dimension  EQUAL  len PARELEFT  PARERIGHT  EOM
number_of_words  EQUAL  len PARELEFT index_to_embedding_mapping DOT keys PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for index COMMA  embedding in index_to_embedding_mapping DOT items PARELEFT  PARERIGHT : EOM
embedding_matrix[]  EQUAL  embedding EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
embedding_layer  EQUAL  Embedding PARELEFT number_of_words COMMA embedding_dimension COMMA weights EQUAL [] COMMA input_length EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_size_layer1 COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_size_layer2 COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
import Clustering EOM
import Prediction EOM
import numpy as np EOM
from sklearn import preprocessing EOM
from keras DOT wrappers DOT scikit_learn import  KerasClassifier EOM
from keras DOT utils import np_utils EOM
from sklearn DOT cross_validation import train_test_split EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT optimizers import SGD EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
epochs  EQUAL  15 EOM
batch_size  EQUAL  100 EOM
latent_dim  EQUAL  50 EOM
classes  EQUAL  Clustering DOT unique_labels EOM
input_dim  EQUAL  Prediction DOT num_input_features EOM
def baseline_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 100 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
x_train  EQUAL  np DOT asarray PARELEFT Prediction DOT series COMMA dtype EQUAL [] DOT dtype PARERIGHT  EOM
y_train  EQUAL  Clustering DOT labels EOM
encoder  EQUAL  preprocessing DOT LabelEncoder PARELEFT  PARERIGHT  EOM
encoder DOT fit PARELEFT  PARERIGHT  EOM
encoder_Y  EQUAL  encoder DOT transform PARELEFT  PARERIGHT  EOM
dummy_y  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
estimator  EQUAL  KerasClassifier PARELEFT build_fn EQUAL  COMMA epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
X_train COMMA  X_test COMMA  Y_train COMMA  Y_test  EQUAL  train_test_split PARELEFT x_train COMMA  dummy_y COMMA  test_size EQUAL  PARERIGHT  EOM
estimator DOT fit PARELEFT  PARERIGHT  EOM
from typing import List COMMA  Tuple EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT layers import Embedding COMMA  Dense COMMA  Dropout EOM
from keras DOT layers import LSTM as KLSTM EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT models import Sequential EOM
import keras DOT utils as ku EOM
import keras EOM
import pathlib EOM
import numpy as np EOM
class LSTM: EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT dataset_preperation PARELEFT  PARERIGHT  EOM
self DOT tokenizer  EQUAL  Tokenizer PARELEFT  PARERIGHT  EOM
self DOT model: keras DOT engine DOT sequential DOT Sequential  EQUAL  None EOM
self DOT predictors: List[]]  EQUAL  None EOM
self DOT label: List[]  EQUAL  None EOM
self DOT max_sequence_len: int  EQUAL  None EOM
self DOT total_words: int  EQUAL  None EOM
def load_corpus PARELEFT  PARERIGHT  -> str: EOM
corpus_path  EQUAL  pathlib DOT Path PARELEFT  PARERIGHT  EOM
with corpus_path DOT open PARELEFT  PARERIGHT  as corpus_file: EOM
corpus  EQUAL  corpus_file DOT read PARELEFT  PARERIGHT  EOM
return corpus EOM
def dataset_preperation PARELEFT  PARERIGHT  -> Tuple[]] COMMA  List[] COMMA  EOM
int COMMA  int]: EOM
corpus  EQUAL  self DOT load_corpus PARELEFT  PARERIGHT  EOM
corpus  EQUAL  corpus DOT lower PARELEFT  PARERIGHT  DOT split PARELEFT  PARERIGHT  EOM
self DOT tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
total_words  EQUAL  len PARELEFT  PARERIGHT  + 1 EOM
input_sequences  EQUAL  list PARELEFT  PARERIGHT  EOM
for line in corpus: EOM
token_list  EQUAL  self DOT tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT [] EOM
for i in range PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
n_gram_sequence  EQUAL  token_list[] EOM
input_sequences DOT append PARELEFT  PARERIGHT  EOM
max_sequence_len  EQUAL  max PARELEFT [] PARERIGHT  EOM
input_sequences  EQUAL  np DOT array PARELEFT pad_sequences PARELEFT input_sequences COMMA maxlen EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
predictors COMMA  label  EQUAL  input_sequences[] COMMA  input_sequences[] EOM
label  EQUAL  ku DOT to_categorical PARELEFT label COMMA  num_classes EQUAL  PARERIGHT  EOM
self DOT predictors  EQUAL  predictors EOM
self DOT label  EQUAL  label EOM
self DOT max_sequence_len  EQUAL  max_sequence_len EOM
self DOT total_words  EQUAL  total_words EOM
return predictors COMMA  label COMMA  max_sequence_len COMMA  total_words EOM
def create_model PARELEFT  PARERIGHT  -> keras DOT engine DOT sequential DOT Sequential: EOM
input_len  EQUAL  self DOT max_sequence_len - 1 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT self DOT total_words COMMA  10 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT KLSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT total_words COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
self DOT model  EQUAL  model EOM
model_json  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
json_path  EQUAL  EOM
with open PARELEFT str PARELEFT  PARERIGHT  COMMA   PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
weights_path  EQUAL  EOM
model DOT save_weights PARELEFT str PARELEFT  PARERIGHT  PARERIGHT  EOM
model_path  EQUAL  EOM
model DOT save PARELEFT str PARELEFT  PARERIGHT  PARERIGHT  EOM
other_data  EQUAL  EOM
with open PARELEFT  PARERIGHT  as data_file: EOM
data_file DOT write PARELEFT  PARERIGHT  EOM
data_file DOT write PARELEFT  PARERIGHT  EOM
def train PARELEFT  PARERIGHT  -> None: EOM
self DOT model DOT fit PARELEFT self DOT predictors COMMA  self DOT label COMMA  epochs EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def generate_text PARELEFT  PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
token_list  EQUAL  self DOT tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT [] EOM
token_list  EQUAL  pad_sequences PARELEFT [] COMMA xlen EQUAL  COMMA padding EQUAL  PARERIGHT  EOM
predicted  EQUAL  self DOT model DOT predict_classes PARELEFT token_list COMMA  verbose EQUAL  PARERIGHT  EOM
output_word  EQUAL  EOM
for word COMMA  index in self DOT tokenizer DOT word_index DOT items PARELEFT  PARERIGHT : EOM
if index  EQUAL  EQUAL  predicted: EOM
output_word  EQUAL  word EOM
break EOM
seed_text + EQUAL   + output_word EOM
return seed_text EOM
if __name__  EQUAL  EQUAL  : EOM
corpus_path  EQUAL  pathlib DOT Path PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT  PARERIGHT  EOM
lstm DOT dataset_preperation PARELEFT  PARERIGHT  EOM
lstm DOT create_model PARELEFT  PARERIGHT  EOM
text  EQUAL  lstm DOT generate_text PARELEFT  PARERIGHT  EOM
text  EQUAL  lstm DOT generate_text PARELEFT  PARERIGHT  EOM
text  EQUAL  lstm DOT generate_text PARELEFT  PARERIGHT  EOM
text  EQUAL  lstm DOT generate_text PARELEFT  PARERIGHT  EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import GlobalAveragePooling1D EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
return model EOM
def LSTM_Dropout_Sentence_Classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
return model EOM
def CNN_LSTM_Sentence_Classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
return model EOM
def CNN_Sentence_Classifier PARELEFT  PARERIGHT : EOM
seq_length  EQUAL  max_review_length EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
return model EOM
def Stacked_LSTM_Sentence_Classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class RestaurantPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM COMMA  Bidirectional EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
from keras DOT optimizers import SGD COMMA  Nadam EOM
def get_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  Nadam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model COMMA optfrom __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class nuRobotPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT layers import Embedding COMMA  LSTM COMMA  TimeDistributed COMMA  Dense COMMA  Dropout EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
from keras DOT optimizers import Adam EOM
from keras DOT models import load_model as keras_load_model EOM
from  DOT  import constant EOM
class Model PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT constant DOT NUM_CHARS COMMA  constant DOT EMBEDDING_SIZE COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT constant DOT NUM_TAGS COMMA  activation EQUAL  PARERIGHT  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model  EQUAL  model EOM
def save_model PARELEFT  PARERIGHT : EOM
model DOT save PARELEFT  PARERIGHT  EOM
def load_model PARELEFT  PARERIGHT : EOM
return keras_load_model PARELEFT  PARERIGHT from keras DOT models import Model COMMA  Sequential COMMA  load_model EOM
from keras DOT optimizers import Nadam COMMA  SGD COMMA  Adam EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D COMMA  Input COMMA  Conv1D COMMA  MaxPooling3D COMMA  Conv3D COMMA  ConvLSTM2D COMMA  LSTM COMMA  AveragePooling2D EOM
from keras DOT layers import Input COMMA  LSTM COMMA  Embedding COMMA  Dense COMMA  LeakyReLU COMMA  Flatten COMMA  Dropout COMMA  SeparableConv2D COMMA  GlobalAveragePooling3D EOM
from keras DOT layers import TimeDistributed COMMA  BatchNormalization EOM
from keras import optimizers EOM
from keras DOT callbacks import EarlyStopping EOM
from keras import regularizers EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  model COMMA  frames COMMA  dimensions COMMA  saved_model EQUAL  COMMA  print_model EQUAL  PARERIGHT : EOM
self DOT frames  EQUAL  frames EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT image_dim  EQUAL  tuple PARELEFT  PARERIGHT  EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  + tuple PARELEFT  PARERIGHT  EOM
self DOT print_model  EQUAL  print_model EOM
metrics  EQUAL  [] EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT CNN_LSTM PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT SepCNN_LSTM PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT CONVLSTM PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT CONV3D PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT CONVLSTM_CONV3D PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL  PARERIGHT  EOM
if self DOT print_model  EQUAL  EQUAL  True: EOM
def CNN_LSTM PARELEFT  PARERIGHT : EOM
frames_input  EQUAL  Input PARELEFT shape EQUAL  PARERIGHT  EOM
vision_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
vision_model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
fc2  EQUAL  Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
CNN_LSTM  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
return CNN_LSTM EOM
def SepCNN_LSTM PARELEFT  PARERIGHT : EOM
frames_input  EQUAL  Input PARELEFT shape EQUAL  PARERIGHT  EOM
vision_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
vision_model DOT add PARELEFT SeparableConv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
vision_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
fc2  EQUAL  Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
CNN_LSTM  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
return CNN_LSTM EOM
def CONVLSTM PARELEFT  PARERIGHT : EOM
CONVLSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA input_shape EQUAL  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return CONVLSTM EOM
def CONV3D PARELEFT  PARERIGHT : EOM
CONV3D  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Conv3D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Conv3D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Conv3D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
CONV3D DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return CONV3D EOM
def CONVLSTM_CONV3D PARELEFT  PARERIGHT : EOM
CONVLSTM_CON3D  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA input_shape EQUAL  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Conv3D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
CONVLSTM_CON3D DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return CONVLSTM_CON3Dfrom keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  units EQUAL  COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport os EOM
global_model_version  EQUAL  56 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT SGD PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import tensorflow as tf EOM
import keras EOM
from keras DOT utils import to_categorical EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras import regularizers EOM
from keras import backend as KTF EOM
from sklearn DOT model_selection import train_test_split EOM
import numpy as np EOM
import pandas as pd EOM
class model PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT X  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
self DOT Y  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
self DOT X  EQUAL  self DOT X[] EOM
self DOT Y  EQUAL  self DOT Y[] EOM
self DOT lstm_size  EQUAL  lstm_size EOM
self DOT dropout  EQUAL  dropout EOM
self DOT batch_size  EQUAL  batch_size EOM
self DOT epochs  EQUAL  epochs EOM
self DOT train_X COMMA  self DOT val_X COMMA  self DOT train_Y COMMA  self DOT val_Y  EQUAL  train_test_split PARELEFT self DOT X COMMA  self DOT Y COMMA  test_size EQUAL  PARERIGHT  EOM
self DOT n_words  EQUAL  791771 EOM
def model_architecture PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT self DOT n_words + 1 COMMA  200 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT lstm_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT lstm_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT n_words COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
tensorboard  EQUAL  TensorBoard PARELEFT log_dir EQUAL  COMMA  histogram_freq EQUAL  COMMA  batch_size EQUAL  COMMA  write_graph EQUAL  COMMA rite_grads EQUAL  COMMA  write_images EQUAL  COMMA  embeddings_freq EQUAL  COMMA  embeddings_layer_names EQUAL  COMMA   embeddings_metadata EQUAL  PARERIGHT  EOM
filepath  EQUAL  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT self DOT train_X COMMA  self DOT train_Y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA allbacks EQUAL [] COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  model PARELEFT  PARERIGHT  EOM
model DOT model_architecture PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import RepeatVector EOM
from keras DOT layers import TimeDistributed EOM
def define_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT src_vocab COMMA  n_units COMMA  input_length EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_units COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT tar_vocab COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT preprocessing DOT image import ImageDataGenerator EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT advanced_activations import PReLU EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD COMMA  Adadelta COMMA  Adagrad EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU EOM
from keras DOT layers import Merge EOM
from phcx import * EOM
import numpy as np EOM
import os EOM
from keras DOT utils import np_utils COMMA  generic_utils EOM
def lenet5 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  5 COMMA  5 COMMA  border_mode EQUAL  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 8 COMMA  3 COMMA  3 COMMA  subsample EQUAL  PARELEFT  PARERIGHT  COMMA border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 16 COMMA  3 COMMA  3 COMMA  subsample EQUAL  PARELEFT  PARERIGHT  COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  input_dim EQUAL  PARELEFT  PARERIGHT  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  input_dim EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_data PARELEFT  PARERIGHT : EOM
if mode  EQUAL  EQUAL  : EOM
pulsar_file_base  EQUAL  filePath + EOM
rfi_file_base  EQUAL  filePath + EOM
else: EOM
pulsar_file_base  EQUAL  filePath + EOM
rfi_file_base  EQUAL  filePath + EOM
pulsar_files  EQUAL  os DOT listdir PARELEFT  PARERIGHT  EOM
rfi_files  EQUAL  os DOT listdir PARELEFT  PARERIGHT  EOM
cnn_input  EQUAL  np DOT empty PARELEFT  PARELEFT len PARELEFT  PARERIGHT +len PARELEFT  PARERIGHT  COMMA  1 COMMA  16 COMMA  64 PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
lstm_input  EQUAL  np DOT empty PARELEFT  PARELEFT len PARELEFT  PARERIGHT +len PARELEFT  PARERIGHT  COMMA  18 COMMA  64 PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
train_label  EQUAL  []*len PARELEFT  PARERIGHT  EOM
train_label DOT extend PARELEFT []*len PARELEFT  PARERIGHT  PARERIGHT  EOM
trainlabel  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
train_num  EQUAL  0 EOM
for filename in pulsar_files: EOM
cand  EQUAL  Candidate PARELEFT  PARERIGHT  EOM
cnn_input[]  EQUAL  np DOT resize PARELEFT cand DOT subbands COMMA  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_input[]  EQUAL  np DOT resize PARELEFT cand DOT subints COMMA  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_num + EQUAL 1 EOM
for filename in rfi_files: EOM
cand  EQUAL  Candidate PARELEFT  PARERIGHT  EOM
cnn_input[]  EQUAL  np DOT resize PARELEFT cand DOT subbands COMMA  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_input[]  EQUAL  np DOT resize PARELEFT cand DOT subints COMMA  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_num + EQUAL 1 EOM
return cnn_input COMMA lstm_input COMMA trainlabel EOM
def main PARELEFT  PARERIGHT : EOM
model_cnn  EQUAL  lenet5 PARELEFT  PARERIGHT  EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
merged  EQUAL  Merge PARELEFT [] COMMA mode EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
optimizer_ins  EQUAL  SGD PARELEFT lr EQUAL  COMMA  momentum EQUAL  COMMA  decay EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model_lstm DOT summary PARELEFT  PARERIGHT  EOM
filePath  EQUAL  EOM
train_data_cnn COMMA train_data_lstm COMMA train_label  EQUAL  get_data PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA  train_label COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
test_data_cnn COMMA test_data_lstm COMMA test_label  EQUAL  get_data PARELEFT  PARERIGHT  EOM
model DOT evaluate PARELEFT [] COMMA test_label COMMA batch_size  EQUAL  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
X_train COMMA  y_train COMMA  X_test COMMA  y_test COMMA p  EQUAL  lstm DOT load_data PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA y_train COMMA batch_size EQUAL  COMMA nb_epoch EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
predictions  EQUAL  lstm DOT predict_sequences_multiple PARELEFT  PARERIGHT  EOM
lstm DOT plot_results_multiple PARELEFT  PARERIGHT  EOM
import numpy EOM
from sys import argv EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
SEQ_LEN  EQUAL  12 EOM
class PasswordLSTM: EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT SEQ_LEN  EQUAL  SEQ_LEN EOM
self DOT X  EQUAL  X EOM
self DOT y  EQUAL  y EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT filepath EQUAL  %  PARELEFT  PARERIGHT  EOM
self DOT epochs  EQUAL  50 EOM
self DOT batch_size  EQUAL  50 EOM
self DOT monitor  EQUAL  EOM
self DOT verbose  EQUAL  1 EOM
self DOT save_best_only EQUAL True EOM
self DOT mode EQUAL  EOM
self DOT checkpoint  EQUAL  None EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model_built  EQUAL  False EOM
def build_model PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT 512 COMMA input_shape EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT self DOT y DOT shape[] COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
self DOT model_built  EQUAL  True EOM
def predict PARELEFT  PARERIGHT : EOM
return self DOT model DOT predict PARELEFT x COMMA verbose EQUAL  PARERIGHT  EOM
def load_weights PARELEFT  PARERIGHT : EOM
if  PARELEFT self DOT model_built ! EQUAL  PARERIGHT : EOM
self DOT build_model PARELEFT  PARERIGHT  EOM
self DOT model DOT load_weights PARELEFT  PARERIGHT  EOM
def fit PARELEFT  PARERIGHT : EOM
self DOT checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath EQUAL  COMMA monitor EQUAL  COMMA verbose EQUAL  COMMA save_best_only EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
self DOT model DOT fit PARELEFT self DOT X COMMA self DOT y COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA callbacks EQUAL [] PARERIGHT from keras import backend as K EOM
from keras import layers EOM
from keras import regularizers EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT models import load_model EOM
from keras DOT models import Sequential EOM
from keras DOT utils import plot_model EOM
def lstmModel PARELEFT n_channels COMMA n_timesteps COMMA n_outputs COMMA activation EQUAL  COMMA keep_rate EQUAL  COMMA go_backwards EQUAL  COMMA unroll EQUAL  PARERIGHT : EOM
name  EQUAL   + activation EOM
lstm  EQUAL  LSTM PARELEFT n_channels COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_outputs COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
folder    EQUAL  EOM
name_h5   EQUAL  folder + name + EOM
name_png  EQUAL  folder + name + EOM
plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
model DOT save PARELEFT name_h5 COMMA  overwrite EQUAL  PARERIGHT  EOM
return model COMMA  name EOM
from keras DOT utils import np_utils EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA  MaxPooling1D EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT layers import Input COMMA  Bidirectional EOM
def build_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_dims COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT embedding_dims COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_cnn PARELEFT  PARERIGHT  : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA embedding_dims COMMA input_length EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_cnn_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_bidirectional_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_dims COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras import layers EOM
import numpy as np EOM
from six DOT moves import range EOM
import sys EOM
import os EOM
from keras DOT models import load_model EOM
import keras EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Bidirectional EOM
from keras DOT utils import plot_model EOM
class SenseModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT lstmunits  EQUAL lstmunits EOM
self DOT lstmLayerNum  EQUAL  lstmLayerNum EOM
self DOT DenseUnits  EQUAL  DenseUnits EOM
self DOT charlenth  EQUAL  charlenth EOM
self DOT datalenth  EQUAL  datalenth EOM
self DOT buildmodel PARELEFT  PARERIGHT  EOM
def buildmodel PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT self DOT DenseUnits COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT layers DOT LSTM PARELEFT self DOT lstmunits COMMA return_sequences EQUAL  COMMA activation EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model DOT summary PARELEFT  PARERIGHT  EOM
def trainModel PARELEFT  PARERIGHT : EOM
for cur in range PARELEFT  PARERIGHT : EOM
log EQUAL self DOT model DOT fit PARELEFT x COMMA  y COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
mdname  EQUAL  savename +  + str PARELEFT  PARERIGHT  EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL : EOM
a  EQUAL  SenseModel PARELEFT  PARERIGHT  EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import Callback EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
def on_batch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def neural_net PARELEFT num_sensors COMMA  params COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT rams[] COMMA  init EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if load: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def lstm_net PARELEFT num_sensors COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT tput_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelimport numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT recurrent import SimpleRNN  COMMA  LSTM EOM
from keras DOT optimizers import SGD  COMMA  Adagrad EOM
def keras_model PARELEFT  batch_dim  COMMA  image_vector EQUAL  COMMA  word_vector EQUAL  PARERIGHT : EOM
LSTM_layers  EQUAL  1 EOM
LSTM_units   EQUAL  300 EOM
DNN_units    EQUAL  [] EOM
question_LSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_q  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
question_LSTM DOT add PARELEFT  PARERIGHT  EOM
question_LSTM DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_1  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_1  EQUAL  LSTM PARELEFT  PARERIGHT  EOM
opt_LSTM_1 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_1 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_2  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_2  EQUAL  LSTM PARELEFT  PARERIGHT  EOM
opt_LSTM_2 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_2 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_3  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_3  EQUAL  LSTM PARELEFT  PARERIGHT  EOM
opt_LSTM_3 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_3 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_4  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_4  EQUAL  LSTM PARELEFT  PARERIGHT  EOM
opt_LSTM_4 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_4 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_5  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_5  EQUAL  LSTM PARELEFT  PARERIGHT  EOM
opt_LSTM_5 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_5 DOT add PARELEFT  PARERIGHT  EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Reshape PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  dims  EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  ode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
layer_pre_DNN  EQUAL  Dense PARELEFT DNN_units[]  COMMA  init  EQUAL  PARERIGHT  EOM
layer_pre_DNN_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_pre_DNN_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_DNN_1  EQUAL  Dense PARELEFT DNN_units[]  COMMA  init  EQUAL  PARERIGHT  EOM
layer_DNN_1_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_DNN_1_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_softmax  EQUAL  Activation PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
X  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
Y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
my_model  EQUAL  keras_model PARELEFT  PARERIGHT  EOM
from tensorflow DOT keras import backend as K EOM
from tensorflow DOT keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA Embedding COMMA Flatten COMMA LSTM COMMA Bidirectional COMMA GlobalAveragePooling1D EOM
from keras DOT layers import Dropout EOM
from keras import regularizers EOM
from keras DOT layers import Input EOM
from keras DOT models import Model EOM
from Attention_keras import Attention COMMA Position_Embedding EOM
class WRNNModel: EOM
def Average PARELEFT  PARERIGHT : EOM
for i in range PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
output + EQUAL  inputs_list[] * weight_array[] EOM
return output EOM
def buildnet PARELEFT  PARERIGHT : EOM
sequence  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
embedded  EQUAL  Embedding PARELEFT 128 COMMA  80 COMMA  input_length EQUAL [] COMMA  mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
blstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
blstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT units  EQUAL  COMMA  input_dim EQUAL  COMMA  use_bias EQUAL  COMMA ctivation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
Main_model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
return Main_model EOM
class DNNModel: EOM
def Average PARELEFT  PARERIGHT : EOM
for i in range PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
output + EQUAL  inputs_list[] * weight_array[] EOM
return output EOM
def buildnet PARELEFT  PARERIGHT : EOM
Main_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
Main_model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_hid_size  EQUAL  128 EOM
l2_rate  EQUAL  0 DOT 05 EOM
Main_model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  input_dim EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  COMMA use_bias EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
Main_model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  input_dim EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  COMMA use_bias EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
Main_model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  input_dim EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  COMMA use_bias EQUAL  PARERIGHT  PARERIGHT  EOM
Main_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
from __future__ import print_function EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D EOM
from keras DOT datasets import imdb EOM
top_words  EQUAL  20000 EOM
maxlen  EQUAL  100 EOM
embedding_size  EQUAL  128 EOM
kernel_size  EQUAL  5 EOM
filters  EQUAL  64 EOM
pool_size  EQUAL  4 EOM
lstm_output_size  EQUAL  70 EOM
batch_size  EQUAL  30 EOM
epochs  EQUAL  2 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters COMMA kernel_size COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  LSTM COMMA  Dropout EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from keras DOT callbacks import EarlyStopping EOM
from sklearn DOT preprocessing import LabelBinarizer EOM
from public_tool DOT bagging_balance_weight import bagging_balance_weight EOM
from keras DOT layers import BatchNormalization EOM
from keras DOT optimizers import SGD EOM
from public_tool DOT form_index import form_index EOM
from public_tool DOT random_cut import random_cut EOM
from public_tool DOT form_accuracy import form_accuracy EOM
from keras DOT models import load_model EOM
import pickle EOM
def form_LSTM_dataset PARELEFT  PARERIGHT : EOM
result_X  EQUAL  [] EOM
result_y  EQUAL  [] EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
begin_index COMMA  end_index  EQUAL  form_index PARELEFT  PARERIGHT  EOM
now_X  EQUAL  X[] EOM
now_y  EQUAL  y[] EOM
for j in range PARELEFT len PARELEFT  PARERIGHT  - T PARERIGHT : EOM
result_X DOT append PARELEFT  PARERIGHT  EOM
result_y DOT append PARELEFT  PARERIGHT  EOM
result_X  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
return result_X COMMA  result_y EOM
def self_LSTM PARELEFT  PARERIGHT : EOM
mms  EQUAL  MinMaxScaler PARELEFT  PARERIGHT  EOM
X  EQUAL  mms DOT fit_transform PARELEFT  PARERIGHT  EOM
T  EQUAL  10 EOM
X_LSTM COMMA  y_LSTM  EQUAL  form_LSTM_dataset PARELEFT  PARERIGHT  EOM
lb  EQUAL  LabelBinarizer PARELEFT  PARERIGHT  EOM
y_LSTM  EQUAL  lb DOT fit_transform PARELEFT  PARERIGHT  EOM
X_train COMMA  y_train COMMA  X_valid COMMA  y_valid  EQUAL  random_cut PARELEFT  PARERIGHT  EOM
X_train COMMA  y_train  EQUAL  bagging_balance_weight PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 30 COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA y_train COMMA tch_size EQUAL  PARELEFT  PARERIGHT  COMMA epochs EQUAL  COMMA verbose EQUAL  COMMA validation_split EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  COMMA shuffle EQUAL  COMMA class_weight EQUAL  COMMA sample_weight EQUAL  COMMA initial_epoch EQUAL  COMMA callbacks EQUAL [] PARERIGHT  EOM
mms_file_name  EQUAL   + file_name + EOM
pickle DOT dump PARELEFT mms COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model_file_name  EQUAL   + file_name + EOM
model DOT save PARELEFT  PARERIGHT import matplotlib DOT pyplot as plt EOM
import pandas EOM
import numpy as np EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributedDense EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import SGD EOM
from keras DOT utils DOT np_utils import to_categorical EOM
def train_simple_lstm PARELEFT  PARERIGHT : EOM
max_features  EQUAL  kwargs DOT get PARELEFT  COMMA  Xtrain DOT max PARELEFT  PARERIGHT  + 1 PARERIGHT  EOM
embedding_size  EQUAL  kwargs DOT get PARELEFT  PARERIGHT  EOM
dense_size  EQUAL  kwargs DOT get PARELEFT  PARERIGHT  EOM
n_epoch  EQUAL  kwargs DOT get PARELEFT  PARERIGHT  EOM
Ytrain  EQUAL  to_categorical PARELEFT Ytrain DOT reshape PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_size COMMA  input_length EQUAL [] COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT Xtrain COMMA  Ytrain COMMA  nb_epoch EQUAL  PARERIGHT  EOM
return model EOM
dataset  EQUAL  np DOT loadtxt PARELEFT  COMMA  delimiter EQUAL  PARERIGHT  EOM
trainX  EQUAL  dataset[] EOM
trainY  EQUAL  dataset[] DOT astype PARELEFT  PARERIGHT  EOM
train_simple_lstm PARELEFT  PARERIGHT  EOM
from keras DOT layers import Dense COMMA  Flatten COMMA  Dropout COMMA  ZeroPadding3D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
from collections import deque EOM
import sys EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  seq_length COMMA aved_model EQUAL  COMMA  features_length EQUAL  PARERIGHT : EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
if self DOT nb_classes > EQUAL  10: EOM
metrics DOT append PARELEFT  PARERIGHT  EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lrcn PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT conv_3d PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2048 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lrcn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA tivation EQUAL  COMMA  padding EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def conv_3d PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Embedding COMMA  LSTM COMMA  GRU COMMA  Dense COMMA  Dropout COMMA  Bidirectional COMMA  TimeDistributed COMMA  Flatten EOM
from keras DOT callbacks import EarlyStopping COMMA  ModelCheckpoint EOM
from sklearn DOT metrics import mean_squared_error EOM
from keras DOT utils import np_utils EOM
import os EOM
import pickle EOM
import sys COMMA  argparse COMMA  os EOM
import keras EOM
import _pickle as pk EOM
import readline EOM
import numpy as np EOM
from keras import regularizers EOM
from keras DOT models import Model COMMA  load_model EOM
from keras DOT layers import Input COMMA  GRU COMMA  LSTM COMMA  Dense COMMA  Dropout COMMA  Bidirectional EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT optimizers import Adam EOM
from keras DOT callbacks import EarlyStopping COMMA  ModelCheckpoint EOM
import keras DOT backend DOT tensorflow_backend as K EOM
import tensorflow as tf EOM
import pandas as pd EOM
import os EOM
import sys EOM
from sklearn DOT linear_model import LinearRegression COMMA  LogisticRegression EOM
from sklearn DOT svm import SVC EOM
from sklearn DOT tree import DecisionTreeClassifier EOM
from sklearn DOT neural_network import MLPClassifier EOM
from sklearn DOT ensemble import RandomForestClassifier EOM
from sklearn DOT cluster import KMeans EOM
from sklearn DOT naive_bayes import GaussianNB EOM
from sklearn DOT model_selection import train_test_split EOM
from sklearn DOT metrics import accuracy_score COMMA  precision_recall_fscore_support COMMA  mean_squared_error COMMA  confusion_matrix EOM
from sklearn DOT preprocessing import StandardScaler EOM
from plot import plot_conf_matrix EOM
import numpy as np EOM
import pandas as pd EOM
import pickle EOM
import os EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Embedding COMMA  LSTM COMMA  GRU COMMA  Dense COMMA  Dropout COMMA  Bidirectional COMMA  TimeDistributed COMMA  Flatten EOM
from keras DOT callbacks import EarlyStopping COMMA  ModelCheckpoint EOM
from sklearn DOT metrics import mean_squared_error EOM
import os EOM
import pickle EOM
os DOT environ[]  EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  choices EQUAL [] PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  choices EQUAL [] PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  choices EQUAL [] PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA   COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  COMMA  default EQUAL  COMMA type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  type EQUAL  COMMA  default EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default  EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default  EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  default EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
args  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
trainX_path  EQUAL   + args DOT window + EOM
trainY_path  EQUAL   + args DOT window + EOM
testY_path  EQUAL     + args DOT window + EOM
mode  EQUAL  args DOT action EOM
def RT_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT args DOT hidden_size COMMA  input_shape EQUAL  PARELEFT int PARELEFT  PARERIGHT  COMMA 4 PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT args DOT hidden_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
if mode  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT args DOT bin_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def RT_gru PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT args DOT hidden_size COMMA  input_shape EQUAL  PARELEFT int PARELEFT  PARERIGHT  COMMA 4 PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT args DOT hidden_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
if mode  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Dense PARELEFT args DOT hidden_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT args DOT bin_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def RF_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT args DOT hidden_size COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT int PARELEFT  PARERIGHT  COMMA 4 PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
if mode  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Dense PARELEFT args DOT bin_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def RF_gru PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT args DOT hidden_size COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT int PARELEFT  PARERIGHT  COMMA 4 PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
if mode  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Dense PARELEFT args DOT bin_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def main PARELEFT  PARERIGHT : EOM
index  EQUAL  args DOT index EOM
bin_size  EQUAL  args DOT bin_size EOM
acc COMMA  pre COMMA  rec COMMA  f_score  EQUAL  [] COMMA  [] COMMA  [] COMMA  [] EOM
from keras DOT backend DOT tensorflow_backend import set_session EOM
config  EQUAL  tf DOT ConfigProto PARELEFT  PARERIGHT  EOM
config DOT gpu_options DOT allow_growth EQUAL True EOM
set_session PARELEFT tf DOT Session PARELEFT config EQUAL  PARERIGHT  PARERIGHT  EOM
save_path  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
if args DOT load_model is not None: EOM
load_path  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
from util import * EOM
dm  EQUAL  DataManager PARELEFT  PARERIGHT  EOM
dm DOT add_data PARELEFT  PARERIGHT  EOM
data COMMA  label COMMA  Z  EQUAL  dm DOT get_data PARELEFT  PARERIGHT  EOM
x_train COMMA  x_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT data COMMA  label COMMA est_size EQUAL  PARERIGHT  EOM
x_train  EQUAL  np DOT load PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
y_train  EQUAL  np DOT load PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
x_test  EQUAL  np DOT load PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np DOT load PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
x_train1  EQUAL  x_train[] DOT reshape PARELEFT  PARERIGHT  EOM
x_train2  EQUAL  x_train[] DOT reshape PARELEFT  PARERIGHT  EOM
x_train1  EQUAL  np DOT concatenate PARELEFT  PARELEFT  PARERIGHT  COMMA  axis  EQUAL  PARERIGHT  EOM
mean_x  EQUAL  np DOT mean PARELEFT x_train1 COMMA  axis  EQUAL  PARERIGHT  EOM
std_x  EQUAL  np DOT std PARELEFT x_train1 COMMA  axis  EQUAL  PARERIGHT  EOM
x_1  EQUAL   PARELEFT  PARERIGHT  / std_x EOM
x_test1  EQUAL  x_test[] DOT reshape PARELEFT  PARERIGHT  EOM
x_test2  EQUAL  x_train[] DOT reshape PARELEFT  PARERIGHT  EOM
x_t1  EQUAL   PARELEFT  PARERIGHT  / std_x EOM
mean_y  EQUAL  np DOT mean PARELEFT  PARERIGHT  EOM
std_y  EQUAL  np DOT std PARELEFT  PARERIGHT  EOM
y  EQUAL   PARELEFT  PARERIGHT  / std_y EOM
y_t1  EQUAL   PARELEFT  PARERIGHT  / std_y EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT  EOM
if args DOT action  EQUAL  EQUAL  : EOM
if args DOT model_type  EQUAL  EQUAL  : EOM
model  EQUAL  RT_lstm PARELEFT  PARERIGHT  EOM
elif args DOT model_type  EQUAL  EQUAL  : EOM
model  EQUAL  RT_gru PARELEFT  PARERIGHT  EOM
elif args DOT model_type  EQUAL  EQUAL  : EOM
model  EQUAL  RF_lstm PARELEFT  PARERIGHT  EOM
elif args DOT model_type  EQUAL  EQUAL  : EOM
model  EQUAL  RF_gru PARELEFT  PARERIGHT  EOM
earlystopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience  EQUAL  COMMA  verbose EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
save_path  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath EQUAL  COMMA verbose EQUAL  COMMA save_best_only EQUAL  COMMA monitor EQUAL  COMMA ode EQUAL  PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA  Y COMMA validation_split EQUAL  COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA llbacks EQUAL []  PARERIGHT  EOM
dict_history  EQUAL  pd DOT DataFrame PARELEFT  PARERIGHT  EOM
dict_history DOT to_csv PARELEFT  PARERIGHT  EOM
elif args DOT action  EQUAL  EQUAL   : EOM
model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
test_y  EQUAL  model DOT predict PARELEFT X_test COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
test_y  EQUAL  test_y * std_y EOM
test_y  EQUAL  test_y + mean_y EOM
np DOT save PARELEFT  PARERIGHT  EOM
elif args DOT action  EQUAL  EQUAL  : EOM
 PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
min_val  EQUAL  min PARELEFT  PARERIGHT  EOM
max_val  EQUAL  max PARELEFT  PARERIGHT  EOM
bins  EQUAL  [] EOM
labels  EQUAL  range PARELEFT  PARERIGHT  EOM
train_label  EQUAL  pd DOT cut PARELEFT train_label COMMA  bins EQUAL  COMMA  labels EQUAL  PARERIGHT  EOM
test_label  EQUAL  pd DOT cut PARELEFT test_label COMMA  bins EQUAL  COMMA  labels EQUAL  PARERIGHT  EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
if train_label[] ! EQUAL  train_label[]: EOM
train_label[]  EQUAL  0 EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
if test_label[] ! EQUAL  test_label[]: EOM
test_label[]  EQUAL  0 EOM
Y_train  EQUAL  np_utils DOT to_categorical PARELEFT train_label COMMA num_classes EQUAL  PARERIGHT  EOM
Y_test  EQUAL  np_utils DOT to_categorical PARELEFT test_label COMMA num_classes EQUAL  PARERIGHT  EOM
if args DOT model_type  EQUAL  EQUAL  : EOM
model  EQUAL  RT_lstm PARELEFT  PARERIGHT  EOM
elif args DOT model_type  EQUAL  EQUAL  : EOM
model  EQUAL  RT_gru PARELEFT  PARERIGHT  EOM
elif args DOT model_type  EQUAL  EQUAL  : EOM
model  EQUAL  RF_lstm PARELEFT  PARERIGHT  EOM
elif args DOT model_type  EQUAL  EQUAL  : EOM
model  EQUAL  RF_gru PARELEFT  PARERIGHT  EOM
earlystopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience  EQUAL  COMMA  verbose EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
save_path  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath EQUAL  COMMA verbose EQUAL  COMMA save_best_only EQUAL  COMMA monitor EQUAL  COMMA ode EQUAL  PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA  Y COMMA validation_split EQUAL  COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA llbacks EQUAL []  PARERIGHT  EOM
dict_history  EQUAL  pd DOT DataFrame PARELEFT  PARERIGHT  EOM
dict_history DOT to_csv PARELEFT  PARERIGHT  EOM
test_y  EQUAL  model DOT predict PARELEFT X_test COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
predict  EQUAL  [] EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
p  EQUAL  np DOT argmax PARELEFT  PARERIGHT  EOM
predict DOT append PARELEFT  PARERIGHT  EOM
predict  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
conf_matrix  EQUAL  confusion_matrix PARELEFT test_label COMMA  predict COMMA  labels EQUAL  PARERIGHT  EOM
figdir  EQUAL  EOM
figpath  EQUAL  os DOT path DOT join PARELEFT figdir COMMA   DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
plot_conf_matrix PARELEFT  PARERIGHT  EOM
accuracy  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
precision COMMA  recall COMMA  f COMMA  _  EQUAL  precision_recall_fscore_support PARELEFT test_label COMMA redict COMMA  average EQUAL  PARERIGHT  EOM
acc DOT append PARELEFT  PARERIGHT  EOM
pre DOT append PARELEFT  PARERIGHT  EOM
rec DOT append PARELEFT  PARERIGHT  EOM
f_score DOT append PARELEFT  PARERIGHT  EOM
if mode  EQUAL  EQUAL  : EOM
with open PARELEFT  + args DOT model +  + str PARELEFT  PARERIGHT  +  COMMA   PARERIGHT  as f: EOM
f DOT write PARELEFT  PARERIGHT  EOM
for idx in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
f DOT write PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  Embedding EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D COMMA  LSTM EOM
def get_mnist_net PARELEFT  PARERIGHT : EOM
if model_name  EQUAL  EQUAL  : EOM
return get_mnist_stdnet PARELEFT  PARERIGHT  EOM
elif model_name  EQUAL  EQUAL  : EOM
return get_mnist_convnet PARELEFT  PARERIGHT  EOM
else: EOM
from keras DOT models import Sequential EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT layers import TimeDistributed COMMA  Dense COMMA  Dropout COMMA Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT optimizers import RMSprop COMMA  Adam EOM
import numpy as np EOM
def one_layer_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  {: inp COMMA  : hidden COMMA  : outp} EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  {: 48 COMMA  : 64 COMMA   : 128 COMMA  : 1} EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model  from keras DOT layers import LSTM COMMA  Dense COMMA  Input COMMA  InputLayer COMMA  Permute COMMA  BatchNormalization COMMA  \ EOM
from keras DOT models import Sequential COMMA  save_model EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT model_selection import GridSearchCV EOM
from src DOT const import * EOM
from src DOT utils import * EOM
INPUT_SHAPE  EQUAL   PARELEFT  PARERIGHT  EOM
LSTM_SIZE  EQUAL  50 EOM
def get_model PARELEFT  PARERIGHT : EOM
lstm_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_model DOT add PARELEFT InputLayer PARELEFT input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT LSTM PARELEFT LSTM_SIZE COMMA dropout EQUAL  COMMA recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_model DOT add PARELEFT Dense PARELEFT NUMBER_OF_PLAYERS COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm_model DOT summary PARELEFT  PARERIGHT  EOM
lstm_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return lstm_model EOM
if __name__  EQUAL  EQUAL  : EOM
csv_dict  EQUAL  read_csv_sequence PARELEFT  PARERIGHT  EOM
players_dict COMMA  val_players_dict  EQUAL  split_training_set PARELEFT  PARERIGHT  EOM
batch_input COMMA  batch_input_other_info COMMA  batch_output COMMA  player_id_to_name_dict \ EOM
 EQUAL  csv_sequence_set_to_keras_batch PARELEFT  PARERIGHT  EOM
val_batch_input COMMA  val_batch_input_other_info COMMA  val_batch_output COMMA  _ \ EOM
 EQUAL  csv_sequence_set_to_keras_batch PARELEFT  PARERIGHT  EOM
model  EQUAL  get_model PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT x EQUAL  COMMA y EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
save_model PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
import numpy as np EOM
import time EOM
import csv EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA Merge EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
import copy EOM
data_dim  EQUAL  1 EOM
timesteps  EQUAL  13 EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
in_dimension  EQUAL  3 EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
from keras DOT utils DOT visualize_util import plot COMMA  to_graph EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT LAB_VTX  EQUAL DATASET_TRK  EQUAL  [] EOM
LAB_TRK  EQUAL  EOM
ROOTFILE  EQUAL  EOM
def load_data PARELEFT  PARERIGHT : EOM
import uproot EOM
import pandas EOM
import numpy as np EOM
f  EQUAL  uproot DOT open PARELEFT  PARERIGHT  EOM
tree  EQUAL  f[] EOM
dataset  EQUAL  tree DOT pandas DOT df PARELEFT  PARERIGHT  EOM
features  EQUAL  dataset DOT loc[] DOT values EOM
labels  EQUAL  dataset DOT loc[] DOT values EOM
features  EQUAL  np DOT resize PARELEFT features COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  np DOT resize PARELEFT labels COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
return features COMMA  labels EOM
def vertex_model PARELEFT  PARERIGHT : EOM
import keras EOM
from keras import layers COMMA  models EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT activations import sigmoid COMMA  tanh EOM
from keras DOT optimizers import Adam COMMA  Nadam COMMA  sgd EOM
from keras DOT activations import softmax COMMA  sigmoid COMMA  relu COMMA  tanh COMMA  elu COMMA  selu EOM
from keras DOT losses import categorical_crossentropy COMMA  logcosh COMMA  binary_crossentropy EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def tracks_model PARELEFT  PARERIGHT : EOM
import keras EOM
from keras import layers COMMA  models EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT activations import sigmoid COMMA  tanh EOM
from keras DOT optimizers import Adam COMMA  Nadam COMMA  sgd EOM
from keras DOT activations import softmax COMMA  sigmoid COMMA  relu COMMA  tanh COMMA  elu COMMA  selu EOM
from keras DOT losses import categorical_crossentropy COMMA  logcosh COMMA  binary_crossentropy EOM
from keras DOT callbacks import TensorBoard EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def LSTM_model PARELEFT  PARERIGHT : EOM
import keras EOM
from keras import layers COMMA  models EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  LSTM EOM
from keras DOT activations import sigmoid EOM
from keras DOT optimizers import Adam EOM
from keras DOT losses import binary_crossentropy EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  1024 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  1024 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  ptimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def train_model PARELEFT  PARERIGHT : EOM
import keras EOM
from keras import layers COMMA  models EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT activations import sigmoid COMMA  tanh EOM
from keras DOT optimizers import Adam COMMA  Nadam COMMA  sgd EOM
from keras DOT activations import softmax COMMA  sigmoid COMMA  relu COMMA  tanh COMMA  elu COMMA  selu EOM
from keras DOT losses import categorical_crossentropy COMMA  logcosh COMMA  binary_crossentropy EOM
from keras DOT callbacks import TensorBoard EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT features COMMA  abels COMMA  est_size EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA pochs EQUAL  COMMA  lidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
return history COMMA  scores COMMA  X_test COMMA  y_test COMMA  model EOM
def conc_method PARELEFT  PARERIGHT : EOM
import uproot EOM
import pandas EOM
import numpy as np EOM
import keras EOM
from keras import layers COMMA  models EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Input COMMA  LSTM EOM
from keras DOT activations import sigmoid COMMA  tanh EOM
from keras DOT optimizers import Adam COMMA  Nadam COMMA  sgd EOM
from keras DOT activations import softmax COMMA  sigmoid COMMA  relu COMMA  tanh COMMA  elu COMMA  selu EOM
from keras DOT losses import categorical_crossentropy COMMA  logcosh COMMA  binary_crossentropy EOM
from keras DOT layers DOT merge import concatenate EOM
vertex_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
out_trk  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
tracks_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  EOM
x  EQUAL  concatenate PARELEFT [] COMMA axis EQUAL  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
main_out  EQUAL  Dense PARELEFT units EQUAL  COMMA kernel_initializer EQUAL  COMMA activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL [] PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT [] COMMA  [] COMMA  epochs EQUAL  PARERIGHT  EOM
pred_labels  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def prediction PARELEFT  PARERIGHT : EOM
result  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
probs  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
probs1D  EQUAL  probs DOT flatten PARELEFT  PARERIGHT  EOM
return result COMMA  probs COMMA  probs1D EOM
def execute PARELEFT  PARERIGHT : EOM
import InDetVtxClassPlot as plot EOM
import Utils as utl EOM
import os EOM
form  EQUAL  EOM
feat_vtx COMMA  lab_vtx  EQUAL  load_data PARELEFT  PARERIGHT  EOM
feat_trk COMMA  lab_trk  EQUAL  load_data PARELEFT  PARERIGHT  EOM
vtx_mod  EQUAL  vertex_model PARELEFT  PARERIGHT  EOM
trk_mod  EQUAL  tracks_model PARELEFT  PARERIGHT  EOM
lstm_vtx_mod  EQUAL  LSTM_model PARELEFT  PARERIGHT  EOM
lstm_trk_mod  EQUAL  LSTM_model PARELEFT  PARERIGHT  EOM
vrs  EQUAL  EOM
vhs  EQUAL  EOM
vps  EQUAL  EOM
vtx_roc_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
vtx_hst_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
vtx_prob_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
vtx_history COMMA  vtx_scores COMMA  x_vtx_test COMMA  y_vtx_test COMMA  out_vtx_mod  EQUAL  train_model PARELEFT  PARERIGHT  EOM
vtx_result COMMA  vtx_probs COMMA  vtx_probs1D  EQUAL  prediction PARELEFT  PARERIGHT  EOM
plot DOT plot_roc PARELEFT  PARERIGHT  EOM
plot DOT plot_history PARELEFT  PARERIGHT  EOM
plot DOT plot_probs PARELEFT  PARERIGHT  EOM
trs  EQUAL  EOM
ths  EQUAL  EOM
tps  EQUAL  EOM
trk_roc_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
trk_hst_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
trk_prob_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
trk_history COMMA  trk_scores COMMA  x_trk_test COMMA  y_trk_test COMMA  out_trk_mod  EQUAL  train_model PARELEFT  PARERIGHT  EOM
trk_result COMMA  trk_probs COMMA  trk_probs1D  EQUAL  prediction PARELEFT  PARERIGHT  EOM
plot DOT plot_roc PARELEFT  PARERIGHT  EOM
plot DOT plot_history PARELEFT  PARERIGHT  EOM
plot DOT plot_probs PARELEFT  PARERIGHT  EOM
vlhs  EQUAL  EOM
vlps  EQUAL  EOM
vtx_lstm_hst_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
vtx_lstm_prob_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
feat_vtx_3D COMMA  lab_vtx_3D  EQUAL  utl DOT twoD_to_3D PARELEFT  PARERIGHT  EOM
lstm_vtx_hist COMMA  lstm_vtx_scores COMMA  lstm_vtx_x_test COMMA  lstm_vtx_y_test COMMA  lstm_vtx_mod  EQUAL  train_model PARELEFT  PARERIGHT  EOM
lstm_vtx_result COMMA  lstm_vtx_probs COMMA  lstm_vtx_probs1D  EQUAL  prediction PARELEFT  PARERIGHT  EOM
lstm_x_test_2D  EQUAL  utl DOT threeD_to2D PARELEFT  PARERIGHT  EOM
lstm_y_test_2D  EQUAL  utl DOT threeD_to2D PARELEFT  PARERIGHT  EOM
plot DOT plot_history PARELEFT  PARERIGHT  EOM
plot DOT plot_probs PARELEFT  PARERIGHT  EOM
tlhs  EQUAL  EOM
tlps  EQUAL  EOM
trk_lstm_hst_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
trk_lstm_prob_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
feat_trk_3D COMMA  lab_trk_3D  EQUAL  utl DOT twoD_to_3D PARELEFT  PARERIGHT  EOM
lstm_trk_hist COMMA  lstm_trk_scores COMMA  lstm_trk_x_test COMMA  lstm_trk_y_test COMMA  lstm_trk_mod  EQUAL  train_model PARELEFT  PARERIGHT  EOM
lstm_trk_result COMMA  lstm_trk_probs COMMA  lstm_trk_probs1D  EQUAL  prediction PARELEFT  PARERIGHT  EOM
lstm_x_test_2D  EQUAL  utl DOT threeD_to2D PARELEFT  PARERIGHT  EOM
lstm_y_test_2D  EQUAL  utl DOT threeD_to2D PARELEFT  PARERIGHT  EOM
plot DOT plot_history PARELEFT  PARERIGHT  EOM
plot DOT plot_probs PARELEFT  PARERIGHT  EOM
con_roc_vtx_str  EQUAL  EOM
con_roc_trk_str  EQUAL  EOM
chs  EQUAL  EOM
con_prob_str  EQUAL  EOM
con_hst_str  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
out_con_mod COMMA  conc_history COMMA  conc_scores COMMA  pred COMMA  con_probs COMMA  con_probs1D  EQUAL  conc_method PARELEFT  PARERIGHT  EOM
out_con_mod COMMA  conc_history COMMA  conc_scores COMMA  pred  EQUAL  conc_method PARELEFT  PARERIGHT  EOM
plot DOT plot_conc_history PARELEFT  PARERIGHT  EOM
plot DOT plot_roc PARELEFT  PARERIGHT  EOM
plot DOT plot_roc PARELEFT  PARERIGHT  EOM
plot DOT plot_probs PARELEFT  PARERIGHT  EOM
return None EOM
def main PARELEFT  PARERIGHT : EOM
nSamples  EQUAL  EOM
test_size  EQUAL  6000 EOM
epochs  EQUAL  10 EOM
epochs_name  EQUAL  EOM
path  EQUAL  EOM
execute PARELEFT  PARERIGHT  EOM
return None EOM
main PARELEFT  PARERIGHT  EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def build_improved_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_basic_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
import os DOT path EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import load_model COMMA  Sequential EOM
def get_model PARELEFT  PARERIGHT : EOM
model_name  EQUAL  Config[] EOM
has_model  EQUAL  os DOT path DOT isfile PARELEFT  PARERIGHT  EOM
if has_model: EOM
return load_model PARELEFT  PARERIGHT  EOM
else: EOM
LSTM_size  EQUAL  Config[] EOM
LSTM_count  EQUAL  Config[] EOM
LSTM_STATEFUL  EQUAL  Config[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_size COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT maxlen COMMA  len PARELEFT  PARERIGHT  PARERIGHT  COMMA  batch_size EQUAL [] COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelimport numpy as np EOM
import pprint EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution2D COMMA  Dense COMMA  Flatten COMMA  Activation COMMA  MaxPooling2D COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT advanced_activations import ELU EOM
from keras DOT layers DOT embeddings import Embedding EOM
from kerasify import export_model EOM
np DOT set_printoptions PARELEFT precision EQUAL  COMMA  threshold EQUAL  PARERIGHT  EOM
def c_array PARELEFT  PARERIGHT : EOM
s  EQUAL  pprint DOT pformat PARELEFT a DOT flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
s  EQUAL  s DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  EOM
shape  EQUAL  EOM
if a DOT shape  EQUAL  EQUAL   PARELEFT  PARERIGHT : EOM
s  EQUAL   % s EOM
shape  EQUAL  EOM
else: EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Reshape COMMA  Merge COMMA  Dropout COMMA  Input EOM
from keras DOT layers import LSTM as keras_lstm EOM
from keras DOT layers DOT embeddings import Embedding EOM
from dictionary import Dictionary EOM
from constants import * EOM
from model_base import ModelBase EOM
class LSTM PARELEFT  PARERIGHT : EOM
lstm_hidden_units  EQUAL  None EOM
dropout  EQUAL  None EOM
recurrent_dropout  EQUAL  None EOM
number_stacked_lstms  EQUAL  None EOM
mlp_hidden_units  EQUAL  None EOM
adding_mlp  EQUAL  None EOM
def __init__ PARELEFT self COMMA  dictionary : Dictionary COMMA  question_maxlen EQUAL  COMMA  embedding_vector_length EQUAL  COMMA  visual_model EQUAL  COMMA  lstm_hidden_units  EQUAL  COMMA  dropout  EQUAL  COMMA  recurrent_dropout  EQUAL  COMMA  number_stacked_lstms  EQUAL  COMMA  adding_mlp  EQUAL  COMMA  number_mlp_units  EQUAL  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT lstm_hidden_units  EQUAL  lstm_hidden_units EOM
self DOT dropout  EQUAL  dropout EOM
self DOT recurrent_dropout  EQUAL  recurrent_dropout EOM
self DOT number_stacked_lstms  EQUAL  number_stacked_lstms EOM
self DOT model_name  EQUAL   + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  +  \ EOM
self DOT model_type  EQUAL  EOM
self DOT adding_mlp  EQUAL  adding_mlp EOM
self DOT mlp_hidden_units  EQUAL  number_mlp_units EOM
def build_visual_model PARELEFT  PARERIGHT : EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_dimension  EQUAL  self DOT dictionary DOT pp_data DOT calculateImageDimension PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
language_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
language_model DOT add PARELEFT Embedding PARELEFT self DOT top_words COMMA  self DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
language_model DOT add PARELEFT keras_lstm PARELEFT self DOT lstm_hidden_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT keras_lstm PARELEFT self DOT lstm_hidden_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
if self DOT adding_mlp: EOM
language_model DOT add PARELEFT Dense PARELEFT self DOT mlp_hidden_units COMMA  init EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def build_language_model PARELEFT  PARERIGHT : EOM
language_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
language_model DOT add PARELEFT Embedding PARELEFT self DOT top_words COMMA  self DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
language_model DOT add PARELEFT ras_lstm PARELEFT self DOT lstm_hidden_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT ras_lstm PARELEFT self DOT lstm_hidden_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
if self DOT adding_mlp: EOM
language_model DOT add PARELEFT Dense PARELEFT self DOT mlp_hidden_units COMMA  init EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return language_modelfrom sentifmdetect import featurizer EOM
from sentifmdetect import util EOM
import os EOM
import keras EOM
from keras DOT optimizers import Adam EOM
from keras import backend EOM
from keras DOT layers import Dense COMMA  Input COMMA  Flatten COMMA  Dropout COMMA  Merge COMMA  BatchNormalization EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding COMMA  LSTM COMMA  Bidirectional EOM
from keras DOT models import Model COMMA  Sequential EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT model_selection import train_test_split COMMA  RandomizedSearchCV EOM
from sklearn DOT metrics import precision_recall_fscore_support COMMA  classification_report COMMA  f1_score COMMA  precision_score COMMA \ EOM
recall_score COMMA  roc_auc_score EOM
import numpy as np EOM
def create_emb_lstm PARELEFT bidirectional EQUAL  COMMA lstm_units EQUAL  COMMA lstm_dropout EQUAL  COMMA lstm_recurrent_dropout EQUAL  COMMA ptimizer EQUAL  PARELEFT  PARERIGHT  COMMA metrics EQUAL [] PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
embeddings_index  EQUAL  featurizer DOT load_emb PARELEFT  PARERIGHT  EOM
EMBEDDINGS_MATRIX  EQUAL  featurizer DOT make_embedding_matrix PARELEFT  PARERIGHT  EOM
EMB_DIM  EQUAL  EMBEDDINGS_MATRIX DOT shape[] EOM
model DOT add PARELEFT edding PARELEFT settings DOT EMB_INPUT_DIM COMMA  EMB_DIM COMMA  weights EQUAL [] COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
elif isinstance PARELEFT  PARERIGHT : EOM
EMB_DIM  EQUAL  wvec EOM
model DOT add PARELEFT bedding PARELEFT settings DOT EMB_INPUT_DIM COMMA  EMB_DIM COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
logging DOT error PARELEFT  PARERIGHT  EOM
if bidirectional: EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT lstm_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT settings DOT OUTPUT_UNITS COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL [] PARELEFT  PARERIGHT  COMMA  metrics EQUAL  PARERIGHT  EOM
return model EOM
class KerasClassifierCustom PARELEFT  PARERIGHT : EOM
return self DOT model DOT predict PARELEFT  PARERIGHT  EOM
class GlobalMetrics PARELEFT  PARERIGHT : EOM
self DOT from_categorical  EQUAL  True EOM
if isinstance PARELEFT  PARERIGHT : EOM
self DOT global_metrics  EQUAL  metrics EOM
else: EOM
raise TypeError PARELEFT  PARERIGHT  EOM
self DOT global_scores  EQUAL  {} EOM
def on_epoch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
predict  EQUAL  np DOT asarray PARELEFT self DOT model DOT predict PARELEFT  PARERIGHT  PARERIGHT  EOM
targ  EQUAL  self DOT validation_data[] EOM
if self DOT from_categorical: EOM
predict  EQUAL  predict DOT argmax PARELEFT axis EQUAL  PARERIGHT  EOM
targ  EQUAL  targ DOT argmax PARELEFT axis EQUAL  PARERIGHT  EOM
for metric COMMA  kwargs in self DOT global_metrics: EOM
self DOT global_scores[]  EQUAL  metric PARELEFT  PARERIGHT  EOM
return EOM
class KerasRandomizedSearchCV PARELEFT  PARERIGHT : EOM
pred  EQUAL  super PARELEFT  PARERIGHT  DOT predict PARELEFT  PARERIGHT  EOM
backend DOT clear_session PARELEFT  PARERIGHT  EOM
return pred EOM
if __name__  EQUAL  EQUAL  : EOM
from sklearn DOT datasets import make_moons EOM
from sklearn DOT model_selection import RandomizedSearchCV EOM
from keras DOT regularizers import l2 EOM
dataset  EQUAL  make_moons PARELEFT  PARERIGHT  EOM
def build_fn PARELEFT nr_of_layers EQUAL  COMMA first_layer_size EQUAL  COMMA layers_slope_coeff EQUAL  COMMA dropout EQUAL  COMMA activation EQUAL  COMMA weight_l2 EQUAL  COMMA act_l2 EQUAL  COMMA input_dim EQUAL  PARERIGHT : EOM
result_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
result_model DOT add PARELEFT Dense PARELEFT first_layer_size COMMA input_dim EQUAL  COMMA activation EQUAL  COMMA W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
current_layer_size  EQUAL  int PARELEFT  PARERIGHT  + 1 EOM
for index_of_layer in range PARELEFT  PARERIGHT : EOM
result_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
result_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
result_model DOT add PARELEFT Dense PARELEFT current_layer_size COMMA W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
current_layer_size  EQUAL  int PARELEFT  PARERIGHT  + 1 EOM
result_model DOT add PARELEFT Dense PARELEFT 1 COMMA activation EQUAL  COMMA W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
result_model DOT compile PARELEFT optimizer EQUAL  COMMA  metrics EQUAL [] COMMA  loss EQUAL  PARERIGHT  EOM
return result_model EOM
NeuralNet  EQUAL  KerasClassifier PARELEFT  PARERIGHT from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  LSTM EOM
from keras DOT models import Sequential EOM
max_features  EQUAL  10000 EOM
maxlen  EQUAL  500 EOM
batch_size  EQUAL  32 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
input_train  EQUAL  sequence DOT pad_sequences PARELEFT input_train COMMA  maxlen EQUAL  PARERIGHT  EOM
input_test  EQUAL  sequence DOT pad_sequences PARELEFT input_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT input_train COMMA _train COMMA  epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  LSTM EOM
from keras DOT models import Sequential EOM
max_features  EQUAL  10000 EOM
maxlen  EQUAL  500 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
x_train  EQUAL  [] for x in x_train] EOM
x_test  EQUAL  [] for x in x_test] EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT x_train COMMA _train COMMA  epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  LSTM EOM
from keras DOT models import Sequential EOM
max_features  EQUAL  10000 EOM
maxlen  EQUAL  500 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT input_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT input_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Bidirectional PARELEFT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT x_train COMMA _train COMMA  epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Embedding EOM
from keras DOT layers import LSTM COMMA  SimpleRNN EOM
from keras DOT datasets import imdb EOM
from keras DOT utils DOT vis_utils import plot_model EOM
batch_size  EQUAL  100 EOM
nb_epoch  EQUAL  1 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
score COMMA  acc  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA batch_size EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
score COMMA  acc  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA batch_size EQUAL  PARERIGHT  EOM
import copy EOM
import time EOM
import re EOM
import os EOM
import pandas as pd EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
from sklearn DOT decomposition import PCA EOM
from sklearn DOT metrics import f1_score COMMA  accuracy_score EOM
from sklearn DOT model_selection import cross_val_score COMMA  KFold EOM
import keras EOM
import tensorflow as tf EOM
os DOT environ[] EQUAL  EOM
from keras DOT preprocessing import sequence EOM
from keras DOT preprocessing DOT text import Tokenizer COMMA  text_to_word_sequence EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras import regularizers EOM
from keras DOT optimizers import SGD COMMA  Adam EOM
from keras DOT initializers import he_normal EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Embedding COMMA  LSTM COMMA  Bidirectional COMMA  BatchNormalization COMMA  Activation EOM
from keras DOT callbacks import History COMMA  CSVLogger COMMA  EarlyStopping COMMA  LearningRateScheduler COMMA  TensorBoard COMMA  ModelCheckpoint EOM
from keras DOT utils import to_categorical EOM
config  EQUAL  tf DOT ConfigProto PARELEFT  device_count  EQUAL  COMMA  : 56}  PARERIGHT  EOM
sess  EQUAL  tf DOT Session PARELEFT config EQUAL  PARERIGHT  EOM
keras DOT backend DOT set_session PARELEFT  PARERIGHT  EOM
from tensorflow DOT python DOT client import device_lib EOM
from keras import backend as K EOM
kfold EQUAL KFold PARELEFT n_splits EQUAL  PARERIGHT  EOM
VOCAB_SIZE  EQUAL  50000 EOM
EMBEDDING_DIM  EQUAL  300 EOM
MAX_DOC_LEN  EQUAL  40 EOM
def plot_explained_variance PARELEFT  PARERIGHT : EOM
pca  EQUAL  PCA PARELEFT  PARERIGHT  EOM
pca_full  EQUAL  pca DOT fit PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT np DOT cumsum PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT xlabel PARELEFT  PARERIGHT  EOM
plt DOT ylabel PARELEFT  PARERIGHT  EOM
plt DOT grid PARELEFT color EQUAL  COMMA linestyle EQUAL  COMMA alpha EQUAL  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
def preprocess_pca PARELEFT X_train COMMA  X_test COMMA  dim COMMA  r EQUAL  PARERIGHT : EOM
pca  EQUAL  PCA PARELEFT n_components EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
X_train_pca  EQUAL  pca DOT fit_transform PARELEFT  PARERIGHT  EOM
X_test_pca  EQUAL  pca DOT transform PARELEFT  PARERIGHT  EOM
return X_train_pca COMMA  X_test_pca EOM
def skill_predictor PARELEFT train_seq COMMA  embedding_matrix COMMA n_labels COMMA  val_data COMMA  learning_rate COMMA  lstm_dim COMMA  batch_size COMMA  epochs COMMA  optimizer_param COMMA  regularization EQUAL  COMMA  n_classes EQUAL  COMMA  MAX_DOC_LEN EQUAL  COMMA  verbose EQUAL  PARERIGHT : EOM
l2_reg  EQUAL  regularizers DOT l2 PARELEFT  PARERIGHT  EOM
embedding_layer  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA input_length EQUAL  COMMA trainable EQUAL  COMMA mask_zero EQUAL  COMMA embeddings_regularizer EQUAL  COMMA weights EQUAL [] PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT activation EQUAL  COMMA  units EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT activation EQUAL  COMMA  units EQUAL  COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT activation EQUAL  COMMA  units EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  History PARELEFT  PARERIGHT  EOM
logfile  EQUAL   DOT format PARELEFT  PARERIGHT  EOM
csv_logger  EQUAL  CSVLogger PARELEFT logfile COMMA  separator EQUAL  COMMA  append EQUAL  PARERIGHT  EOM
scheduler  EQUAL  LearningRateScheduler PARELEFT lambda x: learning_rate*10** PARELEFT  PARERIGHT  COMMA  verbose EQUAL  PARERIGHT  EOM
t1  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT train_seq COMMA train_labels DOT astype PARELEFT  PARERIGHT  COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA validation_data EQUAL  COMMA shuffle EQUAL  COMMA callbacks EQUAL [] COMMA verbose EQUAL  PARERIGHT  EOM
t2  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT save PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
with open PARELEFT  DOT format PARELEFT  PARERIGHT  COMMA   PARERIGHT  as res_file: EOM
res_file DOT write PARELEFT str PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  historyimport numpy as np EOM
import pickle EOM
import sys EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM COMMA  SimpleRNN EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
from keras DOT models import load_model EOM
with open PARELEFT  PARERIGHT  as input: EOM
cached_data  EQUAL  pickle DOT load PARELEFT  PARERIGHT  EOM
char_to_int  EQUAL  cached_data[] EOM
int_to_char  EQUAL  cached_data[] EOM
X  EQUAL  cached_data[] EOM
y  EQUAL  cached_data[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
filepath EQUAL  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
model DOT fit PARELEFT X COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT from keras import backend as K EOM
from keras DOT layers import Dense COMMA  Lambda EOM
from keras DOT models import Sequential COMMA  Graph EOM
def get_item_subgraph PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Flatten COMMA  Dropout EOM
number_of_time_stamps  EQUAL  200 EOM
number_of_in_channels  EQUAL  55 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_item_lstm_subgraph PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Flatten COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT regularizers import l2 EOM
_num_of_hidden_units  EQUAL  100 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  input_length EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_user_subgraph PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT latent_dim COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def per_char_loss PARELEFT  PARERIGHT : EOM
alls  EQUAL  X DOT values PARELEFT  PARERIGHT  EOM
concatenated  EQUAL  K DOT concatenate PARELEFT  PARERIGHT  EOM
reshaped  EQUAL  K DOT mean PARELEFT K DOT reshape PARELEFT concatenated COMMA   PARELEFT K DOT shape PARELEFT  PARERIGHT [] COMMA  3 COMMA  30 PARERIGHT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  EOM
return K DOT softmax PARELEFT K DOT reshape PARELEFT reshaped COMMA   PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
def identity_loss PARELEFT  PARERIGHT : EOM
def get_graph PARELEFT  PARERIGHT : EOM
batch_input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
magic_num  EQUAL  90 EOM
model  EQUAL  Graph PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add_input PARELEFT  DOT format PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  batch_input_shape EQUAL  PARERIGHT  EOM
model DOT add_shared_node PARELEFT get_item_subgraph PARELEFT  PARELEFT  PARERIGHT  COMMA  latent_dim PARERIGHT  COMMA name EQUAL  COMMA ts EQUAL [] COMMA merge_mode EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT Lambda PARELEFT  PARERIGHT  COMMA name EQUAL  COMMA input EQUAL  PARERIGHT  EOM
model DOT add_output PARELEFT name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
return model EOM
def get_graph_lstm PARELEFT  PARERIGHT : EOM
batch_input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
magic_num  EQUAL  90 EOM
model  EQUAL  Graph PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add_input PARELEFT  DOT format PARELEFT  PARERIGHT  COMMA  batch_input_shape EQUAL  PARERIGHT  EOM
model DOT add_shared_node PARELEFT get_item_lstm_subgraph PARELEFT  PARERIGHT  COMMA name EQUAL  COMMA ts EQUAL [] COMMA merge_mode EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT Lambda PARELEFT  PARERIGHT  COMMA name EQUAL  COMMA input EQUAL  PARERIGHT  EOM
model DOT add_output PARELEFT name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
return modelfrom keras DOT layers import Dense COMMA  Activation EOM
from keras DOT layers import LSTM EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import RMSprop EOM
from text_model import * EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  batch_input_shape EQUAL  PARELEFT batch_size COMMA maxlen COMMA  len PARELEFT  PARERIGHT  PARERIGHT  COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
from keras import backend as K EOM
from keras import layers EOM
from keras import regularizers EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT models import load_model EOM
from keras DOT models import Sequential EOM
from keras DOT utils import plot_model EOM
def lstmModel PARELEFT n_channels COMMA n_timesteps COMMA n_outputs COMMA activation EQUAL  COMMA keep_rate EQUAL  COMMA go_backwards EQUAL  COMMA unroll EQUAL  PARERIGHT : EOM
name  EQUAL   + activation EOM
lstm  EQUAL  LSTM PARELEFT n_channels COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA go_backwards EQUAL  COMMA unroll EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_outputs COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
folder    EQUAL  EOM
name_h5   EQUAL  folder + name + EOM
name_png  EQUAL  folder + name + EOM
plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
model DOT save PARELEFT name_h5 COMMA  overwrite EQUAL  PARERIGHT  EOM
return model COMMA  name EOM
import os EOM
import time EOM
import numpy as np EOM
from functools import wraps EOM
from sklearn DOT externals import joblib EOM
from sklearn DOT preprocessing import LabelBinarizer EOM
from sklearn DOT model_selection import cross_val_score EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT models import load_model COMMA  Sequential EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  LSTM EOM
N_FEATURES  EQUAL  10000 EOM
DOC_LEN  EQUAL  60 EOM
N_CLASSES  EQUAL  2 EOM
def timeit PARELEFT  PARERIGHT : EOM
def wrapper PARELEFT  PARERIGHT : EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
result  EQUAL  func PARELEFT  PARERIGHT  EOM
return result COMMA  time DOT time PARELEFT  PARERIGHT  - start EOM
return wrapper EOM
def documents PARELEFT  PARERIGHT : EOM
return list PARELEFT corpus DOT reviews PARELEFT  PARERIGHT  PARERIGHT  EOM
def continuous PARELEFT  PARERIGHT : EOM
return list PARELEFT corpus DOT scores PARELEFT  PARERIGHT  PARERIGHT  EOM
def make_categorical PARELEFT  PARERIGHT : EOM
return np DOT digitize PARELEFT continuous PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def binarize PARELEFT  PARERIGHT : EOM
return np DOT digitize PARELEFT continuous PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def build_nn PARELEFT  PARERIGHT : EOM
nn DOT add PARELEFT Dense PARELEFT 500 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nn DOT add PARELEFT Dense PARELEFT 150 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
nn DOT add PARELEFT Dense PARELEFT N_CLASSES COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
nn DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return nn EOM
def build_lstm PARELEFT  PARERIGHT : EOM
lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm DOT add PARELEFT Embedding PARELEFT N_FEATURES+1 COMMA  128 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dense PARELEFT N_CLASSES COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT compile PARELEFT optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return lstm EOM
def train_model PARELEFT path COMMA  model COMMA  reader COMMA  saveto EQUAL  COMMA  cv EQUAL  COMMA  **kwargs PARERIGHT : EOM
corpus  EQUAL  PickledAmazonReviewsReader PARELEFT  PARERIGHT  EOM
X  EQUAL  documents PARELEFT  PARERIGHT  EOM
y  EQUAL  binarize PARELEFT  PARERIGHT  EOM
scores  EQUAL  cross_val_score PARELEFT model COMMA  X COMMA  y COMMA  cv EQUAL  COMMA  scoring EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
if saveto: EOM
model DOT steps[][] DOT model DOT save PARELEFT  PARERIGHT  EOM
model DOT steps DOT pop PARELEFT  PARERIGHT  EOM
joblib DOT dump PARELEFT  PARERIGHT  EOM
return scores EOM
if __name__  EQUAL  EQUAL  : EOM
from sklearn DOT pipeline import Pipeline EOM
from sklearn DOT feature_extraction DOT text import TfidfVectorizer EOM
from reader import PickledReviewsReader EOM
from am_reader import PickledAmazonReviewsReader EOM
from transformer import TextNormalizer COMMA  GensimDoc2Vectorizer EOM
from transformer import KeyphraseExtractor COMMA  GensimTfidfVectorizer EOM
cpath  EQUAL  EOM
mpath  EQUAL  {: COMMA :} EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
from collections import deque EOM
import sys EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  seq_length COMMA aved_model EQUAL  COMMA  features_length EQUAL  PARERIGHT : EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
if self DOT nb_classes > EQUAL  10: EOM
metrics DOT append PARELEFT  PARERIGHT  EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lrcn PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT mlp PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT conv_3d PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT c3d PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2048 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lrcn PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA tivation EQUAL  COMMA  padding EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def mlp PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def conv_3d PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def c3d PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT ZeroPadding3D PARELEFT padding EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4096 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4096 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelimport keras EOM
from keras DOT models import Sequential COMMA  save_model EOM
from keras DOT layers import LSTM EOM
import keras DOT backend as K EOM
base_path  EQUAL  EOM
backend  EQUAL  K DOT backend PARELEFT  PARERIGHT  EOM
version  EQUAL  keras DOT __version__ EOM
major_version  EQUAL  int PARELEFT  PARERIGHT  EOM
n_in  EQUAL  4 EOM
n_out  EQUAL  6 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_out COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT from keras DOT models import Sequential EOM
from keras import layers EOM
import numpy as np EOM
from six DOT moves import range EOM
import sys EOM
import os EOM
from keras DOT models import load_model EOM
import keras EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Bidirectional EOM
class SenseModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT lstmunits  EQUAL lstmunits EOM
self DOT lstmLayerNum  EQUAL  lstmLayerNum EOM
self DOT DenseUnits  EQUAL  DenseUnits EOM
self DOT charlenth  EQUAL  charlenth EOM
self DOT datalenth  EQUAL  datalenth EOM
self DOT buildmodel PARELEFT  PARERIGHT  EOM
def buildmodel PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT self DOT DenseUnits COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT layers DOT LSTM PARELEFT self DOT lstmunits COMMA  return_sequences EQUAL  COMMA activation EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
self DOT model DOT summary PARELEFT  PARERIGHT  EOM
def trainModel PARELEFT  PARERIGHT : EOM
for cur in range PARELEFT  PARERIGHT : EOM
self DOT model DOT fit PARELEFT x COMMA  y COMMA batch_size EQUAL  COMMA epochs EQUAL  PARERIGHT  EOM
mdname EQUAL savename++str PARELEFT  PARERIGHT  EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL : EOM
a  EQUAL  SenseModel PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Input EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
import numpy as np EOM
import keras DOT preprocessing DOT text as prep EOM
import keras DOT preprocessing DOT sequence as seq EOM
from keras import backend as K EOM
root EQUAL  EOM
corpusFile EQUAL root+ EOM
labelsFile EQUAL root+ EOM
text EQUAL file DOT readlines PARELEFT  PARERIGHT  EOM
toknizer DOT fit_on_texts PARELEFT texts EQUAL  PARERIGHT  EOM
data EQUAL toknizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
data EQUAL np DOT asanyarray PARELEFT  PARERIGHT  EOM
maxlen EQUAL [] EOM
maxlen EQUAL maxlen[] EOM
vocabSize  EQUAL  toknizer DOT word_index DOT __len__ PARELEFT  PARERIGHT +2 EOM
data EQUAL seq DOT pad_sequences PARELEFT sequences EQUAL  COMMA padding EQUAL  PARERIGHT  EOM
file DOT close PARELEFT  PARERIGHT  EOM
file EQUAL open PARELEFT  PARERIGHT  EOM
labels EQUAL [] for i in file DOT readlines PARELEFT  PARERIGHT ] EOM
X_train EQUAL data EOM
Y_train EQUAL labels EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_length EQUAL  COMMA activation EQUAL  COMMA  inner_activation EQUAL  COMMA return_sequences EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT labels[] DOT __len__ PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
get_lstm_layer_output  EQUAL  K DOT function PARELEFT [] DOT input] COMMA [] PARERIGHT  EOM
lstmout EQUAL get_lstm_layer_output PARELEFT  PARERIGHT [] EOM
file EQUAL open PARELEFT  PARERIGHT  EOM
for i in lstmout: EOM
tmp EQUAL str PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT strip PARELEFT  PARERIGHT  EOM
file DOT write PARELEFT  PARERIGHT  EOM
file DOT close PARELEFT  PARERIGHT  EOM
from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from absl DOT testing import parameterized EOM
import numpy as np EOM
from tensorflow DOT python import keras EOM
from tensorflow DOT python DOT eager import context EOM
from tensorflow DOT python DOT keras import keras_parameterized EOM
from tensorflow DOT python DOT keras import testing_utils EOM
from tensorflow DOT python DOT platform import test EOM
from tensorflow DOT python DOT training import adam EOM
from tensorflow DOT python DOT training import gradient_descent EOM
class LSTMLayerTest PARELEFT  PARERIGHT : EOM
def test_return_sequences_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA return_sequences EOM
def test_static_shape_inference_LSTM PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
inputs  EQUAL  keras DOT layers DOT Dense PARELEFT embedding_dim COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
outputs  EQUAL  model DOT layers[] DOT output EOM
self DOT assertEqual PARELEFT outputs DOT shape DOT as_list PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def test_dynamic_behavior_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT mspropmse EOM
x  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_dropout_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA dropout: 0 DOT 1} COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_implementation_mode_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA implementation EOM
def test_constraints_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
k_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
r_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
b_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  COMMA recurrent_constraint EQUAL  COMMA bias_constraint EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
def test_with_masking_layer_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layer_class PARELEFT units EQUAL  COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_masking_with_stacking_LSTM PARELEFT  PARERIGHT : EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_cells  EQUAL  [] EOM
model DOT add PARELEFT keras DOT layers DOT RNN PARELEFT lstm_cells COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_from_config_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
for stateful in  PARELEFT  PARERIGHT : EOM
l1  EQUAL  layer_class PARELEFT units EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
l2  EQUAL  layer_class DOT from_config PARELEFT l1 DOT get_config PARELEFT  PARERIGHT  PARERIGHT  EOM
assert l1 DOT get_config PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL       output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL [] PARERIGHT  EOM
else: EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_non_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [keras DOT backend DOT random_normal_variable PARELEFT  PARERIGHT  COMMA  0 COMMA  1 PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_reset_states_with_values PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  stateful EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
assert len PARELEFT  PARERIGHT   EQUAL     assert layer DOT states[] is not None EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT zeros PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
state_shapes  EQUAL  [] EOM
values  EQUAL  [] EOM
if len PARELEFT  PARERIGHT   EQUAL       values  EQUAL  values[] EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT ones PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
with self DOT assertRaises PARELEFT  PARERIGHT : EOM
layer DOT reset_states PARELEFT [] *  PARELEFT len PARELEFT  PARERIGHT  + 1 PARERIGHT  PARERIGHT  EOM
def test_specify_state_with_masking PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
_  EQUAL  keras DOT layers DOT Masking PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_return_state PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
state  EQUAL  outputs[] EOM
assert len PARELEFT  PARERIGHT   EQUAL     model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
state  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA  state COMMA  atol EQUAL  PARERIGHT  EOM
def test_state_reuse PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
output COMMA  state  EQUAL  outputs[] COMMA  outputs[] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT output COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
outputs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def test_initial_states_as_other_inputs PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
num_states  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
main_inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
inputs  EQUAL  [] + initial_state EOM
layer  EQUAL  layer_class PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
main_inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_regularizers_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  COMMA activity_regularizer EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  3 PARERIGHT  EOM
x  EQUAL  keras DOT backend DOT variable PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer PARELEFT  PARERIGHT  EOM
if context DOT executing_eagerly PARELEFT  PARERIGHT : EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  4 PARERIGHT  EOM
else: EOM
self DOT assertEqual PARELEFT len PARELEFT layer DOT get_losses_for PARELEFT  PARERIGHT  PARERIGHT  COMMA  1 PARERIGHT  EOM
def test_statefulness_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT 4 COMMA embedding_dim COMMA mask_zero EQUAL  COMMA input_length EQUAL  COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT ts COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  weights EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  PARELEFT  PARERIGHT  COMMA oss EQUAL  COMMA  run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
out1  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT out1 DOT shape COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
out2  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out1 DOT max PARELEFT  PARERIGHT  COMMA  out2 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
out3  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out2 DOT max PARELEFT  PARERIGHT  COMMA  out3 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
out4  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out3 COMMA  out4 COMMA  atol EQUAL  PARERIGHT  EOM
out5  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out4 DOT max PARELEFT  PARERIGHT  COMMA  out5 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
left_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
left_padded_input[]  EQUAL  0 EOM
left_padded_input[]  EQUAL  0 EOM
out6  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
right_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
right_padded_input[]  EQUAL  0 EOM
right_padded_input[]  EQUAL  0 EOM
out7  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out7 COMMA  out6 COMMA  atol EQUAL  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
test DOT main PARELEFT  PARERIGHT model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
import numpy as np EOM
data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT data COMMA  labels COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
import numpy as np EOM
data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
one_hot_labels  EQUAL  keras DOT utils DOT to_categorical PARELEFT labels COMMA  num_classes EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT data COMMA  one_hot_labels COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT optimizers import SGD EOM
import numpy as np EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Conv1D COMMA  GlobalAveragePooling1D COMMA  MaxPooling1D EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
from keras DOT layers import Dense COMMA  LSTM COMMA  Activation COMMA  BatchNormalization COMMA  Dropout COMMA  initializers COMMA  Input EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import SGD COMMA  RMSprop EOM
from keras DOT models import load_model EOM
from keras DOT initializers import Constant EOM
import keras DOT backend as K EOM
from keras DOT utils DOT generic_utils import get_custom_objects EOM
from keras DOT backend DOT tensorflow_backend import _to_tensor EOM
def relu_limited PARELEFT x COMMA  alpha EQUAL  COMMA  max_value EQUAL  PARERIGHT : EOM
return K DOT relu PARELEFT x COMMA  alpha EQUAL  COMMA  max_value EQUAL  PARERIGHT  EOM
get_custom_objects PARELEFT  PARERIGHT  DOT update PARELEFT {: Activation PARELEFT  PARERIGHT } PARERIGHT  EOM
def risk_estimation PARELEFT  PARERIGHT : EOM
return -100 DOT  * K DOT mean PARELEFT  PARELEFT  PARERIGHT  * y_pred PARERIGHT  EOM
class WindPuller PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT rate EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT LSTM PARELEFT n_hidden * 4 COMMA  return_sequences EQUAL  COMMA  activation EQUAL  COMMA ecurrent_activation EQUAL  COMMA  kernel_initializer EQUAL  COMMA ecurrent_initializer EQUAL  COMMA  bias_initializer EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT n_hidden COMMA  return_sequences EQUAL  COMMA  activation EQUAL  COMMA ecurrent_activation EQUAL  COMMA  kernel_initializer EQUAL  COMMA ecurrent_initializer EQUAL  COMMA  bias_initializer EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
def fit PARELEFT self COMMA  x COMMA  y COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  verbose EQUAL  COMMA  callbacks EQUAL  COMMA lidation_split EQUAL  COMMA  validation_data EQUAL  COMMA  shuffle EQUAL  COMMA ss_weight EQUAL  COMMA  sample_weight EQUAL  COMMA  initial_epoch EQUAL  COMMA  **kwargs PARERIGHT : EOM
self DOT model DOT fit PARELEFT  PARERIGHT  EOM
def save PARELEFT  PARERIGHT : EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
def load_model PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
return self EOM
def evaluate PARELEFT self COMMA  x COMMA  y COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA ample_weight EQUAL  COMMA  **kwargs PARERIGHT : EOM
return self DOT model DOT evaluate PARELEFT  PARERIGHT  EOM
def predict PARELEFT self COMMA  x COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT : EOM
return self DOT model DOT predict PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
from keras DOT optimizers import SGD EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
import numpy as np EOM
import openWav EOM
def train PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  10 EOM
data_dim  EQUAL  len PARELEFT  PARERIGHT  EOM
batchsize  EQUAL  10 EOM
num_hidden_dimensions  EQUAL  data_dim/2 EOM
num_frequency_dimensions  EQUAL  data_dim EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_hidden_dimensions COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
exit EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  verbose EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
return model EOM
def predict PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
x_train COMMA  y_train COMMA  x_test COMMA  y_test COMMA  sr  EQUAL  openWav DOT lstmData PARELEFT  PARERIGHT  EOM
model  EQUAL  train PARELEFT  PARERIGHT     from keras DOT layers DOT convolutional import Conv2DTranspose  COMMA  Conv1D COMMA  Conv2D COMMA Convolution3D COMMA  MaxPooling2D COMMA UpSampling1D COMMA UpSampling2D COMMA UpSampling3D EOM
from keras DOT layers import Input COMMA LSTM COMMA Bidirectional COMMA TimeDistributed COMMA Embedding COMMA  Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA    Reshape COMMA  Flatten COMMA  Lambda EOM
from keras DOT layers DOT noise import GaussianDropout COMMA  GaussianNoise EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras import initializers EOM
from keras import regularizers EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
import numpy as np EOM
import pandas as pd EOM
import os EOM
def create_LSTM PARELEFT input_dim COMMA output_dim COMMA embedding_matrix EQUAL [] PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if embedding_matrix ! EQUAL  []: EOM
embedding_layer  EQUAL  Embedding PARELEFT embedding_matrix DOT shape[] COMMA embedding_matrix DOT shape[] COMMA weights EQUAL [] COMMA input_length EQUAL  COMMA trainable EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 150 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT 150 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 150 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
model_id  EQUAL  EOM
model  EQUAL  create_LSTM PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA embedding_matrix EQUAL [] PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class BotPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport keras DOT backend as K EOM
import tensorflow as tf EOM
from keras import optimizers EOM
from keras import losses EOM
from keras import metrics EOM
from keras import models EOM
from keras import layers EOM
from keras import callbacks EOM
from keras import regularizers EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT models import Model EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import GRU EOM
from keras DOT layers import Masking EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Activation EOM
from keras DOT layers import Lambda EOM
from keras DOT layers import Bidirectional EOM
from keras DOT layers import BatchNormalization EOM
from keras DOT layers import Input EOM
from keras DOT constraints import max_norm EOM
def model_3_LSTM_advanced1 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  out EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  out EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced3 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 6 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  out EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced4 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 6 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  out EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced5 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA   PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced6 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA   PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced7 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA   PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model import tensorflow as tf EOM
from tensorflow import keras EOM
import numpy as np EOM
from keras import Sequential EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import LSTM COMMA Bidirectional COMMA Embedding COMMA Dropout EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers import GlobalMaxPooling1D COMMA Concatenate EOM
import numpy as np EOM
import keras EOM
import tensorflow as tf EOM
from keras DOT layers import LSTM COMMA Bidirectional COMMA Embedding COMMA Dropout COMMA Dense EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT constraints import maxnorm EOM
from keras DOT engine import Input EOM
from keras DOT engine import Model EOM
from keras DOT layers import Dropout COMMA  Dense COMMA  Bidirectional COMMA  LSTM COMMA  \ EOM
Embedding COMMA  GaussianNoise COMMA  Activation COMMA  Flatten COMMA  \ EOM
RepeatVector COMMA  MaxoutDense COMMA  GlobalMaxPooling1D COMMA  \ EOM
Convolution1D COMMA  MaxPooling1D COMMA  concatenate COMMA  Conv1D COMMA GaussianNoise EOM
from keras DOT regularizers import l2 EOM
from keras import initializers EOM
from keras import backend as K COMMA  regularizers COMMA  constraints COMMA  initializers EOM
from keras DOT engine DOT topology import Layer EOM
class Attention PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT attention_size  EQUAL  attention_size EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
def build PARELEFT  PARERIGHT : EOM
self DOT W  EQUAL  self DOT add_weight PARELEFT name EQUAL  PARELEFT  PARERIGHT  COMMA hape EQUAL  PARELEFT  PARERIGHT  COMMA initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  EOM
self DOT b  EQUAL  self DOT add_weight PARELEFT name EQUAL  PARELEFT  PARERIGHT  COMMA hape EQUAL  PARELEFT  PARERIGHT  COMMA initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  EOM
self DOT u  EQUAL  self DOT add_weight PARELEFT name EQUAL  PARELEFT  PARERIGHT  COMMA hape EQUAL  PARELEFT  PARERIGHT  COMMA initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  EOM
super PARELEFT  PARERIGHT  DOT build PARELEFT  PARERIGHT  EOM
def call PARELEFT self COMMA  x COMMA  mask EQUAL  PARERIGHT : EOM
et  EQUAL  K DOT tanh PARELEFT K DOT dot PARELEFT  PARERIGHT  + self DOT b PARERIGHT  EOM
at  EQUAL  K DOT softmax PARELEFT K DOT squeeze PARELEFT K DOT dot PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  PARERIGHT  EOM
if mask is not None: EOM
at * EQUAL  K DOT cast PARELEFT mask COMMA  K DOT floatx PARELEFT  PARERIGHT  PARERIGHT  EOM
atx  EQUAL  K DOT expand_dims PARELEFT at COMMA  axis EQUAL  PARERIGHT  EOM
ot  EQUAL  atx * x EOM
output  EQUAL  K DOT sum PARELEFT ot COMMA  axis EQUAL  PARERIGHT  EOM
return output EOM
def compute_mask PARELEFT self COMMA  input COMMA  input_mask EQUAL  PARERIGHT : EOM
return None EOM
def compute_output_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT  PARERIGHT  EOM
def simple_nn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 16 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  PARELEFT  PARERIGHT  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def simple_nn_l2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 16 COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Activation EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Bidirectional EOM
import keras EOM
def window_transform_series PARELEFT  PARERIGHT : EOM
X  EQUAL  [] EOM
y  EQUAL  [] EOM
X  EQUAL  [] for i in range PARELEFT  PARERIGHT ] EOM
y  EQUAL  [] for i in range PARELEFT  PARERIGHT ] EOM
X  EQUAL  np DOT asarray PARELEFT  PARERIGHT  EOM
X DOT shape  EQUAL   PARELEFT np DOT shape PARELEFT  PARERIGHT [] PARERIGHT  EOM
y  EQUAL  np DOT asarray PARELEFT  PARERIGHT  EOM
y DOT shape  EQUAL   PARELEFT len PARELEFT  PARERIGHT  COMMA 1 PARERIGHT  EOM
return X COMMA y EOM
def build_part1_RNN PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 5 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def cleaned_text PARELEFT  PARERIGHT : EOM
import re EOM
text  EQUAL  text DOT replace PARELEFT  PARERIGHT  EOM
text  EQUAL  re DOT sub PARELEFT  PARERIGHT  EOM
return text EOM
def window_transform_text PARELEFT  PARERIGHT : EOM
inputs EQUAL  [] for i in range PARELEFT 0 COMMA len PARELEFT  PARERIGHT -window_size COMMA  step_size PARERIGHT ] EOM
outputs EQUAL  [] for i in range PARELEFT 0 COMMA len PARELEFT  PARERIGHT -window_size COMMA  step_size PARERIGHT ] EOM
return inputs COMMA outputs EOM
def build_part2_RNN PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_chars COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_part2_RNN_Bi PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 200 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Input COMMA  Dense COMMA  Conv1D COMMA  MaxPooling1D COMMA  GlobalAveragePooling1D COMMA  Dropout COMMA  Reshape COMMA  BatchNormalization EOM
from keras DOT models import Model EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
def build_model_LSTM PARELEFT  PARERIGHT : EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
seq_input_drop  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
if lstm_attention: EOM
lstm_output  EQUAL  LSTM PARELEFT lstm_output_dim COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_output COMMA  _  EQUAL  AttentionWeightedAverage PARELEFT name EQUAL  COMMA  attention_type EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
else: EOM
lstm_output  EQUAL  LSTM PARELEFT lstm_output_dim COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
second_last  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
second_last_drop  EQUAL  Dense PARELEFT second_last_dim COMMA  name EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
outputs  EQUAL  Dense PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
return Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 100 COMMA  kernel_size COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 100 COMMA  kernel_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 160 COMMA  kernel_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 160 COMMA  kernel_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom abc import ABCMeta COMMA  abstractmethod EOM
import numpy as np EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from scipy import stats EOM
from sklearn DOT cross_validation import StratifiedShuffleSplit EOM
from keras DOT callbacks import ModelCheckpoint EOM
from OriKerasExtension DOT P300Prediction import create_target_table COMMA  accuracy_by_repetition EOM
from OriKerasExtension DOT ThesisHelper import readCompleteMatFile COMMA  ExtractDataVer4 EOM
def create_train_data PARELEFT gcd_res COMMA  fist_time_stamp EQUAL  COMMA  last_time_stamp EQUAL  COMMA  down_samples_param EQUAL  COMMA take_same_number_positive_and_negative EQUAL  PARERIGHT : EOM
all_positive_train  EQUAL  [] EOM
all_negative_train  EQUAL  [] EOM
data_for_eval  EQUAL  ExtractDataVer4 PARELEFT  PARERIGHT  EOM
temp_data_for_eval  EQUAL  downsample_data PARELEFT  PARERIGHT  EOM
all_tags  EQUAL  gcd_res[][]  EQUAL  EQUAL  1] EOM
all_data  EQUAL  temp_data_for_eval[]  EQUAL  EQUAL  1] EOM
categorical_tags  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
return all_data COMMA  all_tags EOM
class GeneralModel PARELEFT  PARERIGHT : EOM
__metaclass__  EQUAL  ABCMeta EOM
def predict PARELEFT  PARERIGHT : EOM
pass EOM
def fit PARELEFT  PARERIGHT : EOM
pass EOM
def reset PARELEFT  PARERIGHT : EOM
pass EOM
def get_name PARELEFT  PARERIGHT : EOM
pass EOM
def get_params PARELEFT  PARERIGHT : EOM
pass EOM
class LSTM_EEG PARELEFT  PARERIGHT : EOM
def get_params PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT get_params PARELEFT  PARERIGHT  EOM
return self DOT model DOT get_weights PARELEFT  PARERIGHT  EOM
def get_name PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT get_name PARELEFT  PARERIGHT  EOM
return self DOT __class__ DOT __name__ +  + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  EOM
def reset PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT reset PARELEFT  PARERIGHT  EOM
self DOT model DOT set_weights PARELEFT  PARERIGHT  EOM
def __init__ PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT positive_weight  EQUAL  positive_weight EOM
self DOT _num_of_hidden_units  EQUAL  _num_of_hidden_units EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT regularizers import l2 EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  output_dim EQUAL  COMMA  input_length EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
self DOT original_weights  EQUAL  self DOT model DOT get_weights PARELEFT  PARERIGHT  EOM
def fit PARELEFT  PARERIGHT : EOM
_y  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
checkpointer  EQUAL  ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  PARERIGHT  EOM
sss  EQUAL  list PARELEFT StratifiedShuffleSplit PARELEFT _y[] COMMA  n_iter EQUAL  COMMA  test_size EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT fit PARELEFT stats DOT zscore PARELEFT _X[][]] COMMA  axis EQUAL  PARERIGHT  COMMA  _y[][]] COMMA epoch EQUAL  COMMA  show_accuracy EQUAL  COMMA  verbose EQUAL  COMMA  validation_data EQUAL  PARELEFT ats DOT zscore PARELEFT _X[][]] COMMA  axis EQUAL  PARERIGHT  COMMA  _y[][]] PARERIGHT  COMMA ss_weight EQUAL  COMMA  1: self DOT positive_weight} COMMA callbacks EQUAL [] PARERIGHT  EOM
def predict PARELEFT  PARERIGHT : EOM
return self DOT model DOT predict PARELEFT stats DOT zscore PARELEFT _X COMMA  axis EQUAL  PARERIGHT  PARERIGHT  EOM
class LSTM_CNN_EEG PARELEFT  PARERIGHT : EOM
def get_params PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT get_params PARELEFT  PARERIGHT  EOM
return self DOT model DOT get_weights PARELEFT  PARERIGHT  EOM
def get_name PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT get_name PARELEFT  PARERIGHT  EOM
return self DOT __class__ DOT __name__ +  + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  EOM
def reset PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT reset PARELEFT  PARERIGHT  EOM
self DOT model DOT set_weights PARELEFT  PARERIGHT  EOM
def __init__ PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT positive_weight  EQUAL  positive_weight EOM
self DOT _num_of_hidden_units  EQUAL  _num_of_hidden_units EOM
from keras DOT layers DOT recurrent import GRU EOM
from keras DOT layers DOT convolutional import Convolution2D EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  TimeDistributedDense COMMA  Reshape EOM
from keras DOT layers DOT convolutional import MaxPooling2D EOM
from keras DOT layers DOT core import Permute EOM
maxToAdd  EQUAL  200 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributedDense PARELEFT 10 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
import os EOM
os DOT environ[]  EQUAL  EOM
import keras EOM
from keras DOT models import Sequential COMMA Model EOM
from keras DOT layers import Embedding COMMA  Dense COMMA  merge COMMA  SimpleRNN COMMA  Activation COMMA  LSTM COMMA  GRU COMMA  Dropout COMMA  Input COMMA  TimeDistributed COMMA  \ EOM
Concatenate COMMA  Add COMMA  Conv3D EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT convolutional import Conv2D EOM
from keras DOT layers DOT convolutional import MaxPooling2D COMMA MaxPooling3D EOM
from keras DOT layers DOT core import Flatten EOM
from keras import optimizers EOM
from EmbeddingMatrix import EmbeddingMatrix EOM
from keras DOT utils DOT np_utils import to_categorical EOM
import config EOM
GRID_COUNT  EQUAL  config DOT GRID_COUNT EOM
TEXT_K  EQUAL  config DOT text_k EOM
def geo_lprnn_text_model PARELEFT user_dim COMMA  len COMMA  place_dim  EQUAL  COMMA  time_dim EQUAL  COMMA  pl_d EQUAL  COMMA me_k EQUAL  COMMA  hidden_neurons EQUAL  COMMA  learning_rate EQUAL  PARERIGHT : EOM
pl_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name  EQUAL  PARERIGHT  EOM
time_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name  EQUAL  PARERIGHT  EOM
user_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
text_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
pl_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name  EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
time_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
user_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
attrs_latent  EQUAL  keras DOT layers DOT concatenate PARELEFT  PARERIGHT  EOM
lstm_out  EQUAL  LSTM PARELEFT hidden_neurons COMMA  return_sequences EQUAL  COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
dense  EQUAL  Dense PARELEFT place_dim + 1 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
out_vec  EQUAL  keras DOT layers DOT add PARELEFT  PARERIGHT  EOM
pred  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
sgd  EQUAL  optimizers DOT SGD PARELEFT lr EQUAL  PARERIGHT  EOM
rmsprop  EQUAL  optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def geo_lprnn_trainable_text_model PARELEFT user_dim COMMA  len COMMA word_vec COMMA  place_dim  EQUAL  COMMA  time_dim EQUAL  COMMA _d EQUAL  COMMA  time_k EQUAL  COMMA  hidden_neurons EQUAL  COMMA learning_rate EQUAL  PARERIGHT : EOM
pl_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name  EQUAL  PARERIGHT  EOM
time_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name  EQUAL  PARERIGHT  EOM
user_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
text_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
pl_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name  EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
time_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
user_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
text_embedding  EQUAL  EmbeddingMatrix PARELEFT TEXT_K COMMA  weights EQUAL [] COMMA  name EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
attrs_latent  EQUAL  keras DOT layers DOT concatenate PARELEFT  PARERIGHT  EOM
lstm_out  EQUAL  LSTM PARELEFT hidden_neurons COMMA  return_sequences EQUAL  COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
dense  EQUAL  Dense PARELEFT place_dim + 1 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
out_vec  EQUAL  keras DOT layers DOT add PARELEFT  PARERIGHT  EOM
pred  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
sgd  EQUAL  optimizers DOT SGD PARELEFT lr EQUAL  PARERIGHT  EOM
rmsprop  EQUAL  optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def createSTCRNNModel PARELEFT user_dim COMMA  len COMMA word_vec COMMA  place_dim  EQUAL  COMMA  time_dim EQUAL  COMMA _d EQUAL  COMMA  time_k EQUAL  COMMA  hidden_neurons EQUAL  COMMA learning_rate EQUAL  PARERIGHT : EOM
pl_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name  EQUAL  PARERIGHT  EOM
time_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name  EQUAL  PARERIGHT  EOM
user_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
text_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
pltm_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
pl_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name  EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
time_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
user_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
text_embedding  EQUAL  EmbeddingMatrix PARELEFT TEXT_K COMMA  weights EQUAL [] COMMA  name EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv1  EQUAL  Conv3D PARELEFT 20 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
bn1 EQUAL  BatchNormalization PARELEFT axis EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv2  EQUAL  Conv3D PARELEFT 20 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
bn2  EQUAL  BatchNormalization PARELEFT axis EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
mp  EQUAL  MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
dr  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lc  EQUAL  keras DOT layers DOT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attrs_latent  EQUAL  keras DOT layers DOT concatenate PARELEFT  PARERIGHT  EOM
lstm_out  EQUAL  LSTM PARELEFT hidden_neurons COMMA  return_sequences EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
dense  EQUAL  Dense PARELEFT place_dim + 1 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
out_vec  EQUAL  keras DOT layers DOT add PARELEFT  PARERIGHT  EOM
pred  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
sgd  EQUAL  optimizers DOT SGD PARELEFT lr EQUAL  PARERIGHT  EOM
rmsprop  EQUAL  optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return modelfrom preprocessing import load_data EOM
import random EOM
import matplotlib DOT pyplot as plt EOM
from keras import Model EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT layers import LeakyReLU COMMA  TimeDistributed EOM
from keras DOT layers DOT core import Dense COMMA  Flatten COMMA  Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Convolution3D COMMA  MaxPooling3D COMMA  Convolution2D COMMA  MaxPooling2D EOM
from keras DOT callbacks import * EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras import optimizers EOM
from keras DOT utils import multi_gpu_model EOM
import os EOM
import pickle EOM
import time EOM
class ModelMGPU PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
pmodel  EQUAL  multi_gpu_model PARELEFT  PARERIGHT  EOM
self DOT __dict__ DOT update PARELEFT  PARERIGHT  EOM
self DOT _smodel  EQUAL  ser_model EOM
def __getattribute__ PARELEFT  PARERIGHT : EOM
return getattr PARELEFT  PARERIGHT  EOM
return super PARELEFT  PARERIGHT  DOT __getattribute__ PARELEFT  PARERIGHT  EOM
def RNN PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model EOM
tStart  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
X COMMA  y  EQUAL  load_data PARELEFT  PARERIGHT  EOM
model  EQUAL  RNN PARELEFT  PARERIGHT  EOM
parallel_model  EQUAL  ModelMGPU PARELEFT  PARERIGHT  EOM
parallel_model DOT compile PARELEFT optimizer  EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
dirpath  EQUAL  EOM
if not os DOT path DOT exists PARELEFT  PARERIGHT : EOM
os DOT mkdir PARELEFT  PARERIGHT  EOM
filepath EQUAL  dirpath + EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  ave_best_only EQUAL  COMMA  period EQUAL  PARERIGHT  EOM
history  EQUAL  earlystopper  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
parallel_model DOT fit PARELEFT X COMMA y COMMA  validation_split EQUAL  COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA  shuffle EQUAL  COMMA  callbacks  EQUAL [] PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
pickle DOT dump PARELEFT  PARERIGHT  EOM
tEnd  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import GlobalAveragePooling1D EOM
from keras DOT layers DOT convolutional import Convolution1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import LSTM EOM
from features import dumpFeatures EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  200 COMMA  input_length EQUAL [] COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 250 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_1  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_1  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_1 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  200 COMMA  input_length EQUAL [] COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 250 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_2  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_2  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_2 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  200 COMMA  input_length EQUAL [] COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 250 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_3  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_3  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_3 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  200 COMMA  input_length EQUAL [] COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_4  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_4  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_4 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  200 COMMA  input_length EQUAL [] COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_5  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_5  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_5 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
[]  EQUAL  cPickle DOT load PARELEFT open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  50 COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_6  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_6  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_6 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  50 COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 250 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_7  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_7  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_7 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  20 COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 250 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_8  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_8  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_8 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  50 COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_9  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_9  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_9 COMMA  open PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features+1 COMMA  50 COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_10  EQUAL  model DOT predict_proba PARELEFT X_train COMMA  batch_size EQUAL  PARERIGHT  EOM
test_10  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
cPickle DOT dump PARELEFT test_10 COMMA  open PARELEFT  PARERIGHT  PARERIGHT import os EOM
global_model_version  EQUAL  55 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT SGD PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT convolutional import Conv2D COMMA  Conv3D EOM
from keras DOT layers DOT convolutional_recurrent import ConvLSTM2D EOM
from keras DOT regularizers import l2 EOM
def Feed_Forward_NN PARELEFT  PARERIGHT : EOM
name  EQUAL   DOT format PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model COMMA  name EOM
def Regularized_Feed_Forward_NN PARELEFT  PARERIGHT : EOM
name  EQUAL   DOT format PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model COMMA  name EOM
def LSTM_vector PARELEFT  PARERIGHT : EOM
name  EQUAL   DOT format PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_neurons COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_neurons COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT in_out_neurons COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model COMMA  name EOM
def ConvLSTM2D_matrix PARELEFT  PARERIGHT : EOM
name  EQUAL   DOT format PARELEFT  PARERIGHT  EOM
input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
kernel_size  EQUAL   PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA input_shape EQUAL  COMMA  padding EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA padding EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA padding EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA padding EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  data_format EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model COMMA  namefrom keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
if tf DOT __version__  EQUAL  EQUAL  : EOM
from tensorflow DOT contrib DOT keras DOT api DOT keras DOT layers import Dense COMMA  Flatten COMMA  Dropout COMMA  ZeroPadding3D EOM
from tensorflow DOT contrib DOT keras DOT python DOT keras DOT layers DOT recurrent import LSTM EOM
from tensorflow DOT contrib DOT keras DOT python DOT keras DOT models import Sequential COMMA  load_model EOM
from tensorflow DOT contrib DOT keras DOT api DOT keras DOT optimizers import Adam EOM
from tensorflow DOT contrib DOT keras DOT python DOT keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
else: EOM
from keras DOT layers import Dense COMMA  Flatten COMMA  Dropout COMMA  ZeroPadding3D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
from collections import deque EOM
import sys EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  seq_length COMMA aved_model EQUAL  COMMA  features_length EQUAL  PARERIGHT : EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
if self DOT nb_classes > EQUAL  10: EOM
metrics DOT append PARELEFT  PARERIGHT  EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lrcn PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT mlp PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT conv_3d PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT c3d PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2048 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lrcn PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA tivation EQUAL  COMMA  padding EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def mlp PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def conv_3d PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def c3d PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT ZeroPadding3D PARELEFT padding EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4096 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4096 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelimport os EOM
global_model_version  EQUAL  57 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM COMMA  Dropout EOM
from keras import backend as K EOM
from keras_tqdm import TQDMNotebookCallback EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT num_words COMMA 12 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
LSTM_history  EQUAL  LSTM_model DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL import keras COMMA  urllib2 EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT optimizers import SGD COMMA  RMSprop COMMA  Adagrad EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
data   EQUAL  urllib2 DOT urlopen PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  EOM
data  EQUAL  [] EOM
data2 EQUAL [] EOM
for x in data: EOM
try: EOM
data2 DOT append PARELEFT  PARERIGHT  EOM
except: EOM
pass EOM
data2  EQUAL  data2[] EOM
data2  EQUAL  [] EOM
X  EQUAL  data2[] EOM
y  EQUAL  data2[] EOM
X  EQUAL  np DOT array PARELEFT  PARERIGHT  DOT T EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  DOT T EOM
Xtrain  EQUAL  X[] EOM
ytrain  EQUAL  y[] EOM
Xtest  EQUAL  X[] EOM
Ytest  EQUAL  y[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT Xtrain COMMA  ytrain COMMA  batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT Xtest COMMA  Ytest COMMA  batch_size EQUAL  PARERIGHT  EOM
pred  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
import matplotlib DOT pyplot as plt EOM
fig  EQUAL  plt DOT figure PARELEFT  PARERIGHT  EOM
fig DOT suptitle PARELEFT  COMMA  fontsize EQUAL  PARERIGHT  EOM
plt DOT xlabel PARELEFT  COMMA  fontsize EQUAL  PARERIGHT  EOM
plt DOT ylabel PARELEFT  COMMA  fontsize EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT Ytest COMMA  color EQUAL  COMMA  label  EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM COMMA  SimpleRNN COMMA  GRU EOM
from keras DOT layers DOT core import * EOM
max_features  EQUAL  5883 EOM
maxlen  EQUAL  80 EOM
batch_size  EQUAL  32 EOM
in_out_neurons  EQUAL  2 EOM
hidden_neurons  EQUAL  300 EOM
import os EOM
import sys EOM
import pandas as pd EOM
def _load_data PARELEFT data COMMA  n_prev EQUAL  PARERIGHT : EOM
for i in range PARELEFT len PARELEFT  PARERIGHT -n_prev PARERIGHT : EOM
docX DOT append PARELEFT  PARERIGHT  EOM
docY DOT append PARELEFT  PARERIGHT  EOM
all_X  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
all_Y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
return all_X COMMA  all_Y EOM
def train_test_split PARELEFT dataframe COMMA  test_size EQUAL  PARERIGHT : EOM
X_train COMMA  y_train  EQUAL  _load_data PARELEFT  PARERIGHT  EOM
X_test COMMA  y_test  EQUAL  _load_data PARELEFT  PARERIGHT  EOM
return  PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT  EOM
def rnn_lstm PARELEFT file_dataframe COMMA  test_size EQUAL  COMMA  col EQUAL  PARERIGHT : EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT ile_dataframe[] COMMA  test_size EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
hidden  EQUAL  32 EOM
step  EQUAL  10 EOM
model1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model1 DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  input_length EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model2 DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  \lidation_data EQUAL  PARELEFT  PARERIGHT  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
score COMMA  accuracy  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA batch_size EQUAL  PARERIGHT  EOM
return  PARELEFT  PARERIGHT  EOM
def main PARELEFT  PARERIGHT : EOM
file_name EQUAL  EOM
file_dataframe  EQUAL  pd DOT read_csv PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT from __future__ import print_function EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Input COMMA  Bidirectional EOM
from keras DOT optimizers import Adam EOM
from keras DOT callbacks import EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT metrics import categorical_accuracy EOM
import spacy EOM
nlp  EQUAL  spacy DOT load PARELEFT  PARERIGHT  EOM
import numpy as np EOM
import pandas as pd EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT utils import np_utils EOM
data  EQUAL   PARELEFT open PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  PARERIGHT  EOM
chars  EQUAL  sorted PARELEFT list PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
id_char  EQUAL  {id:char for id COMMA  char in enumerate PARELEFT  PARERIGHT } EOM
char_id  EQUAL  {char:id for id COMMA  char in enumerate PARELEFT  PARERIGHT } EOM
x  EQUAL  [] EOM
Y  EQUAL  [] EOM
length  EQUAL  len PARELEFT  PARERIGHT  EOM
seq_length  EQUAL  100 EOM
for i in range PARELEFT  PARERIGHT : EOM
sequence  EQUAL  data[] EOM
label  EQUAL  data[] EOM
x DOT append PARELEFT  PARERIGHT  EOM
Y DOT append PARELEFT  PARERIGHT  EOM
x_mod  EQUAL  np DOT reshape PARELEFT x COMMA   PARELEFT len PARELEFT  PARERIGHT  COMMA  seq_length COMMA  1 PARERIGHT  PARERIGHT  EOM
x_mod  EQUAL  x_mod / float PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
y_mod  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 400 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y_mod DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT x_mod COMMA  y_mod COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
string_mapped  EQUAL  x[] EOM
for i in range PARELEFT  PARERIGHT : EOM
x1  EQUAL  np DOT reshape PARELEFT string_mapped COMMA  PARELEFT 1 COMMA len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
x1  EQUAL  x1 / float PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
pred_index  EQUAL  np DOT argmax PARELEFT model DOT predict PARELEFT x1 COMMA  verbose EQUAL  PARERIGHT  PARERIGHT  EOM
seq  EQUAL  [] for value in string_mapped] EOM
string_mapped DOT append PARELEFT  PARERIGHT  EOM
full_string  EQUAL  string_mapped[] EOM
txt EQUAL  EOM
for char in full_string: EOM
txt  EQUAL  txt+char EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras DOT layers import Conv2D EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import sys EOM
import random EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT utils import np_utils EOM
from keras DOT optimizers import SGD EOM
from keras DOT layers import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT utils DOT data_utils import get_file EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT models import model_from_json EOM
from keras DOT layers import Merge EOM
from data_helper import loaddata EOM
m_names COMMA  f_names  EQUAL  loaddata PARELEFT  PARERIGHT  EOM
totalEntries  EQUAL  len PARELEFT  PARERIGHT  + len PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  len PARELEFT max PARELEFT  m_names  COMMA  key EQUAL  PARERIGHT  PARERIGHT  + len PARELEFT max PARELEFT  f_names  COMMA  key EQUAL  PARERIGHT  PARERIGHT  EOM
chars  EQUAL  set PARELEFT    DOT join PARELEFT  PARERIGHT  +  DOT join PARELEFT  PARERIGHT    PARERIGHT  EOM
char_index  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
X  EQUAL  np DOT zeros PARELEFT  PARELEFT totalEntries  COMMA  maxlen COMMA  len PARELEFT  PARERIGHT   PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
y  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
for i COMMA  name in enumerate PARELEFT  PARERIGHT : EOM
for t COMMA  char in enumerate PARELEFT  PARERIGHT : EOM
X[]]  EQUAL  1 EOM
y[]  EQUAL  1 EOM
for i COMMA  name in enumerate PARELEFT  PARERIGHT : EOM
for t COMMA  char in enumerate PARELEFT  PARERIGHT : EOM
X[]]  EQUAL     y[]  EQUAL nEpochs  EQUAL  10 EOM
def baseline_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT maxlen COMMA  len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
model EQUAL baseline_model PARELEFT  PARERIGHT  EOM
json_string  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as file: EOM
file DOT write PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT X COMMA y COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
def baseline_model1 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT maxlen COMMA  len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
model1 EQUAL baseline_model1 PARELEFT  PARERIGHT  EOM
json_string  EQUAL  model1 DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as file: EOM
file DOT write PARELEFT  PARERIGHT  EOM
model1 DOT fit PARELEFT X COMMA y COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
model1 DOT save_weights PARELEFT  PARERIGHT __author__  EQUAL from keras DOT regularizers import l2 EOM
from sklearn DOT cross_validation import train_test_split EOM
from six DOT moves import xrange EOM
from keras DOT layers import LSTM COMMA  Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  Lambda EOM
from keras DOT layers import MaxPooling1D COMMA  MaxPooling2D COMMA  AveragePooling2D COMMA  MaxPooling3D EOM
from keras DOT layers import Conv1D COMMA  Conv2D COMMA  Conv3D COMMA  GlobalAveragePooling2D COMMA  GlobalMaxPooling2D EOM
from keras DOT layers DOT convolutional_recurrent import ConvLSTM2D COMMA  ConvRecurrent2D EOM
from keras DOT engine import Input COMMA  Model EOM
from keras DOT callbacks import Callback COMMA  LearningRateScheduler COMMA  ModelCheckpoint COMMA  EarlyStopping EOM
from keras DOT preprocessing DOT image import ImageDataGenerator EOM
import json EOM
import keras EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT optimizers import SGD COMMA  Adam EOM
from keras import backend as K EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT utils DOT data_utils import get_file EOM
from keras DOT layers DOT wrappers import TimeDistributed COMMA  Bidirectional EOM
import numpy as np EOM
from keras DOT layers DOT wrappers import TimeDistributed COMMA  Bidirectional EOM
from keras DOT layers DOT recurrent import SimpleRNN COMMA  GRU EOM
import warnings EOM
from keras DOT utils import layer_utils EOM
if __name__  EQUAL  EQUAL  : EOM
from util import Util as util EOM
X_data_name_1  EQUAL  EOM
y_data_name_1  EQUAL  EOM
X_data_name_2  EQUAL  EOM
y_data_name_2  EQUAL  EOM
X_train COMMA  y_train  EQUAL  util DOT load_from_npz PARELEFT  PARERIGHT  COMMA  util DOT load_from_npz PARELEFT  PARERIGHT  EOM
X_test COMMA  y_test  EQUAL  util DOT load_from_npz PARELEFT  PARERIGHT  COMMA  util DOT load_from_npz PARELEFT  PARERIGHT  EOM
def normalize PARELEFT  PARERIGHT : EOM
mean  EQUAL  np DOT mean PARELEFT X_train COMMA axis EQUAL  PARERIGHT  EOM
std  EQUAL  np DOT std PARELEFT X_train COMMA  axis EQUAL  PARERIGHT  EOM
X_train  EQUAL   PARELEFT  PARERIGHT / PARELEFT  PARERIGHT  EOM
X_test  EQUAL   PARELEFT  PARERIGHT / PARELEFT  PARERIGHT  EOM
return X_train COMMA  X_test EOM
X_train COMMA  X_test  EQUAL  normalize PARELEFT  PARERIGHT  EOM
X_train  EQUAL  X_train DOT reshape PARELEFT  PARERIGHT  EOM
X_test  EQUAL  X_test DOT reshape PARELEFT  PARERIGHT  EOM
from keras DOT utils import np_utils EOM
nb_classes  EQUAL  7 EOM
y_train  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
from keras DOT layers DOT merge import concatenate COMMA  add EOM
def audio_clstm PARELEFT  PARERIGHT : EOM
x  EQUAL  GRU PARELEFT 577 COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  GRU PARELEFT 577 COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  GRU PARELEFT 577 COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  GRU PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 7 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
return x EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
out  EQUAL  audio_clstm PARELEFT  PARERIGHT  EOM
model_clstm  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL [] PARERIGHT  EOM
model_clstm DOT summary PARELEFT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model_clstm DOT compile PARELEFT optimizer EQUAL  COMMA  oss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
mc  EQUAL  keras DOT callbacks DOT ModelCheckpoint PARELEFT  COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  COMMA  mode EQUAL  COMMA  period EQUAL  PARERIGHT  EOM
model_clstm DOT fit PARELEFT X_train_2nd COMMA  y_train_2nd COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  uffle EQUAL  COMMA  epochs EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
open PARELEFT  PARERIGHT  DOT write PARELEFT model_clstm DOT to_yaml PARELEFT  PARERIGHT  PARERIGHT  EOM
proba_clstm  EQUAL  model_clstm DOT predict_on_batch PARELEFT  PARERIGHT  EOM
model_Bilstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Bilstm DOT add PARELEFT LSTM PARELEFT 577 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_Bilstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_Bilstm DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 577 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_Bilstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_Bilstm DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_Bilstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_Bilstm DOT add PARELEFT Dense PARELEFT 7 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Bilstm DOT summary PARELEFT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model_Bilstm DOT compile PARELEFT optimizer EQUAL  COMMA  oss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
mc  EQUAL  keras DOT callbacks DOT ModelCheckpoint PARELEFT  COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  COMMA  mode EQUAL  COMMA  period EQUAL  PARERIGHT  EOM
model_Bilstm DOT fit PARELEFT X_train_2nd COMMA  y_train_2nd COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  uffle EQUAL  COMMA  epochs EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT 577 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT 577 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT 7 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT summary PARELEFT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model_lstm DOT compile PARELEFT optimizer EQUAL  COMMA  oss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
mc  EQUAL  keras DOT callbacks DOT ModelCheckpoint PARELEFT  COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  COMMA  mode EQUAL  COMMA  period EQUAL  PARERIGHT  EOM
model_lstm DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  uffle EQUAL  COMMA  epochs EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT 577 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT 577 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT 7 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT summary PARELEFT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model_lstm DOT compile PARELEFT optimizer EQUAL  COMMA  oss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
mc  EQUAL  keras DOT callbacks DOT ModelCheckpoint PARELEFT  COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  COMMA  mode EQUAL  COMMA  period EQUAL  PARERIGHT  EOM
model_lstm DOT fit PARELEFT X_train_2nd COMMA  y_train_2nd COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  uffle EQUAL  COMMA  epochs EQUAL  COMMA  callbacks EQUAL [] EOM
import os EOM
global_model_version  EQUAL  41 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  10000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import pandas as pd EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT models import Input EOM
from keras DOT models import Model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Merge EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT models import model_from_json EOM
from keras DOT callbacks import ModelCheckpoint EOM
from MyModule import data EOM
from MyModule import evaluate EOM
import os EOM
def build_lstm_models PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA output_dim EQUAL [][] COMMA ctivation EQUAL [] COMMA  recurrent_activation EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL [][] COMMA ctivation EQUAL [] COMMA  recurrent_activation EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def add_multi_dense PARELEFT  PARERIGHT : EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT dense_config[][] COMMA  activation EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_model PARELEFT model_path COMMA  weight_path COMMA  lstm_config COMMA  dense_config COMMA  time_steps EQUAL  PARERIGHT : EOM
if os DOT path DOT exists PARELEFT  PARERIGHT : EOM
json_string  EQUAL  open PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  EOM
model  EQUAL  model_from_json PARELEFT  PARERIGHT  EOM
else: EOM
lstm_models  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
lstm_models DOT append PARELEFT build_lstm_models PARELEFT  PARERIGHT  PARERIGHT  EOM
date_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
date_model DOT add PARELEFT ense PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA nits EQUAL [][] COMMA  activation EQUAL [] PARERIGHT  PARERIGHT  EOM
lstm_models DOT append PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT lstm_models COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  add_multi_dense PARELEFT  PARERIGHT  EOM
open PARELEFT  PARERIGHT  DOT write PARELEFT model DOT to_json PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if os DOT path DOT exists PARELEFT  PARERIGHT : EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def train PARELEFT df_raw COMMA  model_path COMMA  weight_path COMMA  lstm_config COMMA  dense_config COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  time_steps EQUAL  COMMA test_split EQUAL  PARERIGHT : EOM
df_date  EQUAL  df_raw DOT pop PARELEFT  PARERIGHT  EOM
df_date  EQUAL  pd DOT concat PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
df_date  EQUAL  pd DOT concat PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
df_date  EQUAL  df_date DOT loc[] EOM
df_raw  EQUAL  data DOT process_sequence_features PARELEFT df_raw COMMA  time_steps EQUAL  PARERIGHT  EOM
df_date_encode  EQUAL  data DOT encoding_features PARELEFT  PARERIGHT  EOM
y_scaled COMMA  y_scaler  EQUAL  data DOT min_max_scale PARELEFT np DOT array PARELEFT df_raw DOT pop PARELEFT  PARERIGHT  PARERIGHT  DOT reshape PARELEFT  PARERIGHT  PARERIGHT  EOM
X_scaled COMMA  X_scaler  EQUAL  data DOT min_max_scale PARELEFT  PARERIGHT  EOM
date_encode  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
train_y  EQUAL  y_scaled[] EOM
test_y  EQUAL  y_scaled[] EOM
train_y  EQUAL  train_y DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
test_y  EQUAL  test_y DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
X_scaled  EQUAL  X_scaled DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
date_encode  EQUAL  date_encode DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_X  EQUAL  [] EOM
test_X  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
train_X DOT append PARELEFT X_scaled[] PARERIGHT  EOM
test_X DOT append PARELEFT X_scaled[] PARERIGHT  EOM
train_X DOT append PARELEFT date_encode[] PARERIGHT  EOM
test_X DOT append PARELEFT date_encode[] PARERIGHT  EOM
model  EQUAL  build_model PARELEFT  PARERIGHT  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT weight_path COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
history  EQUAL  model DOT fit PARELEFT train_X COMMA  train_y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA rbose EQUAL  COMMA  callbacks EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
plt DOT figure PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
pred_y  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
test_y  EQUAL  data DOT inverse_to_original_data PARELEFT train_y DOT reshape PARELEFT  PARERIGHT  COMMA  test_y DOT reshape PARELEFT  PARERIGHT  COMMA  scaler EQUAL  COMMA n_num EQUAL  PARELEFT len PARELEFT  PARERIGHT  *  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
pred_y  EQUAL  data DOT inverse_to_original_data PARELEFT train_y DOT reshape PARELEFT  PARERIGHT  COMMA  pred_y DOT reshape PARELEFT  PARERIGHT  COMMA  scaler EQUAL  COMMA n_num EQUAL  PARELEFT len PARELEFT  PARERIGHT  *  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return test_y COMMA  pred_y EOM
if __name__  EQUAL  EQUAL  : EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
cols  EQUAL  [] EOM
metrics  EQUAL  [] EOM
time_steps  EQUAL  [] EOM
for time_step in time_steps: EOM
df_raw_data  EQUAL  pd DOT read_csv PARELEFT  COMMA  usecols EQUAL  COMMA  dtype EQUAL  PARERIGHT  EOM
epoch  EQUAL  200 EOM
batch  EQUAL  1024 EOM
model_path  EQUAL   + str PARELEFT  PARERIGHT  + EOM
weight_path  EQUAL   + str PARELEFT  PARERIGHT  + EOM
test_split  EQUAL  0 DOT 4 EOM
lstm_num  EQUAL  6 EOM
lstm_layers  EQUAL  [] EOM
lstm_activation  EQUAL  EOM
lstm_recurrent_activation  EQUAL  EOM
lstm_input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
lstm_dropout  EQUAL  0 DOT 3 EOM
dense_layers  EQUAL  [] EOM
dense_activation  EQUAL  None EOM
date_features_shape  EQUAL   PARELEFT  PARERIGHT  EOM
dense_dropout  EQUAL  0 DOT 5 EOM
lstm_conf  EQUAL  {: lstm_num COMMA : lstm_input_shape COMMA : lstm_layers COMMA : lstm_activation COMMA : lstm_recurrent_activation COMMA : lstm_dropout} EOM
dense_conf  EQUAL  {: date_features_shape COMMA : dense_layers COMMA : dense_activation COMMA : dense_dropout} EOM
y_true COMMA  y_pred  EQUAL  train PARELEFT df_raw_data COMMA  model_path COMMA  weight_path COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  lstm_config EQUAL  COMMA nse_config EQUAL  COMMA  time_steps EQUAL  COMMA  test_split EQUAL  PARERIGHT  EOM
metrics DOT append PARELEFT evaluate DOT print_metrics PARELEFT  PARERIGHT  PARERIGHT  EOM
from data import data EOM
import numpy as np EOM
from sim import sim EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation COMMA  LSTM EOM
import keras DOT utils EOM
from data import data EOM
from keras DOT callbacks import History EOM
import matplotlib DOT pyplot as plt EOM
from keras import optimizers EOM
path  EQUAL  EOM
prefix  EQUAL  EOM
index  EQUAL   PARELEFT  PARERIGHT  EOM
suffix  EQUAL  EOM
d  EQUAL  data DOT multiload PARELEFT  PARERIGHT  EOM
[]  EQUAL  data DOT preplstm PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 9 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
optimizers DOT rmsprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
epch  EQUAL  100 EOM
hist  EQUAL  model DOT fit PARELEFT inpt COMMA  trgt COMMA  epochs EQUAL  PARERIGHT  EOM
history  EQUAL  History PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT range PARELEFT  PARERIGHT  COMMA  hist DOT history[] PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT import numpy as np EOM
import jieba EOM
import multiprocessing EOM
from gensim DOT models DOT word2vec import Word2Vec EOM
from gensim DOT corpora DOT dictionary import Dictionary EOM
from keras DOT preprocessing import sequence EOM
from sklearn DOT cross_validation import train_test_split EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA Activation EOM
from keras DOT models import model_from_yaml EOM
import sys EOM
sys DOT setrecursionlimit PARELEFT  PARERIGHT  EOM
import yaml EOM
vocab_dim  EQUAL  100 EOM
window_size  EQUAL  7 EOM
n_epoch  EQUAL  4 EOM
input_length  EQUAL  100 EOM
maxlen  EQUAL  100 EOM
batch_size  EQUAL  32 EOM
def loadfile PARELEFT  PARERIGHT : EOM
neg EQUAL pd DOT read_csv PARELEFT r COMMA header EQUAL  COMMA index_col EQUAL  PARERIGHT [] EOM
pos EQUAL pd DOT read_csv PARELEFT r COMMA header EQUAL  COMMA index_col EQUAL  COMMA error_bad_lines EQUAL  PARERIGHT [] EOM
neu EQUAL pd DOT read_csv PARELEFT r COMMA  header EQUAL  COMMA  index_col EQUAL  PARERIGHT [] EOM
combined  EQUAL  np DOT concatenate PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT concatenate PARELEFT  PARELEFT np DOT ones PARELEFT len PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  COMMA   DOT zeros PARELEFT len PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  COMMA   * np DOT ones PARELEFT len PARELEFT  PARERIGHT  COMMA dtype EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return combined COMMA y EOM
def tokenizer PARELEFT  PARERIGHT : EOM
return text EOM
def create_dictionaries PARELEFT model EQUAL  COMMA combined EQUAL  PARERIGHT : EOM
gensim_dict  EQUAL  Dictionary PARELEFT  PARERIGHT  EOM
gensim_dict DOT doc2bow PARELEFT model DOT wv DOT vocab DOT keys PARELEFT  PARERIGHT  COMMA allow_update EQUAL  PARERIGHT  EOM
for sentence in combined: EOM
new_txt  EQUAL  [] EOM
for word in sentence: EOM
try: EOM
new_txt DOT append PARELEFT  PARERIGHT  EOM
except: EOM
data DOT append PARELEFT  PARERIGHT  EOM
combined EQUAL parse_dataset PARELEFT  PARERIGHT  EOM
return w2indx COMMA  w2vec COMMA combined EOM
else: EOM
def word2vec_train PARELEFT  PARERIGHT : EOM
model  EQUAL  Word2Vec PARELEFT size EQUAL  COMMA min_count EQUAL  COMMA window EQUAL  COMMA workers EQUAL  COMMA iter EQUAL  PARERIGHT  EOM
model DOT train PARELEFT combined COMMA  total_examples EQUAL  COMMA ochs  EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
index_dict COMMA  word_vectors COMMA combined  EQUAL  create_dictionaries PARELEFT model EQUAL  COMMA combined EQUAL  PARERIGHT  EOM
return   index_dict COMMA  word_vectors COMMA combined EOM
def build_data PARELEFT  PARERIGHT : EOM
embedding_weights[]  EQUAL  word_vectors[] EOM
x_train COMMA  x_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT combined COMMA  y COMMA  test_size EQUAL  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT y_train COMMA num_classes EQUAL  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT y_test COMMA num_classes EQUAL  PARERIGHT  EOM
return n_symbols COMMA embedding_weights COMMA x_train COMMA y_train COMMA x_test COMMA y_test EOM
import itertools EOM
import unittest EOM
import numpy as np EOM
import os COMMA  shutil EOM
import tempfile EOM
import pytest EOM
from coremltools DOT _deps import HAS_KERAS_TF EOM
from coremltools DOT models DOT utils import macos_version EOM
if HAS_KERAS_TF: EOM
import keras DOT backend EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Convolution2D COMMA  AtrousConvolution2D COMMA  LSTM COMMA  \ EOM
ZeroPadding2D COMMA  Deconvolution2D COMMA  Permute COMMA  Convolution1D COMMA  AtrousConvolution1D COMMA  \ EOM
MaxPooling2D COMMA  AveragePooling2D COMMA  Flatten COMMA  Dropout COMMA  UpSampling2D COMMA  merge COMMA  Merge COMMA  Input COMMA  GRU COMMA  \ EOM
GlobalMaxPooling2D COMMA  GlobalMaxPooling1D COMMA  GlobalAveragePooling2D COMMA  GlobalAveragePooling1D COMMA  \ EOM
Cropping1D COMMA  Cropping2D COMMA  Reshape COMMA  AveragePooling1D COMMA  MaxPooling1D COMMA  RepeatVector COMMA  ELU COMMA  \ EOM
SimpleRNN COMMA  BatchNormalization COMMA  Embedding COMMA  ZeroPadding1D COMMA  UpSampling1D EOM
from keras DOT layers DOT wrappers import Bidirectional COMMA  TimeDistributed EOM
from keras DOT optimizers import SGD EOM
from coremltools DOT converters import keras as kerasConverter EOM
def _keras_transpose PARELEFT x COMMA  is_sequence EQUAL  PARERIGHT : EOM
if len PARELEFT  PARERIGHT   EQUAL         x  EQUAL  np DOT transpose PARELEFT  PARERIGHT  EOM
return np DOT expand_dims PARELEFT x COMMA  axis EQUAL  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL         return np DOT transpose PARELEFT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             return x DOT reshape PARELEFT x DOT shape[] +  PARELEFT  PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             return x DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
else: EOM
return x EOM
else: EOM
return x EOM
def _get_coreml_model PARELEFT  PARERIGHT : EOM
from coremltools DOT converters import keras as keras_converter EOM
model  EQUAL  keras_converter DOT convert PARELEFT  PARERIGHT  EOM
return model EOM
def _generate_data PARELEFT input_shape COMMA  mode  EQUAL  PARERIGHT : EOM
X  EQUAL  np DOT zeros PARELEFT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
X  EQUAL  np DOT ones PARELEFT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
X  EQUAL  np DOT array PARELEFT range PARELEFT np DOT product PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  DOT reshape PARELEFT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
X  EQUAL  np DOT random DOT rand PARELEFT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
X  EQUAL  np DOT random DOT rand PARELEFT  PARERIGHT -0 DOT 5 EOM
return X EOM
def conv2d_bn PARELEFT x COMMA  nb_filter COMMA  nb_row COMMA  nb_col COMMA  border_mode EQUAL  COMMA  subsample EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT : EOM
bn_name  EQUAL  name + EOM
conv_name  EQUAL  name + EOM
else: EOM
bn_name  EQUAL  None EOM
conv_name  EQUAL  None EOM
bn_axis  EQUAL  3 EOM
x  EQUAL  Convolution2D PARELEFT nb_filter COMMA  nb_row COMMA  nb_col COMMA subsample EQUAL  COMMA activation EQUAL  COMMA border_mode EQUAL  COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  BatchNormalization PARELEFT axis EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
return x EOM
import tensorflow as tf EOM
import numpy as np EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Dropout COMMA  TimeDistributed COMMA  Bidirectional EOM
from keras DOT layers import LSTM COMMA  Input COMMA  merge COMMA  multiply COMMA  Conv2D COMMA  \ EOM
Conv2DTranspose COMMA  BatchNormalization COMMA  UpSampling2D COMMA  ConvLSTM2D COMMA  Conv3D COMMA  BatchNormalization EOM
from keras DOT layers DOT core import Permute COMMA  Reshape COMMA  Flatten COMMA  Lambda COMMA  RepeatVector EOM
from keras DOT optimizers import RMSprop COMMA  Adam EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
from keras DOT utils DOT data_utils import get_file EOM
from keras DOT models import load_model EOM
from Midi_Parser import MidiParser EOM
from keras import backend as K EOM
MAX_LEN  EQUAL  25 EOM
OUT_MAX_LEN  EQUAL  1 EOM
from preprocessing import PITCHES_REPRESS EOM
NUM_CHANNELS  EQUAL  4 EOM
INPUT_DIM  EQUAL  NUM_CHANNELS * PITCHES_REPRESS EOM
INPUT_DIM  EQUAL  PITCHES_REPRESS EOM
def simple PARELEFT maxlen COMMA  input_dim EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout_U EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout_U EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  clipvalue EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def prepare_model_keras PARELEFT maxlen COMMA  input_dim EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  COMMA dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA eturn_sequences EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def prepare_conv_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA eturn_sequences EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  COMMA adding EQUAL  COMMA  data_format EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def prepare_attention PARELEFT maxlen COMMA  full_attention EQUAL  PARERIGHT : EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_units  EQUAL  32 EOM
lstm_out COMMA  state_h COMMA  state_c  EQUAL  LSTM PARELEFT lstm_units COMMA  return_sequences EQUAL  COMMA  return_state EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
state_c  EQUAL  RepeatVector PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_out  EQUAL  merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  EOM
else: EOM
lstm_out  EQUAL  LSTM PARELEFT lstm_units COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention_mul  EQUAL  attention_3d_block PARELEFT  PARERIGHT  EOM
attention_mul2  EQUAL  attention_3d_block PARELEFT  PARERIGHT  EOM
attention_mul2 EQUAL  Lambda PARELEFT lambda x: K DOT sum PARELEFT x COMMA  axis EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT INPUT_DIM COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT input EQUAL [] COMMA  output EQUAL  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def attention_3d_block PARELEFT  PARERIGHT : EOM
input_dim  EQUAL  int PARELEFT  PARERIGHT  EOM
a  EQUAL  Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
a  EQUAL  Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
if full_attention: EOM
a  EQUAL  Dense PARELEFT MAX_LEN COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
a  EQUAL  Dense PARELEFT MAX_LEN COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
a_probs  EQUAL  Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output_attention_mul  EQUAL  multiply PARELEFT  PARERIGHT  EOM
return output_attention_mul EOM
def discriminator PARELEFT maxlen EQUAL  COMMA  depth  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA \metrics EQUAL [] PARERIGHT  EOM
return model EOM
def adversarial PARELEFT  PARERIGHT : EOM
optimizer  EQUAL  Adam PARELEFT  PARERIGHT  EOM
discriminator DOT trainable  EQUAL  False EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA \metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def generator PARELEFT maxlen  EQUAL  PARERIGHT : EOM
optimizer  EQUAL  Adam PARELEFT  PARERIGHT  EOM
noise_shape  EQUAL   PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT momentum EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT momentum EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LeakyReLU PARELEFT alpha EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT momentum EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT MAX_LEN * INPUT_DIM COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA \metrics EQUAL [] PARERIGHT  EOM
return model EOM
def build_and_run_model PARELEFT X COMMA  maxlen COMMA eq_len EQUAL  COMMA  out_file EQUAL  PARERIGHT : EOM
with tf DOT Graph PARELEFT  PARERIGHT  DOT as_default PARELEFT  PARERIGHT : EOM
net  EQUAL  tflearn DOT input_data PARELEFT [] COMMA data_preprocessing EQUAL  COMMA data_augmentation EQUAL  PARERIGHT  EOM
net  EQUAL  tflearn DOT lstm PARELEFT net COMMA  512 COMMA  return_seq EQUAL  PARERIGHT  EOM
net  EQUAL  tflearn DOT dropout PARELEFT  PARERIGHT  EOM
net  EQUAL  tflearn DOT lstm PARELEFT net COMMA  512 COMMA  return_seq EQUAL  PARERIGHT  EOM
net  EQUAL  tflearn DOT dropout PARELEFT  PARERIGHT  EOM
net  EQUAL  tflearn DOT lstm PARELEFT  PARERIGHT  EOM
net  EQUAL  tflearn DOT fully_connected PARELEFT net COMMA  X DOT shape[] COMMA activation EQUAL  PARERIGHT  EOM
net  EQUAL  tflearn DOT regression PARELEFT net COMMA  optimizer EQUAL  COMMA loss EQUAL  COMMA learning_rate EQUAL  PARERIGHT  EOM
model  EQUAL  tflearn DOT DNN PARELEFT net COMMA  clip_gradients EQUAL  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
from  keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from DataCreateHelper import DataCreate EOM
class Models: EOM
def StackedLSTM PARELEFT  PARERIGHT : EOM
model EQUAL Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT memoryunitecount COMMA return_sequences EQUAL  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
model DOT fit PARELEFT X_train[] COMMA y_train[] COMMA batch_size EQUAL  COMMA epochs EQUAL  PARERIGHT  EOM
loss EQUAL model DOT evaluate PARELEFT  PARERIGHT  EOM
def VanillaLSTM PARELEFT  PARERIGHT : EOM
mainmodel EQUAL Sequential PARELEFT  PARERIGHT  EOM
mainmodel DOT add PARELEFT LSTM PARELEFT memoryunitcount COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
mainmodel DOT add PARELEFT Dense PARELEFT input_shape[] COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
mainmodel DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
mainmodel DOT fit PARELEFT X_train[] COMMA y_train[] COMMA epochs EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
mydatacraete EQUAL DataCreate PARELEFT  PARERIGHT  EOM
loss EQUAL mainmodel DOT evaluate PARELEFT X_predict COMMA y_predict COMMA verbose EQUAL  PARERIGHT  EOM
yhat EQUAL mainmodel DOT predict PARELEFT X_predict[] DOT reshape PARELEFT  PARERIGHT  PARERIGHT  EOM
if __name__ EQUAL  EQUAL : EOM
import keras EOM
import tensorflow EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
import numpy as np EOM
import time EOM
import csv EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA Merge EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
import copy EOM
data_dim  EQUAL  1 EOM
timesteps  EQUAL  13 EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
in_dimension  EQUAL  3 EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
from keras DOT utils DOT visualize_util import plot COMMA  to_graph EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT import glob EOM
import subprocess EOM
import json EOM
import re EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras import metrics EOM
from sklearn DOT metrics import precision_recall_fscore_support EOM
from sklearn DOT metrics import f1_score EOM
from sklearn DOT metrics import precision_score EOM
from sklearn DOT metrics import recall_score EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Embedding  COMMA  Merge COMMA RepeatVector EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU COMMA  TimeDistributed EOM
from keras DOT datasets import imdb EOM
from keras DOT layers DOT core import Reshape EOM
from keras DOT optimizers import SGD COMMA  Adam COMMA  RMSprop EOM
from sklearn DOT metrics import confusion_matrix EOM
from sklearn DOT model_selection import StratifiedKFold EOM
seed EQUAL 7 EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
def RLSTM PARELEFT  PARERIGHT : EOM
xtrain EQUAL [] EOM
ytrain EQUAL [] EOM
xtest EQUAL [] EOM
ytest EQUAL [] EOM
X_train  EQUAL  np DOT loadtxt PARELEFT  PARERIGHT  EOM
Y_train  EQUAL  np DOT loadtxt PARELEFT  PARERIGHT  EOM
Y_train  EQUAL  Y_train DOT reshape PARELEFT  PARERIGHT  EOM
X_test  EQUAL  X_train EOM
Y_test  EQUAL  Y_train EOM
X_train  EQUAL  np DOT repeat PARELEFT X_train COMMA  500 COMMA  axis  EQUAL  PARERIGHT  EOM
Y_train  EQUAL  np DOT repeat PARELEFT Y_train COMMA  500 COMMA  axis  EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 3 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT X_test COMMA  Y_test COMMA  verbose EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
Y_result EQUAL model DOT predict PARELEFT X_test COMMA batch_size EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
for num in range PARELEFT 0 COMMA len PARELEFT  PARERIGHT  PARERIGHT : EOM
for s in range PARELEFT 0 COMMA len PARELEFT  PARERIGHT  PARERIGHT : EOM
for u in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  LSTM COMMA  Activation COMMA  Dropout COMMA  Embedding COMMA  Bidirectional COMMA  GlobalMaxPool1D EOM
from keras DOT optimizers import RMSprop EOM
class BiLSTM PARELEFT  PARERIGHT : EOM
def create_model PARELEFT self COMMA  num_words COMMA  n_dims  EQUAL  COMMA  max_words  EQUAL  COMMA  hidden_units  EQUAL  COMMA  vectors  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT num_words COMMA  100 COMMA  input_length  EQUAL  COMMA  trainable  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT hidden_units COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
class BiLSTMv2 PARELEFT  PARERIGHT : EOM
def create_model PARELEFT self COMMA  wv COMMA  max_words  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT wv DOT shape[] COMMA  wv DOT shape[] COMMA  input_length  EQUAL  COMMA  trainable  EQUAL  COMMA  weights  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
class CSTM PARELEFT  PARERIGHT : EOM
def create_model PARELEFT self COMMA  vectors COMMA  max_words  EQUAL  COMMA  hidden_units  EQUAL  PARERIGHT : EOM
wv  EQUAL  vectors EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT wv DOT shape[] COMMA  wv DOT shape[] COMMA  input_length  EQUAL  COMMA  trainable  EQUAL  COMMA  weights  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
import pickle as pkl EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT layers import Dense COMMA  Flatten COMMA  Dropout COMMA  ZeroPadding3D EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT convolutional import MaxPooling3D COMMA  Conv3D EOM
from keras DOT models import model_from_yaml EOM
from collections import deque EOM
import sys EOM
from keras DOT preprocessing import image EOM
import numpy as np EOM
from dataSetModel import DataSetModel COMMA  GetArrayFromImage EOM
from keras DOT applications DOT inception_v3 import InceptionV3 COMMA  preprocess_input EOM
from keras DOT layers import Reshape EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
class Model PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  classesNumber COMMA  modelName COMMA  sequenseLength COMMA  savedModel EQUAL  COMMA  featuresLength EQUAL  PARERIGHT : EOM
self DOT featureQueue  EQUAL  deque PARELEFT  PARERIGHT  EOM
self DOT sequenseLength  EQUAL  sequenseLength EOM
self DOT savedModel  EQUAL  savedModel EOM
self DOT classesNumber  EQUAL  classesNumber EOM
self DOT featuresLength  EQUAL  featuresLength EOM
if self DOT savedModel is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif modelName  EQUAL  EQUAL  : EOM
self DOT shapeOfInput  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT Conv3DModelCreate PARELEFT  PARERIGHT  EOM
elif modelName  EQUAL  EQUAL   : EOM
self DOT shapeOfInput  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT LSTMModelCreate PARELEFT  PARERIGHT  EOM
elif modelName  EQUAL  EQUAL   : EOM
self DOT shapeOfInputConv3d  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT shapeOfInputLSTM  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT Conv3dBLSTM PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
if self DOT classesNumber > EQUAL  10: EOM
metrics DOT append PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def Conv3DModelCreate PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from process_data import * EOM
from time import time EOM
def base_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT n_lstm COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def multilayer_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT n_lstm COMMA  input_shape EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def generate PARELEFT model COMMA  n COMMA  seed COMMA  temp EQUAL  PARERIGHT : EOM
exp_pdf  EQUAL  np DOT exp PARELEFT np DOT log PARELEFT  PARERIGHT  / temp PARERIGHT  EOM
return np DOT random DOT choice PARELEFT np DOT arange PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  COMMA  p EQUAL  PARELEFT  PARERIGHT  / np DOT sum PARELEFT  PARERIGHT  PARERIGHT  EOM
gen  EQUAL  [] EOM
window  EQUAL  len PARELEFT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
prev  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
gen DOT append PARELEFT int_to_onehot PARELEFT sample PARELEFT model DOT predict PARELEFT  PARERIGHT [] PARERIGHT  COMMA  128 PARERIGHT  PARERIGHT  EOM
return  DOT join PARELEFT [] PARERIGHT  EOM
def perplexity PARELEFT  PARERIGHT : EOM
return np DOT prod PARELEFT P **  PARELEFT -1 / len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
X COMMA  Y  EQUAL  character_onehot PARELEFT  PARERIGHT  EOM
X_test COMMA  Y_test  EQUAL  character_onehot PARELEFT  PARERIGHT  EOM
bs  EQUAL  100 EOM
start  EQUAL  time PARELEFT  PARERIGHT  EOM
character_model  EQUAL  multilayer_model PARELEFT 100 COMMA  np DOT shape PARELEFT  PARERIGHT  COMMA  128 PARERIGHT  EOM
character_model DOT fit PARELEFT X COMMA  Y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
end  EQUAL  time PARELEFT  PARERIGHT  EOM
seed  EQUAL  EOM
temps  EQUAL  [] EOM
for t in temps: EOM
from configs DOT data_config import * EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D EOM
def create_model_lstm PARELEFT embedding_trainable EQUAL  COMMA  embedding_matrix EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if embedding_trainable: EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA ights EQUAL [] COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_embedding_size COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_model_cnn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filter_length EQUAL  COMMA  nb_filter EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dropout COMMA  Dense COMMA  Activation COMMA  Input COMMA  Embedding EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT models import load_model EOM
from keras DOT layers DOT merge import Average EOM
from keras DOT models import Model EOM
import os EOM
def M1_Embedding_128_256_relu PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def M2_Embedding_32_64_relu PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def M3_Embedding_32_64_64_64_relu PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def M4_Embedding_256_512_relu PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def M5_128 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def M6_128_256_relu PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def M7_128_256_relu_dropout PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def M8_M5_average_merge PARELEFT  PARERIGHT : EOM
truncated_models_outputs  EQUAL  [] EOM
models  EQUAL  [] EOM
for model_file in os DOT listdir PARELEFT  PARERIGHT : EOM
model_path  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
current_model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
models DOT append PARELEFT  PARERIGHT  EOM
current_model DOT pop PARELEFT  PARERIGHT  EOM
truncated_models_outputs DOT append PARELEFT  PARERIGHT  EOM
new_models  EQUAL  [] EOM
input_layer  EQUAL  Input PARELEFT shape EQUAL  PARELEFT SEQUENCE_LENGTH-1 COMMA  len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for model in models: EOM
model  EQUAL  model PARELEFT  PARERIGHT  EOM
new_models DOT append PARELEFT  PARERIGHT  EOM
output  EQUAL  Average PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Activation PARELEFT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
MODELS  EQUAL  {: M1_Embedding_128_256_relu COMMA : M2_Embedding_32_64_relu COMMA : M3_Embedding_32_64_64_64_relu COMMA : M4_Embedding_256_512_relu COMMA : M5_128 COMMA : M6_128_256_relu COMMA : M7_128_256_relu_dropout COMMA : M8_M5_average_merge} EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  MODELS[] PARELEFT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import GlobalAveragePooling1D COMMA  MaxPooling1D COMMA  Dense COMMA Dropout COMMA MaxPool1D COMMA  Conv1D COMMA  GlobalMaxPool1D COMMA  Activation COMMA  Bidirectional COMMA  LSTM COMMA  Input EOM
from keras import backend as K EOM
from keras DOT optimizers import Adam EOM
def precision PARELEFT  PARERIGHT : EOM
predicted_positives  EQUAL  K DOT sum PARELEFT K DOT round PARELEFT K DOT clip PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
precision  EQUAL  true_positives /  PARELEFT predicted_positives + K DOT epsilon PARELEFT  PARERIGHT  PARERIGHT  EOM
return precision EOM
def recall PARELEFT  PARERIGHT : EOM
possible_positives  EQUAL  K DOT sum PARELEFT K DOT round PARELEFT K DOT clip PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
recall  EQUAL  true_positives /  PARELEFT possible_positives + K DOT epsilon PARELEFT  PARERIGHT  PARERIGHT  EOM
return recall EOM
def mlpModel PARELEFT input1_shape COMMA  layers EQUAL [] PARERIGHT : EOM
last_idx  EQUAL  len PARELEFT  PARERIGHT  - 1 EOM
for  PARELEFT  PARERIGHT  in enumerate PARELEFT  PARERIGHT : EOM
activation_name  EQUAL  EOM
if idx  EQUAL  EQUAL  last_idx: EOM
activation_name  EQUAL  EOM
if idx  EQUAL  EQUAL  0: EOM
model DOT add PARELEFT Dense PARELEFT input_shape  EQUAL  COMMA  units  EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units  EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer  EQUAL  COMMA  loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def convModel PARELEFT  PARERIGHT : EOM
for  PARELEFT  PARERIGHT  in enumerate PARELEFT  PARERIGHT : EOM
if isinstance PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT MaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             if i  EQUAL  EQUAL  0: EOM
model DOT add PARELEFT Conv1D PARELEFT layer[] COMMA  layer[] COMMA  nput_shape EQUAL  COMMA  padding EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Conv1D PARELEFT layer[] COMMA  layer[] COMMA  padding EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT GlobalMaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA etrics EQUAL [] COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def convLstmModel PARELEFT  PARERIGHT : EOM
for  PARELEFT  PARERIGHT  in enumerate PARELEFT  PARERIGHT : EOM
if isinstance PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT MaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             if i  EQUAL  EQUAL  0: EOM
model DOT add PARELEFT Conv1D PARELEFT layer[] COMMA  layer[] COMMA  nput_shape EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Conv1D PARELEFT layer[] COMMA  layer[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
for  PARELEFT  PARERIGHT  in enumerate PARELEFT  PARERIGHT : EOM
if i  EQUAL  EQUAL  len PARELEFT  PARERIGHT  - 1: EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT layer COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA etrics EQUAL [] COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lstmHypnoModel PARELEFT x_train COMMA  y_train COMMA input1_shape COMMA batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA input_shape EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA etrics EQUAL [] COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def convHypnoModel PARELEFT x_train COMMA  y_train COMMA  input_shape COMMA  max_features EQUAL  COMMA  n_epochs EQUAL  COMMA  class_weight EQUAL  COMMA  1:1 DOT 0} COMMA  batch_size EQUAL  COMMA  kernel_size EQUAL  COMMA  pool_size EQUAL  COMMA  filters EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters COMMA kernel_size COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalMaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA etrics EQUAL [] COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Conv1D COMMA  GlobalAveragePooling1D COMMA  MaxPooling1D EOM
def properHypnoConv PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  30 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA etrics EQUAL [] COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def doubleHypnoConv PARELEFT  PARERIGHT : EOM
main_input  EQUAL  Input PARELEFT shape  EQUAL  PARERIGHT  EOM
x  EQUAL  Conv1D PARELEFT 64 COMMA  30 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Conv1D PARELEFT 64 COMMA  10 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  MaxPooling1D PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  GlobalAveragePooling1D PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output_hypno  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
output_arousals  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL [] PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA etrics EQUAL [] COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return modelimport keras EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Input COMMA  Dropout COMMA  Activation EOM
from keras DOT datasets import mnist EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT optimizers import Adam EOM
from keras DOT callbacks import TensorBoard EOM
learning_rate  EQUAL  0 DOT 001 EOM
training_iters  EQUAL  3 EOM
batch_size  EQUAL  128 EOM
display_step  EQUAL  10 EOM
n_input  EQUAL  28 EOM
n_step  EQUAL  28 EOM
n_hidden  EQUAL  128 EOM
n_classes  EQUAL  10 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
x_train  EQUAL  x_train DOT reshape PARELEFT  PARERIGHT  EOM
x_test  EQUAL  x_test DOT reshape PARELEFT  PARERIGHT  EOM
x_train  EQUAL  x_train DOT astype PARELEFT  PARERIGHT  EOM
x_test  EQUAL  x_test DOT astype PARELEFT  PARERIGHT  EOM
x_train / EQUAL  255 EOM
x_test / EQUAL  255 EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT  PARERIGHT  EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT n_hidden COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dense PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
predictions  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
adam  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA   ss EQUAL  COMMA   trics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA   tch_size EQUAL  COMMA   ochs EQUAL  COMMA   rbose EQUAL  COMMA   alidation_data EQUAL  PARELEFT  PARERIGHT  COMMA llbacks EQUAL [] PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
from keras import Input EOM
from keras DOT engine import Model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Flatten COMMA  Dense COMMA  Dropout EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT optimizers import SGD EOM
from keras DOT optimizers import Adam COMMA  RMSprop COMMA  Adagrad EOM
from keras DOT layers import LSTM COMMA  Convolution1D COMMA  LeakyReLU COMMA  MaxPooling1D COMMA  UpSampling1D COMMA  Merge COMMA  Conv1D COMMA  concatenate EOM
from keras DOT utils DOT vis_utils import plot_model EOM
from keras DOT models import load_model EOM
import io EOM
import time EOM
t0  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 37 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
t1  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
tt  EQUAL  t1 - t0 EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Input EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
import numpy as np EOM
import keras DOT preprocessing DOT text as prep EOM
import keras DOT preprocessing DOT sequence as seq EOM
from keras import backend as K EOM
import  sklearn DOT cluster as clu EOM
from matplotlib import pyplot as plt EOM
from keras DOT utils DOT visualize_util import plot EOM
text EQUAL file DOT readlines PARELEFT  PARERIGHT  EOM
toknizer EQUAL prep DOT Tokenizer PARELEFT  PARERIGHT  EOM
toknizer DOT fit_on_texts PARELEFT texts EQUAL  PARERIGHT  EOM
data EQUAL toknizer DOT texts_to_sequences PARELEFT texts EQUAL  PARERIGHT  EOM
data EQUAL np DOT asanyarray PARELEFT  PARERIGHT  EOM
maxlen EQUAL [] EOM
maxlen EQUAL maxlen[] EOM
vocabSize EQUAL toknizer DOT word_index DOT __len__ PARELEFT  PARERIGHT  EOM
data EQUAL seq DOT pad_sequences PARELEFT sequences EQUAL  COMMA padding EQUAL  PARERIGHT  EOM
X_train EQUAL data EOM
Y_train EQUAL np DOT eye PARELEFT data DOT __len__ PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_length EQUAL  COMMA activation EQUAL  COMMA  inner_activation EQUAL  COMMA return_sequences EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT data DOT __len__ PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
get_lstm_layer_output  EQUAL  K DOT function PARELEFT [] DOT input] COMMA [] PARERIGHT  EOM
y EQUAL model DOT predict PARELEFT x EQUAL  PARERIGHT  EOM
labels EQUAL [] EOM
lstmout EQUAL get_lstm_layer_output PARELEFT  PARERIGHT [] EOM
y_pred EQUAL kmeans DOT fit_predict PARELEFT  PARERIGHT  EOM
saveFile EQUAL  EOM
w EQUAL open PARELEFT  PARERIGHT  EOM
tmp EQUAL [] EOM
for i COMMA v in enumerate PARELEFT  PARERIGHT : EOM
tmp DOT append PARELEFT str PARELEFT  PARERIGHT ++v PARERIGHT  EOM
tmp EQUAL sorted PARELEFT  PARERIGHT  EOM
for i in tmp: EOM
w DOT write PARELEFT  PARERIGHT from keras DOT models import Sequential COMMA Model EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT core import Reshape COMMA  Permute EOM
from keras DOT layers import Merge COMMA concatenate EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
import numpy as np EOM
def model_cnn_lstm_adam_binary PARELEFT inputShape COMMA batchSize EQUAL  COMMA stateful EQUAL  PARERIGHT : EOM
optimizer  EQUAL  EOM
loss  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 4 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +inputShape PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape  EQUAL  model DOT layers[] DOT output_shape EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape[] COMMA np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_cnn_lstm_adam_binary_dropout PARELEFT inputShape COMMA batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
optimizer  EQUAL  EOM
loss  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 4 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +inputShape PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape  EQUAL  model DOT layers[] DOT output_shape EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape[] COMMA np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_cnn_lstm_adam PARELEFT inputShape COMMA  numClasses EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  PARERIGHT : EOM
optimizer  EQUAL  EOM
loss  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 4 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +inputShape PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape  EQUAL  model DOT layers[] DOT output_shape EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape[] COMMA np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_branched_cnn_mixed_lstm_binary PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_branched_cnn_mixed_lstm_regression PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA umFilter EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
from keras DOT layers import Input EOM
def model_branched_cnn_mixed_lstm_binary_functional PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
input1  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  EOM
input2  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
output1  EQUAL  branch1 PARELEFT  PARERIGHT  EOM
output2  EQUAL  branch2 PARELEFT  PARERIGHT  EOM
mergedInput  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_branched_cnn_mixed_lstm_regression_padding PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA  numUnitLSTM EQUAL  COMMA batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
input1  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  EOM
input2  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape1  EQUAL  branch1 DOT layers[] DOT output_shape EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape1[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nPadTo  EQUAL  int PARELEFT np DOT ceil PARELEFT  PARERIGHT  * ntOut PARERIGHT  EOM
nPadding  EQUAL   PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT ZeroPadding1D PARELEFT padding EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
output1  EQUAL  branch1 PARELEFT  PARERIGHT  EOM
output2  EQUAL  branch2 PARELEFT  PARERIGHT  EOM
mergedInput  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT numUnitLSTM COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT numUnitLSTM COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
from keras DOT layers import ZeroPadding1D EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT core import Reshape COMMA  Permute EOM
from keras DOT layers import Merge COMMA  concatenate COMMA  BatchNormalization EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
def model_branched_cnn_mixed_lstm_regression_batchNorm PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA umUnitLSTM EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
input1  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  EOM
input2  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape1  EQUAL  branch1 DOT layers[] DOT output_shape EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape1[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nPadTo  EQUAL  int PARELEFT np DOT ceil PARELEFT  PARERIGHT  * ntOut PARERIGHT  EOM
nPadding  EQUAL   PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT ZeroPadding1D PARELEFT padding EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
output1  EQUAL  branch1 PARELEFT  PARERIGHT  EOM
output2  EQUAL  branch2 PARELEFT  PARERIGHT  EOM
mergedInput  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT numUnitLSTM COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  BatchNormalization PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT numUnitLSTM COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  BatchNormalization PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_branched_cnn_mixed_lstm_regression_functional PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
input1  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  EOM
input2  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
output1  EQUAL  branch1 PARELEFT  PARERIGHT  EOM
output2  EQUAL  branch2 PARELEFT  PARERIGHT  EOM
mergedInput  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_cnn_cat_mixed_lstm_2predict PARELEFT input1Shape COMMA  input2Shape COMMA  numClasses COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
optimizer  EQUAL  EOM
loss  EQUAL  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  1 COMMA  5 COMMA  border_mode EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  1 COMMA  5 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  1 COMMA  5 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  3 COMMA  5 COMMA  border_mode EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  3 COMMA  5 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
convOutShape  EQUAL  model DOT layers[] DOT output_shape EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT np DOT prod PARELEFT  PARERIGHT  COMMA  convOutShape[] PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  lossfrom keras DOT layers import Input COMMA  Dense EOM
from keras DOT models import Model EOM
from keras DOT layers import Flatten EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import GlobalMaxPool1D EOM
from keras DOT layers import Dropout EOM
from keras DOT models import Sequential EOM
def LSTM_Classifier PARELEFT embDim EQUAL  COMMA  lstmDim EQUAL  COMMA  hidDim EQUAL  COMMA  outDim EQUAL  COMMA  maxlen EQUAL  COMMA  max_features EQUAL  PARERIGHT : EOM
model EQUAL Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embDim COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstmDim COMMA  return_sequences EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalMaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT hidDim COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT outDim COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import pandas as pd EOM
from sklearn DOT cross_validation import train_test_split EOM
from sklearn DOT preprocessing import LabelEncoder EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT layers import Embedding EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
def LSTM_fakenews PARELEFT  PARERIGHT : EOM
df  EQUAL  pd DOT read_csv PARELEFT  COMMA  encoding EQUAL  PARERIGHT  EOM
df  EQUAL  df DOT dropna PARELEFT  PARERIGHT  EOM
X_body_text  EQUAL  df DOT text DOT values EOM
X_headline_text  EQUAL  df DOT title DOT values EOM
y  EQUAL  df DOT label DOT values EOM
X_headline_train COMMA  X_headline_test COMMA  y_headline_train COMMA  y_headline_test  EQUAL  train_test_split PARELEFT X_headline_text COMMA  y COMMA  test_size EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
X_body_train COMMA  X_body_test COMMA  y_body_train COMMA  y_body_test  EQUAL  train_test_split PARELEFT X_body_text COMMA  y COMMA  test_size EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
X_headline_list  EQUAL  list PARELEFT  PARERIGHT  EOM
tokenizer  EQUAL  Tokenizer PARELEFT  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
l  EQUAL  len PARELEFT max PARELEFT sequences COMMA key  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
from keras DOT utils import to_categorical EOM
y_train_LSTM  EQUAL  [] EOM
y_test_LSTM  EQUAL  [] EOM
for x in y_headline_train: EOM
if x  EQUAL  EQUAL  : EOM
y_train_LSTM DOT append PARELEFT  PARERIGHT  EOM
else: EOM
y_train_LSTM DOT append PARELEFT  PARERIGHT  EOM
for x in y_headline_test: EOM
if x  EQUAL  EQUAL  : EOM
y_test_LSTM DOT append PARELEFT  PARERIGHT  EOM
else: EOM
y_test_LSTM DOT append PARELEFT  PARERIGHT  EOM
y_train_LSTM  EQUAL  to_categorical PARELEFT y_train_LSTM COMMA  num_classes  EQUAL  PARERIGHT  EOM
y_test_LSTM  EQUAL  to_categorical PARELEFT y_test_LSTM COMMA   num_classes  EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT padded_headline_sequences COMMA  y_train_LSTM COMMA  validation_split EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
test  EQUAL  list PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
pad_test  EQUAL  pad_sequences PARELEFT sequences COMMA  maxlen  EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT pad_test COMMA y_test_LSTM COMMA verbose EQUAL  PARERIGHT  EOM
from keras DOT utils import to_categorical EOM
y_train_LSTM  EQUAL  [] EOM
y_test_LSTM  EQUAL  [] EOM
for x in y_body_train: EOM
if x  EQUAL  EQUAL  : EOM
y_train_LSTM DOT append PARELEFT  PARERIGHT  EOM
else: EOM
y_train_LSTM DOT append PARELEFT  PARERIGHT  EOM
for x in y_body_test: EOM
if x  EQUAL  EQUAL  : EOM
y_test_LSTM DOT append PARELEFT  PARERIGHT  EOM
else: EOM
y_test_LSTM DOT append PARELEFT  PARERIGHT  EOM
y_train_LSTM  EQUAL  to_categorical PARELEFT y_train_LSTM COMMA  num_classes  EQUAL  PARERIGHT  EOM
y_test_LSTM  EQUAL  to_categorical PARELEFT y_test_LSTM COMMA   num_classes  EQUAL  PARERIGHT  EOM
X_body_list  EQUAL  list PARELEFT  PARERIGHT  EOM
tokenizer  EQUAL  Tokenizer PARELEFT  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
l  EQUAL  len PARELEFT max PARELEFT sequences COMMA key  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT padded_body_sequences COMMA  y_train_LSTM COMMA  validation_split EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
test  EQUAL  list PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
pad_test  EQUAL  pad_sequences PARELEFT sequences COMMA  maxlen  EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT pad_test COMMA y_test_LSTM COMMA verbose EQUAL  PARERIGHT  EOM
from datasets import Datasets EOM
import numpy as np EOM
from keras DOT layers DOT core import Dense COMMA  Merge COMMA  Dropout EOM
from keras DOT layers import recurrent EOM
from keras DOT models import Sequential EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
class Fit: EOM
def __init__ PARELEFT self COMMA model EQUAL  COMMA w2v_dim EQUAL  COMMA sent_hidden_size EQUAL  COMMA dropout EQUAL  COMMA query_hidden_size EQUAL  COMMA batch_size EQUAL  COMMA ochs EQUAL  COMMA  vocab_size EQUAL  COMMA  rs EQUAL  COMMA ent_hidden_size2 EQUAL  COMMA  query_hidden_size2 EQUAL  COMMA two_hidden_layers EQUAL  PARERIGHT : EOM
self DOT W2V_DIM  EQUAL  w2v_dim EOM
self DOT SENT_HIDDEN_SIZE  EQUAL  sent_hidden_size EOM
self DOT QUERY_HIDDEN_SIZE  EQUAL  query_hidden_size EOM
self DOT BATCH_SIZE  EQUAL  batch_size EOM
self DOT EPOCHS  EQUAL  epochs EOM
self DOT vocab_size  EQUAL  vocab_size EOM
self DOT SENT_HIDDEN_SIZE2  EQUAL  sent_hidden_size2 EOM
self DOT QUERY_HIDDEN_SIZE2  EQUAL  query_hidden_size2 EOM
self DOT two_hidden_layers  EQUAL  two_hidden_layers EOM
self DOT rs  EQUAL  rs EOM
self DOT dropout  EQUAL  dropout EOM
self DOT X  EQUAL  None EOM
self DOT Xq  EQUAL  None EOM
self DOT Y  EQUAL  None EOM
self DOT answers  EQUAL  None EOM
def compile_layers PARELEFT  PARERIGHT : EOM
RNN  EQUAL  self DOT model EOM
sentrnn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
sentrnn DOT add PARELEFT RNN PARELEFT self DOT W2V_DIM COMMA self DOT SENT_HIDDEN_SIZE COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
sentrnn DOT add PARELEFT Dense PARELEFT self DOT SENT_HIDDEN_SIZE COMMA self DOT SENT_HIDDEN_SIZE2 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
qrnn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
qrnn DOT add PARELEFT RNN PARELEFT self DOT W2V_DIM COMMA  self DOT QUERY_HIDDEN_SIZE COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
qrnn DOT add PARELEFT RNN PARELEFT self DOT QUERY_HIDDEN_SIZE COMMA  self DOT QUERY_HIDDEN_SIZE2 COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT SENT_HIDDEN_SIZE2 + self DOT QUERY_HIDDEN_SIZE2 COMMA  self DOT vocab_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  class_mode EQUAL  PARERIGHT  EOM
self DOT model  EQUAL  model EOM
else: EOM
RNN  EQUAL  self DOT model EOM
sentrnn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
sentrnn DOT add PARELEFT RNN PARELEFT self DOT W2V_DIM COMMA  self DOT SENT_HIDDEN_SIZE COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
if self DOT dropout: EOM
sentrnn DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
qrnn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
qrnn DOT add PARELEFT RNN PARELEFT self DOT W2V_DIM COMMA  self DOT QUERY_HIDDEN_SIZE COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT SENT_HIDDEN_SIZE + self DOT QUERY_HIDDEN_SIZE COMMA  self DOT vocab_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  class_mode EQUAL  PARERIGHT  EOM
self DOT model  EQUAL  model EOM
def run PARELEFT  PARERIGHT : EOM
self DOT X  EQUAL  X EOM
self DOT Xq  EQUAL  Xq EOM
self DOT Y  EQUAL  Y EOM
self DOT model DOT fit PARELEFT [] COMMA  Y COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  show_accuracy EQUAL  COMMA  validation_split  EQUAL  PARERIGHT  EOM
def score PARELEFT  PARERIGHT : EOM
return acc EOM
if __name__  EQUAL  EQUAL  : EOM
passfrom __future__ import print_function EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Embedding EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU EOM
from keras DOT datasets import imdb EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT metrics import  PARELEFT  PARERIGHT  EOM
from sklearn import metrics EOM
from sklearn DOT preprocessing import Normalizer EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
X  EQUAL  traindata DOT iloc[] EOM
Y  EQUAL  traindata DOT iloc[] EOM
C  EQUAL  testdata DOT iloc[] EOM
T  EQUAL  testdata DOT iloc[] EOM
scaler  EQUAL  Normalizer PARELEFT  PARERIGHT  DOT fit PARELEFT  PARERIGHT  EOM
trainX  EQUAL  scaler DOT transform PARELEFT  PARERIGHT  EOM
np DOT set_printoptions PARELEFT precision EQUAL  PARERIGHT  EOM
scaler  EQUAL  Normalizer PARELEFT  PARERIGHT  DOT fit PARELEFT  PARERIGHT  EOM
testT  EQUAL  scaler DOT transform PARELEFT  PARERIGHT  EOM
np DOT set_printoptions PARELEFT precision EQUAL  PARERIGHT  EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testT COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
csv_logger  EQUAL  CSVLogger PARELEFT  COMMA separator EQUAL  COMMA  append EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from absl DOT testing import parameterized EOM
import numpy as np EOM
from tensorflow DOT python import keras EOM
from tensorflow DOT python DOT eager import context EOM
from tensorflow DOT python DOT keras import keras_parameterized EOM
from tensorflow DOT python DOT keras import testing_utils EOM
from tensorflow DOT python DOT platform import test EOM
from tensorflow DOT python DOT training import adam EOM
from tensorflow DOT python DOT training import gradient_descent EOM
class LSTMLayerTest PARELEFT  PARERIGHT : EOM
def test_return_sequences_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA return_sequences EOM
def test_static_shape_inference_LSTM PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
inputs  EQUAL  keras DOT layers DOT Dense PARELEFT embedding_dim COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
outputs  EQUAL  model DOT layers[] DOT output EOM
self DOT assertEqual PARELEFT outputs DOT shape DOT as_list PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def test_dynamic_behavior_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT mspropmse EOM
x  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_dropout_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA dropout: 0 DOT 1} COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_implementation_mode_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA implementation EOM
def test_constraints_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
k_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
r_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
b_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  COMMA recurrent_constraint EQUAL  COMMA bias_constraint EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
def test_with_masking_layer_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layer_class PARELEFT units EQUAL  COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_masking_with_stacking_LSTM PARELEFT  PARERIGHT : EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_cells  EQUAL  [] EOM
model DOT add PARELEFT keras DOT layers DOT RNN PARELEFT lstm_cells COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_from_config_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
for stateful in  PARELEFT  PARERIGHT : EOM
l1  EQUAL  layer_class PARELEFT units EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
l2  EQUAL  layer_class DOT from_config PARELEFT l1 DOT get_config PARELEFT  PARERIGHT  PARERIGHT  EOM
assert l1 DOT get_config PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL       output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL [] PARERIGHT  EOM
else: EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_non_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [keras DOT backend DOT random_normal_variable PARELEFT  PARERIGHT  COMMA  0 COMMA  1 PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_reset_states_with_values PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  stateful EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
assert len PARELEFT  PARERIGHT   EQUAL     assert layer DOT states[] is not None EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT zeros PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
state_shapes  EQUAL  [] EOM
values  EQUAL  [] EOM
if len PARELEFT  PARERIGHT   EQUAL       values  EQUAL  values[] EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT ones PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
with self DOT assertRaises PARELEFT  PARERIGHT : EOM
layer DOT reset_states PARELEFT [] *  PARELEFT len PARELEFT  PARERIGHT  + 1 PARERIGHT  PARERIGHT  EOM
def test_specify_state_with_masking PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
_  EQUAL  keras DOT layers DOT Masking PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_return_state PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
state  EQUAL  outputs[] EOM
assert len PARELEFT  PARERIGHT   EQUAL     model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
state  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA  state COMMA  atol EQUAL  PARERIGHT  EOM
def test_state_reuse PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
output COMMA  state  EQUAL  outputs[] COMMA  outputs[] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT output COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
outputs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def test_initial_states_as_other_inputs PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
num_states  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
main_inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
inputs  EQUAL  [] + initial_state EOM
layer  EQUAL  layer_class PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
main_inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_regularizers_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  COMMA activity_regularizer EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  3 PARERIGHT  EOM
x  EQUAL  keras DOT backend DOT variable PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer PARELEFT  PARERIGHT  EOM
if context DOT executing_eagerly PARELEFT  PARERIGHT : EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  4 PARERIGHT  EOM
else: EOM
self DOT assertEqual PARELEFT len PARELEFT layer DOT get_losses_for PARELEFT  PARERIGHT  PARERIGHT  COMMA  1 PARERIGHT  EOM
def test_statefulness_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT 4 COMMA embedding_dim COMMA mask_zero EQUAL  COMMA input_length EQUAL  COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT ts COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  weights EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  PARELEFT  PARERIGHT  COMMA oss EQUAL  COMMA  run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
out1  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT out1 DOT shape COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
out2  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out1 DOT max PARELEFT  PARERIGHT  COMMA  out2 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
out3  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out2 DOT max PARELEFT  PARERIGHT  COMMA  out3 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
out4  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out3 COMMA  out4 COMMA  atol EQUAL  PARERIGHT  EOM
out5  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out4 DOT max PARELEFT  PARERIGHT  COMMA  out5 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
left_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
left_padded_input[]  EQUAL  0 EOM
left_padded_input[]  EQUAL  0 EOM
out6  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
right_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
right_padded_input[]  EQUAL  0 EOM
right_padded_input[]  EQUAL  0 EOM
out7  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out7 COMMA  out6 COMMA  atol EQUAL  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
test DOT main PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
import numpy as np EOM
max_features  EQUAL  1000 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
batch_size  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA  epochs EQUAL  COMMA  shuffle EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT Source: EOM
import numpy EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
filename  EQUAL  EOM
raw_text  EQUAL  open PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  EOM
raw_text  EQUAL  raw_text DOT lower PARELEFT  PARERIGHT  EOM
chars  EQUAL  sorted PARELEFT list PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
char_to_int  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
n_chars  EQUAL  len PARELEFT  PARERIGHT  EOM
n_vocab  EQUAL  len PARELEFT  PARERIGHT  EOM
seq_length  EQUAL  100 EOM
dataX  EQUAL  [] EOM
dataY  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
seq_in  EQUAL  raw_text[] EOM
seq_out  EQUAL  raw_text[] EOM
dataX DOT append PARELEFT  PARERIGHT  EOM
dataY DOT append PARELEFT  PARERIGHT  EOM
n_patterns  EQUAL  len PARELEFT  PARERIGHT  EOM
X  EQUAL  numpy DOT reshape PARELEFT dataX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
X DOT shape EOM
X  EQUAL  X / float PARELEFT  PARERIGHT  EOM
y  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
filepath EQUAL  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
model DOT fit PARELEFT X COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
import sys EOM
import numpy EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
filename  EQUAL  EOM
raw_text  EQUAL  open PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  EOM
raw_text  EQUAL  raw_text DOT lower PARELEFT  PARERIGHT  EOM
chars  EQUAL  sorted PARELEFT list PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
char_to_int  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
int_to_char  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
n_chars  EQUAL  len PARELEFT  PARERIGHT  EOM
n_vocab  EQUAL  len PARELEFT  PARERIGHT  EOM
seq_length  EQUAL  100 EOM
dataX  EQUAL  [] EOM
dataY  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
seq_in  EQUAL  raw_text[] EOM
seq_out  EQUAL  raw_text[] EOM
dataX DOT append PARELEFT  PARERIGHT  EOM
dataY DOT append PARELEFT  PARERIGHT  EOM
n_patterns  EQUAL  len PARELEFT  PARERIGHT  EOM
X  EQUAL  numpy DOT reshape PARELEFT dataX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
X  EQUAL  X / float PARELEFT  PARERIGHT  EOM
y  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
filename  EQUAL  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
start  EQUAL  numpy DOT random DOT randint PARELEFT 0 COMMA  len PARELEFT  PARERIGHT -1 PARERIGHT  EOM
pattern  EQUAL  dataX[] EOM
for i in range PARELEFT  PARERIGHT : EOM
X  EQUAL  numpy DOT reshape PARELEFT pattern COMMA   PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
X  EQUAL  x / float PARELEFT  PARERIGHT  EOM
prediction  EQUAL  model DOT predict PARELEFT x COMMA  verbose EQUAL  PARERIGHT  EOM
index  EQUAL  numpy DOT argmax PARELEFT  PARERIGHT  EOM
result  EQUAL  int_to_char[] EOM
seq_in  EQUAL  [] for value in pattern] EOM
sys DOT stdout DOT write PARELEFT  PARERIGHT  EOM
pattern DOT append PARELEFT  PARERIGHT  EOM
pattern  EQUAL  pattern[] EOM
import numpy as np EOM
import tensorflow as tf EOM
import tensorflow DOT keras DOT layers as layers EOM
from AutoconLayer import AutoconLayer EOM
def get_bartimaeus PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT LSTM PARELEFT rec_units COMMA  input_shape EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT dense_units COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 22 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_rnn PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT SimpleRNN PARELEFT rec_units COMMA  input_shape EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT dense_units COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 22 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_dwarf PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT LSTM PARELEFT rec_units COMMA  input_shape EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 22 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_nathanael PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT LSTM PARELEFT 60 COMMA  input_shape EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 22 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_ptolemaeus PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT LSTM PARELEFT 60 COMMA  input_shape EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 22 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_grindelwald PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT LSTM PARELEFT 80 COMMA  input_shape EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 22 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_autoconceptor PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT AutoconLayer PARELEFT output_dim EQUAL  COMMA  alpha EQUAL  COMMA  lam EQUAL  COMMA  batchsize EQUAL  COMMA  layer_norm EQUAL  COMMA  reuse EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 22 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import print_function COMMA  division EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT recurrent import SimpleRNN COMMA  LSTM EOM
from keras DOT layers DOT noise import GaussianDropout EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
import theano EOM
import theano DOT tensor as T EOM
def build_feed_forward PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_train_rnn_mse PARELEFT dx COMMA  dh COMMA  do COMMA  span EQUAL  COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_test_rnn_mse PARELEFT dx COMMA  dh COMMA  do COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_simple_rnn_stateful PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT dh COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_stacked_rnn PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT do COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_train_lstm_mse PARELEFT dx COMMA  dh COMMA  do COMMA  span EQUAL  COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_test_lstm_mse PARELEFT dx COMMA  dh COMMA  do COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_lstm_stateful PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_train_lstm_softmax PARELEFT dx COMMA  dh COMMA  do COMMA  span EQUAL  COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_test_lstm_softmax PARELEFT dx COMMA  dh COMMA  do COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_lstm_stateful_softmax PARELEFT dx COMMA  dh COMMA  do COMMA  length EQUAL  COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_stacked_lstm_dropout_stateful_softmax PARELEFT dx COMMA  dh COMMA  do COMMA  length EQUAL  COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_train_stacked_lstm_dropout_softmax PARELEFT dx COMMA  dh COMMA  do COMMA  span EQUAL  COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_test_stacked_lstm_dropout_softmax PARELEFT dx COMMA  dh COMMA  do COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_train_stacked_lstm_dropout_mse PARELEFT dx COMMA  dh COMMA  do COMMA  span EQUAL  COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_test_stacked_lstm_dropout_mse PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_stacked_lstm PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_stacked_lstm_mse_stateful PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_stacked_lstm_mse_stateful_dropout PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_stacked_lstm_regularized PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA activation EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_stacked_lstm_regularized_dropout PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA activation EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_stacked_lstm_regularized_dropout_batchnorm PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA activation EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def build_overkill_stacked_lstm_regularized_dropout PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT do COMMA input_dim EQUAL  COMMA return_sequences EQUAL  COMMA activation EQUAL  COMMA W_regularizer EQUAL  COMMA U_regularizer EQUAL  COMMA b_regularizer EQUAL  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
def last_mse PARELEFT  PARERIGHT : EOM
yt  EQUAL  y_true[] EOM
yp  EQUAL  y_pred[] EOM
se  EQUAL  T DOT mean PARELEFT T DOT square PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  EOM
return se EOM
def get_hidden PARELEFT  PARERIGHT : EOM
get_activations  EQUAL  theano DOT function PARELEFT odel DOT layers[] DOT input] COMMA  model DOT layers[] DOT output COMMA  allow_input_downcast EQUAL  PARERIGHT  EOM
return get_activations EOM
def build_softmax_rnn PARELEFT dx COMMA  dh COMMA  do COMMA  length COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT dh COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
if weights is not None: EOM
model DOT set_weights PARELEFT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
dummy_params  EQUAL  10 COMMA  15 COMMA  5 COMMA  0 COMMA  None EOM
build_lstm PARELEFT  PARERIGHT  EOM
build_simple_rnn PARELEFT  PARERIGHT  EOM
build_softmax_rnn PARELEFT  PARERIGHT  EOM
build_stacked_lstm_dropout PARELEFT  PARERIGHT import keras EOM
from keras DOT models import Sequential COMMA  save_model EOM
from keras DOT layers import LSTM EOM
import keras DOT backend as K EOM
base_path  EQUAL  EOM
backend  EQUAL  K DOT backend PARELEFT  PARERIGHT  EOM
version  EQUAL  keras DOT __version__ EOM
major_version  EQUAL  int PARELEFT  PARERIGHT  EOM
n_in  EQUAL  4 EOM
n_out  EQUAL  6 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_out COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Embedding COMMA  LSTM COMMA  Dense COMMA  Dropout COMMA  Bidirectional COMMA  TimeDistributed COMMA  Activation COMMA  Convolution1D COMMA  MaxPool1D EOM
from keras DOT models import Model EOM
from keras DOT preprocessing import sequence EOM
use_dropout  EQUAL  True EOM
def LSTM_Model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def LSTM2Layer_Model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def BiLSTM_Model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def CLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT 128 COMMA  3 COMMA  padding EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def CBiLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT 128 COMMA  3 COMMA  padding EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
CBiLSTM PARELEFT  PARERIGHT import os EOM
global_model_version  EQUAL  40 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  59 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import numpy as np EOM
from keras DOT preprocessing DOT text import one_hot EOM
from keras_preprocessing import sequence EOM
from keras import Sequential EOM
from keras DOT models import load_model EOM
from keras DOT layers import Embedding COMMA  LSTM COMMA  Dense COMMA  Dropout EOM
import matplotlib DOT pyplot as plt EOM
import sys EOM
negative  EQUAL  open PARELEFT  PARERIGHT  DOT readlines PARELEFT  PARERIGHT  EOM
positive  EQUAL  open PARELEFT  PARERIGHT  DOT readlines PARELEFT  PARERIGHT  EOM
temp  EQUAL  [] EOM
for line in negative: EOM
temp DOT append PARELEFT line DOT strip PARELEFT  PARERIGHT  PARERIGHT  EOM
negative  EQUAL  temp DOT copy PARELEFT  PARERIGHT  EOM
temp  EQUAL  [] EOM
for line in positive: EOM
temp DOT append PARELEFT line DOT strip PARELEFT  PARERIGHT  PARERIGHT  EOM
positive  EQUAL  temp DOT copy PARELEFT  PARERIGHT  EOM
positive  EQUAL  [] EOM
negative  EQUAL  [] EOM
negative_vocab  EQUAL  len PARELEFT sorted PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
positive_vocab  EQUAL  len PARELEFT sorted PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vocab  EQUAL  len PARELEFT sorted PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
encoded_negative  EQUAL  [] EOM
encoded_positive  EQUAL  [] EOM
x_train  EQUAL  encoded_positive[] + encoded_negative[] EOM
x_test  EQUAL  encoded_positive[] + encoded_negative[] EOM
y_train  EQUAL  [] * 7000 + [] * 7000 EOM
y_test  EQUAL  [] * 2926 + [] * 2704 EOM
max_review_length  EQUAL  350 EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test COMMA  maxlen EQUAL  PARERIGHT  EOM
if len PARELEFT  PARERIGHT  < EQUAL     embedding_vector_length  EQUAL  32 EOM
dropout_rate  EQUAL  0 DOT 2 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  validation_split EQUAL  COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
del model EOM
model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
bad  EQUAL  EOM
good  EQUAL  EOM
bad_  EQUAL  one_hot PARELEFT  PARERIGHT  EOM
good_  EQUAL  one_hot PARELEFT  PARERIGHT  EOM
bad_encoded  EQUAL  sequence DOT pad_sequences PARELEFT [] COMMA  maxlen EQUAL  PARERIGHT  EOM
good_encoded  EQUAL  sequence DOT pad_sequences PARELEFT [] COMMA  maxlen EQUAL  PARERIGHT  EOM
from keras import optimizers EOM
import numpy as np EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT ensemble import BaggingClassifier COMMA  RandomForestClassifier COMMA  \ EOM
ExtraTreesClassifier COMMA  AdaBoostClassifier COMMA  GradientBoostingClassifier COMMA  \ EOM
VotingClassifier EOM
from sklearn DOT naive_bayes import GaussianNB EOM
from sklearn DOT linear_model import LogisticRegression EOM
from mlxtend DOT classifier import StackingCVClassifier EOM
def create_ffNN PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT 100 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 50 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 9 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
adam  EQUAL  optimizers DOT Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_LSTM PARELEFT optimizer EQUAL  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 9 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_biLSTM PARELEFT optimizer EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 9 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def best_ensemble PARELEFT  PARERIGHT : EOM
bagging_clf  EQUAL  BaggingClassifier PARELEFT n_estimators EQUAL  COMMA  max_features EQUAL  COMMA random_state EQUAL  PARERIGHT  EOM
rf_clf  EQUAL  RandomForestClassifier PARELEFT n_estimators EQUAL  COMMA  max_features EQUAL  COMMA riterion EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
return zip PARELEFT  PARERIGHT  EOM
def stacking PARELEFT  PARERIGHT : EOM
for  PARELEFT  PARERIGHT  in best_ensemble PARELEFT  PARERIGHT : EOM
classifiers DOT append PARELEFT  PARERIGHT  EOM
superlearner  EQUAL  RandomForestClassifier PARELEFT random_state EQUAL  PARERIGHT  EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
stacking_clf  EQUAL  StackingCVClassifier PARELEFT classifiers COMMA eta_classifier EQUAL  COMMA  cv EQUAL  PARERIGHT  EOM
return stacking_clffrom numpy import array EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import LSTM EOM
length  EQUAL  5 EOM
seq  EQUAL  array PARELEFT [] PARERIGHT  EOM
X  EQUAL  seq DOT reshape PARELEFT  PARERIGHT  EOM
y  EQUAL  seq DOT reshape PARELEFT  PARERIGHT  EOM
n_neurons  EQUAL  length EOM
n_batch  EQUAL  1 EOM
n_epoch  EQUAL  1000 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_neurons COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
result  EQUAL  model DOT predict PARELEFT X COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
for value in result[]: EOM
from keras DOT models import Model EOM
from keras DOT layers import Input EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Bidirectional EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT merge import concatenate EOM
from keras DOT models import Sequential EOM
import numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
emb_size  EQUAL  8 EOM
filters  EQUAL  3 EOM
lstm_number  EQUAL  10 EOM
def multiple PARELEFT  PARERIGHT : EOM
inputs1  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding1  EQUAL  Embedding PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
dropout1_0  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv1  EQUAL  Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
pool1  EQUAL  MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
dropout1_1  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
b_lstm1  EQUAL  Bidirectional PARELEFT LSTM PARELEFT lstm_number COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm1  EQUAL  Bidirectional PARELEFT LSTM PARELEFT lstm_number COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
inputs2  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding2  EQUAL  Embedding PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
dropout2_0  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv2  EQUAL  Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
pool2  EQUAL  MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
dropout2_1  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
b_lstm2  EQUAL  Bidirectional PARELEFT LSTM PARELEFT lstm_number COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm2  EQUAL  Bidirectional PARELEFT LSTM PARELEFT lstm_number COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
inputs3  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding3  EQUAL  Embedding PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
dropout3_0  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv3  EQUAL  Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
pool3  EQUAL  MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
dropout3_1  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
b_lstm3  EQUAL  Bidirectional PARELEFT LSTM PARELEFT lstm_number COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm3  EQUAL  Bidirectional PARELEFT LSTM PARELEFT lstm_number COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
merged  EQUAL  concatenate PARELEFT  PARERIGHT  EOM
dropout  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
outputs  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model EOM
def cnn_blstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  emb_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters COMMA  3 COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_number COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_number COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom loop import vector EOM
from keras DOT models import model_from_json EOM
from data import embedding COMMA  dev_data COMMA  train_data EOM
import tqdm EOM
import json EOM
import numpy as np EOM
from loop import make_generator EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Dropout COMMA  Flatten EOM
EMBEDDING_DIMS  EQUAL  300 EOM
CONTEXT_LENGTH  EQUAL  700 EOM
QUESTION_LENGTH  EQUAL  40 EOM
cenc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
cenc DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
cenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
qenc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
qenc DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
qenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
aenc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
aenc DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
aenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
facts  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
facts DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  dot_axes EQUAL [] PARERIGHT  PARERIGHT  EOM
attn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
attn DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  dot_axes EQUAL [] PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
results  EQUAL  [] EOM
for i in tqdm DOT tqdm PARELEFT range PARELEFT  PARERIGHT  PARERIGHT : EOM
prediction  EQUAL  [] EOM
c COMMA  q COMMA  a  EQUAL  train_data[] EOM
c_vec  EQUAL  vector PARELEFT c COMMA  pad_to EQUAL  PARERIGHT  EOM
q_vec  EQUAL  vector PARELEFT q COMMA  pad_to EQUAL  PARERIGHT  EOM
C  EQUAL  [] EOM
Q  EQUAL  [] EOM
A  EQUAL  [] EOM
for word in c: EOM
C DOT append PARELEFT  PARERIGHT  EOM
Q DOT append PARELEFT  PARERIGHT  EOM
A DOT append PARELEFT vector PARELEFT [] COMMA  pad_to EQUAL  PARERIGHT  PARERIGHT  EOM
C COMMA  Q COMMA  A  EQUAL  map PARELEFT np DOT array COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
P  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
for i COMMA  word in enumerate PARELEFT  PARERIGHT : EOM
prediction DOT append PARELEFT {		: word COMMA 		: float PARELEFT  PARERIGHT 		} PARERIGHT  EOM
results DOT append PARELEFT {:  DOT join PARELEFT  PARERIGHT  COMMA :  DOT join PARELEFT  PARERIGHT  COMMA :  DOT join PARELEFT  PARERIGHT  COMMA 	: prediction	} PARERIGHT  EOM
json DOT dump PARELEFT results COMMA  open PARELEFT  PARERIGHT  COMMA  indent EQUAL  PARERIGHT from keras DOT models import Sequential EOM
from keras import layers EOM
import numpy as np EOM
from six DOT moves import range EOM
import sys EOM
import os EOM
from keras DOT models import load_model EOM
import keras EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense COMMA Dropout COMMA Activation EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Bidirectional EOM
import time EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT utils import plot_model EOM
from keras DOT layers DOT embeddings import Embedding EOM
class SenseModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT lstmunits  EQUAL lstmunits EOM
self DOT lstmLayerNum  EQUAL  lstmLayerNum EOM
self DOT DenseUnits  EQUAL  DenseUnits EOM
self DOT charlenth  EQUAL  charlenth EOM
self DOT datalenth  EQUAL  datalenth EOM
self DOT buildmodel PARELEFT  PARERIGHT  EOM
def buildmodel PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT layers DOT LSTM PARELEFT self DOT lstmunits COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT layers DOT LSTM PARELEFT self DOT lstmunits COMMA  return_sequences EQUAL  COMMA activation EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model DOT summary PARELEFT  PARERIGHT  EOM
def trainModel PARELEFT  PARERIGHT : EOM
for cur in range PARELEFT  PARERIGHT : EOM
self DOT model DOT fit PARELEFT x COMMA  y COMMA batch_size EQUAL  COMMA epochs EQUAL  PARERIGHT  EOM
mdname EQUAL savename++str PARELEFT  PARERIGHT  EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL : EOM
a  EQUAL  SenseModel PARELEFT  PARERIGHT import os EOM
global_model_version  EQUAL  52 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Dropout COMMA  Bidirectional EOM
from keras DOT layers import LSTM EOM
def model_0 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  EOM
def model_1 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  COMMA  merge_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  EOM
def model_7 PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  EOM
def model_8 PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  input_shape EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  EOM
def model_9 PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  PARERIGHT  COMMA input_shape EQUAL  COMMA merge_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  PARERIGHT  COMMA merge_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  import keras EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Input COMMA  Dropout COMMA  Activation EOM
from keras DOT datasets import mnist EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT optimizers import Adam EOM
from keras DOT callbacks import TensorBoard EOM
learning_rate  EQUAL  0 DOT 001 EOM
training_iters  EQUAL  3 EOM
batch_size  EQUAL  128 EOM
display_step  EQUAL  10 EOM
n_input  EQUAL  28 EOM
n_step  EQUAL  28 EOM
n_hidden  EQUAL  128 EOM
n_classes  EQUAL  10 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
x_train  EQUAL  x_train DOT reshape PARELEFT  PARERIGHT  EOM
x_test  EQUAL  x_test DOT reshape PARELEFT  PARERIGHT  EOM
x_train  EQUAL  x_train DOT astype PARELEFT  PARERIGHT  EOM
x_test  EQUAL  x_test DOT astype PARELEFT  PARERIGHT  EOM
x_train / EQUAL  255 EOM
x_test / EQUAL  255 EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT  PARERIGHT  EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT n_hidden COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dense PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
predictions  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
adam  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA   ss EQUAL  COMMA   trics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA   tch_size EQUAL  COMMA   ochs EQUAL  COMMA   rbose EQUAL  COMMA   alidation_data EQUAL  PARELEFT  PARERIGHT  COMMA llbacks EQUAL [] PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT regularizers import l1 COMMA  activity_l1 EOM
def create_simple_LSTM  PARELEFT LSTM_size COMMA  Dense_size COMMA  embeddings COMMA  max_input_length COMMA  is_trainable COMMA  opt  EQUAL  PARERIGHT : EOM
D  EQUAL  embeddings DOT shape[] EOM
out_dim  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim  EQUAL [] COMMA  output_dim EQUAL  COMMA  weights EQUAL [] COMMA  trainable EQUAL  COMMA  input_length  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_size COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Dense_size COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT out_dim COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def create_extreme_LSTM  PARELEFT LSTM_size COMMA  Dense_sizes COMMA  embeddings COMMA  max_input_length COMMA  is_trainable COMMA  opt  EQUAL  PARERIGHT : EOM
D  EQUAL  embeddings DOT shape[] EOM
out_dim  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim  EQUAL [] COMMA output_dim EQUAL  COMMA weights EQUAL [] COMMA trainable EQUAL  COMMA put_length  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
for Dense_size in Dense_sizes: EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def create_stacked_LSTM  PARELEFT LSTM_size COMMA  Dense_sizes COMMA  embeddings COMMA  max_input_length COMMA  is_trainable COMMA  opt  EQUAL  PARERIGHT : EOM
D  EQUAL  embeddings DOT shape[] EOM
out_dim  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim  EQUAL [] COMMA output_dim EQUAL  COMMA weights EQUAL [] COMMA trainable EQUAL  COMMA put_length  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_size COMMA activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_size COMMA activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_size COMMA activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT LSTM_size COMMA activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
for Dense_size in Dense_sizes: EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense  COMMA Dropout COMMA Activation EOM
from keras DOT optimizers import SGD EOM
import pandas as pd EOM
import  matplotlib DOT pyplot as plt EOM
datas EQUAL pd DOT read_excel PARELEFT  PARERIGHT  EOM
X EQUAL datas DOT iloc[] DOT as_matrix PARELEFT  PARERIGHT  EOM
y EQUAL datas DOT iloc[] DOT as_matrix PARELEFT  PARERIGHT  EOM
model EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 26 COMMA input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 26 COMMA input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X COMMA  y COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  shuffle EQUAL  COMMA verbose EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
score EQUAL model DOT evaluate PARELEFT X COMMA y COMMA batch_size EQUAL  PARERIGHT  EOM
p EQUAL model DOT predict PARELEFT X COMMA batch_size EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
fig COMMA  ax  EQUAL  plt DOT subplots PARELEFT  PARERIGHT  EOM
ax DOT scatter PARELEFT  PARERIGHT  EOM
ax DOT plot PARELEFT [] COMMA [] COMMA  COMMA lw EQUAL  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
import numpy as np EOM
import pandas as pd EOM
import os EOM
import matplotlib DOT pyplot as plt EOM
from sklearn DOT decomposition import PCA EOM
from sklearn DOT metrics import mean_squared_error COMMA  r2_score EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from sklearn DOT model_selection import train_test_split EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Bidirectional COMMA  Conv1D EOM
from keras DOT layers import MaxPooling1D COMMA  BatchNormalization COMMA  AveragePooling1D COMMA  GlobalAveragePooling1D EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Flatten EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT initializers import random_normal EOM
from keras DOT callbacks import EarlyStopping EOM
from keras import backend as K EOM
from fixed_leakyrelu import LeakyReLU EOM
n_out  EQUAL  1 EOM
variable_num  EQUAL  33 EOM
n_hidden  EQUAL  32 EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  PARERIGHT  EOM
def rmse PARELEFT  PARERIGHT : EOM
return K DOT sqrt PARELEFT K DOT mean PARELEFT K DOT square PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  PARERIGHT  EOM
def simpleLSTM PARELEFT lstm_nodes EQUAL  COMMA lookback EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_nodes COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def TemporalCNN PARELEFT cnn_nodes EQUAL  COMMA kernel_size  EQUAL  COMMA lookback EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT name  EQUAL  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes COMMA  kernel_size EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def BLSTM PARELEFT lstm_nodes EQUAL  COMMA lookback EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_nodes COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def StackeLSTM PARELEFT lstm_nodes EQUAL  COMMA lookback EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_nodes COMMA  return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_nodes COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def VGG16LIKE PARELEFT lstm_nodes EQUAL  COMMA cnn_nodes EQUAL  COMMA base_fc_nodes  EQUAL  COMMA kernel_size EQUAL  COMMA lookback EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT name  EQUAL  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes*2 COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes*2 COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes*3 COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes*3 COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes*3 COMMA kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes*3 COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT int PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_nodes COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def VGG_BLSTM PARELEFT lstm_nodes EQUAL  COMMA cnn_nodes EQUAL  COMMA base_fc_nodes  EQUAL  COMMA kernel_size EQUAL  COMMA lookback EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT name  EQUAL  EOM
model DOT add PARELEFT 1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT v1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT v1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT v1D PARELEFT cnn_nodes*2 COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT v1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT nv1D PARELEFT cnn_nodes*4 COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT v1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT int PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
Activation PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_nodes COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def VGG_BLSTM_LeakyReLU PARELEFT lstm_nodes EQUAL  COMMA cnn_nodes EQUAL  COMMA base_fc_nodes  EQUAL  COMMA kernel_size EQUAL  COMMA lookback EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT name  EQUAL  EOM
model DOT add PARELEFT 1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT 1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT 1D PARELEFT cnn_nodes*2 COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT 1D PARELEFT cnn_nodes*4 COMMA  kernel_size COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT cnn_nodes COMMA  kernel_size COMMA  padding EQUAL  COMMA  kernel_initializer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT int PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT LeakyReLU PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_nodes COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_out COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
model  EQUAL  VGG_BLSTM PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  LSTM COMMA  Bidirectional EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT layers import Dense COMMA  GlobalAveragePooling1D EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Dropout COMMA  Embedding COMMA  Flatten COMMA  Input COMMA  Convolution1D COMMA  MaxPooling1D EOM
from keras DOT layers import Conv1D COMMA  concatenate EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras import regularizers EOM
def cnn PARELEFT  PARERIGHT : EOM
embedding_dim EQUAL  300 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA  tput_dim EQUAL  COMMA  weights EQUAL [] COMMA nput_length EQUAL  COMMA trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  DOT 25 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
graph_in  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
convs  EQUAL  [] EOM
for filter_length in  PARELEFT  PARERIGHT : EOM
conv  EQUAL  Convolution1D PARELEFT nb_filter EQUAL  COMMA ilter_length EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
pool  EQUAL  MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
flatten  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
convs DOT append PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  Model PARELEFT input EQUAL  COMMA  output EQUAL  PARELEFT  PARERIGHT   PARERIGHT   PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA  tput_dim EQUAL  COMMA  weights EQUAL [] COMMA nput_length EQUAL  COMMA nable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  Bidirectional PARELEFT LSTM PARELEFT units EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D EOM
def model PARELEFT max_features  EQUAL  COMMA  maxlen  EQUAL  PARERIGHT : EOM
embedding_size  EQUAL  128 EOM
kernel_size  EQUAL  5 EOM
filters  EQUAL  64 EOM
pool_size  EQUAL  4 EOM
lstm_output_size  EQUAL  70 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters COMMA  kernel_size COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import BatchNormalization EOM
from keras import regularizers EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Convolution1D EOM
from keras DOT layers import MaxPool1D EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import concatenate EOM
from keras DOT layers import GRU EOM
from keras DOT layers import Conv1D EOM
from keras DOT layers import Bidirectional EOM
from keras DOT layers import Permute EOM
from keras DOT layers import merge EOM
from keras DOT models import Model EOM
from keras DOT layers import Reshape EOM
from keras DOT layers import RepeatVector EOM
from keras DOT layers import Input EOM
from keras DOT layers import Activation EOM
from keras DOT layers import Lambda EOM
import keras DOT backend as K EOM
K DOT set_image_dim_ordering PARELEFT  PARERIGHT  EOM
from utils import dense_to_one_hot EOM
from utils import labels_smooth EOM
from utils import Attention_layer EOM
from utils import str_to_list EOM
def lstm PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  int PARELEFT  PARERIGHT  EOM
embedding_size  EQUAL  int PARELEFT  PARERIGHT  EOM
dropout_prob  EQUAL  float PARELEFT  PARERIGHT  EOM
l2_reg_scala  EQUAL  float PARELEFT  PARERIGHT  EOM
units  EQUAL  int PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size + 2 COMMA  embedding_size COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  bias_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def bilstm PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  int PARELEFT  PARERIGHT  EOM
embedding_size  EQUAL  int PARELEFT  PARERIGHT  EOM
units  EQUAL  int PARELEFT  PARERIGHT  EOM
dropout_prob  EQUAL  float PARELEFT  PARERIGHT  EOM
l2_reg_scala  EQUAL  float PARELEFT  PARERIGHT  EOM
length  EQUAL  int PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size + 1 COMMA  embedding_size COMMA  input_length EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Permute PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 1 COMMA  1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  bias_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def bilstm_att PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  int PARELEFT  PARERIGHT  EOM
embedding_size  EQUAL  int PARELEFT  PARERIGHT  EOM
units  EQUAL  int PARELEFT  PARERIGHT  EOM
dropout_prob  EQUAL  float PARELEFT  PARERIGHT  EOM
l2_reg_scala  EQUAL  float PARELEFT  PARERIGHT  EOM
length  EQUAL  int PARELEFT  PARERIGHT  EOM
_input  EQUAL  Input PARELEFT shape EQUAL [] COMMA  name EQUAL  COMMA  dtype EQUAL  PARERIGHT  EOM
embed  EQUAL  Embedding PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
activations  EQUAL  Bidirectional PARELEFT LSTM PARELEFT units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  RepeatVector PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
activations  EQUAL  Permute PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
sent_representation  EQUAL  merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  EOM
sent_representation  EQUAL  Lambda PARELEFT lambda xin: K DOT sum PARELEFT xin COMMA  axis EQUAL  PARERIGHT  COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
prob  EQUAL  Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def gru PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  int PARELEFT  PARERIGHT  EOM
embedding_size  EQUAL  int PARELEFT  PARERIGHT  EOM
dropout_prob  EQUAL  float PARELEFT  PARERIGHT  EOM
l2_reg_scala  EQUAL  float PARELEFT  PARERIGHT  EOM
units  EQUAL  int PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size+1 COMMA  embedding_size COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT embedding_size COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  bias_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def bilstm_att2 PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  int PARELEFT  PARERIGHT  EOM
embedding_size  EQUAL  int PARELEFT  PARERIGHT  EOM
units  EQUAL  int PARELEFT  PARERIGHT  EOM
dropout_prob  EQUAL  float PARELEFT  PARERIGHT  EOM
l2_reg_scala  EQUAL  float PARELEFT  PARERIGHT  EOM
length  EQUAL  int PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size + 1 COMMA  embedding_size COMMA  input_length EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT GRU PARELEFT units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Attention_layer PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  bias_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def mlp PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
vocab_size  EQUAL  int PARELEFT  PARERIGHT  EOM
units  EQUAL  int PARELEFT  PARERIGHT  EOM
dropout_prob  EQUAL  float PARELEFT  PARERIGHT  EOM
l2_reg_scala  EQUAL  float PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def textcnn PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  int PARELEFT  PARERIGHT  EOM
embedding_size  EQUAL  int PARELEFT  PARERIGHT  EOM
dropout_prob  EQUAL  float PARELEFT  PARERIGHT  EOM
l2_reg_scala  EQUAL  float PARELEFT  PARERIGHT  EOM
length  EQUAL  int PARELEFT  PARERIGHT  EOM
filter_sizes  EQUAL  str_to_list PARELEFT  PARERIGHT  EOM
filter_nums  EQUAL  str_to_list PARELEFT  PARERIGHT  EOM
main_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA dtype EQUAL  PARERIGHT  EOM
embed  EQUAL  Embedding PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
cnn_outs  EQUAL  [] EOM
for i COMMA  filter_size in enumerate PARELEFT  PARERIGHT : EOM
filter_num  EQUAL  filter_nums[] EOM
cnn  EQUAL  Convolution1D PARELEFT filter_num COMMA  filter_size COMMA  padding EQUAL  COMMA  strides EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
cnn  EQUAL  MaxPool1D PARELEFT pool_size EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
cnn_outs DOT append PARELEFT  PARERIGHT  EOM
out  EQUAL  concatenate PARELEFT cnn_outs COMMA  axis EQUAL  PARERIGHT  EOM
flat  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
drop  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
main_output  EQUAL  Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return modelfrom keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT models import Sequential EOM
def get_lstm PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT units[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_gru PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT GRU PARELEFT units[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def _get_sae PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT hidden COMMA  input_dim EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_saes PARELEFT  PARERIGHT : EOM
sae2  EQUAL  _get_sae PARELEFT  PARERIGHT  EOM
sae3  EQUAL  _get_sae PARELEFT  PARERIGHT  EOM
saes  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  input_dim EQUAL [] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
models  EQUAL  [] EOM
return modelsimport datetime EOM
import os EOM
import keras EOM
import numpy as np EOM
import pandas as pd EOM
from base_model import BaseModel EOM
from multivariate_container import MultivariateContainer EOM
from typing import Union EOM
class MultivariateLSTM PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA ontainer: MultivariateContainer COMMA onfig: bool EQUAL  COMMA ate_empty: bool EQUAL  PARERIGHT  -> None: EOM
self DOT config  EQUAL  config EOM
self DOT container  EQUAL  container EOM
self DOT hist  EQUAL  None EOM
if create_empty: EOM
self DOT core  EQUAL  None EOM
else: EOM
self DOT core  EQUAL  self DOT _construct_lstm_model PARELEFT  PARERIGHT  EOM
self DOT _gen_file_name PARELEFT  PARERIGHT  EOM
def _construct_lstm_model PARELEFT self COMMA onfig: dict COMMA erbose: bool EQUAL         input_sequence  EQUAL  keras DOT layers DOT Input PARELEFT hape EQUAL  PARELEFT  PARERIGHT  COMMA dtype EQUAL  COMMA name EQUAL  PARERIGHT  EOM
normalization  EQUAL  keras DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  keras DOT layers DOT LSTM PARELEFT units EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
dense1  EQUAL  keras DOT layers DOT Dense PARELEFT units EQUAL [] COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
predictions  EQUAL  keras DOT layers DOT Dense PARELEFT 1 COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  keras DOT Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if verbose: EOM
keras DOT utils DOT print_summary PARELEFT  PARERIGHT  EOM
return model EOM
def _construct_lstm_sequential PARELEFT self COMMA onfig: dict COMMA erbose: bool EQUAL         model  EQUAL  keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT units EQUAL [] COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT units EQUAL [] COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT units EQUAL [] COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT units EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if verbose: EOM
keras DOT utils DOT print_summary PARELEFT  PARERIGHT  EOM
return model EOM
def update_config PARELEFT self COMMA ew_config: dict-> None: EOM
self DOT prev_config  EQUAL  self DOT config EOM
self DOT config  EQUAL  new_config EOM
self DOT core  EQUAL  self DOT _construct_lstm_model PARELEFT self DOT config COMMA  verbose EQUAL  PARERIGHT  EOM
def fit_model PARELEFT self COMMA pochs: int EQUAL         start_time  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
self DOT hist  EQUAL  self DOT core DOT fit PARELEFT self DOT container DOT train_X COMMA self DOT container DOT train_y COMMA epochs EQUAL  COMMA size EQUAL [] COMMA tion_split EQUAL [] PARERIGHT  EOM
finish_time  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
time_taken  EQUAL  finish_time - start_time EOM
def predict PARELEFT self COMMA _feed: np DOT ndarray-> np DOT ndarray: EOM
y_hat  EQUAL  self DOT core DOT predict PARELEFT X_feed COMMA  verbose EQUAL  PARERIGHT  EOM
return y_hat EOM
def save_model PARELEFT elf COMMA  ile_dir: str EQUAL         if file_dir is None: EOM
file_dir  EQUAL  self DOT file_name EOM
try: EOM
folder  EQUAL  f EOM
os DOT system PARELEFT  PARERIGHT  EOM
except: EOM
_  EQUAL  os DOT system PARELEFT  PARERIGHT  EOM
raise FileNotFoundError PARELEFT  to create directory COMMA  please create directory  DOT /saved_models/ EOM
model_json  EQUAL  self DOT core DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
self DOT core DOT save_weights PARELEFT  PARERIGHT  EOM
try: EOM
keras DOT utils DOT plot_model PARELEFT self DOT core COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
except: EOM
if self DOT hist is not None: EOM
hist_loss  EQUAL  np DOT squeeze PARELEFT np DOT array PARELEFT  PARERIGHT  PARERIGHT  EOM
hist_val_loss  EQUAL  np DOT squeeze PARELEFT np DOT array PARELEFT  PARERIGHT  PARERIGHT  EOM
combined  EQUAL  np DOT stack PARELEFT  PARERIGHT  EOM
combined  EQUAL  np DOT transpose PARELEFT  PARERIGHT  EOM
df  EQUAL  pd DOT DataFrame PARELEFT combined COMMA  dtype EQUAL  PARERIGHT  EOM
df DOT columns  EQUAL  [] EOM
df DOT to_csv PARELEFT f COMMA  sep EQUAL  PARERIGHT  EOM
else: EOM
def load_model PARELEFT elf COMMA  older_dir: str-> None: EOM
folder_dir + EQUAL  EOM
try: EOM
json_file  EQUAL  open PARELEFT  PARERIGHT  EOM
except FileNotFoundError: EOM
raise Warning PARELEFT n file not found DOT  Expected: {folder_dir}model_structure DOT json EOM
model_file  EQUAL  json_file DOT read PARELEFT  PARERIGHT  EOM
json_file DOT close PARELEFT  PARERIGHT  EOM
self DOT core  EQUAL  keras DOT models DOT model_from_json PARELEFT  PARERIGHT  EOM
try: EOM
self DOT core DOT load_weights PARELEFT  COMMA  by_name EQUAL  PARERIGHT  EOM
except FileNotFoundError: EOM
raise Warning PARELEFT file not found DOT  Expected: {folder_dir}model_weights DOT h5 EOM
self DOT core DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
def summarize_training PARELEFT  PARERIGHT : EOM
def visualize_training PARELEFT  PARERIGHT : EOM
raise NotImplementedErrorfrom math import sqrt EOM
from numpy import concatenate EOM
from matplotlib import pyplot EOM
import numpy as np EOM
from pandas import read_csv EOM
from pandas import DataFrame EOM
from pandas import concat EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from sklearn DOT preprocessing import LabelEncoder EOM
from sklearn DOT metrics import mean_squared_error EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT core import RepeatVector EOM
from keras DOT models import model_from_yaml EOM
import os EOM
from keras DOT utils import plot_model EOM
from keras DOT utils DOT vis_utils import plot_model EOM
from keras DOT utils DOT vis_utils import model_to_dot EOM
folder_address  EQUAL  EOM
preoutaddress  EQUAL  EOM
malware_class_dir  EQUAL  EOM
apa  EQUAL  1000 EOM
batch  EQUAL  10 EOM
i EQUAL 0 EOM
filenamelist  EQUAL  list PARELEFT  PARERIGHT  EOM
wholefilepath  EQUAL  dir + + filename EOM
filenamelist DOT append PARELEFT  PARERIGHT  EOM
return filenamelist EOM
def data_to_reconstruction_problem PARELEFT  PARERIGHT : EOM
df EQUAL  DataFrame PARELEFT  PARERIGHT  EOM
list_concat  EQUAL  list PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
tempdf  EQUAL  df DOT shift PARELEFT  PARERIGHT  EOM
list_concat DOT append PARELEFT  PARERIGHT  EOM
data_for_autoencoder EQUAL concat PARELEFT list_concat COMMA  axis  EQUAL  PARERIGHT  EOM
data_for_autoencoder DOT dropna PARELEFT inplace  EQUAL  PARERIGHT  EOM
return data_for_autoencoder EOM
def data_to_reconstruction_problem PARELEFT  PARERIGHT : EOM
df EQUAL  DataFrame PARELEFT  PARERIGHT  EOM
list_concat  EQUAL  list PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
tempdf  EQUAL  df DOT shift PARELEFT  PARERIGHT  EOM
list_concat DOT append PARELEFT  PARERIGHT  EOM
data_for_autoencoder EQUAL concat PARELEFT list_concat COMMA  axis  EQUAL  PARERIGHT  EOM
data_for_autoencoder DOT dropna PARELEFT inplace  EQUAL  PARERIGHT  EOM
return data_for_autoencoder EOM
def out_put_core PARELEFT  PARERIGHT : EOM
thefile  EQUAL  open PARELEFT  PARERIGHT  EOM
for item in writting_list: EOM
thefile DOT write PARELEFT  PARERIGHT  EOM
n_apis  EQUAL  16 EOM
n_features  EQUAL  34 EOM
for i in range PARELEFT 0 COMMA len PARELEFT  PARERIGHT  PARERIGHT : EOM
dataset  EQUAL  read_csv PARELEFT filepathlist[] COMMA  header EQUAL  COMMA  index_col EQUAL  PARERIGHT  EOM
values  EQUAL  dataset DOT values EOM
reframed  EQUAL  data_to_reconstruction_problem PARELEFT  PARERIGHT  EOM
reframed  EQUAL  reframed DOT astype PARELEFT  PARERIGHT  EOM
scaler  EQUAL  MinMaxScaler PARELEFT feature_range EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
scaled  EQUAL  scaler DOT fit_transform PARELEFT  PARERIGHT  EOM
dfscaled  EQUAL  DataFrame PARELEFT  PARERIGHT  EOM
train_X  EQUAL  dfscaled DOT values EOM
train_X  EQUAL  train_X DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
sample_number  EQUAL  train_X DOT shape[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
timesstep16  EQUAL  n_apis EOM
timesstep8  EQUAL  int PARELEFT  PARERIGHT  EOM
timesstep4  EQUAL  int PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_features COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT timesstep16 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT timesstep8 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT timesstep16 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_features COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
pyplot DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
pyplot DOT legend PARELEFT  PARERIGHT  EOM
lossepoch  EQUAL   DOT format PARELEFT os DOT path DOT basename PARELEFT  PARERIGHT  PARERIGHT  EOM
pyplot DOT savefig PARELEFT  PARERIGHT  EOM
pyplot DOT gcf PARELEFT  PARERIGHT  DOT clear PARELEFT  PARERIGHT  EOM
yhat  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
yhat  EQUAL  yhat DOT reshape PARELEFT  PARERIGHT  EOM
yhat  EQUAL  scaler DOT inverse_transform PARELEFT  PARERIGHT  EOM
df2  EQUAL  DataFrame PARELEFT  PARERIGHT  EOM
df2 DOT to_csv PARELEFT  PARERIGHT  EOM
from keras DOT layers import Dense COMMA  Flatten COMMA  Dropout COMMA  ZeroPadding3D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
from collections import deque EOM
import sys EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  seq_length COMMA aved_model EQUAL  COMMA  features_length EQUAL  PARERIGHT : EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2048 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1024 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
import os EOM
global_model_version  EQUAL  48 EOM
global_batch_size  EQUAL  16 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  34 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT preprocessing DOT image import ImageDataGenerator EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  Reshape EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT layers DOT recurrent import LSTM COMMA  SimpleRNN EOM
from keras DOT optimizers import SGD COMMA  Adam EOM
from keras DOT utils import np_utils EOM
def build_MLP_net PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Convolution2D PARELEFT 512 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_LSTM_net PARELEFT  PARERIGHT : EOM
img_model DOT add PARELEFT Convolution2D PARELEFT 512 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
img_model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
img_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
language_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
language_model DOT add PARELEFT Embedding PARELEFT nb_classes COMMA  256 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT TimeDistributedDense PARELEFT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
def build_random PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom music21 import converter COMMA instrument COMMA note COMMA chord COMMA stream EOM
import tensorflow as tf EOM
from keras DOT layers import Dense COMMA  Conv2D COMMA  Dropout COMMA  Flatten COMMA  MaxPooling2D COMMA LSTM COMMA Activation EOM
from keras DOT models import Sequential EOM
import keras DOT models EOM
import numpy as np EOM
from keras DOT utils import np_utils EOM
from keras DOT callbacks import ModelCheckpoint EOM
import glob EOM
import pickle EOM
def createModel PARELEFT  PARERIGHT : EOM
with open PARELEFT  PARERIGHT  as f: EOM
networkInput COMMA  pitchNames COMMA  numNotes COMMA  nVocab  COMMA  normalNetworkInput  EQUAL  pickle DOT load PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
import numpy as np EOM
import time EOM
import csv EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA Merge EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
import copy EOM
data_dim  EQUAL  1 EOM
timesteps  EQUAL  13 EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
in_dimension  EQUAL  3 EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
from keras DOT utils DOT visualize_util import plot COMMA  to_graph EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
from keras DOT models import load_model EOM
from keras DOT layers import TimeDistributed COMMA  Dense COMMA  LSTM EOM
from keras DOT utils import np_utils EOM
from keras DOT callbacks import ModelCheckpoint EOM
from matplotlib DOT ticker import FormatStrFormatter EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 10 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y_input_dim_1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def build_timedistributed_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT y_input_dim_1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_time_distributed_stateful_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA stateful EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT y_input_dim_1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def build_stacked_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_stateful_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y_input_dim_1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_cwrnn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT cwrnn DOT ClockworkRNN PARELEFT output_dim EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA period_spec EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y_input_dim_1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelfrom __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class nuRobotPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader1  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list1  EQUAL  list PARELEFT  PARERIGHT  EOM
testX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y1  EQUAL  testdata DOT iloc[] EOM
y_test1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
testX  EQUAL  sequence DOT pad_sequences PARELEFT testX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  2 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA nb_epoch EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  import os EOM
global_model_version  EQUAL  65 EOM
global_batch_size  EQUAL  64 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from flask import Flask COMMA  render_template COMMA request COMMA send_file EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Input EOM
from keras DOT layers import Conv1D EOM
from keras DOT models import Model EOM
import json EOM
import keras EOM
from keras DOT layers import Dropout COMMA  Flatten EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D EOM
import numpy as np EOM
from sklearn DOT model_selection import train_test_split EOM
conv1  EQUAL  Conv1D PARELEFT 5 COMMA 2 COMMA activation EQUAL  COMMA padding EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
dense  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 32 COMMA  kernel_size EQUAL  COMMA activation EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
app  EQUAL  Flask PARELEFT  PARERIGHT  EOM
def prediction PARELEFT  PARERIGHT : EOM
data  EQUAL  request DOT json EOM
data  EQUAL  data[] EOM
if PARELEFT len PARELEFT  PARERIGHT <100 PARERIGHT : EOM
for j in range PARELEFT 0 COMMA 100-len PARELEFT  PARERIGHT  PARERIGHT : EOM
data DOT append PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
data_to_predict  EQUAL  [] EOM
data_to_predict  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
label  EQUAL  np DOT argmax PARELEFT  PARERIGHT  EOM
if PARELEFT label EQUAL  PARERIGHT : EOM
value  EQUAL  EOM
elif PARELEFT label EQUAL  PARERIGHT : EOM
value  EQUAL  EOM
elif PARELEFT label EQUAL  PARERIGHT : EOM
value  EQUAL  EOM
elif PARELEFT label EQUAL  PARERIGHT : EOM
value  EQUAL  EOM
else: EOM
value EQUAL  EOM
result  EQUAL  {:value} EOM
return json DOT dumps PARELEFT  PARERIGHT  EOM
def dashboard PARELEFT  PARERIGHT : EOM
return render_template PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
app DOT run PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT recurrent import LSTM EOM
def create_lstm_network PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
for cur_unit in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def new_lstm_network PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  class_mode EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Input COMMA  Layer COMMA  Merge EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
import numpy as np EOM
import keras DOT preprocessing DOT text as prep EOM
import keras DOT preprocessing DOT sequence as seq EOM
from keras DOT constraints import maxnorm COMMA  nonneg EOM
from keras DOT callbacks import EarlyStopping EOM
from keras import backend as K EOM
from keras DOT layers DOT core import Lambda EOM
def readEmbedding PARELEFT file EQUAL  PARERIGHT : EOM
f EQUAL open PARELEFT  PARERIGHT  EOM
embedding EQUAL [] EOM
for i in f  DOT readlines PARELEFT  PARERIGHT : EOM
tmp EQUAL [] EOM
embedding DOT append PARELEFT  PARERIGHT  EOM
return np DOT asanyarray PARELEFT  PARERIGHT  EOM
corpusFile EQUAL  EOM
labelsFile EQUAL  EOM
file EQUAL open PARELEFT  PARERIGHT  EOM
text EQUAL  [] EOM
toknizer DOT fit_on_texts PARELEFT texts EQUAL  PARERIGHT  EOM
data EQUAL toknizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
data EQUAL np DOT asanyarray PARELEFT  PARERIGHT  EOM
maxlen EQUAL [] EOM
maxlen EQUAL maxlen[] EOM
worddic EQUAL toknizer DOT word_index EOM
wordcount EQUAL  toknizer DOT word_counts EOM
vocabSize  EQUAL  toknizer DOT word_index DOT __len__ PARELEFT  PARERIGHT +2 EOM
data EQUAL seq DOT pad_sequences PARELEFT sequences EQUAL  COMMA padding EQUAL  PARERIGHT  EOM
file DOT close PARELEFT  PARERIGHT  EOM
file EQUAL open PARELEFT  PARERIGHT  EOM
tmp EQUAL [] EOM
labelLen EQUAL max PARELEFT  PARERIGHT +1 EOM
labels EQUAL [] EOM
for i in tmp: EOM
k EQUAL []*labelLen EOM
k[] EQUAL 1 EOM
labels DOT append PARELEFT  PARERIGHT  EOM
X_train EQUAL data EOM
Y_train EQUAL labels EOM
weights EQUAL readEmbedding PARELEFT  PARERIGHT  EOM
leftmodel  EQUAL  Sequential PARELEFT name EQUAL  PARERIGHT  EOM
leftmodel DOT add PARELEFT Embedding PARELEFT input_length EQUAL  COMMA input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  mask_zero EQUAL  COMMA  name EQUAL  COMMA weights EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
rightmodel EQUAL Sequential PARELEFT name EQUAL  PARERIGHT  EOM
rightmodel DOT add PARELEFT Embedding PARELEFT input_length EQUAL  COMMA input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  mask_zero EQUAL  COMMA  name EQUAL  COMMA  trainable EQUAL  COMMA  W_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model EQUAL Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARELEFT lambda x: x[]*K DOT repeat_elements PARELEFT  PARERIGHT  PARERIGHT   COMMA  output_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_length EQUAL  COMMA  activation EQUAL  COMMA  inner_activation EQUAL  COMMA return_sequences EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT labels[] DOT __len__ PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT x EQUAL [] COMMA  y EQUAL  COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  PARERIGHT  EOM
importance  EQUAL  rightmodel DOT get_layer PARELEFT name EQUAL  PARERIGHT  DOT get_weights PARELEFT  PARERIGHT [] EOM
file EQUAL open PARELEFT  PARERIGHT  EOM
sortedImp EQUAL [] EOM
for i in worddic: EOM
sortedImp DOT append PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
sortedImp EQUAL sorted PARELEFT sortedImp COMMA key EQUAL [] COMMA reverse EQUAL  PARERIGHT  EOM
for i in sortedImp: EOM
file DOT write PARELEFT str PARELEFT  PARERIGHT ++str PARELEFT  PARERIGHT + PARERIGHT  EOM
file DOT close PARELEFT  PARERIGHT  EOM
embeddings  EQUAL  model DOT get_layer PARELEFT name EQUAL  PARERIGHT  DOT get_weights PARELEFT  PARERIGHT [] EOM
file EQUAL open PARELEFT  PARERIGHT  EOM
for i in embeddings: EOM
tmp EQUAL str PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  DOT strip PARELEFT  PARERIGHT  EOM
file DOT write PARELEFT  PARERIGHT  EOM
file DOT close PARELEFT  PARERIGHT  EOM
file EQUAL open PARELEFT  PARERIGHT  EOM
for i in worddic: EOM
tmp EQUAL str PARELEFT  PARERIGHT ++str PARELEFT  PARERIGHT  EOM
file DOT write PARELEFT  PARERIGHT  EOM
file DOT close PARELEFT  PARERIGHT  EOM
class RestaurantPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelwarnings DOT filterwarnings PARELEFT  PARERIGHT  EOM
import string EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from keras DOT utils import np_utils COMMA  to_categorical EOM
from sklearn DOT model_selection import train_test_split COMMA  KFold COMMA  GridSearchCV COMMA  StratifiedShuffleSplit COMMA StratifiedKFold EOM
from sklearn DOT metrics import confusion_matrix COMMA  classification_report COMMA  accuracy_score EOM
from sklearn DOT preprocessing import LabelEncoder EOM
from sklearn DOT pipeline import Pipeline EOM
from sklearn DOT feature_extraction DOT text import TfidfVectorizer COMMA  CountVectorizer EOM
import pandas as pd EOM
from keras import layers EOM
from keras DOT models import Model COMMA  Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  LSTM EOM
from keras DOT layers import Input COMMA  Flatten COMMA  merge COMMA  Lambda COMMA  Dropout EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from keras DOT layers DOT wrappers import TimeDistributed COMMA  Bidirectional EOM
from keras DOT utils import np_utils COMMA  to_categorical EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
import gensim EOM
from gensim DOT models import Word2Vec EOM
from gensim DOT models DOT keyedvectors import KeyedVectors EOM
import matplotlib DOT pyplot as plt EOM
import itertools EOM
from nltk DOT stem DOT wordnet import WordNetLemmatizer EOM
from nltk DOT tokenize import RegexpTokenizer EOM
from sklearn DOT utils import shuffle EOM
import numpy as np EOM
full_data  EQUAL  np DOT loadtxt PARELEFT  COMMA delimiter EQUAL  COMMA skiprows EQUAL  PARERIGHT  EOM
x  EQUAL  full_data[] EOM
y  EQUAL  full_data[] EOM
encoder  EQUAL  LabelEncoder PARELEFT  PARERIGHT  EOM
encoder DOT fit PARELEFT  PARERIGHT  EOM
encoded_y  EQUAL  encoder DOT transform PARELEFT  PARERIGHT  EOM
dummy_y  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
def full_multiclass_report PARELEFT model COMMA x COMMA y_true COMMA classes COMMA batch_size EQUAL  COMMA binary EQUAL  PARERIGHT : EOM
if not binary: EOM
y_true  EQUAL  np DOT argmax PARELEFT y_true COMMA axis EQUAL  PARERIGHT  EOM
y_pred  EQUAL  model DOT predict_classes PARELEFT x COMMA  batch_size EQUAL  PARERIGHT  EOM
seed  EQUAL 1000 EOM
Neurons  EQUAL  1024 EOM
Baseline  EQUAL  100 EOM
Top1  EQUAL  161 EOM
Top2  EQUAL  214 EOM
Top3  EQUAL  249 EOM
Top4  EQUAL  283 EOM
Top5  EQUAL  323 EOM
NoOfAtt EQUAL Top3 EOM
x_train COMMA  x_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT x COMMA  dummy_y COMMA  train_size EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
x_train COMMA  x_val COMMA  y_train COMMA  y_val  EQUAL  train_test_split PARELEFT x_train COMMA  y_train COMMA  train_size EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
x_train  EQUAL  x_train DOT reshape PARELEFT  PARERIGHT  EOM
x_test  EQUAL  x_test DOT reshape PARELEFT  PARERIGHT  EOM
x_val  EQUAL  x_val DOT reshape PARELEFT  PARERIGHT  EOM
LSTM_Model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_Model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA  return_sequences  EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
LSTM_Model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA  return_sequences  EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
LSTM_Model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA  return_sequences  EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
LSTM_Model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_Model DOT add PARELEFT layers DOT Dense PARELEFT 5 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_Model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
LSTM_Model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_History EQUAL LSTM_Model DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs  EQUAL  COMMA  batch_size  EQUAL  COMMA verbose EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  shuffle EQUAL  PARERIGHT  EOM
full_multiclass_report PARELEFT LSTM_Model COMMA  x_val COMMA  y_val COMMA  encoder DOT inverse_transform PARELEFT np DOT arange PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  32 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class RestaurantPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
batch_shape  EQUAL   PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT -1 COMMA  batch_input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_hidden COMMA  batch_input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom  DOT base import BaseNet EOM
import numpy as np EOM
import time EOM
import math as m EOM
import tensorflow as tf EOM
import keras EOM
from keras import Model EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import InputLayer EOM
from keras DOT layers import Conv1D EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Bidirectional EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers import Input COMMA  Concatenate COMMA  Permute COMMA  Reshape COMMA  Merge EOM
from keras DOT layers import concatenate EOM
from keras DOT optimizers import Adam EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import TimeDistributed COMMA  Dense COMMA  Dropout COMMA  Flatten EOM
import json EOM
import pickle EOM
class iEEGSeq PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  name COMMA  num_classes EQUAL  COMMA  num_timewins EQUAL  COMMA  DROPOUT EQUAL  COMMA  BIDIRECT EQUAL  COMMA  FREEZE EQUAL  PARERIGHT : EOM
if name not in _availmodels: EOM
raise AttributeError PARELEFT AMECNNLSTM CNNLSTM MIX EOM
self DOT name  EQUAL  name EOM
self DOT num_timewins  EQUAL  num_timewins EOM
self DOT DROPOUT  EQUAL  DROPOUT EOM
self DOT BIDIRECT  EQUAL  BIDIRECT EOM
self DOT FREEZE  EQUAL  FREEZE EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
def loadmodel PARELEFT  PARERIGHT : EOM
json_file  EQUAL  open PARELEFT  PARERIGHT  EOM
loaded_model_json  EQUAL  json_file DOT read PARELEFT  PARERIGHT  EOM
json_file DOT close PARELEFT  PARERIGHT  EOM
fixed_cnn_model  EQUAL  keras DOT models DOT model_from_json PARELEFT  PARERIGHT  EOM
fixed_cnn_model DOT load_weights PARELEFT  PARERIGHT  EOM
fixed_cnn_model DOT pop PARELEFT  PARERIGHT  EOM
fixed_cnn_model DOT pop PARELEFT  PARERIGHT  EOM
return fixed_cnn_model EOM
def buildmodel PARELEFT  PARERIGHT : EOM
size_mem  EQUAL  128 EOM
num_timewins  EQUAL  self DOT num_timewins EOM
self DOT input_shape  EQUAL  convnet DOT input_shape EOM
if self DOT name  EQUAL  EQUAL  : EOM
self DOT _build_same_cnn_lstm PARELEFT vnet COMMA  num_timewins EQUAL  COMMA  size_mem EQUAL  COMMA  BIDIRECT EQUAL  PARERIGHT  EOM
elif self DOT name  EQUAL  EQUAL  : EOM
self DOT _build_cnn_lstm PARELEFT vnet COMMA  num_timewins EQUAL  COMMA  size_mem EQUAL  COMMA  BIDIRECT EQUAL  PARERIGHT  EOM
elif self DOT name  EQUAL  EQUAL  : EOM
self DOT _build_cnn_lstm_mix PARELEFT vnet COMMA  num_timewins EQUAL  COMMA  size_mem EQUAL  COMMA  BIDIRECT EQUAL  PARERIGHT  EOM
elif self DOT name  EQUAL  EQUAL  : EOM
self DOT _appendlstm PARELEFT nvnet COMMA  num_timewins EQUAL  COMMA  size_mem EQUAL  PARERIGHT  EOM
def buildoutput PARELEFT  PARERIGHT : EOM
if self DOT name  EQUAL  EQUAL   or self DOT name  EQUAL  EQUAL  : EOM
self DOT _build_seq_output PARELEFT size_fc EQUAL  PARERIGHT  EOM
elif self DOT name  EQUAL  EQUAL  : EOM
self DOT _build_output PARELEFT  PARERIGHT  EOM
elif self DOT name  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT _build_seq_output PARELEFT size_fc EQUAL  PARERIGHT  EOM
return self DOT model EOM
def _build_same_cnn_lstm PARELEFT self COMMA  convnet COMMA  num_timewins COMMA  size_mem EQUAL  COMMA  BIDIRECT EQUAL  PARERIGHT : EOM
convnet DOT trainable  EQUAL  False EOM
convnet DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
cnn_output_shape  EQUAL  convnet DOT output_shape[] EOM
cnn_input_shape  EQUAL  tuple PARELEFT list PARELEFT  PARERIGHT [] PARERIGHT  EOM
self DOT model DOT add PARELEFT TimeDistributed PARELEFT onvnet COMMA  input_shape EQUAL  PARELEFT  PARERIGHT +cnn_input_shape PARERIGHT  PARERIGHT  EOM
if BIDIRECT: EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT units EQUAL  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
self DOT model DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
def _build_cnn_lstm PARELEFT self COMMA  convnet COMMA  num_timewins COMMA  size_mem EQUAL  COMMA  BIDIRECT EQUAL  PARERIGHT : EOM
buffweights  EQUAL  convnet DOT weights EOM
convnet DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
convnets DOT append PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Merge PARELEFT convnets COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
num_cnn_features  EQUAL  convnets[] DOT output_shape[] EOM
self DOT model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if BIDIRECT: EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT units EQUAL  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
self DOT model DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
def _build_cnn_lstm_mix PARELEFT self COMMA  convnet COMMA  num_timewins COMMA  size_mem EQUAL  COMMA  BIDIRECT EQUAL  PARERIGHT : EOM
buffweights  EQUAL  convnet DOT weights EOM
convnet DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
cnn_input_shape  EQUAL  tuple PARELEFT list PARELEFT  PARERIGHT [] PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
convnets DOT append PARELEFT  PARERIGHT  EOM
if self DOT FREEZE: EOM
for net in convnets: EOM
net DOT trainable  EQUAL  False EOM
self DOT model DOT add PARELEFT Merge PARELEFT convnets COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
num_cnn_features  EQUAL  convnets[] DOT output_shape[] EOM
self DOT model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
convpool  EQUAL  self DOT model DOT output EOM
reform_convpool  EQUAL  Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
convout_1d  EQUAL  Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
convout_1d  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
if BIDIRECT: EOM
lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT units EQUAL  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
else: EOM
lstm  EQUAL  LSTM PARELEFT units EQUAL  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
self DOT auxmodel  EQUAL  keras DOT layers DOT concatenate PARELEFT  PARERIGHT  EOM
def _build_lstm PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT output_dim COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return self DOT model EOM
def _appendlstm PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT TimeDistributed PARELEFT ixed_model COMMA  input_shape EQUAL  PARELEFT  PARERIGHT +self DOT input_shape PARERIGHT  PARERIGHT  EOM
if BIDIRECT: EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT units EQUAL  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
self DOT model DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  60 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
import scipy DOT io EOM
from scipy DOT interpolate import griddata EOM
from sklearn DOT preprocessing import scale EOM
import time EOM
from functools import reduce EOM
import math as m EOM
from keras DOT utils DOT training_utils import multi_gpu_model EOM
import tensorflow as tf EOM
import keras EOM
from keras DOT optimizers import SGD EOM
from keras DOT models import Sequential EOM
from keras DOT layers import InputLayer EOM
from keras DOT layers import Conv1D COMMA  Conv2D COMMA  MaxPooling2D EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed COMMA  Dense COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers import Input COMMA  Concatenate COMMA  Permute COMMA  Reshape COMMA  Merge EOM
from keras DOT layers DOT embeddings import Embedding EOM
class IEEGdnn PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  imsize: int  EQUAL  COMMA  n_colors: int  EQUAL  COMMA  num_classes: int  EQUAL  PARERIGHT : EOM
self DOT n_colors  EQUAL  n_colors EOM
self DOT num_classes  EQUAL  num_classes EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
def _build_2dcnn PARELEFT self COMMA  w_init: list  EQUAL  COMMA  n_layers: tuple  EQUAL  PARELEFT  PARERIGHT  COMMA  poolsize: tuple  EQUAL  PARELEFT  PARERIGHT  COMMA  n_filters_first: int  EQUAL  COMMA  filter_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT : EOM
if w_init is None: EOM
w_init  EQUAL  [] * sum PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT InputLayer PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
count EQUAL 0 EOM
for idx COMMA  n_layer in enumerate PARELEFT  PARERIGHT : EOM
for ilay in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Conv2D PARELEFT n_filters_first* PARELEFT  PARERIGHT  COMMA  ernel_size EQUAL  PARELEFT  PARERIGHT  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL [] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
if DEBUG: EOM
count+ EQUAL 1 EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def _build_lstm PARELEFT  PARERIGHT : EOM
self DOT model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT output_dim COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return self DOT model EOM
def build_same_cnn_lstm PARELEFT self COMMA  num_timewins: int COMMA  size_mem: int  EQUAL  COMMA size_fc: int  EQUAL  COMMA  DROPOUT: bool  EQUAL  PARERIGHT : EOM
convnet  EQUAL  self DOT _build_2dcnn PARELEFT w_init EQUAL  COMMA  n_layers EQUAL  PARELEFT  PARERIGHT  COMMA  olsize EQUAL  PARELEFT  PARERIGHT  COMMA  n_filters_first EQUAL  COMMA  filter_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
convnet DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
cnn_output_shape  EQUAL  convnet DOT output_shape[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT convnet COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA  ctivation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
output  EQUAL  self DOT _build_output PARELEFT model DOT output COMMA  size_fc EQUAL  PARERIGHT  EOM
return output EOM
def build_cnn_lstm PARELEFT self COMMA  num_timewins: int COMMA  size_mem: int  EQUAL  COMMA  size_fc: int  EQUAL  COMMA  DROPOUT: bool  EQUAL  PARERIGHT : EOM
convnets  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
convnet  EQUAL  self DOT _build_2dcnn PARELEFT w_init EQUAL  COMMA  n_layers EQUAL  PARELEFT  PARERIGHT  COMMA  olsize EQUAL  PARELEFT  PARERIGHT  COMMA  n_filters_first EQUAL  COMMA  filter_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
convnet DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
convnets DOT append PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT convnets COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
num_cnn_features  EQUAL  convnets[] DOT output_shape[] EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA  ctivation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  self DOT _build_output PARELEFT  PARERIGHT  EOM
return model EOM
def build_cnn_lstm_mix PARELEFT self COMMA  num_timewins: int COMMA  size_mem: int  EQUAL  COMMA  size_fc: int  EQUAL  COMMA  DROPOUT: bool  EQUAL  PARERIGHT : EOM
convnets  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
convnet  EQUAL  self DOT _build_2dcnn PARELEFT w_init EQUAL  COMMA  n_layers EQUAL  PARELEFT  PARERIGHT  COMMA  olsize EQUAL  PARELEFT  PARERIGHT  COMMA  n_filters_first EQUAL  COMMA  filter_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
convnet DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
convnets DOT append PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT convnets COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
num_cnn_features  EQUAL  convnets[] DOT output_shape[] EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
convpool  EQUAL  model DOT output EOM
reform_convpool  EQUAL  Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
convout_1d  EQUAL  Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
convout_1d  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT units EQUAL  COMMA  ctivation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  self DOT _build_output PARELEFT  PARERIGHT  EOM
return model EOM
def _build_output PARELEFT self COMMA  finalmodel COMMA  size_fc: int  EQUAL  COMMA  DROPOUT: bool  EQUAL  PARERIGHT : EOM
if DROPOUT: EOM
output  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT self DOT num_classes COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
if DROPOUT: EOM
output  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
return output EOM
def _build_seq_output PARELEFT self COMMA  finalmodel COMMA  size_fc: int  EQUAL  COMMA  DROPOUT: bool  EQUAL  PARERIGHT : EOM
if DROPOUT: EOM
finalmodel DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
finalmodel DOT add PARELEFT Dense PARELEFT size_fc COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
if DROPOUT: EOM
finalmodel DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
finalmodel DOT add PARELEFT Dense PARELEFT self DOT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return finalmodel EOM
def init_callbacks PARELEFT  PARERIGHT : EOM
callbacks  EQUAL  [] EOM
return callbacks EOM
optimizer  EQUAL  keras DOT optimizers DOT Adam PARELEFT lr EQUAL  COMMA  eta_1 EQUAL  COMMA  beta_2 EQUAL  COMMA epsilon EQUAL  COMMA decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL  PARERIGHT  EOM
self DOT model_config  EQUAL  model DOT get_config PARELEFT  PARERIGHT  EOM
return model DOT get_config PARELEFT  PARERIGHT  EOM
def train PARELEFT self COMMA  model COMMA  xtrain COMMA  ytrain COMMA  xtest COMMA  ytest COMMA ize: int  EQUAL  COMMA  epochs: int  EQUAL  COMMA  AUGMENT: bool EQUAL  PARERIGHT : EOM
callbacks  EQUAL  self DOT init_callbacks PARELEFT  PARERIGHT  EOM
aug  EQUAL  ImageDataGenerator PARELEFT width_shift_range EQUAL  COMMA eight_shift_range EQUAL  COMMA  horizontal_flip EQUAL  COMMA fill_mode EQUAL  PARERIGHT  EOM
HH  EQUAL  model DOT fit_generator PARELEFT idation_data EQUAL  PARELEFT  PARERIGHT  COMMA   epochs EQUAL  COMMA allbacks EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
else: EOM
HH  EQUAL  model DOT fit PARELEFT xtrain COMMA  ytrain COMMA  verbose EQUAL  COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
self DOT HH  EQUAL  HH EOM
return HH EOM
def eval PARELEFT self COMMA  xtest COMMA  ytest COMMA  batch_size EQUAL  PARERIGHT : EOM
self DOT score  EQUAL  self DOT model DOT evaluate PARELEFT xtest COMMA  ytest COMMA  batch_size EQUAL  PARERIGHT  EOM
acc_train_history  EQUAL  self DOT score DOT history[] EOM
acc_test_history  EQUAL  self DOT score DOT history[] EOM
loss_train_history  EQUAL  self DOT score DOT history[] EOM
loss_test_history  EQUAL  self DOT score DOT history[]from keras import layers COMMA  models COMMA  optimizers COMMA  initializers EOM
from keras import backend as K EOM
import tensorflow as tf EOM
import numpy as np EOM
from keras DOT regularizers import l2 EOM
def preprocess PARELEFT  PARERIGHT : EOM
inp_shape  EQUAL   PARELEFT  PARERIGHT  EOM
out_shape  EQUAL   PARELEFT  PARERIGHT  EOM
inp  EQUAL  layers DOT Input PARELEFT shape EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
def generateCovLayer PARELEFT  PARERIGHT : EOM
convModel  EQUAL  models DOT Sequential PARELEFT name EQUAL  PARERIGHT  EOM
convModel DOT add PARELEFT layers DOT Conv2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
convModel DOT add PARELEFT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
convModel DOT add PARELEFT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convModel DOT add PARELEFT layers DOT pooling DOT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
return convModel EOM
convModel  EQUAL  generateCovLayer PARELEFT  PARERIGHT  EOM
def presplit PARELEFT  PARERIGHT : EOM
return inputR EOM
return [] EOM
def GenerateBLSTMTime PARELEFT  PARERIGHT : EOM
[]  EQUAL  preprocess PARELEFT  PARERIGHT  EOM
def easyreshape PARELEFT  PARERIGHT : EOM
xR  EQUAL  K DOT reshape PARELEFT x COMMA  shape EQUAL [] PARERIGHT  EOM
return xR EOM
convoutputR  EQUAL  layers DOT Lambda PARELEFT easyreshape COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
SIZE_RLAYERS  EQUAL  256 EOM
x  EQUAL  convoutputR EOM
x  EQUAL  layers DOT Bidirectional PARELEFT layers DOT LSTM PARELEFT SIZE_RLAYERS COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA dropout EQUAL  COMMA recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
mask_o  EQUAL  layers DOT TimeDistributed PARELEFT layers DOT Dense PARELEFT out_shape[] COMMA activation EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
train_model  EQUAL  models DOT Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL [] PARERIGHT  EOM
return train_model EOM
def GenerateBLSTMFrequency PARELEFT  PARERIGHT : EOM
[]  EQUAL  preprocess PARELEFT  PARERIGHT  EOM
SIZE_RLAYERS  EQUAL  128 EOM
rnnModel  EQUAL  models DOT Sequential PARELEFT name EQUAL  PARERIGHT  EOM
import prepare_data as pd EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Activation EOM
from keras DOT callbacks import ModelCheckpoint EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def train PARELEFT  PARERIGHT : EOM
filepath  EQUAL  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA monitor EQUAL  COMMA erbose  EQUAL  COMMA save_best_only EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
model DOT fit PARELEFT net_input COMMA  net_output COMMA ochs  EQUAL  COMMA batch_size EQUAL  COMMA callbacks EQUAL  PARERIGHT  EOM
def train_net PARELEFT  PARERIGHT : EOM
notes  EQUAL  pd DOT convert_from_midi PARELEFT  PARERIGHT  EOM
vocab  EQUAL  len PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  EOM
net_input COMMA  net_output  EQUAL  pd DOT generate_sequence PARELEFT  PARERIGHT  EOM
model  EQUAL  build_network PARELEFT  PARERIGHT  EOM
train PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
train_net PARELEFT  PARERIGHT from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class RestaurantPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport sys EOM
import numpy as np EOM
import h5py EOM
import scipy DOT io EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT convolutional import Conv1D COMMA  MaxPooling1D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
input_file  EQUAL  sys DOT argv[] EOM
output_file  EQUAL  sys DOT argv[] EOM
forward_lstm  EQUAL  LSTM PARELEFT 320 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  EOM
backward_lstm  EQUAL  LSTM PARELEFT 320 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA padding EQUAL  COMMA strides EQUAL  COMMA activation EQUAL  COMMA kernel_size EQUAL  COMMA filters EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
testmat  EQUAL  scipy DOT io DOT loadmat PARELEFT  PARERIGHT [] EOM
y  EQUAL  model DOT predict PARELEFT testmat COMMA  verbose  EQUAL  PARERIGHT  EOM
f  EQUAL  h5py DOT File PARELEFT  PARERIGHT  EOM
f DOT create_dataset PARELEFT  COMMA  data EQUAL  PARERIGHT  EOM
f DOT close PARELEFT  PARERIGHT from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM COMMA  Conv1D COMMA  Flatten COMMA  Dropout EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
def convolutional_nn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 32 COMMA  3 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 16 COMMA  3 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 180 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
dimensions  EQUAL  300 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200 COMMA   input_shape EQUAL  PARELEFT  PARERIGHT  COMMA   return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
top_words  EQUAL  10000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  1600 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  convolutional_nn PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from absl DOT testing import parameterized EOM
import numpy as np EOM
from tensorflow DOT python import keras EOM
from tensorflow DOT python DOT framework import test_util as tf_test_util EOM
from tensorflow DOT python DOT keras import testing_utils EOM
from tensorflow DOT python DOT platform import test EOM
from tensorflow DOT python DOT training import adam EOM
from tensorflow DOT python DOT training import gradient_descent EOM
from tensorflow DOT python DOT training DOT rmsprop import RMSPropOptimizer EOM
class LSTMLayerTest PARELEFT  PARERIGHT : EOM
def test_return_sequences_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA return_sequences EOM
def test_static_shape_inference_LSTM PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
inputs  EQUAL  keras DOT layers DOT Dense PARELEFT embedding_dim COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
outputs  EQUAL  model DOT layers[] DOT output EOM
self DOT assertEqual PARELEFT outputs DOT get_shape PARELEFT  PARERIGHT  DOT as_list PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def test_dynamic_behavior_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT RMSPropOptimizer PARELEFT  PARERIGHT  COMMA   PARERIGHT  EOM
x  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_dropout_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA dropout: 0 DOT 1} COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_implementation_mode_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA implementation EOM
def test_constraints_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
k_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
r_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
b_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  COMMA recurrent_constraint EQUAL  COMMA bias_constraint EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
def test_with_masking_layer_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layer_class PARELEFT units EQUAL  COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_masking_with_stacking_LSTM PARELEFT  PARERIGHT : EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_cells  EQUAL  [] EOM
model DOT add PARELEFT keras DOT layers DOT RNN PARELEFT lstm_cells COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_from_config_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
for stateful in  PARELEFT  PARERIGHT : EOM
l1  EQUAL  layer_class PARELEFT units EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
l2  EQUAL  layer_class DOT from_config PARELEFT l1 DOT get_config PARELEFT  PARERIGHT  PARERIGHT  EOM
assert l1 DOT get_config PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL       output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL [] PARERIGHT  EOM
else: EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_non_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [keras DOT backend DOT random_normal_variable PARELEFT  PARERIGHT  COMMA  0 COMMA  1 PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_reset_states_with_values PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  stateful EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
assert len PARELEFT  PARERIGHT   EQUAL     assert layer DOT states[] is not None EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT zeros PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
state_shapes  EQUAL  [] EOM
values  EQUAL  [] EOM
if len PARELEFT  PARERIGHT   EQUAL       values  EQUAL  values[] EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT ones PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
with self DOT assertRaises PARELEFT  PARERIGHT : EOM
layer DOT reset_states PARELEFT [] *  PARELEFT len PARELEFT  PARERIGHT  + 1 PARERIGHT  PARERIGHT  EOM
def test_specify_state_with_masking PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
_  EQUAL  keras DOT layers DOT Masking PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_return_state PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
state  EQUAL  outputs[] EOM
assert len PARELEFT  PARERIGHT   EQUAL     model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
state  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA  state COMMA  atol EQUAL  PARERIGHT  EOM
def test_state_reuse PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
output COMMA  state  EQUAL  outputs[] COMMA  outputs[] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT output COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
outputs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def test_initial_states_as_other_inputs PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
num_states  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
main_inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
inputs  EQUAL  [] + initial_state EOM
layer  EQUAL  layer_class PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
main_inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
class LSTMLayerGraphOnlyTest PARELEFT  PARERIGHT : EOM
def test_statefulness_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT cached_session PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT 4 COMMA embedding_dim COMMA mask_zero EQUAL  COMMA input_length EQUAL  COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT ts COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  weights EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  PARELEFT  PARERIGHT  COMMA loss EQUAL  PARERIGHT  EOM
out1  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT out1 DOT shape COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
out2  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out1 DOT max PARELEFT  PARERIGHT  COMMA  out2 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
out3  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out2 DOT max PARELEFT  PARERIGHT  COMMA  out3 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
out4  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out3 COMMA  out4 COMMA  atol EQUAL  PARERIGHT  EOM
out5  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out4 DOT max PARELEFT  PARERIGHT  COMMA  out5 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
left_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
left_padded_input[]  EQUAL  0 EOM
left_padded_input[]  EQUAL  0 EOM
out6  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
right_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
right_padded_input[]  EQUAL  0 EOM
right_padded_input[]  EQUAL  0 EOM
out7  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out7 COMMA  out6 COMMA  atol EQUAL  PARERIGHT  EOM
def test_regularizers_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT cached_session PARELEFT  PARERIGHT : EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  COMMA activity_regularizer EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  3 PARERIGHT  EOM
x  EQUAL  keras DOT backend DOT variable PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT layer DOT get_losses_for PARELEFT  PARERIGHT  PARERIGHT  COMMA  1 PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
test DOT main PARELEFT  PARERIGHT from tensorflow import keras EOM
from util_tools DOT log_utils import get_logger EOM
LOGGER  EQUAL  get_logger PARELEFT  PARERIGHT  EOM
sgd  EQUAL  keras DOT optimizers DOT SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
def get_model PARELEFT  PARERIGHT : EOM
if  name EQUAL  EQUAL : EOM
return zzw_cnn PARELEFT  PARERIGHT  EOM
elif name EQUAL  EQUAL : EOM
return zzw_lstm PARELEFT  PARERIGHT  EOM
elif name EQUAL  EQUAL : EOM
return final_model PARELEFT  PARERIGHT  EOM
elif name EQUAL  EQUAL : EOM
return yeqy_cnn PARELEFT  PARERIGHT  EOM
elif name EQUAL  EQUAL : EOM
return yeqy_lstm_single PARELEFT  PARERIGHT  EOM
else: EOM
LOGGER DOT error PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
assert PARELEFT  PARERIGHT  EOM
def final_active_func PARELEFT  PARERIGHT : EOM
if classify_type  EQUAL  EQUAL  4: EOM
return EOM
elif classify_type  EQUAL  EQUAL  16: EOM
return EOM
def zzw_cnn PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT Sequential PARELEFT  PARERIGHT  EOM
e  EQUAL  keras DOT layers DOT Embedding PARELEFT vocab_size COMMA  50 COMMA  weights EQUAL [] COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Conv1D PARELEFT 256 COMMA  5 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT MaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Conv1D PARELEFT 256 COMMA  5 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT MaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Conv1D PARELEFT 128 COMMA  5 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT MaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT classify_type COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def final_model PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT Sequential PARELEFT  PARERIGHT  EOM
e  EQUAL  keras DOT layers DOT Embedding PARELEFT vocab_size COMMA  50 COMMA  weights EQUAL [] COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Conv1D PARELEFT 256 COMMA  7 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT GlobalMaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT classify_type COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def yeqy_lstm_single PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT Sequential PARELEFT  PARERIGHT  EOM
e  EQUAL  keras DOT layers DOT Embedding PARELEFT vocab_size COMMA  50 COMMA  weights EQUAL [] COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT CuDNNLSTM PARELEFT 128 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT classify_type COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def yeqy_cnn PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT Sequential PARELEFT  PARERIGHT  EOM
e  EQUAL  keras DOT layers DOT Embedding PARELEFT vocab_size COMMA  50 COMMA  weights EQUAL [] COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Conv1D PARELEFT 256 COMMA  7 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT GlobalMaxPool1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 256 COMMA  activation EQUAL  COMMA bias_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT classify_type COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def zzw_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT Sequential PARELEFT  PARERIGHT  EOM
e  EQUAL  keras DOT layers DOT Embedding PARELEFT vocab_size COMMA  50 COMMA  weights EQUAL [] COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT CuDNNLSTM PARELEFT 50 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT CuDNNLSTM PARELEFT 50 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT classify_type COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT models import Model EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT callbacks import TensorBoard EOM
from keras import Sequential EOM
import numpy as np EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
batch_size  EQUAL  32 EOM
def hold PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_val  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
max_caption_len  EQUAL  16 EOM
vocab_size  EQUAL  10000 EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 10 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM COMMA  Bidirectional EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
from keras DOT optimizers import SGD COMMA  Nadam EOM
def get_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 1024 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT yshape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT yshape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  Nadam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model COMMA optfrom keras DOT models import Sequential EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT core import Merge COMMA  Dense COMMA  Dropout EOM
import numpy as np EOM
class TGVModel: EOM
def __init__ PARELEFT self COMMA  word_embedding_matrix COMMA  tags_embedding_matrix COMMA  trigram EQUAL  COMMA  word EQUAL  COMMA  tags EQUAL  COMMA  combining EQUAL  PARERIGHT : EOM
self DOT trigram_model  EQUAL  self DOT random_first_level_network PARELEFT lstm_output_size EQUAL  PARERIGHT  EOM
self DOT word_network  EQUAL  self DOT first_level_network PARELEFT word_embedding_matrix COMMA  lstm_output_size EQUAL  PARERIGHT  EOM
self DOT tags_network  EQUAL  self DOT first_level_network PARELEFT tags_embedding_matrix COMMA  lstm_output_size EQUAL  PARERIGHT  EOM
self DOT model  EQUAL  self DOT second_level_network PARELEFT self DOT trigram_model COMMA  self DOT word_network COMMA  self DOT tags_network COMMA combining_layer EQUAL  PARERIGHT  EOM
def first_level_network PARELEFT self COMMA  embedding_matrix COMMA  lstm_output_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  44 EOM
global_batch_size  EQUAL  16 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
from hyperopt import Trials COMMA  STATUS_OK COMMA  tpe EOM
from keras DOT datasets import mnist EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT models import Sequential EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
from hyperas import optim EOM
from keras DOT models import model_from_json EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT optimizers import SGD  COMMA  Adam EOM
import tensorflow as tf EOM
import keras DOT backend as K EOM
from hyperas DOT distributions import choice COMMA  uniform COMMA  conditional EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
__author__  EQUAL  EOM
def data PARELEFT  PARERIGHT : EOM
x  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
x  EQUAL  x DOT reshape PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
y  EQUAL  y DOT reshape PARELEFT  PARERIGHT  EOM
x_train  COMMA x_test   EQUAL  np DOT split PARELEFT x COMMA 2 COMMA  axis EQUAL  PARERIGHT  EOM
y_train  COMMA  y_test EQUAL  np DOT split PARELEFT y COMMA 2 COMMA  axis EQUAL  PARERIGHT  EOM
return x_train COMMA  y_train COMMA  x_test COMMA  y_test EOM
def model PARELEFT  PARERIGHT : EOM
model_lstm  DOT add PARELEFT LSTM PARELEFT {{choice PARELEFT  PARERIGHT }} COMMA  dropout EQUAL  PARELEFT  PARERIGHT }} COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA urrent_dropout EQUAL  PARELEFT  PARERIGHT }} COMMA return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
condition  EQUAL  conditional PARELEFT {{choice PARELEFT  PARERIGHT }} PARERIGHT  EOM
if condition  EQUAL  EQUAL  : EOM
pass EOM
elif condition  EQUAL  EQUAL  : EOM
model_lstm  DOT add PARELEFT LSTM PARELEFT {{choice PARELEFT  PARERIGHT }} COMMA  dropout EQUAL  PARELEFT  PARERIGHT }} COMMA ecurrent_dropout EQUAL  PARELEFT  PARERIGHT }} COMMA turn_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
elif condition   EQUAL  EQUAL  : EOM
model_lstm  DOT add PARELEFT LSTM PARELEFT {{choice PARELEFT  PARERIGHT }} COMMA  dropout EQUAL  PARELEFT  PARERIGHT }} COMMA ecurrent_dropout EQUAL  PARELEFT  PARERIGHT }} COMMA turn_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT {{choice PARELEFT  PARERIGHT }} PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT {{choice PARELEFT  PARERIGHT }} PARERIGHT  PARERIGHT  EOM
elif condition  EQUAL  EQUAL  : EOM
model_lstm  DOT add PARELEFT LSTM PARELEFT {{choice PARELEFT  PARERIGHT }} COMMA  dropout EQUAL  PARELEFT  PARERIGHT }} COMMA ecurrent_dropout EQUAL  PARELEFT  PARERIGHT }} COMMA turn_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT {{choice PARELEFT  PARERIGHT }} PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT {{choice PARELEFT  PARERIGHT }} PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dense PARELEFT {{choice PARELEFT  PARERIGHT }} COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT {{choice PARELEFT  PARERIGHT }} PARERIGHT  PARERIGHT  EOM
model_lstm  DOT add PARELEFT Dense PARELEFT 9 COMMA  activation EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
adam  EQUAL  Adam PARELEFT clipnorm EQUAL  COMMA  clipvalue EQUAL  PARERIGHT  EOM
model_lstm  DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model_lstm DOT summary PARELEFT  PARERIGHT  EOM
model_lstm DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA verbose EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
loss COMMA  acc  EQUAL  model_lstm DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
return {: -acc COMMA  : STATUS_OK COMMA  : model_lstm} EOM
if __name__  EQUAL  EQUAL  : EOM
import gc gc DOT collect PARELEFT  PARERIGHT  EOM
best_run COMMA  best_model  EQUAL  optim DOT minimize PARELEFT model EQUAL  COMMA data EQUAL  COMMA algo EQUAL  COMMA max_evals EQUAL  COMMA trials EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
X_train COMMA  Y_train COMMA  X_test COMMA  Y_test  EQUAL  data PARELEFT  PARERIGHT  EOM
import h5py EOM
from base_model import BaseModel EOM
from data_source import DataSource EOM
from keras DOT layers import concatenate EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import GRU EOM
from keras DOT layers import Input EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D EOM
from keras DOT layers import Conv2D EOM
from keras DOT layers import MaxPooling1D EOM
from keras DOT layers import MaxPooling2D EOM
from keras DOT layers import Merge EOM
from keras DOT layers DOT core import Flatten EOM
from keras DOT layers DOT core import Reshape EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
from keras DOT models import Model EOM
from keras DOT models import Sequential EOM
from keras DOT models import load_model EOM
import numpy as np EOM
from utils DOT vocabulary import Vocabulary EOM
DROPOUT  EQUAL  0 DOT 2 EOM
LSTM_SIZE  EQUAL  1024 EOM
SEQ_LEN  EQUAL  40 EOM
OPENAI_FEATURE_SIZE  EQUAL  4096 EOM
OPENAI_REDUCED_SIZE  EQUAL  25 EOM
BATCH_SIZE  EQUAL  64 EOM
class Model PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  vocab COMMA  data_source COMMA  lstm_size EQUAL  COMMA p_prob EQUAL  COMMA  seq_length EQUAL  COMMA  arch EQUAL  COMMA  is_eval EQUAL  PARERIGHT : EOM
BaseModel DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT filter_sizes  EQUAL  [] EOM
self DOT num_filters  EQUAL  256 EOM
def create_model PARELEFT self COMMA  ckpt_file EQUAL  PARERIGHT : EOM
if ckpt_file is None: EOM
if self DOT arch  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT LSTM_SIZE COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA mplementation EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT arch  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT GRU PARELEFT LSTM_SIZE COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA mplementation EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT arch  EQUAL  EQUAL  : EOM
conv_filters  EQUAL  [] EOM
for filter_size in self DOT filter_sizes: EOM
conv_filters DOT append PARELEFT Sequential PARELEFT  PARERIGHT  PARERIGHT  EOM
conv_filters[] DOT add PARELEFT  PARERIGHT  EOM
conv_filters[] DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA rides EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
conv_filters[] DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Merge PARELEFT conv_filters COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT arch  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
filter_size  EQUAL  3 EOM
self DOT model DOT add PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA rides EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  PARELEFT  PARERIGHT  COMMA  kernel_size EQUAL  COMMA rides EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 1024 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT arch  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
filter_size  EQUAL  3 EOM
self DOT model DOT add PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA rides EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  PARELEFT  PARERIGHT  COMMA  kernel_size EQUAL  COMMA rides EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  PARELEFT  PARERIGHT  COMMA  kernel_size EQUAL  COMMA rides EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  PARELEFT  PARERIGHT  COMMA  kernel_size EQUAL  COMMA rides EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 1024 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT arch  EQUAL  EQUAL  : EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT LSTM PARELEFT LSTM_SIZE COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA mplementation EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
conv_filters  EQUAL  [] EOM
for filter_size in self DOT filter_sizes: EOM
conv_filters DOT append PARELEFT Sequential PARELEFT  PARERIGHT  PARERIGHT  EOM
conv_filters[] DOT add PARELEFT  PARERIGHT  EOM
conv_filters[] DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA rides EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
conv_filters[] DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Merge PARELEFT conv_filters COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 1024 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT arch  EQUAL  EQUAL  : EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT LSTM PARELEFT LSTM_SIZE COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA mplementation EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dense PARELEFT OPENAI_REDUCED_SIZE COMMA ctivation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 1024 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT arch  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT LSTM_SIZE COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA mplementation EQUAL  COMMA  unroll EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT LSTM_SIZE COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA mplementation EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 1024 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT arch  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT  PARERIGHT  EOM
lstm_layer  EQUAL  LSTM PARELEFT LSTM_SIZE COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA mplementation EQUAL  COMMA  unroll EQUAL  PARERIGHT  EOM
self DOT model DOT add PARELEFT Bidirectional PARELEFT lstm_layer COMMA  merge_mode EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
raise NotImplementedError PARELEFT  PARERIGHT  EOM
else: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  type EQUAL  COMMA  default EQUAL  COMMA  nargs EQUAL  COMMA p EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  type EQUAL  COMMA default EQUAL  COMMA  EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  type EQUAL  COMMA default EQUAL  COMMA  EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  type EQUAL  COMMA  default EQUAL  COMMA p EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA ction EQUAL  COMMA  const EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  type EQUAL  COMMA  default EQUAL  COMMA  nargs EQUAL  COMMA Type of word embedding Word2Vec or Glove EOM
args  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
vocab  EQUAL  Vocabulary PARELEFT  PARERIGHT  EOM
openai_features_dir  EQUAL  None EOM
if args DOT lstm_arch  EQUAL  EQUAL  : EOM
openai_features_dir  EQUAL  EOM
data_source  EQUAL  DataSource PARELEFT vocab EQUAL  COMMA labeled_data_file EQUAL  COMMA test_data_file EQUAL  COMMA embedding_file EQUAL  PARELEFT  PARERIGHT  COMMA embedding_dim EQUAL  COMMA seq_length EQUAL  COMMA embedding_type EQUAL  COMMA openai_features_dir EQUAL  PARERIGHT  EOM
model  EQUAL  Model PARELEFT vocab EQUAL  COMMA data_source EQUAL  COMMA lstm_size EQUAL  COMMA drop_prob EQUAL  COMMA arch EQUAL  COMMA is_eval EQUAL  PARERIGHT  EOM
if args DOT is_train: EOM
model DOT create_model PARELEFT  PARERIGHT  EOM
model DOT train PARELEFT batch_size EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
elif args DOT is_eval: EOM
model DOT create_model PARELEFT  PARERIGHT  EOM
y_test COMMA  y_probs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
f DOT write PARELEFT  PARERIGHT  EOM
for idx COMMA  y in zip PARELEFT np DOT arange PARELEFT  PARERIGHT  COMMA  y_test PARERIGHT : EOM
f DOT write PARELEFT str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  +  PARERIGHT  EOM
else: EOM
model DOT create_model PARELEFT  PARERIGHT  EOM
y_test COMMA  y_probs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
f DOT write PARELEFT  PARERIGHT  EOM
for idx COMMA  y in zip PARELEFT np DOT arange PARELEFT  PARERIGHT  COMMA  y_test PARERIGHT : EOM
f DOT write PARELEFT str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  +  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
f DOT write PARELEFT  PARERIGHT  EOM
for idx COMMA  y in zip PARELEFT np DOT arange PARELEFT  PARERIGHT  COMMA  y_probs PARERIGHT : EOM
f DOT write PARELEFT str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  +  PARERIGHT  EOM
y_val COMMA  y_probs  EQUAL  model DOT predict PARELEFT data_source DOT validation PARELEFT  PARERIGHT [] PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
f DOT write PARELEFT  PARERIGHT  EOM
for idx COMMA  probs COMMA  pred_y COMMA  true_y in zip PARELEFT  np DOT arange PARELEFT  PARERIGHT  COMMA  y_probs COMMA _val COMMA  data_source DOT validation PARELEFT  PARERIGHT [] PARERIGHT : EOM
f DOT write PARELEFT str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  ++ str PARELEFT  PARERIGHT  + EOM
import numpy as np EOM
import pandas as pd EOM
import datetime EOM
import matplotlib DOT pyplot as plt EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from keras DOT callbacks import EarlyStopping COMMA  ReduceLROnPlateau COMMA  ModelCheckpoint COMMA  TensorBoard EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA Conv1D COMMA MaxPooling1D COMMA Flatten COMMA LSTM COMMA GRU EOM
import pywt EOM
from collections import defaultdict EOM
from keras import losses EOM
from sklearn import metrics EOM
import math EOM
import sys EOM
from keras DOT callbacks import History EOM
def mean_absolute_percentage_error PARELEFT  PARERIGHT : EOM
return np DOT mean PARELEFT np DOT abs PARELEFT  PARELEFT  PARERIGHT  / y_true PARERIGHT  PARERIGHT *100 EOM
def multivariateGRU PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def multivariateLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def multivariateLSTM_sequence PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def singleLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def singleLSTM_sequences PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def singleGRU PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def Ensemble_Network PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT nodes COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def train PARELEFT  PARERIGHT : EOM
history  EQUAL  History PARELEFT  PARERIGHT  EOM
reduce_lr  EQUAL  ReduceLROnPlateau PARELEFT monitor EQUAL  COMMA  factor EQUAL  COMMA  patience EQUAL  COMMA  min_lr EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
checkpointer EQUAL ModelCheckpoint PARELEFT +weights_file+ COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  COMMA  mode EQUAL  COMMA  period EQUAL  PARERIGHT  EOM
earlystopper EQUAL EarlyStopping PARELEFT monitor EQUAL  COMMA  min_delta EQUAL  COMMA  patience EQUAL  COMMA  verbose EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT x COMMA  y COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  COMMA callbacks EQUAL [] PARERIGHT  EOM
lowest_val_loss EQUAL min PARELEFT  PARERIGHT  EOM
return model COMMA lowest_val_lossimport pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class JobsPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT models import load_model EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from config import MODEL_DIR COMMA  SCORE_COLUMNS EOM
import os DOT path as osp EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def train_model PARELEFT  PARERIGHT : EOM
model  EQUAL  build_model PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT X COMMA  Y COMMA  epochs EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
model DOT save PARELEFT osp DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_model PARELEFT  PARERIGHT : EOM
model  EQUAL  load_model PARELEFT osp DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
loss  EQUAL  model DOT evaluate PARELEFT  PARERIGHT  EOM
return lossimport numpy as np EOM
from keras DOT layers import Input COMMA  Dense EOM
from keras DOT models import Model EOM
X  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
h  EQUAL  Dense PARELEFT 75 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model2  EQUAL  Model PARELEFT input EQUAL  COMMA  output EQUAL  PARERIGHT  EOM
model2 DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  PARERIGHT  EOM
out  EQUAL  model2 DOT predict PARELEFT  PARERIGHT  EOM
out DOT shape EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
import reader EOM
[]  EQUAL  reader DOT get_formatted_data PARELEFT  PARERIGHT  EOM
responses  EQUAL  reader DOT get_response PARELEFT  PARERIGHT  EOM
input_layer_matrix  EQUAL  reader DOT get_embedding_matrix_input PARELEFT  PARERIGHT  EOM
word_indices  EQUAL  reader DOT get_word_index PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT len PARELEFT  PARERIGHT  + 1 COMMA 300 COMMA weights EQUAL [] COMMA input_length EQUAL  COMMA trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 75 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 75 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT qn1 COMMA  qn1 COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy as np EOM
from keras DOT layers import Input COMMA  Dense EOM
from keras DOT models import Model EOM
from keras DOT layers DOT embeddings import Embedding EOM
X  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
h  EQUAL  Dense PARELEFT 75 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT 300 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model2  EQUAL  Model PARELEFT input EQUAL  COMMA  output EQUAL  PARERIGHT  EOM
model2 DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  PARERIGHT  EOM
out  EQUAL  model2 DOT predict PARELEFT  PARERIGHT  EOM
out DOT shape EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation EOM
from keras DOT layers DOT recurrent import LSTM EOM
in_out_neurons  EQUAL  2 EOM
hidden_neurons  EQUAL  300 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT in_out_neurons COMMA  hidden_neurons COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
import numpy as np EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers import Input COMMA  Dense EOM
from keras DOT models import Model EOM
from keras DOT layers DOT core import Reshape EOM
X  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
flatten  EQUAL  Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT   PARELEFT  PARERIGHT  EOM
h  EQUAL  LSTM PARELEFT 75 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model2  EQUAL  Model PARELEFT input EQUAL  COMMA  output EQUAL  PARERIGHT  EOM
model2 DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  PARERIGHT  EOM
out  EQUAL  model2 DOT predict PARELEFT  PARERIGHT  EOM
out DOT shapefrom keras DOT layers import Input COMMA  Dense COMMA  Conv2D COMMA  MaxPooling2D COMMA  UpSampling2D COMMA  LSTM COMMA  Embedding COMMA  Dropout EOM
from keras DOT models import Model COMMA  Sequential EOM
from keras import layers EOM
from keras import backend as K EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras import callbacks EOM
from keras DOT callbacks import TensorBoard EOM
from keras import metrics EOM
from keras import optimizers EOM
def model_v34 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 52 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 24  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v35 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 52 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 24  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v38 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 52 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v39 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v40 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v41 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v42 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v43 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v44 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v45 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v46 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v47 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v48 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v49 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v50 PARELEFT  PARERIGHT : EOM
model  EQUAL  model_v49 PARELEFT  PARERIGHT  EOM
return model EOM
def model_v51 PARELEFT  PARERIGHT : EOM
model  EQUAL  model_v49 PARELEFT  PARERIGHT  EOM
return model EOM
def model_v52 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 39 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v53 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_v54 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 18  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT callbacks import EarlyStopping EOM
from keras DOT optimizers import Nadam EOM
from keras DOT layers import Merge EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT utils DOT np_utils import to_categorical EOM
import numpy as np EOM
from sklearn DOT metrics import confusion_matrix COMMA  accuracy_score EOM
from import_dataset import x_accel_test COMMA  x_accel_validation COMMA  x_accel_train COMMA  y_accel_test COMMA  y_accel_validation COMMA  y_accel_train COMMA  z_accel_test COMMA  z_accel_validation COMMA  z_accel_train COMMA  x_gyro_test COMMA  x_gyro_validation COMMA  x_gyro_train COMMA  y_gyro_test COMMA  y_gyro_validation COMMA  y_gyro_train COMMA  z_gyro_test COMMA  z_gyro_validation COMMA  z_gyro_train COMMA  y_test COMMA  y_validation COMMA  y_train EOM
if __name__  EQUAL  EQUAL  : EOM
subsample  EQUAL  2 EOM
N_dense  EQUAL  60 EOM
N_LSTM  EQUAL  40 EOM
lr  EQUAL  9 DOT 7e-4 EOM
b1  EQUAL  0 DOT 9 EOM
b2  EQUAL  0 DOT 9 EOM
model_x_acc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_x_acc DOT add PARELEFT LSTM PARELEFT N_LSTM COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_y_acc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_y_acc DOT add PARELEFT LSTM PARELEFT N_LSTM COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_z_acc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_z_acc DOT add PARELEFT LSTM PARELEFT N_LSTM COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_x_gyr  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_x_gyr DOT add PARELEFT LSTM PARELEFT N_LSTM COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_y_gyr  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_y_gyr DOT add PARELEFT LSTM PARELEFT N_LSTM COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_z_gyr  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_z_gyr DOT add PARELEFT LSTM PARELEFT N_LSTM COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
merged  EQUAL  Merge PARELEFT [] COMMA mode EQUAL  PARERIGHT  EOM
final_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
final_model DOT add PARELEFT  PARERIGHT  EOM
final_model DOT add PARELEFT Dense PARELEFT N_dense COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
final_model DOT add PARELEFT Dense PARELEFT 9 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
nadam  EQUAL  Nadam PARELEFT lr EQUAL  COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  PARERIGHT  EOM
final_model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
y_train_c  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
y_validation_c  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
final_model DOT fit PARELEFT [] COMMA y_train_c COMMA validation_data EQUAL  PARELEFT  PARERIGHT  COMMA nb_epoch EQUAL  COMMA callbacks EQUAL [] PARERIGHT  EOM
predictions  EQUAL  np DOT argmax PARELEFT final_model DOT predict PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  EOM
predictions_train  EQUAL  np DOT argmax PARELEFT final_model DOT predict PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  EOM
predictions_val  EQUAL  np DOT argmax PARELEFT final_model DOT predict PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  EOM
test_acc  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
train_acc  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
val_acc  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
final_model DOT save PARELEFT  PARERIGHT  EOM
final_model DOT save_weights PARELEFT  PARERIGHT from __future__ import print_function EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import Adam EOM
from keras DOT datasets import imdb EOM
from keras DOT callbacks import TensorBoard COMMA  ModelCheckpoint EOM
from keras_diagram import ascii EOM
def binary_model PARELEFT embedding_size EQUAL  COMMA  window_size EQUAL  COMMA  window_step EQUAL  COMMA lstm_size EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 8 COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def multiclass_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 8 COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 00 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT window_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  2000 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader1  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list1  EQUAL  list PARELEFT  PARERIGHT  EOM
testX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y1  EQUAL  testdata DOT iloc[] EOM
y_test1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  2000 EOM
testX  EQUAL  sequence DOT pad_sequences PARELEFT testX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT callbacks import ModelCheckpoint EOM
def lstm_model PARELEFT seq_length COMMA  chars COMMA  n_neurons EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_neurons COMMA nput_shape EQUAL  PARELEFT seq_length COMMA  len PARELEFT  PARERIGHT  PARERIGHT  COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
return model EOM
from math import sqrt EOM
from numpy import concatenate EOM
from matplotlib import pyplot EOM
import numpy as np EOM
from pandas import read_csv EOM
from pandas import DataFrame EOM
from keras DOT models import load_model EOM
from pandas import concat EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from sklearn DOT preprocessing import LabelEncoder EOM
from sklearn DOT metrics import mean_squared_error EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT core import RepeatVector EOM
from keras DOT layers import Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD EOM
from keras DOT models import model_from_yaml EOM
import os EOM
from keras DOT utils import plot_model EOM
from keras DOT utils DOT vis_utils import plot_model EOM
from keras DOT utils DOT vis_utils import model_to_dot EOM
i  EQUAL  0 EOM
filenamelist  EQUAL  list PARELEFT  PARERIGHT  EOM
wholefilepath  EQUAL  dir +  + filename EOM
filenamelist DOT append PARELEFT  PARERIGHT  EOM
return filenamelist EOM
def data_to_reconstruction_problem PARELEFT  PARERIGHT : EOM
df  EQUAL  DataFrame PARELEFT  PARERIGHT  EOM
list_concat  EQUAL  list PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
tempdf  EQUAL  df DOT shift PARELEFT  PARERIGHT  EOM
list_concat DOT append PARELEFT  PARERIGHT  EOM
data_for_autoencoder  EQUAL  concat PARELEFT list_concat COMMA  axis EQUAL  PARERIGHT  EOM
data_for_autoencoder DOT dropna PARELEFT inplace EQUAL  PARERIGHT  EOM
return data_for_autoencoder EOM
def out_put_core PARELEFT  PARERIGHT : EOM
thefile  EQUAL  open PARELEFT  PARERIGHT  EOM
for item in writting_list: EOM
thefile DOT write PARELEFT  PARERIGHT  EOM
def data_preprocess PARELEFT  PARERIGHT : EOM
dataset  EQUAL  read_csv PARELEFT file_name COMMA  header EQUAL  COMMA  index_col EQUAL  PARERIGHT  EOM
if dataset DOT shape[]<16: EOM
return 0 COMMA 0 EOM
values  EQUAL  dataset DOT values EOM
reframed  EQUAL  data_to_reconstruction_problem PARELEFT  PARERIGHT  EOM
reframedvalues  EQUAL  reframed EOM
reframed  EQUAL  reframed DOT astype PARELEFT  PARERIGHT  EOM
scaler  EQUAL  MinMaxScaler PARELEFT feature_range EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
scaled  EQUAL  scaler DOT fit_transform PARELEFT  PARERIGHT  EOM
dfscaled  EQUAL  DataFrame PARELEFT  PARERIGHT  EOM
valuescaled  EQUAL dfscaled DOT values EOM
return  valuescaled COMMA scaler COMMA reframedvalues EOM
def SingleFileLstmAutoencoder PARELEFT  PARERIGHT : EOM
W_Hidden1_list  EQUAL  list PARELEFT  PARERIGHT  EOM
W_Hidden2_list  EQUAL  list PARELEFT  PARERIGHT  EOM
W_Hidden3_list  EQUAL  list PARELEFT  PARERIGHT  EOM
W_Hidden4_list  EQUAL  list PARELEFT  PARERIGHT  EOM
W_Hidden5_list  EQUAL  list PARELEFT  PARERIGHT  EOM
train_X COMMA  scaler COMMA  y  EQUAL  data_preprocess PARELEFT  PARERIGHT  EOM
train_X  EQUAL  train_X DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
sample_number  EQUAL  train_X DOT shape[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT outputlayer2 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT outputlayer3 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT outputlayer2 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_features COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def train5modelAE PARELEFT  PARERIGHT : EOM
k1  EQUAL  SingleFileLstmAutoencoder PARELEFT  PARERIGHT  EOM
k2  EQUAL  SingleFileLstmAutoencoder PARELEFT  PARERIGHT  EOM
k3  EQUAL  SingleFileLstmAutoencoder PARELEFT  PARERIGHT  EOM
k4  EQUAL  SingleFileLstmAutoencoder PARELEFT  PARERIGHT  EOM
k5  EQUAL  SingleFileLstmAutoencoder PARELEFT  PARERIGHT  EOM
return k1 COMMA  k2 COMMA  k3 COMMA  k4 COMMA  k5 EOM
apa  EQUAL  200 EOM
batch  EQUAL  10 EOM
timestep  EQUAL  16 EOM
numfeature  EQUAL  25 EOM
data_for_model_training_1  EQUAL  r EOM
data_for_model_training_2  EQUAL  r EOM
data_for_model_training_3  EQUAL  r EOM
data_for_model_training_4  EQUAL  r EOM
data_for_model_training_5  EQUAL  r EOM
k1 COMMA  k2 COMMA  k3 COMMA  k4 COMMA  k5  EQUAL  train5modelAE PARELEFT  PARERIGHT  EOM
filename  EQUAL   r EOM
timestep  EQUAL  16 EOM
numfeature  EQUAL  25 EOM
apa  EQUAL  10 EOM
batch  EQUAL  4 EOM
def postboosting PARELEFT  PARERIGHT : EOM
test_x COMMA  scaler COMMA y  EQUAL  data_preprocess PARELEFT  PARERIGHT  EOM
test_x  EQUAL  test_x DOT reshape PARELEFT  PARERIGHT  EOM
yhatk1  EQUAL  k1 DOT predict PARELEFT  PARERIGHT  EOM
yhatk2  EQUAL  k2 DOT predict PARELEFT  PARERIGHT  EOM
yhatk3  EQUAL  k3 DOT predict PARELEFT  PARERIGHT  EOM
yhatk4  EQUAL  k4 DOT predict PARELEFT  PARERIGHT  EOM
yhatk5  EQUAL  k5 DOT predict PARELEFT  PARERIGHT  EOM
inputofdense  EQUAL  np DOT concatenate PARELEFT  PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  DOT reshape PARELEFT  PARERIGHT  EOM
test_x  EQUAL  test_x DOT reshape PARELEFT  PARERIGHT  EOM
modelmerge  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelmerge DOT add PARELEFT Convolution2D PARELEFT nb_filter  EQUAL  COMMA nb_row  EQUAL  COMMA nb_col  EQUAL  COMMA  border_mode EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
modelmerge DOT compile PARELEFT loss EQUAL  COMMA  metrics EQUAL [] COMMA  optimizer EQUAL  PARERIGHT  EOM
history  EQUAL  modelmerge DOT fit PARELEFT inputofdense COMMA  test_x COMMA    nb_epoch EQUAL  COMMA   batch_size EQUAL  PARERIGHT  EOM
return modelmerge EOM
modelmerge  EQUAL postboosting PARELEFT  PARERIGHT  EOM
filepathlist  EQUAL  r EOM
test_x COMMA  scaler COMMA y  EQUAL  data_preprocess PARELEFT  PARERIGHT  EOM
test_x  EQUAL  test_x DOT reshape PARELEFT  PARERIGHT  EOM
yhatk1  EQUAL  k1 DOT predict PARELEFT  PARERIGHT  EOM
yhatk2  EQUAL  k2 DOT predict PARELEFT  PARERIGHT  EOM
yhatk3  EQUAL  k3 DOT predict PARELEFT  PARERIGHT  EOM
yhatk4  EQUAL  k4 DOT predict PARELEFT  PARERIGHT  EOM
yhatk5  EQUAL  k5 DOT predict PARELEFT  PARERIGHT  EOM
inputofdense  EQUAL  np DOT concatenate PARELEFT  PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  DOT reshape PARELEFT  PARERIGHT  EOM
yhat  EQUAL  modelmerge DOT predict PARELEFT  PARERIGHT  EOM
yhat  EQUAL  yhat DOT reshape PARELEFT  PARERIGHT  EOM
yhat  EQUAL  scaler DOT inverse_transform PARELEFT  PARERIGHT  EOM
rmse  EQUAL  np DOT sqrt PARELEFT np DOT mean PARELEFT  PARELEFT  PARELEFT  PARERIGHT  ** 2 PARERIGHT  COMMA axis EQUAL  PARERIGHT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA  RepeatVector COMMA  Merge EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT dropout EQUAL  COMMA  weights EQUAL [] COMMA  mask_zero EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
lstm  EQUAL  LSTM PARELEFT 200 COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  COMMA  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 3 COMMA  name EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
def get_vocab PARELEFT  PARERIGHT : EOM
vocab_count COMMA  vocab  EQUAL  Counter PARELEFT w for txt in lst for w in txt DOT split PARELEFT  PARERIGHT  PARERIGHT  EOM
return vocab COMMA  vocab_count EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import random EOM
import sys EOM
import numpy as np EOM
from sklearn DOT cross_validation import train_test_split EOM
from save_load_model import * EOM
from keras DOT models import Sequential EOM
from keras DOT models import model_from_json EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT regularizers import l1 COMMA  l2 COMMA  activity_l1 COMMA  activity_l2 EOM
from keras DOT utils DOT visualize_util import plot EOM
def createModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT settings DOT hiddenNodes COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT settings DOT hiddenNodes COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT settings DOT hiddenNodes COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
if  PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT settings DOT N_values COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
elif settings DOT l2Amount > 0: EOM
model DOT add PARELEFT Dense PARELEFT settings DOT N_values COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
settings DOT filename  EQUAL  settings DOT activation +  + settings DOT trainingset +  + str PARELEFT  PARERIGHT  + + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  EOM
save_model_scratch PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as settingsFile: EOM
for  PARELEFT  PARERIGHT  in vars PARELEFT  PARERIGHT  DOT items PARELEFT  PARERIGHT : EOM
settingsFile DOT write PARELEFT setting +  + str PARELEFT  PARERIGHT  +  PARERIGHT  EOM
if createPlot: EOM
plot PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT model_selection import StratifiedKFold EOM
from sklearn DOT model_selection import cross_val_score EOM
from sklearn DOT model_selection import GridSearchCV EOM
import numpy EOM
from babeltraceReader import * EOM
from sklearn DOT externals import joblib EOM
import babeltrace EOM
import threading COMMA  queue EOM
from datetime import datetime EOM
import os EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT model_selection import GridSearchCV EOM
import numpy EOM
from testFeatureExtraction import * EOM
import os EOM
def create_model1 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 8 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_model2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 8 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_model3 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 6 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def benchmarkLSTM PARELEFT  PARERIGHT : EOM
seed  EQUAL  7 EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
os DOT system PARELEFT  PARERIGHT  EOM
vec  EQUAL  DictVectorizer PARELEFT separator EQUAL  PARERIGHT  EOM
listeOutput  EQUAL  [] EOM
dictDataset  EQUAL  itertools DOT chain DOT from_iterable PARELEFT readCSV_data PARELEFT  PARERIGHT  PARERIGHT  EOM
for item in readCSV_output PARELEFT  PARERIGHT : EOM
listeOutput  EQUAL  listeOutput  + item EOM
X  EQUAL  vec DOT fit_transform PARELEFT  PARERIGHT  DOT toarray PARELEFT  PARERIGHT  EOM
Y  EQUAL  listeOutput EOM
scoring  EQUAL  [] EOM
kfold  EQUAL  StratifiedKFold PARELEFT n_splits EQUAL  COMMA  shuffle EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
model2  EQUAL  KerasClassifier PARELEFT build_fn EQUAL  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
scores2  EQUAL  cross_validate PARELEFT model2 COMMA  X COMMA  Y COMMA  cv EQUAL  COMMA scoring  EQUAL  PARERIGHT  EOM
save  EQUAL  joblib DOT dump PARELEFT  PARERIGHT  EOM
save  EQUAL  None EOM
save  EQUAL  joblib DOT dump PARELEFT  PARERIGHT  EOM
if save ! EQUAL  None : EOM
else: EOM
def LSTMFromCSV PARELEFT  PARERIGHT : EOM
seed  EQUAL  7 EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
os DOT system PARELEFT  PARERIGHT  EOM
vec  EQUAL  DictVectorizer PARELEFT separator EQUAL  PARERIGHT  EOM
listeOutput  EQUAL  [] EOM
dictDataset  EQUAL  itertools DOT chain DOT from_iterable PARELEFT readCSV_data PARELEFT  PARERIGHT  PARERIGHT  EOM
for item in readCSV_output PARELEFT  PARERIGHT : EOM
listeOutput  EQUAL  listeOutput  + item EOM
X  EQUAL  vec DOT fit_transform PARELEFT  PARERIGHT  DOT toarray PARELEFT  PARERIGHT  EOM
Y  EQUAL  listeOutput EOM
kfold  EQUAL  StratifiedKFold PARELEFT n_splits EQUAL  COMMA  shuffle EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
model1  EQUAL  KerasClassifier PARELEFT build_fn EQUAL  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
save  EQUAL  joblib DOT dump PARELEFT  PARERIGHT  EOM
save  EQUAL  None EOM
save  EQUAL  joblib DOT dump PARELEFT  PARERIGHT  EOM
if save ! EQUAL  None : EOM
else: EOM
def LSTMPredict PARELEFT  PARERIGHT : EOM
modele  EQUAL  EOM
dictVec  EQUAL  EOM
clf  EQUAL  joblib DOT load PARELEFT  PARERIGHT  EOM
vec  EQUAL  joblib DOT load PARELEFT  PARERIGHT  EOM
trace_collection  EQUAL  babeltrace DOT TraceCollection PARELEFT  PARERIGHT  EOM
trace_handle  EQUAL  trace_collection DOT add_trace PARELEFT  PARERIGHT  EOM
listeMachines  EQUAL  [] EOM
dicTid  EQUAL  {} EOM
dictCPUid  EQUAL  {} EOM
tempsDebut  EQUAL  datetime DOT now PARELEFT  PARERIGHT  DOT time PARELEFT  PARERIGHT  EOM
for event in trace_collection DOT events: EOM
try : EOM
eventpreprocessed  EQUAL  preprocessMoreEventsklearn PARELEFT  PARERIGHT  EOM
if clf DOT predict PARELEFT vec DOT transform PARELEFT  PARERIGHT  DOT toarray PARELEFT  PARERIGHT  PARERIGHT  ! EQUAL []: EOM
pass EOM
except TypeError: EOM
pass EOM
def benchmarkPredictLSTM PARELEFT  PARERIGHT : EOM
path  EQUAL  EOM
listeDirectory  EQUAL  [] EOM
listeDirectory  EQUAL  [] EOM
tempsDebut  EQUAL  EOM
tempsFin  EQUAL  EOM
for directory in listeDirectory: EOM
LSTMPredict PARELEFT  PARERIGHT  EOM
tempsFin  EQUAL  datetime DOT now PARELEFT  PARERIGHT  DOT time PARELEFT  PARERIGHT  EOM
def main PARELEFT  PARERIGHT : EOM
benchmarkPredictLSTM PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT  EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM COMMA  SimpleDeepRNN EOM
def simpleLSTM PARELEFT  PARERIGHT  : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  128 COMMA  activation EQUAL  COMMA  inner_activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  2 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM512 PARELEFT  PARERIGHT  : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 10 COMMA  256 COMMA  activation EQUAL  COMMA  inner_activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  128 COMMA  init EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  2 COMMA  init EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def simpleRNN PARELEFT  PARERIGHT  : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT SimpleDeepRNN PARELEFT 256 COMMA  128 COMMA  truncate_gradient EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  2 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def RNN512 PARELEFT  PARERIGHT  : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT SimpleDeepRNN PARELEFT 10 COMMA  256 COMMA  depth EQUAL  COMMA  truncate_gradient EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  128 COMMA  init EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  2 COMMA  init EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def GRU512 PARELEFT  PARERIGHT  : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT recurrent DOT GRU PARELEFT 10 COMMA  256 COMMA  truncate_gradient EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  128 COMMA  init EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  2 COMMA  init EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
Models  EQUAL  {:simpleRNN COMMA  :simpleLSTM COMMA  :LSTM512 COMMA  :RNN512 COMMA  :GRU512} EOM
AllModels  EQUAL  Models DOT keys PARELEFT  PARERIGHT  EOM
def getModel PARELEFT  PARERIGHT  : EOM
return Models[] PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
from keras DOT layers DOT merge import Concatenate COMMA  Add COMMA  add EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
word_feature_size  EQUAL  300 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
from __future__ import print_function EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Embedding EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU EOM
from keras DOT datasets import imdb EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT metrics import  PARELEFT  PARERIGHT  EOM
from sklearn import metrics EOM
from sklearn DOT preprocessing import Normalizer EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
X  EQUAL  traindata DOT iloc[] EOM
Y  EQUAL  traindata DOT iloc[] EOM
C  EQUAL  testdata DOT iloc[] EOM
T  EQUAL  testdata DOT iloc[] EOM
scaler  EQUAL  Normalizer PARELEFT  PARERIGHT  DOT fit PARELEFT  PARERIGHT  EOM
trainX  EQUAL  scaler DOT transform PARELEFT  PARERIGHT  EOM
np DOT set_printoptions PARELEFT precision EQUAL  PARERIGHT  EOM
scaler  EQUAL  Normalizer PARELEFT  PARERIGHT  DOT fit PARELEFT  PARERIGHT  EOM
testT  EQUAL  scaler DOT transform PARELEFT  PARERIGHT  EOM
np DOT set_printoptions PARELEFT precision EQUAL  PARERIGHT  EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testT COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  16 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  PARERIGHT  EOM
csv_logger  EQUAL  CSVLogger PARELEFT  COMMA separator EQUAL  COMMA  append EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout COMMA  Highway EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense COMMA  Embedding EOM
def model PARELEFT  PARERIGHT : EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_image DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_image DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_image DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT Embedding PARELEFT args DOT vocabulary_size COMMA  args DOT word_emb_dim COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
for i in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Conv1D COMMA  MaxPooling1D EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
import wandb EOM
from wandb DOT wandb_keras import WandbKerasCallback EOM
run  EQUAL  wandb DOT init PARELEFT  PARERIGHT  EOM
config  EQUAL  run DOT config EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT config DOT num_words COMMA  config DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 32 COMMA 3 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA callbacks EQUAL [] COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras DOT layers import Conv2D EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import pandas as pd EOM
import numpy as np EOM
def preprocess_DATA PARELEFT  PARERIGHT : EOM
features  EQUAL  dataset DOT shape[] EOM
dataset_train  EQUAL  dataset DOT iloc[] EOM
dataset_test  EQUAL  dataset DOT iloc[]] EOM
training_set  EQUAL  dataset_train DOT iloc[] DOT values EOM
training_set_label  EQUAL  dataset_train DOT iloc[] DOT values EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
scaler_features  EQUAL  MinMaxScaler PARELEFT feature_range  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
scaler_label  EQUAL  MinMaxScaler PARELEFT feature_range  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
training_set_scaled  EQUAL  scaler_features DOT fit_transform PARELEFT  PARERIGHT  EOM
training_set_scaled_label  EQUAL  scaler_label DOT fit_transform PARELEFT  PARERIGHT  EOM
X_train  EQUAL  [] EOM
y_train  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
X_train DOT append PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
y_train DOT append PARELEFT  PARERIGHT  EOM
X_train COMMA  y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  COMMA  np DOT array PARELEFT  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT X_train COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
ground_truth  EQUAL  dataset_test DOT iloc[] DOT values EOM
dataset_total  EQUAL  pd DOT concat PARELEFT  PARELEFT  PARERIGHT  COMMA  axis  EQUAL  PARERIGHT  EOM
dataset_total  EQUAL  dataset_total DOT iloc[] EOM
inputs  EQUAL  dataset_total[] DOT values EOM
inputs  EQUAL  inputs DOT reshape PARELEFT  PARERIGHT  EOM
inputs  EQUAL  scaler_features DOT transform PARELEFT  PARERIGHT  EOM
return X_train COMMA  y_train COMMA  inputs COMMA  ground_truth COMMA  scaler_features COMMA  scaler_label EOM
def build_LSTM PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL [] COMMA  return_sequences  EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL [] COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL [] COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer  EQUAL  COMMA  loss  EQUAL  PARERIGHT  EOM
return model EOM
def build_GRU PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import GRU EOM
from keras DOT layers import Dropout EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT units  EQUAL [] COMMA  return_sequences  EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT units  EQUAL [] COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT units  EQUAL [] COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT units  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer  EQUAL  COMMA  loss  EQUAL  PARERIGHT  EOM
return model EOM
def predict_MODEL PARELEFT  PARERIGHT : EOM
from math import sqrt EOM
from sklearn DOT metrics import mean_squared_error EOM
X_test  EQUAL  [] EOM
for i in range PARELEFT timestep COMMA  int PARELEFT len PARELEFT  PARERIGHT  PARERIGHT -Output PARERIGHT : EOM
X_test DOT append PARELEFT  PARERIGHT  EOM
X_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT X_test COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
Predicted  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
True_Output  EQUAL  inputs[] EOM
RMSE  EQUAL  sqrt PARELEFT mean_squared_error PARELEFT  PARERIGHT  PARERIGHT  EOM
Predicted  EQUAL  scaler_label DOT inverse_transform PARELEFT  PARERIGHT  EOM
True_Output  EQUAL  scaler_label DOT inverse_transform PARELEFT  PARERIGHT  EOM
return Predicted COMMA  True_Output COMMA  RMSE EOM
from keras DOT models import Sequential EOM
from keras DOT models import Model EOM
from keras DOT layers import Input EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Bidirectional EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Conv1D EOM
from keras DOT layers import MaxPooling1D EOM
from keras DOT layers import UpSampling1D EOM
from keras DOT layers import Concatenate EOM
from keras DOT optimizers import Adam EOM
def simple_LSTM PARELEFT  PARERIGHT : EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT name EQUAL  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT  PARERIGHT  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def bidirectional_LSTM PARELEFT  PARERIGHT : EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT name EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT  PARERIGHT  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def conv_LSTM PARELEFT  PARERIGHT : EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  clipnorm EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT name EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA 4 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA 4 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA 4 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA 4 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA ptimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def conv_LSTM PARELEFT  PARERIGHT : EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  clipnorm EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT name EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA 4 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA 4 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA 4 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA 4 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA ptimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def conv_LSTM2 PARELEFT  PARERIGHT : EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT name EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 16 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 32 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA ptimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def UNet_LSTM PARELEFT  PARERIGHT : EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
inputs  EQUAL  Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
conv1  EQUAL  Conv1D PARELEFT 32 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv2  EQUAL  Conv1D PARELEFT 32 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv3  EQUAL  Conv1D PARELEFT 64 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv4  EQUAL  Conv1D PARELEFT 64 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv7  EQUAL  Conv1D PARELEFT 128 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv8  EQUAL  Conv1D PARELEFT 128 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
drop1  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
up2  EQUAL  Conv1D PARELEFT 64 COMMA 2 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT UpSampling1D PARELEFT size EQUAL  PARERIGHT  PARELEFT  PARERIGHT  PARERIGHT  EOM
concat2  EQUAL  Concatenate PARELEFT axis EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv11  EQUAL  Conv1D PARELEFT 64 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv12  EQUAL  Conv1D PARELEFT 64 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
up3  EQUAL  Conv1D PARELEFT 32 COMMA 2 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT UpSampling1D PARELEFT size EQUAL  PARERIGHT  PARELEFT  PARERIGHT  PARERIGHT  EOM
concat3  EQUAL  Concatenate PARELEFT axis EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv13  EQUAL  Conv1D PARELEFT 32 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
conv14  EQUAL  Conv1D PARELEFT 128 COMMA 3 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm1  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm2  EQUAL  LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
flat1  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
dense1  EQUAL  Dense PARELEFT len PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT input EQUAL  COMMA  output EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA ptimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
activities  EQUAL  list PARELEFT range PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  UNet_LSTM PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT layers import TimeDistributed COMMA  Dense COMMA  Dropout COMMA Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT optimizers import RMSprop COMMA  Adam EOM
import numpy as np EOM
def one_layer_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  {: inp COMMA  : hidden COMMA  : outp} EOM
layers  EQUAL  {: 16 COMMA  : 64 COMMA  : 1} EOM
model DOT add PARELEFT LSTM PARELEFT 1 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  {: 48 COMMA  : 64 COMMA   : 128 COMMA  : 1} EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model  from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT utils DOT data_utils import get_file EOM
from keras DOT callbacks import EarlyStopping EOM
def create_lstm PARELEFT input_shape COMMA  optimizer EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelimport os EOM
global_model_version  EQUAL  61 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  36 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dense PARELEFT 24 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT optimizers import RMSprop EOM
def build PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT layers[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
from keras DOT callbacks import TensorBoard COMMA  EarlyStopping COMMA  ReduceLROnPlateau EOM
def run_network PARELEFT X_train COMMA  y_train COMMA  X_test COMMA  layers COMMA  epochs COMMA  batch_size EQUAL  PARERIGHT : EOM
model  EQUAL  build PARELEFT  PARERIGHT  EOM
history  EQUAL  None EOM
try: EOM
history  EQUAL  model DOT fit PARELEFT train COMMA  y_train COMMA  atch_size EQUAL  COMMA  pochs EQUAL  COMMA  validation_split EQUAL  COMMA callbacks EQUAL [] PARERIGHT  EOM
except KeyboardInterrupt: EOM
predicted  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
return model COMMA  predicted COMMA  historyfrom keras DOT utils import np_utils EOM
from keras DOT models import Sequential COMMA  load_model EOM
import keras DOT layers DOT recurrent EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT convolutional import Convolution1D COMMA  MaxPooling1D COMMA  Conv2D COMMA  MaxPooling2D EOM
def LSTM PARELEFT input_shape COMMA  nb_classes COMMA  counts EQUAL [] COMMA  dropout EQUAL  COMMA  optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
for ind COMMA  c in enumerate PARELEFT  PARERIGHT : EOM
ret_seq  EQUAL  not  PARELEFT ind  EQUAL  PARELEFT  PARERIGHT -1 PARERIGHT  EOM
if ind  EQUAL  EQUAL  0: EOM
model DOT add PARELEFT keras DOT layers DOT recurrent DOT LSTM PARELEFT c COMMA  input_shape EQUAL  COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras DOT layers DOT recurrent DOT LSTM PARELEFT c COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def Conv1D_2_class PARELEFT input_shape COMMA  nb_classes COMMA  nb_filter EQUAL  COMMA  dropout EQUAL  COMMA  optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
filter_length_1  EQUAL  50 EOM
filter_length_2  EQUAL  25 EOM
if nb_classes ! EQUAL 2: EOM
raise Exception PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA input_shape EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def cifar10_net PARELEFT input_shape COMMA  nb_classes COMMA  optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT : EOM
activ  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT rmsprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Activation EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Flatten EOM
from keras import metrics EOM
def create_cnn_model PARELEFT X COMMA  y COMMA  layers COMMA  output_dim COMMA  optimizer COMMA  dropout EQUAL  PARERIGHT : EOM
input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
output  EQUAL  y DOT shape[] EOM
regressor  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
regressor DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA kernel_size EQUAL  COMMA input_shape EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
if dropout > 0: EOM
regressor DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
regressor DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA kernel_size EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
if dropout > 0: EOM
regressor DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
regressor DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
regressor DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
activation  EQUAL  EOM
regressor DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
regressor DOT compile PARELEFT optimizer EQUAL  COMMA metrics EQUAL [] COMMA loss EQUAL  PARERIGHT  EOM
return regressor EOM
def create_stateless_lstm_model PARELEFT X COMMA  y COMMA  layers COMMA  output_dim COMMA  optimizer COMMA  dropout EQUAL  PARERIGHT : EOM
stateful  EQUAL  False EOM
input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
output  EQUAL  y DOT shape[] EOM
regressor  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
return_sequences  EQUAL  False if layers  EQUAL  EQUAL  1 else True EOM
regressor DOT add PARELEFT input_shape EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT dropout > 0:regressor DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT n range PARELEFT  PARERIGHT :t PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT equences  EQUAL  PARELEFT  EOM
LSTM PARELEFT units EQUAL  COMMA return_sequences EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT dropout > 0:regressor DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT regressor DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT tivation  EQUAL  PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT regressor DOT compile PARELEFT  EOM
optimizer EQUAL optimizer COMMA  EOM
metrics EQUAL [] COMMA  EOM
batch_input_shape EQUAL batch_input_shape COMMA  EOM
stateful EQUAL stateful PARERIGHT  PARERIGHT dropout > 0:regressor DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT n range PARELEFT  PARERIGHT :t PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT regressor DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA  EOM
return_sequences EQUAL return_sequences COMMA  EOM
import pandas as pd EOM
import numpy as np EOM
import nltk EOM
from nltk DOT corpus import stopwords EOM
from nltk DOT stem import SnowballStemmer EOM
import re EOM
from sklearn DOT metrics import accuracy_score EOM
import datetime COMMA  time COMMA  json EOM
from string import punctuation EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Embedding COMMA  Dense COMMA  Dropout COMMA  Reshape COMMA  Merge COMMA  BatchNormalization COMMA  TimeDistributed COMMA  Lambda COMMA  Activation COMMA  LSTM COMMA  Flatten COMMA  Convolution1D COMMA  GRU COMMA  MaxPooling1D EOM
from keras DOT regularizers import l2 EOM
from keras DOT callbacks import Callback COMMA  ModelCheckpoint COMMA  EarlyStopping EOM
from keras import initializers EOM
from keras import backend as K EOM
from keras DOT optimizers import SGD EOM
from keras DOT optimizers import Adadelta EOM
from collections import defaultdict EOM
from keras DOT utils import np_utils EOM
from keras DOT layers DOT advanced_activations import PReLU EOM
import codecs EOM
import random EOM
corpus  EQUAL  pd DOT read_csv PARELEFT  PARERIGHT  EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
corpus  EQUAL  corpus DOT reindex PARELEFT np DOT random DOT permutation PARELEFT  PARERIGHT  PARERIGHT  EOM
def process_blog PARELEFT  PARERIGHT : EOM
random DOT shuffle PARELEFT  PARERIGHT  EOM
corpus_post COMMA  y_train  EQUAL  zip PARELEFT  PARERIGHT  EOM
c EQUAL [] EOM
import tensorflow as tf EOM
import os EOM
os DOT environ[]  EQUAL  EOM
Sequential  EQUAL  tf DOT keras DOT models DOT Sequential EOM
Dense  EQUAL  tf DOT keras DOT layers DOT Dense EOM
Dropout  EQUAL  tf DOT keras DOT layers DOT Dropout EOM
LSTM  EQUAL  tf DOT keras DOT layers DOT LSTM EOM
mnist  EQUAL tf DOT keras DOT datasets DOT mnist EOM
 PARELEFT  PARERIGHT  COMMA  PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
x_test  EQUAL  x_test/255 EOM
x_train  EQUAL  x_train/255 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA activation  EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  tf DOT keras DOT optimizers DOT Adam PARELEFT lr EQUAL  COMMA decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA ptimizer  EQUAL  COMMA metrics  EQUAL []	 PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA y_train COMMA epochs EQUAL  COMMA validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class BotPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom sentifmdetect import featurizer EOM
from sentifmdetect import util EOM
import os EOM
import keras EOM
from keras DOT optimizers import Adam EOM
from keras import backend EOM
from keras DOT layers import Dense COMMA  Input COMMA  Flatten COMMA  Dropout COMMA  Merge COMMA  BatchNormalization EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding COMMA  LSTM COMMA  Bidirectional EOM
from keras DOT models import Model COMMA  Sequential EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from sklearn DOT model_selection import train_test_split COMMA  RandomizedSearchCV EOM
from sklearn DOT metrics import precision_recall_fscore_support COMMA  classification_report COMMA  f1_score COMMA  precision_score COMMA \ EOM
recall_score COMMA  roc_auc_score EOM
import numpy as np EOM
def create_emb_lstm PARELEFT bidirectional EQUAL  COMMA lstm_units EQUAL  COMMA lstm_dropout EQUAL  COMMA lstm_recurrent_dropout EQUAL  COMMA ptimizer EQUAL  PARELEFT  PARERIGHT  COMMA metrics EQUAL [] PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
embeddings_index  EQUAL  featurizer DOT load_emb PARELEFT  PARERIGHT  EOM
EMBEDDINGS_MATRIX  EQUAL  featurizer DOT make_embedding_matrix PARELEFT  PARERIGHT  EOM
EMB_DIM  EQUAL  EMBEDDINGS_MATRIX DOT shape[] EOM
model DOT add PARELEFT edding PARELEFT settings DOT EMB_INPUT_DIM COMMA  EMB_DIM COMMA  weights EQUAL [] COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
elif isinstance PARELEFT  PARERIGHT : EOM
EMB_DIM  EQUAL  wvec EOM
model DOT add PARELEFT bedding PARELEFT settings DOT EMB_INPUT_DIM COMMA  EMB_DIM COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
logging DOT error PARELEFT  PARERIGHT  EOM
if bidirectional: EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT lstm_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT settings DOT OUTPUT_UNITS COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL [] PARELEFT  PARERIGHT  COMMA  metrics EQUAL  PARERIGHT  EOM
return model EOM
class KerasClassifierCustom PARELEFT  PARERIGHT : EOM
return self DOT model DOT predict PARELEFT  PARERIGHT  EOM
class GlobalMetrics PARELEFT  PARERIGHT : EOM
self DOT from_categorical  EQUAL  True EOM
if isinstance PARELEFT  PARERIGHT : EOM
self DOT global_metrics  EQUAL  metrics EOM
else: EOM
raise TypeError PARELEFT  PARERIGHT  EOM
self DOT global_scores  EQUAL  {} EOM
def on_epoch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
predict  EQUAL  np DOT asarray PARELEFT self DOT model DOT predict PARELEFT  PARERIGHT  PARERIGHT  EOM
targ  EQUAL  self DOT validation_data[] EOM
if self DOT from_categorical: EOM
predict  EQUAL  predict DOT argmax PARELEFT axis EQUAL  PARERIGHT  EOM
targ  EQUAL  targ DOT argmax PARELEFT axis EQUAL  PARERIGHT  EOM
for metric COMMA  kwargs in self DOT global_metrics: EOM
self DOT global_scores[]  EQUAL  metric PARELEFT  PARERIGHT  EOM
return EOM
class KerasRandomizedSearchCV PARELEFT  PARERIGHT : EOM
pred  EQUAL  super PARELEFT  PARERIGHT  DOT predict PARELEFT  PARERIGHT  EOM
backend DOT clear_session PARELEFT  PARERIGHT  EOM
return pred EOM
if __name__  EQUAL  EQUAL  : EOM
from sklearn DOT datasets import make_moons EOM
from sklearn DOT model_selection import RandomizedSearchCV EOM
from keras DOT regularizers import l2 EOM
dataset  EQUAL  make_moons PARELEFT  PARERIGHT  EOM
def build_fn PARELEFT nr_of_layers EQUAL  COMMA first_layer_size EQUAL  COMMA layers_slope_coeff EQUAL  COMMA dropout EQUAL  COMMA activation EQUAL  COMMA weight_l2 EQUAL  COMMA act_l2 EQUAL  COMMA input_dim EQUAL  PARERIGHT : EOM
result_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
result_model DOT add PARELEFT Dense PARELEFT first_layer_size COMMA input_dim EQUAL  COMMA activation EQUAL  COMMA W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
current_layer_size  EQUAL  int PARELEFT  PARERIGHT  + 1 EOM
for index_of_layer in range PARELEFT  PARERIGHT : EOM
result_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
result_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
result_model DOT add PARELEFT Dense PARELEFT current_layer_size COMMA W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
current_layer_size  EQUAL  int PARELEFT  PARERIGHT  + 1 EOM
result_model DOT add PARELEFT Dense PARELEFT 1 COMMA activation EQUAL  COMMA W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
result_model DOT compile PARELEFT optimizer EQUAL  COMMA  metrics EQUAL [] COMMA  loss EQUAL  PARERIGHT  EOM
return result_model EOM
NeuralNet  EQUAL  KerasClassifier PARELEFT  PARERIGHT import numpy EOM
import pandas EOM
from sklearn import preprocessing EOM
from sklearn import cross_validation EOM
from matplotlib import pyplot EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dense COMMA  Dropout EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from keras import callbacks EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
from keras DOT layers DOT recurrent import LSTM EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
scaler  EQUAL  MinMaxScaler PARELEFT feature_range EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
train  EQUAL  scaler DOT fit_transform PARELEFT  PARERIGHT  EOM
train  EQUAL  np DOT reshape PARELEFT train COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
trainlabel  EQUAL  pandas DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
scaler  EQUAL  MinMaxScaler PARELEFT feature_range EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_label  EQUAL  scaler DOT fit_transform PARELEFT  PARERIGHT  EOM
train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
train_label  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  PARERIGHT  EOM
csv_logger  EQUAL  CSVLogger PARELEFT  COMMA separator EQUAL  COMMA  append EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT train COMMA  train_label COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
import time EOM
from keras DOT layers DOT core import Dense EOM
from keras DOT layers DOT core import Dropout COMMA  Activation EOM
from keras DOT layers DOT recurrent import LSTM COMMA  SimpleRNN EOM
from keras DOT models import Sequential EOM
def build_model_mlp PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_model_recurrent PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT output_dim EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_model_lstm_simple PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_model_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hiddens2 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
import numpy as np EOM
from tensorflow DOT python import keras EOM
from tensorflow DOT python DOT framework import test_util as tf_test_util EOM
from tensorflow DOT python DOT keras import testing_utils EOM
from tensorflow DOT python DOT platform import test EOM
from tensorflow DOT python DOT training import adam EOM
from tensorflow DOT python DOT training import gradient_descent EOM
from tensorflow DOT python DOT training DOT rmsprop import RMSPropOptimizer EOM
class LSTMLayerTest PARELEFT  PARERIGHT : EOM
def test_return_sequences_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA return_sequences EOM
def test_static_shape_inference_LSTM PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
inputs  EQUAL  keras DOT layers DOT Dense PARELEFT embedding_dim COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
outputs  EQUAL  model DOT layers[] DOT output EOM
self DOT assertEquals PARELEFT outputs DOT get_shape PARELEFT  PARERIGHT  DOT as_list PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def test_dynamic_behavior_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT RMSPropOptimizer PARELEFT  PARERIGHT  COMMA   PARERIGHT  EOM
x  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_dropout_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA dropout: 0 DOT 1} COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_implementation_mode_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
for mode in []: EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA implementation EOM
def test_constraints_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
k_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
r_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
b_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  COMMA recurrent_constraint EQUAL  COMMA bias_constraint EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
def test_with_masking_layer_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layer_class PARELEFT units EQUAL  COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_masking_with_stacking_LSTM PARELEFT  PARERIGHT : EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_cells  EQUAL  [] EOM
model DOT add PARELEFT keras DOT layers DOT RNN PARELEFT lstm_cells COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_from_config_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
for stateful in  PARELEFT  PARERIGHT : EOM
l1  EQUAL  layer_class PARELEFT units EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
l2  EQUAL  layer_class DOT from_config PARELEFT l1 DOT get_config PARELEFT  PARERIGHT  PARERIGHT  EOM
assert l1 DOT get_config PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL       output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL [] PARERIGHT  EOM
else: EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_non_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [keras DOT backend DOT random_normal_variable PARELEFT  PARERIGHT  COMMA  0 COMMA  1 PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_reset_states_with_values PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  stateful EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
assert len PARELEFT  PARERIGHT   EQUAL     assert layer DOT states[] is not None EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT zeros PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
state_shapes  EQUAL  [] EOM
values  EQUAL  [] EOM
if len PARELEFT  PARERIGHT   EQUAL       values  EQUAL  values[] EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT ones PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
with self DOT assertRaises PARELEFT  PARERIGHT : EOM
layer DOT reset_states PARELEFT [] *  PARELEFT len PARELEFT  PARERIGHT  + 1 PARERIGHT  PARERIGHT  EOM
def test_specify_state_with_masking PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
_  EQUAL  keras DOT layers DOT Masking PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_return_state PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
state  EQUAL  outputs[] EOM
assert len PARELEFT  PARERIGHT   EQUAL     model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
state  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA  state COMMA  atol EQUAL  PARERIGHT  EOM
def test_state_reuse PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
output COMMA  state  EQUAL  outputs[] COMMA  outputs[] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT output COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
outputs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def test_initial_states_as_other_inputs PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
num_states  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
main_inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
inputs  EQUAL  [] + initial_state EOM
layer  EQUAL  layer_class PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
main_inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
class LSTMLayerGraphOnlyTest PARELEFT  PARERIGHT : EOM
def test_statefulness_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT cached_session PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT 4 COMMA embedding_dim COMMA mask_zero EQUAL  COMMA input_length EQUAL  COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT ts COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  weights EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  PARELEFT  PARERIGHT  COMMA loss EQUAL  PARERIGHT  EOM
out1  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT out1 DOT shape COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
out2  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out1 DOT max PARELEFT  PARERIGHT  COMMA  out2 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
out3  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out2 DOT max PARELEFT  PARERIGHT  COMMA  out3 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
out4  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out3 COMMA  out4 COMMA  atol EQUAL  PARERIGHT  EOM
out5  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out4 DOT max PARELEFT  PARERIGHT  COMMA  out5 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
left_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
left_padded_input[]  EQUAL  0 EOM
left_padded_input[]  EQUAL  0 EOM
out6  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
right_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
right_padded_input[]  EQUAL  0 EOM
right_padded_input[]  EQUAL  0 EOM
out7  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out7 COMMA  out6 COMMA  atol EQUAL  PARERIGHT  EOM
def test_regularizers_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT cached_session PARELEFT  PARERIGHT : EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  COMMA activity_regularizer EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  3 PARERIGHT  EOM
x  EQUAL  keras DOT backend DOT variable PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT layer DOT get_losses_for PARELEFT  PARERIGHT  PARERIGHT  COMMA  1 PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
test DOT main PARELEFT  PARERIGHT import pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM EOM
from keras import backend as K EOM
from keras_tqdm import TQDMNotebookCallback EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA test_size EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
modelLSTM_2a  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT summary PARELEFT  PARERIGHT  EOM
modelLSTM_2a DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
LSTM_history  EQUAL  modelLSTM_2a DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense COMMA  Activation EOM
from keras DOT layers import TimeDistributed COMMA  GaussianNoise COMMA  GaussianDropout COMMA  Dropout EOM
from keras DOT models import Model EOM
def build_model_without_TS PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_neuron COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_neuron COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_model_with_TS PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_neuron COMMA  return_sequences EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_neuron COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_neuron COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model EOM
from __future__ import print_function EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import LSTM EOM
from keras import regularizers EOM
def mlp_softmax PARELEFT dim EQUAL  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 7 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_stack PARELEFT timesteps EQUAL  COMMA  data_dim EQUAL  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 7 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT layers import Embedding COMMA  LSTM COMMA  TimeDistributed COMMA  Dense COMMA  Dropout EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
from keras DOT optimizers import Adam EOM
from Tokenizer import constant EOM
class Model PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT constant DOT NUM_CHARS COMMA  5 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT constant DOT NUM_TAGS COMMA  activation EQUAL  PARERIGHT  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  modelimport pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM COMMA  Dropout EOM
from keras import backend as K EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
LSTM_history  EQUAL  LSTM_model DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras DOT layers import Conv2D EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class RestaurantPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom random import random EOM
from numpy import array EOM
from numpy import cumsum EOM
from matplotlib import pyplot EOM
from pandas import DataFrame EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Bidirectional EOM
def get_sequence PARELEFT  PARERIGHT : EOM
X  EQUAL  array PARELEFT [] PARERIGHT  EOM
limit  EQUAL  n_timesteps / 4 DOT 0 EOM
y  EQUAL  array PARELEFT [] PARERIGHT  EOM
X  EQUAL  X DOT reshape PARELEFT  PARERIGHT  EOM
y  EQUAL  y DOT reshape PARELEFT  PARERIGHT  EOM
return X COMMA  y EOM
def get_lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 20 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def get_bi_lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 20 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def train_model PARELEFT  PARERIGHT : EOM
loss  EQUAL  list PARELEFT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
X COMMA  y  EQUAL  get_sequence PARELEFT  PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT X COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
loss DOT append PARELEFT  PARERIGHT  EOM
return loss EOM
n_timesteps  EQUAL  10 EOM
results  EQUAL  DataFrame PARELEFT  PARERIGHT  EOM
model  EQUAL  get_lstm_model PARELEFT  PARERIGHT  EOM
results[]  EQUAL  train_model PARELEFT  PARERIGHT  EOM
model  EQUAL  get_lstm_model PARELEFT  PARERIGHT  EOM
results[]  EQUAL  train_model PARELEFT  PARERIGHT  EOM
model  EQUAL  get_bi_lstm_model PARELEFT  PARERIGHT  EOM
results[]  EQUAL  train_model PARELEFT  PARERIGHT  EOM
results DOT plot PARELEFT  PARERIGHT  EOM
pyplot DOT show PARELEFT  PARERIGHT from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import LSTM EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import RMSprop EOM
class LSTMRNN PARELEFT  PARERIGHT : EOM
def build PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA 		input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  RMSprop PARELEFT lr  EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer  EQUAL  PARERIGHT  EOM
return modelimport pandas as pd EOM
import tensorflow as tf EOM
import matplotlib DOT pyplot as plt EOM
import keras EOM
import numpy as np EOM
import scikitplot DOT plotters as skplt EOM
from sklearn DOT model_selection import train_test_split EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  LSTM EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT models import load_model EOM
from keras DOT optimizers import Adam EOM
train  EQUAL  pd DOT read_pickle PARELEFT  PARERIGHT  EOM
test  EQUAL  pd DOT read_pickle PARELEFT  PARERIGHT  EOM
num_words  EQUAL  2000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
X  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
X  EQUAL  pad_sequences PARELEFT X COMMA  maxlen EQUAL  PARERIGHT  EOM
embed_dim  EQUAL  128 EOM
ckpt_callback  EQUAL  ModelCheckpoint PARELEFT  COMMA monitor EQUAL  COMMA verbose EQUAL  COMMA save_best_only EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT num_words COMMA  embed_dim COMMA  input_length  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 196 COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 196 COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 9 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  optimizer EQUAL  COMMA  metrics  EQUAL [] PARERIGHT  EOM
Y  EQUAL  pd DOT get_dummies PARELEFT  PARERIGHT  DOT values EOM
X_train COMMA  X_test COMMA  Y_train COMMA  Y_test  EQUAL  train_test_split PARELEFT X COMMA  Y COMMA  test_size  EQUAL  COMMA  random_state  EQUAL  COMMA  stratify EQUAL  PARERIGHT  EOM
batch_size  EQUAL  64 EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
probas  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
pred_indices  EQUAL  np DOT argmax PARELEFT probas COMMA  axis EQUAL  PARERIGHT  EOM
classes  EQUAL  np DOT array PARELEFT range PARELEFT  PARERIGHT  PARERIGHT  EOM
preds  EQUAL  classes[] EOM
skplt DOT plot_confusion_matrix PARELEFT classes[] COMMA  preds PARERIGHT  EOM
Xtest  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
Xtest  EQUAL  pad_sequences PARELEFT Xtest COMMA  maxlen EQUAL  PARERIGHT  EOM
probas  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
submission_df  EQUAL  pd DOT DataFrame PARELEFT probas COMMA  columns EQUAL [] PARERIGHT  EOM
submission_df[]  EQUAL  df_test[] EOM
submission_df DOT head PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout COMMA  Highway EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense COMMA  Embedding EOM
def model PARELEFT  PARERIGHT : EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT Embedding PARELEFT args DOT vocabulary_size COMMA  args DOT word_emb_dim COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for i in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Bidirectional COMMA  LSTM EOM
from keras DOT layers DOT core import Dropout COMMA  Dense EOM
class BidirectionalLSTMNet: EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 320 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  class_mode EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
class TimeDistributedLSTMNet: EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 320 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  class_mode EQUAL  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers import ConvLSTM2D EOM
class Models PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT n_timesteps  EQUAL  n_timesteps EOM
self DOT n_features  EQUAL  n_features EOM
self DOT n_outputs  EQUAL  n_outputs EOM
self DOT n_steps  EQUAL  n_steps EOM
self DOT n_length  EQUAL  n_length EOM
if model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT cnnlstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT convlstm PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT n_outputs COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def cnnlstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  activation EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT n_outputs COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def convlstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT ConvLSTM2D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT n_outputs COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelimport os EOM
global_model_version  EQUAL  38 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT convolutional import Convolution1D COMMA  MaxPooling1D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from DSTC2 DOT traindev DOT scripts import myLogger EOM
from keras DOT layers DOT pooling import GlobalMaxPooling1D EOM
from keras DOT models import Sequential EOM
from keras DOT preprocessing import sequence EOM
from keras DOT layers import Embedding EOM
from keras DOT datasets import imdb EOM
from keras DOT utils DOT visualize_util import plot EOM
import numpy as np EOM
__author__  EQUAL  EOM
def basic_cnn_LSTM_init PARELEFT  PARERIGHT : EOM
return input_mtr COMMA  output_mtr EOM
def output_shape PARELEFT  PARERIGHT : EOM
y_train  EQUAL  np DOT array PARELEFT map PARELEFT lambda session: reduce PARELEFT lambda sentence1 COMMA  sentence2: np DOT hstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  session PARERIGHT  COMMA  y_train PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT map PARELEFT lambda session: reduce PARELEFT lambda sentence1 COMMA  sentence2: np DOT hstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  session PARERIGHT  COMMA  y_test PARERIGHT  PARERIGHT  EOM
return y_train COMMA  y_test EOM
def get_mixed PARELEFT  PARERIGHT : EOM
logger  EQUAL  myLogger DOT myLogger PARELEFT  PARERIGHT  EOM
logger DOT info PARELEFT  PARERIGHT  EOM
filter_length  EQUAL  5 EOM
nb_filter  EQUAL  16 EOM
pool_length  EQUAL  4 EOM
lstm_output_size  EQUAL  1024 EOM
layer  EQUAL  3 EOM
hidden_size  EQUAL  1024 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_output_size COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
plot PARELEFT model COMMA  to_file EQUAL  PARERIGHT  EOM
return model EOM
def sample_mixed PARELEFT  PARERIGHT : EOM
max_features  EQUAL  20000 EOM
maxlen  EQUAL  100 EOM
embedding_size  EQUAL  128 EOM
filter_length  EQUAL  5 EOM
nb_filter  EQUAL  64 EOM
pool_length  EQUAL  4 EOM
lstm_output_size  EQUAL  70 EOM
batch_size  EQUAL  30 EOM
nb_epoch  EQUAL  2 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
score COMMA  acc  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
import pickle EOM
from keras DOT callbacks import ModelCheckpoint COMMA  RemoteMonitor EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT models import Sequential EOM
import dataset as ds EOM
from sample_model import SampleModelCallback EOM
batches_per_epoch  EQUAL  1500 EOM
batch_size  EQUAL  256 EOM
samples_per_epoch  EQUAL  batches_per_epoch * batch_size EOM
seq_length  EQUAL  50 EOM
vocab_length  EQUAL  ds DOT vocab_length PARELEFT  PARERIGHT  EOM
generator  EQUAL  ds DOT dataset PARELEFT  PARERIGHT  EOM
def large_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT vocab_length COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def small_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT vocab_length COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
model  EQUAL  large_model PARELEFT  PARERIGHT  EOM
filename  EQUAL  EOM
if os DOT path DOT isfile PARELEFT  PARERIGHT : EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
filepath  EQUAL  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
sample  EQUAL  SampleModelCallback PARELEFT  PARERIGHT  EOM
remote  EQUAL  RemoteMonitor PARELEFT root EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
history  EQUAL  model DOT fit_generator PARELEFT generator EQUAL  COMMA  nb_epoch EQUAL  COMMA  samples_per_epoch EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  39 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Merge COMMA  Dropout COMMA  Reshape EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT utils DOT visualize_util import plot EOM
num_hidden_units_mlp  EQUAL  1024 EOM
num_hidden_units_lstm  EQUAL  512 EOM
img_dim  EQUAL  900 EOM
word_vec_dim  EQUAL  300 EOM
max_len  EQUAL  100 EOM
nb_classes  EQUAL  1000 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_hidden_units_mlp COMMA  input_dim EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_hidden_units_mlp COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_hidden_units_mlp COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT nb_classes COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT import os EOM
global_model_version  EQUAL  29 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3_1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3_1 DOT add PARELEFT  PARERIGHT  EOM
branch_3_1 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3_2 DOT add PARELEFT  PARERIGHT  EOM
branch_3_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4_1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4_1 DOT add PARELEFT  PARERIGHT  EOM
branch_4_1 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4_2 DOT add PARELEFT  PARERIGHT  EOM
branch_4_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5_1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5_1 DOT add PARELEFT  PARERIGHT  EOM
branch_5_1 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5_2 DOT add PARELEFT  PARERIGHT  EOM
branch_5_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_1 DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_1 DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model_1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_1 DOT add PARELEFT Dense PARELEFT 300 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import os EOM
import time EOM
import numpy as np EOM
from functools import wraps EOM
from sklearn DOT externals import joblib EOM
from sklearn DOT preprocessing import LabelBinarizer EOM
from sklearn DOT model_selection import cross_val_score EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT models import load_model COMMA  Sequential EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  LSTM EOM
N_FEATURES  EQUAL  10000 EOM
DOC_LEN  EQUAL  60 EOM
N_CLASSES  EQUAL  2 EOM
def timeit PARELEFT  PARERIGHT : EOM
def wrapper PARELEFT  PARERIGHT : EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
result  EQUAL  func PARELEFT  PARERIGHT  EOM
return result COMMA  time DOT time PARELEFT  PARERIGHT  - start EOM
return wrapper EOM
def documents PARELEFT  PARERIGHT : EOM
return list PARELEFT corpus DOT reviews PARELEFT  PARERIGHT  PARERIGHT  EOM
def continuous PARELEFT  PARERIGHT : EOM
return list PARELEFT corpus DOT scores PARELEFT  PARERIGHT  PARERIGHT  EOM
def make_categorical PARELEFT  PARERIGHT : EOM
return np DOT digitize PARELEFT continuous PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def binarize PARELEFT  PARERIGHT : EOM
return np DOT digitize PARELEFT continuous PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def build_nn PARELEFT  PARERIGHT : EOM
nn DOT add PARELEFT Dense PARELEFT 500 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nn DOT add PARELEFT Dense PARELEFT 150 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
nn DOT add PARELEFT Dense PARELEFT N_CLASSES COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
nn DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return nn EOM
def build_lstm PARELEFT  PARERIGHT : EOM
lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm DOT add PARELEFT Embedding PARELEFT N_FEATURES+1 COMMA  128 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dense PARELEFT N_CLASSES COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT compile PARELEFT optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return lstm EOM
def train_model PARELEFT path COMMA  model COMMA  reader COMMA  saveto EQUAL  COMMA  cv EQUAL  COMMA  **kwargs PARERIGHT : EOM
corpus  EQUAL  PickledAmazonReviewsReader PARELEFT  PARERIGHT  EOM
X  EQUAL  documents PARELEFT  PARERIGHT  EOM
y  EQUAL  binarize PARELEFT  PARERIGHT  EOM
scores  EQUAL  cross_val_score PARELEFT model COMMA  X COMMA  y COMMA  cv EQUAL  COMMA  scoring EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
if saveto: EOM
model DOT steps[][] DOT model DOT save PARELEFT  PARERIGHT  EOM
model DOT steps DOT pop PARELEFT  PARERIGHT  EOM
joblib DOT dump PARELEFT  PARERIGHT  EOM
return scores EOM
if __name__  EQUAL  EQUAL  : EOM
from sklearn DOT pipeline import Pipeline EOM
from sklearn DOT feature_extraction DOT text import TfidfVectorizer EOM
from reader import PickledReviewsReader EOM
from am_reader import PickledAmazonReviewsReader EOM
from transformer import TextNormalizer COMMA  GensimDoc2Vectorizer EOM
from transformer import KeyphraseExtractor COMMA  GensimTfidfVectorizer EOM
cpath  EQUAL  EOM
mpath  EQUAL  {:  COMMA : } EOM
import sys EOM
import os EOM
import zipfile EOM
import numpy as np EOM
import tensorflow as tf EOM
from keras DOT models import Sequential EOM
from keras DOT layers import CuDNNLSTM COMMA  Dense COMMA  LSTM COMMA  Convolution1D COMMA  Flatten EOM
from keras DOT layers import Dropout COMMA  GlobalAveragePooling1D COMMA  MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras import optimizers EOM
from keras DOT backend DOT tensorflow_backend import set_session EOM
from keras DOT callbacks import TensorBoard COMMA  EarlyStopping EOM
def model_covNet PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  5000 EOM
embedding_size  EQUAL  32 EOM
max_review_length  EQUAL  500 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_size COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
for i in layer: EOM
model DOT add PARELEFT Convolution1D PARELEFT i COMMA  3 COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT i COMMA  3 COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
if i! EQUAL layer[]: EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_mlp PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  5000 EOM
embedding_size  EQUAL  32 EOM
max_review_length  EQUAL  500 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_size COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in layer: EOM
model DOT add PARELEFT Dense PARELEFT i COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_lstm PARELEFT  PARERIGHT : EOM
vocab_size  EQUAL  5000 EOM
embedding_size  EQUAL  32 EOM
max_review_length  EQUAL  500 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_size COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def training PARELEFT  PARERIGHT : EOM
global np COMMA  sequence COMMA  Sequential COMMA  optimizers COMMA  TensorBoard COMMA  EarlyStopping EOM
if PARELEFT isTrain EQUAL  PARERIGHT : EOM
data  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
else: EOM
data  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
data EQUAL data DOT item PARELEFT  PARERIGHT  EOM
reviews_feats  EQUAL  data[] EOM
ratings  EQUAL  data[] EOM
max_review_length  EQUAL  500 EOM
X  EQUAL  sequence DOT pad_sequences PARELEFT reviews_feats COMMA  maxlen EQUAL  PARERIGHT  EOM
ratings  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X_train  EQUAL  X EOM
y_train  EQUAL  ratings EOM
data  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
data EQUAL data DOT item PARELEFT  PARERIGHT  EOM
reviews_feats  EQUAL  data[] EOM
ratings  EQUAL  data[] EOM
max_review_length  EQUAL  500 EOM
X  EQUAL  sequence DOT pad_sequences PARELEFT reviews_feats COMMA  maxlen EQUAL  PARERIGHT  EOM
ratings  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X_test  EQUAL  X EOM
y_test  EQUAL  ratings EOM
if model  EQUAL  EQUAL  : EOM
model  EQUAL  model_lstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
model  EQUAL  model_mlp PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
model  EQUAL  model_covNet PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA trics  EQUAL [] PARERIGHT  EOM
earlystopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA min_delta EQUAL  COMMA patience EQUAL  COMMA verbose EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA callbacks EQUAL [] COMMA shuffle EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
if isTrain EQUAL  EQUAL 1: EOM
model_json  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
results  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
return results[]**0 DOT 5 EOM
if  PARELEFT len PARELEFT  PARERIGHT  > 1 and sys DOT argv[] EQUAL  PARERIGHT : EOM
if os DOT path DOT exists PARELEFT  PARERIGHT : EOM
os DOT remove PARELEFT  PARERIGHT  EOM
with zipfile DOT ZipFile PARELEFT  PARERIGHT  as zip_ref: EOM
zip_ref DOT extractall PARELEFT  PARERIGHT  EOM
os DOT rename PARELEFT  PARERIGHT  EOM
f  EQUAL  open PARELEFT  PARERIGHT  EOM
arguments  EQUAL  f DOT readline PARELEFT  PARERIGHT  DOT split PARELEFT  PARERIGHT  EOM
model  EQUAL  arguments[] EOM
if model  EQUAL  EQUAL  : EOM
output  EQUAL  arguments[] EOM
rmse  EQUAL  training PARELEFT model COMMA  int PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  EOM
else: EOM
output  EQUAL  [] EOM
for i in range PARELEFT 1 COMMA  len PARELEFT  PARERIGHT -1 PARERIGHT : EOM
layer  EQUAL  arguments[] DOT replace PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer DOT replace PARELEFT  PARERIGHT  EOM
output DOT append PARELEFT int PARELEFT  PARERIGHT  PARERIGHT  EOM
rmse  EQUAL  training PARELEFT  PARERIGHT  EOM
f DOT close PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential COMMA load_model EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  LSTM EOM
from keras DOT utils import np_utils EOM
from keras DOT wrappers DOT scikit_learn import KerasRegressor EOM
from keras DOT callbacks import ModelCheckpoint EOM
from sklearn DOT model_selection import cross_val_score EOM
from sklearn DOT model_selection import KFold EOM
from sklearn DOT preprocessing import StandardScaler EOM
from sklearn DOT pipeline import Pipeline EOM
class network PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  self DOT getModel PARELEFT  PARERIGHT  EOM
def getModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 400 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def train PARELEFT self COMMA x COMMA y COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA filepath EQUAL  PARERIGHT : EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
self DOT model DOT fit PARELEFT x COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
self DOT model  EQUAL  self DOT load_best_model PARELEFT  PARERIGHT  EOM
return self DOT model EOM
def load_best_model PARELEFT self COMMA  filepath EQUAL  PARERIGHT : EOM
return load_model PARELEFT  PARERIGHT  EOM
class timing_network PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  self DOT getModel PARELEFT  PARERIGHT  EOM
def getModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 400 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 200 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 16 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def train PARELEFT self COMMA x COMMA y COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA filepath EQUAL  PARERIGHT : EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
self DOT model DOT fit PARELEFT x COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
self DOT model  EQUAL  self DOT load_best_model PARELEFT  PARERIGHT  EOM
return self DOT model EOM
def load_best_model PARELEFT self COMMA  filepath EQUAL  PARERIGHT : EOM
return load_model PARELEFT  PARERIGHT import tensorflow as tf EOM
import numpy as np EOM
class ConvLSTM PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  num_classes COMMA  num_lstm_cells EQUAL  COMMA  num_lstm_layers EQUAL  COMMA el_size EQUAL  PARELEFT  PARERIGHT  COMMA  filter_size EQUAL [] COMMA  pool_size EQUAL  PARELEFT  PARERIGHT  COMMA um_cnn_layers EQUAL  COMMA  dropout_rate EQUAL  PARERIGHT : EOM
self DOT num_classes  EQUAL  num_classes EOM
self DOT num_lstm_cells  EQUAL  num_lstm_cells EOM
self DOT num_lstm_layers  EQUAL  num_cnn_layers EOM
self DOT pool_size  EQUAL  pool_size EOM
self DOT num_cnn_layers  EQUAL  num_cnn_layers EOM
self DOT num_classes  EQUAL  num_classes EOM
self DOT dropout_rate  EQUAL  dropout_rate EOM
self DOT kernel_size  EQUAL  kernel_size EOM
self DOT filter_size  EQUAL  filter_size EOM
self DOT model  EQUAL  None EOM
def create_cnn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Conv1D PARELEFT self DOT filter_size[] COMMA  self DOT kernel_size COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
for layer in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Conv1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT AveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def create_lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Permute PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT CuDNNLSTM PARELEFT self DOT num_lstm_cells COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
for layer in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT CuDNNLSTM PARELEFT self DOT num_lstm_cells COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def create_network PARELEFT  PARERIGHT : EOM
cnn_input  EQUAL  tf DOT reshape PARELEFT input_data COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_input  EQUAL  tf DOT reshape PARELEFT input_data COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
shape_cnn  EQUAL  cnn_input DOT shape[] EOM
shape_lstm  EQUAL  lstm_input DOT shape[] EOM
lstm_input  EQUAL  tf DOT keras DOT layers DOT Input PARELEFT shape EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
cnn_input  EQUAL  tf DOT keras DOT layers DOT Input PARELEFT shape EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
cnn_out  EQUAL  self DOT create_cnn_model PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_out  EQUAL  self DOT create_lstm_model PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
network_output  EQUAL  tf DOT keras DOT layers DOT concatenate PARELEFT  PARERIGHT  EOM
network_output  EQUAL  tf DOT keras DOT layers DOT Dense PARELEFT self DOT num_classes COMMA activation EQUAL  COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  tf DOT keras DOT models DOT Model PARELEFT inputs EQUAL [] COMMA outputs EQUAL [] PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
def fit PARELEFT self COMMA  input_data COMMA  labels COMMA  num_epochs COMMA  time_steps COMMA  num_features COMMA atch_size COMMA  learn_rate EQUAL  PARERIGHT : EOM
cnn_input  EQUAL  np DOT reshape PARELEFT input_data COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_input  EQUAL  np DOT reshape PARELEFT input_data COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT fit PARELEFT {: lstm_input COMMA  : cnn_input} COMMA : labels} COMMA pochs EQUAL  COMMA  batch_size EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
def evaluate PARELEFT  PARERIGHT : EOM
cnn_data  EQUAL  np DOT reshape PARELEFT test_data COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm_data  EQUAL  np DOT reshape PARELEFT test_data COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
loss COMMA  accuracy  EQUAL  self DOT model DOT evaluate PARELEFT x EQUAL [] COMMA  y EQUAL  COMMA  steps EQUAL  PARERIGHT  EOM
return loss COMMA  accuracyimport numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
from IPython DOT display import display EOM
from sklearn DOT model_selection import train_test_split EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA Flatten COMMA  Reshape EOM
from keras DOT layers import Embedding COMMA  Masking EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD EOM
from keras DOT datasets import mnist EOM
from keras DOT layers import BatchNormalization EOM
from sklearn DOT svm import SVC EOM
from keras DOT utils import np_utils EOM
from keras DOT models import load_model EOM
from sklearn DOT utils DOT class_weight import compute_class_weight COMMA  compute_sample_weight EOM
from sklearn DOT metrics import recall_score COMMA  precision_score EOM
from keras import metrics EOM
import keras DOT backend as K EOM
from sklearn DOT metrics import confusion_matrix EOM
from keras import regularizers EOM
from sklearn DOT ensemble import RandomForestClassifier EOM
labelName EQUAL  EOM
runEpoch EQUAL 20 EOM
AE_Epochs  EQUAL  20 EOM
modelName  EQUAL  EOM
BS  EQUAL  256 EOM
Alldata  EQUAL  pd DOT read_csv PARELEFT  PARERIGHT  EOM
Alldata  EQUAL  shuffle PARELEFT  PARERIGHT  EOM
train_all COMMA test_all EQUAL train_test_split PARELEFT Alldata COMMA  test_size EQUAL  PARERIGHT  EOM
y_train  EQUAL  train_all DOT label EOM
y_test  EQUAL  test_all DOT label EOM
X_train  EQUAL  train_all DOT drop PARELEFT labelName COMMA  axis  EQUAL  COMMA  inplace EQUAL  PARERIGHT  EOM
X_test  EQUAL  test_all DOT drop PARELEFT labelName COMMA  axis  EQUAL  COMMA  inplace EQUAL  PARERIGHT  EOM
size_data  EQUAL  X_train DOT shape[] EOM
timesteps  EQUAL  5 EOM
data_dim  EQUAL  size_data/timesteps EOM
X_train  EQUAL  sc DOT fit_transform PARELEFT  PARERIGHT  EOM
X_test  EQUAL  sc DOT transform PARELEFT  PARERIGHT  EOM
Size1  EQUAL  256 EOM
Size2  EQUAL  128 EOM
Size3  EQUAL  64 EOM
inputSize  EQUAL size_data EOM
Autoencoder  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
Autoencoder DOT add PARELEFT  PARERIGHT  EOM
Autoencoder DOT add PARELEFT  PARERIGHT  EOM
Autoencoder DOT add PARELEFT  PARERIGHT  EOM
Autoencoder DOT add PARELEFT  PARERIGHT  EOM
Autoencoder DOT add PARELEFT  PARERIGHT  EOM
Autoencoder DOT add PARELEFT  PARERIGHT  EOM
Autoencoder DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
Autoencoder DOT fit PARELEFT X_train COMMA  X_train COMMA  nb_epoch EQUAL  COMMA  shuffle EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
encoder1_train  EQUAL  Encoder1 DOT predict PARELEFT  PARERIGHT  EOM
encoder2_train  EQUAL  Encoder2 DOT predict PARELEFT  PARERIGHT  EOM
X_train  EQUAL  Encoder3 DOT predict PARELEFT  PARERIGHT  EOM
encoder1_test  EQUAL  Encoder1 DOT predict PARELEFT  PARERIGHT  EOM
encoder2_test  EQUAL  Encoder2 DOT predict PARELEFT  PARERIGHT  EOM
X_test  EQUAL  Encoder3 DOT predict PARELEFT  PARERIGHT  EOM
def classifier_builder  PARELEFT  PARERIGHT : EOM
classifier  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
classifier DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
classifier DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
classifier DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  COMMA recurrent_activation EQUAL  COMMA unit_forget_bias EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
classifier DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
classifier DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
classifier DOT compile PARELEFT loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return classifier EOM
class_weights  EQUAL  compute_class_weight PARELEFT  COMMA  np DOT unique PARELEFT  PARERIGHT  COMMA  y_train PARERIGHT  EOM
classifier  EQUAL  KerasClassifier PARELEFT build_fn EQUAL  COMMA tch_size  EQUAL  COMMA epoch  EQUAL  PARERIGHT  EOM
classifier DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA  class_weight EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  verbose EQUAL  PARERIGHT  EOM
y_predict EQUAL classifier DOT predict PARELEFT X_test COMMA batch_size EQUAL  PARERIGHT  EOM
y_predict  EQUAL   [] for j in y_predict] EOM
y_predict  EQUAL  np DOT where PARELEFT np DOT array PARELEFT  PARERIGHT <0 DOT 5 COMMA 0 COMMA 1 PARERIGHT  EOM
precision  EQUAL  precision_score PARELEFT y_test COMMA  y_predict COMMA  average EQUAL  PARERIGHT  EOM
recall  EQUAL  recall_score PARELEFT y_test COMMA y_predict COMMA  average EQUAL  PARERIGHT  EOM
confusion_matrix EQUAL confusion_matrix PARELEFT  PARERIGHT  EOM
import numpy EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
from keras DOT optimizers import RMSprop EOM
import sys EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 31 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
trainerOpt  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
filename  EQUAL  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
completeText  EQUAL  open PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  DOT lower PARELEFT  PARERIGHT  EOM
chars  EQUAL  sorted PARELEFT list PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
charToInt  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
int_to_char  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
pattern  EQUAL  EOM
sort_sen  EQUAL  list PARELEFT  PARERIGHT  EOM
pattern  EQUAL  [] for value in sort_sen] EOM
for i in range PARELEFT  PARERIGHT : EOM
X  EQUAL  numpy DOT reshape PARELEFT pattern COMMA   PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
X  EQUAL  x / float PARELEFT  PARERIGHT  EOM
prediction  EQUAL  model DOT predict PARELEFT x COMMA  verbose EQUAL  PARERIGHT  EOM
index  EQUAL  numpy DOT argmax PARELEFT  PARERIGHT  EOM
result  EQUAL  int_to_char[] EOM
seq_in  EQUAL  [] for value in pattern] EOM
sys DOT stdout DOT write PARELEFT  PARERIGHT  EOM
pattern DOT append PARELEFT  PARERIGHT  EOM
pattern  EQUAL  pattern[]__author__  EQUAL import os DOT path EOM
import numpy as np EOM
from data_manipulator import elementwise_square COMMA  roll_rows EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  AutoEncoder COMMA  Activation EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT regularizers import l2 EOM
from convolutional import Convolution1D COMMA  MaxPooling1D EOM
class TimeDistributedAutoEncoder: EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT conf  EQUAL  conf EOM
self DOT model_dir  EQUAL  EOM
self DOT model_name  EQUAL  EOM
self DOT encoder_sizes  EQUAL  [] EOM
self DOT decoder_sizes  EQUAL  [] EOM
self DOT models  EQUAL  [] EOM
self DOT compiled  EQUAL  False EOM
def get_model_name PARELEFT  PARERIGHT : EOM
if not self DOT compiled: EOM
raise Exception PARELEFT  PARERIGHT  EOM
model_structure  EQUAL  EOM
model_name  EQUAL  model_structure %  PARELEFT  DOT join PARELEFT str PARELEFT  PARERIGHT  for e in self DOT encoder_sizes PARERIGHT  DOT join PARELEFT str PARELEFT  PARERIGHT  for d in self DOT decoder_sizes PARERIGHT  int PARELEFT  PARERIGHT  self DOT conf[] PARERIGHT  EOM
model_dir  EQUAL  model_name DOT replace PARELEFT  PARERIGHT  DOT replace PARELEFT  PARERIGHT  EOM
from data_manipulator import create_dir EOM
create_dir PARELEFT  PARERIGHT  EOM
return model_dir COMMA  model_name EOM
def compile PARELEFT self COMMA  optimizer EQUAL  PARERIGHT : EOM
for model in self DOT models: EOM
if optimizer is not None: EOM
model DOT compile PARELEFT loss EQUAL [] COMMA  optimizer EQUAL  PARERIGHT  EOM
else: EOM
model DOT compile PARELEFT loss EQUAL [] COMMA  optimizer EQUAL [] PARERIGHT  EOM
self DOT compiled  EQUAL  True EOM
def add_autoencoder PARELEFT self COMMA  encoder_sizes EQUAL [] COMMA  decoder_sizes EQUAL [] PARERIGHT : EOM
assert PARELEFT len PARELEFT  PARERIGHT  ! EQUAL  PARELEFT  PARERIGHT  ! EQUAL  PARERIGHT  EOM
assert PARELEFT len PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT encoder_sizes  EQUAL  encoder_sizes EOM
self DOT decoder_sizes  EQUAL  decoder_sizes EOM
self DOT models  EQUAL  [] EOM
encoders  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
decoders  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - 1 PARERIGHT : EOM
encoders DOT add PARELEFT Dense PARELEFT encoder_sizes[] COMMA  encoder_sizes[] init EQUAL [] activation EQUAL [] W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
decoders DOT add PARELEFT Dense PARELEFT decoder_sizes[] COMMA  decoder_sizes[] init EQUAL [] activation EQUAL [] W_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT models[] DOT add PARELEFT AutoEncoder PARELEFT encoder EQUAL  PARELEFT i  EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return self DOT models EOM
def add_conv_autoencoder PARELEFT self COMMA  encoder_sizes EQUAL [] COMMA  decoder_sizes EQUAL [] PARERIGHT : EOM
assert PARELEFT len PARELEFT  PARERIGHT  ! EQUAL  PARELEFT  PARERIGHT  ! EQUAL  PARERIGHT  EOM
assert PARELEFT len PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT encoder_sizes  EQUAL  encoder_sizes EOM
self DOT decoder_sizes  EQUAL  decoder_sizes EOM
self DOT models  EQUAL  [] EOM
encoders  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
decoders  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - 1 PARERIGHT : EOM
encoders DOT add PARELEFT Convolution1D PARELEFT 32 COMMA  3 COMMA  3 activation EQUAL [] init EQUAL [] border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
encoders DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
encoders DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
encoders DOT add PARELEFT Convolution1D PARELEFT 32 COMMA  1 COMMA  1 activation EQUAL [] init EQUAL [] border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
decoders DOT add PARELEFT Convolution1D PARELEFT 32 COMMA  1 COMMA  1 activation EQUAL [] init EQUAL [] border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
decoders DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
decoders DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT models[] DOT add PARELEFT AutoEncoder PARELEFT encoder EQUAL  PARELEFT i  EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return self DOT models EOM
def add_lstm_autoencoder PARELEFT self COMMA  encoder_sizes EQUAL [] COMMA  decoder_sizes EQUAL [] PARERIGHT : EOM
assert PARELEFT len PARELEFT  PARERIGHT  ! EQUAL  PARELEFT  PARERIGHT  ! EQUAL  PARERIGHT  EOM
assert PARELEFT len PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT encoder_sizes  EQUAL  encoder_sizes EOM
self DOT decoder_sizes  EQUAL  decoder_sizes EOM
self DOT models  EQUAL  [] EOM
encoders  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
decoders  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - 1 PARERIGHT : EOM
encoders DOT add PARELEFT LSTM PARELEFT encoder_sizes[] COMMA  encoder_sizes[] activation EQUAL [] inner_activation EQUAL [] init EQUAL [] inner_init EQUAL [] truncate_gradient EQUAL  PARELEFT  PARERIGHT  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
decoders DOT add PARELEFT LSTM PARELEFT decoder_sizes[] COMMA  decoder_sizes[] activation EQUAL [] inner_activation EQUAL [] init EQUAL [] inner_init EQUAL [] truncate_gradient EQUAL  PARELEFT int PARELEFT  PARERIGHT  PARERIGHT rn_sequences EQUAL  PARELEFT i  EQUAL  PARELEFT  PARERIGHT  - 1 PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT models[] DOT add PARELEFT AutoEncoder PARELEFT encoder EQUAL  PARELEFT i  EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return self DOT models EOM
return x EOM
def softmax PARELEFT  PARERIGHT : EOM
e_x  EQUAL  np DOT exp PARELEFT x - np DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
out  EQUAL  e_x / e_x DOT sum PARELEFT  PARERIGHT  EOM
return out EOM
def sigmoid PARELEFT  PARERIGHT : EOM
return 1 /  PARELEFT 1 + np DOT exp PARELEFT  PARERIGHT  PARERIGHT  EOM
def get_model PARELEFT  PARERIGHT : EOM
return self DOT models EOM
def get_model_type PARELEFT  PARERIGHT : EOM
return self DOT conf[] EOM
def load_model PARELEFT  PARERIGHT : EOM
if os DOT path DOT isfile PARELEFT  PARERIGHT : EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return True EOM
else: EOM
return Falseimport matplotlib DOT pyplot as plt EOM
import numpy as np EOM
import time EOM
import csv EOM
import sys EOM
import tensorflow as tf EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers import Convolution2D EOM
from keras DOT layers DOT recurrent import LSTM COMMA  SimpleRNN COMMA  GRU EOM
import keras as keras EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
from keras import backend as K EOM
class multiLSTM: EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT lstmModels  EQUAL  [] EOM
self DOT xTest COMMA  self DOT yTest  EQUAL  None COMMA  None EOM
file_dataset  EQUAL  EOM
with open PARELEFT  PARERIGHT  as f: EOM
data  EQUAL  csv DOT reader PARELEFT f COMMA  delimiter EQUAL  PARERIGHT  EOM
winds  EQUAL  [] EOM
for line in data: EOM
winds DOT append PARELEFT  PARERIGHT  EOM
self DOT means_stds  EQUAL  [] EOM
self DOT winds COMMA  self DOT means_stds  EQUAL  self DOT normalize_winds_0_1 PARELEFT  PARERIGHT  EOM
activation  EQUAL  [] EOM
self DOT epochs COMMA  self DOT trainDataRate  EQUAL  [] COMMA  1] if realRun else [] COMMA  0 DOT 005] EOM
def normalize_winds_0_1 PARELEFT  PARERIGHT : EOM
windMax  EQUAL  winds DOT max PARELEFT  PARERIGHT  EOM
windMin  EQUAL  winds DOT min PARELEFT  PARERIGHT  EOM
normal_winds  EQUAL   PARELEFT  PARERIGHT  / windMax EOM
mins_maxs  EQUAL  [] EOM
return np DOT array PARELEFT  PARERIGHT  COMMA  mins_maxs EOM
def denormalize PARELEFT  PARERIGHT : EOM
return res EOM
def loadData_1 PARELEFT  PARERIGHT : EOM
for index in range PARELEFT len PARELEFT  PARERIGHT  - self DOT inputHorizon PARERIGHT : EOM
result DOT append PARELEFT  PARERIGHT  EOM
result  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
trainRow  EQUAL  int PARELEFT  PARERIGHT  EOM
X_train  EQUAL  result[] EOM
y_train  EQUAL  self DOT winds[] EOM
self DOT xTest  EQUAL  result[] EOM
self DOT yTest  EQUAL  self DOT winds[] EOM
self DOT predicted  EQUAL  np DOT zeros_like PARELEFT  PARERIGHT  EOM
return [] EOM
def loadData PARELEFT  PARERIGHT : EOM
for ind in range PARELEFT len PARELEFT  PARERIGHT  - self DOT inputHorizon -1 PARERIGHT : EOM
tempInput  EQUAL  preXTrain[] EOM
temp_shape  EQUAL  tempInput DOT shape EOM
tempInput  EQUAL  np DOT reshape PARELEFT tempInput COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
output  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
tInput  EQUAL  np DOT reshape PARELEFT  PARERIGHT  EOM
tempInput  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
tempInput  EQUAL  np DOT delete PARELEFT tempInput COMMA  0 COMMA  axis EQUAL  PARERIGHT  EOM
xTrain[]  EQUAL  tempInput EOM
yTrain[]  EQUAL  preYTrain[] EOM
return [] EOM
def buildModelLSTM_1 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
in_nodes  EQUAL  out_nodes  EQUAL  self DOT inOutVecDim EOM
layers  EQUAL  [] EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA  output_dim EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def buildModelLSTM_2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  [] EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA output_dim EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def buildModelLSTM_3 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  [] EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA  output_dim EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def buildModelLSTM_4 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  [] EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA  output_dim EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def buildModelLSTM_5 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  [] EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA  output_dim EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def buildModelLSTM_6 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layers  EQUAL  [] EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA  output_dim EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def buildModelLSTM PARELEFT  PARERIGHT : EOM
if lstmModelNum  EQUAL  EQUAL  1: EOM
return self DOT buildModelLSTM_1 PARELEFT  PARERIGHT  EOM
elif lstmModelNum  EQUAL  EQUAL  2: EOM
return self DOT buildModelLSTM_2 PARELEFT  PARERIGHT  EOM
elif lstmModelNum  EQUAL  EQUAL  3: EOM
return self DOT buildModelLSTM_3 PARELEFT  PARERIGHT  EOM
elif lstmModelNum  EQUAL  EQUAL  4: EOM
return self DOT buildModelLSTM_4 PARELEFT  PARERIGHT  EOM
elif lstmModelNum  EQUAL  EQUAL  5: EOM
return self DOT buildModelLSTM_5 PARELEFT  PARERIGHT  EOM
elif lstmModelNum  EQUAL  EQUAL  6: EOM
return self DOT buildModelLSTM_6 PARELEFT  PARERIGHT  EOM
def trainLSTM PARELEFT  PARERIGHT : EOM
lstmModel  EQUAL  self DOT buildModelLSTM PARELEFT  PARERIGHT  EOM
lstmModel DOT fit PARELEFT xTrain COMMA  yTrain COMMA batch_size EQUAL  COMMA nb_epoch EQUAL [] COMMA validation_split EQUAL  PARERIGHT  EOM
return lstmModel EOM
def test PARELEFT  PARERIGHT : EOM
for ind in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
modelInd  EQUAL  ind % 6 EOM
if modelInd  EQUAL  EQUAL  0: EOM
testInputRaw  EQUAL  self DOT xTest[] EOM
testInputShape  EQUAL  testInputRaw DOT shape EOM
testInput  EQUAL  np DOT reshape PARELEFT  PARERIGHT  EOM
else: EOM
testInputRaw  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
testInput  EQUAL  np DOT delete PARELEFT testInputRaw COMMA  0 COMMA  axis EQUAL  PARERIGHT  EOM
testInputShape  EQUAL  testInput DOT shape EOM
testInput  EQUAL  np DOT reshape PARELEFT  PARERIGHT  EOM
self DOT predicted[]  EQUAL  self DOT lstmModels[] DOT predict PARELEFT  PARERIGHT  EOM
def errorMeasures PARELEFT  PARERIGHT : EOM
mae  EQUAL  np DOT mean PARELEFT np DOT absolute PARELEFT  PARERIGHT  PARERIGHT  EOM
rmse  EQUAL  np DOT sqrt PARELEFT  PARELEFT np DOT mean PARELEFT  PARELEFT np DOT absolute PARELEFT  PARERIGHT  PARERIGHT  ** 2 PARERIGHT  PARERIGHT  PARERIGHT  EOM
nrsme_maxMin  EQUAL  100 * rmse /  PARELEFT denormalYTest DOT max PARELEFT  PARERIGHT  - denormalYTest DOT min PARELEFT  PARERIGHT  PARERIGHT  EOM
nrsme_mean  EQUAL  100 * rmse /  PARELEFT denormalYTest DOT mean PARELEFT  PARERIGHT  PARERIGHT  EOM
return mae COMMA  rmse COMMA  nrsme_maxMin COMMA  nrsme_mean EOM
def drawGraphStation PARELEFT self COMMA  station COMMA  visualise EQUAL  COMMA  ax EQUAL  PARERIGHT : EOM
yTest  EQUAL  self DOT yTest[] EOM
denormalYTest  EQUAL  self DOT denormalize PARELEFT  PARERIGHT  EOM
denormalPredicted  EQUAL  self DOT denormalize PARELEFT  PARERIGHT  EOM
mae COMMA  rmse COMMA  nrmse_maxMin COMMA  nrmse_mean  EQUAL  self DOT errorMeasures PARELEFT  PARERIGHT  EOM
if visualise: EOM
if ax is None: EOM
fig  EQUAL  plt DOT figure PARELEFT  PARERIGHT  EOM
ax  EQUAL  fig DOT add_subplot PARELEFT  PARERIGHT  EOM
ax DOT plot PARELEFT denormalYTest COMMA  label EQUAL  PARERIGHT  EOM
ax DOT plot PARELEFT denormalPredicted COMMA  label EQUAL  COMMA  color EQUAL  PARERIGHT  EOM
ax DOT set_xticklabels PARELEFT [] COMMA  rotation EQUAL  PARERIGHT  EOM
return mae COMMA  rmse COMMA  nrmse_maxMin COMMA  nrmse_mean EOM
def drawGraphAllStations PARELEFT  PARERIGHT : EOM
rows COMMA  cols  EQUAL  1 COMMA  1 EOM
maeRmse  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
fig COMMA  ax_array  EQUAL  plt DOT subplots PARELEFT rows COMMA  cols COMMA  sharex EQUAL  COMMA  sharey EQUAL  PARERIGHT  EOM
staInd  EQUAL  0 EOM
maeRmse[]  EQUAL  self DOT drawGraphStation PARELEFT staInd COMMA  visualise EQUAL  COMMA  ax EQUAL  PARERIGHT  EOM
staInd + EQUAL  1 EOM
plt DOT xticks PARELEFT  PARERIGHT  EOM
filename  EQUAL  EOM
plt DOT savefig PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT savefig PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
def run PARELEFT  PARERIGHT : EOM
xTrain COMMA  yTrain  EQUAL  self DOT loadData_1 PARELEFT  PARERIGHT  EOM
self DOT lstmModels[]  EQUAL  self DOT trainLSTM PARELEFT  PARERIGHT  EOM
for modelInd in range PARELEFT  PARERIGHT : EOM
xTrain COMMA  yTrain  EQUAL  self DOT loadData PARELEFT  PARERIGHT  EOM
self DOT lstmModels[]  EQUAL  self DOT trainLSTM PARELEFT  PARERIGHT  EOM
self DOT test PARELEFT  PARERIGHT  EOM
self DOT drawGraphAllStations PARELEFT  PARERIGHT  EOM
DeepForecast  EQUAL  multiLSTM PARELEFT  PARERIGHT  EOM
DeepForecast DOT run PARELEFT  PARERIGHT from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
class LSTM_NN PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
from keras DOT preprocessing import sequence EOM
from keras DOT optimizers import SGD COMMA  RMSprop COMMA  Adagrad EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT constraints import unitnorm EOM
from keras DOT layers DOT core import Reshape COMMA  Flatten COMMA  Merge EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D COMMA  Convolution1D COMMA  MaxPooling1D EOM
from sklearn DOT cross_validation import KFold EOM
from keras DOT callbacks import EarlyStopping EOM
from keras DOT regularizers import l2 EOM
import numpy as np EOM
from sklearn import cross_validation EOM
import math EOM
from keras_input_data import make_idx_data EOM
from load_vai import loadVAI EOM
import _pickle as cPickle EOM
from metrics import continuous_metrics EOM
def cnn PARELEFT W EQUAL  PARERIGHT : EOM
N_fm  EQUAL  100 EOM
dense_nb  EQUAL  20 EOM
kernel_size  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL [] COMMA  output_dim EQUAL [] COMMA  weights EQUAL [] COMMA  W_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT W DOT shape[] COMMA  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT nb_filter EQUAL  COMMA  nb_row EQUAL  COMMA  nb_col EQUAL  COMMA  border_mode EQUAL  COMMA _regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def imdb_cnn PARELEFT W EQUAL  PARERIGHT : EOM
N_fm  EQUAL  100 EOM
kernel_size  EQUAL  5 EOM
max_features  EQUAL  W DOT shape[] EOM
hidden_dims  EQUAL  100 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  dims COMMA  input_length EQUAL  COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def cnn_lstm PARELEFT  PARERIGHT : EOM
nb_filter  EQUAL  100 EOM
filter_length  EQUAL  5 EOM
pool_length  EQUAL  2 EOM
lstm_output_size  EQUAL  100 EOM
p  EQUAL  0 DOT 25 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  input_length EQUAL  COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
x  EQUAL  cPickle DOT load PARELEFT open PARELEFT  PARERIGHT  PARERIGHT  EOM
revs COMMA  W COMMA  W2 COMMA  word_idx_map COMMA  vocab  EQUAL  x[] COMMA  x[] COMMA  x[] COMMA  x[] COMMA  x[] EOM
sentences EQUAL [] EOM
for rev in revs: EOM
sentence  EQUAL  rev[] EOM
sentences DOT append PARELEFT  PARERIGHT  EOM
idx_data  EQUAL  make_idx_data PARELEFT  PARERIGHT  EOM
dim  EQUAL  EOM
column  EQUAL  loadVAI PARELEFT  PARERIGHT  EOM
irony EQUAL column EOM
batch_size  EQUAL  8 EOM
Y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
Y  EQUAL  [] EOM
n_MAE EQUAL 0 EOM
n_Pearson_r EQUAL 0 EOM
n_Spearman_r EQUAL 0 EOM
n_MSE EQUAL 0 EOM
n_R2 EQUAL 0 EOM
n_MSE_sqrt EQUAL 0 EOM
SEED  EQUAL  42 EOM
for i in range PARELEFT  PARERIGHT : EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  cross_validation DOT train_test_split PARELEFT ata COMMA  Y COMMA  test_size EQUAL  COMMA  random_state EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  lstm_cnn PARELEFT  PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
result  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA validation_data EQUAL  PARELEFT  PARERIGHT  COMMA callbacks EQUAL [] PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
predict  EQUAL  model DOT predict PARELEFT X_test COMMA  batch_size EQUAL  PARERIGHT  DOT reshape PARELEFT  PARELEFT 1 COMMA  len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT [] EOM
estimate EQUAL continuous_metrics PARELEFT  PARERIGHT  EOM
n_MAE + EQUAL  estimate[] EOM
n_Pearson_r + EQUAL  estimate[] EOM
ndigit EQUAL 3 EOM
avg_MAE  EQUAL   round PARELEFT  PARERIGHT  EOM
avg_Pearson_r  EQUAL   round PARELEFT  PARERIGHT  EOM
from visualize import plot_keras COMMA  draw_hist EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import Callback EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
def on_batch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def neural_net PARELEFT num_sensors COMMA  num_actions COMMA  params COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT rams[] COMMA  init EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_actions COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if load: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def lstm_net PARELEFT num_sensors COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT tput_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelimport os EOM
global_model_version  EQUAL  51 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential COMMA Model EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT core import Reshape COMMA  Permute EOM
from keras DOT layers import Merge COMMA concatenate EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
import numpy as np EOM
def model_cnn_lstm_adam_binary PARELEFT inputShape COMMA batchSize EQUAL  COMMA stateful EQUAL  PARERIGHT : EOM
optimizer  EQUAL  EOM
loss  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 4 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +inputShape PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape  EQUAL  model DOT layers[] DOT output_shape EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape[] COMMA np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_cnn_lstm_adam_binary_dropout PARELEFT inputShape COMMA batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
optimizer  EQUAL  EOM
loss  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 4 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +inputShape PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape  EQUAL  model DOT layers[] DOT output_shape EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape[] COMMA np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_cnn_lstm_adam PARELEFT inputShape COMMA  numClasses EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  PARERIGHT : EOM
optimizer  EQUAL  EOM
loss  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 4 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +inputShape PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape  EQUAL  model DOT layers[] DOT output_shape EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape[] COMMA np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_branched_cnn_mixed_lstm_binary PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_branched_cnn_mixed_lstm_regression PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA umFilter EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
from keras DOT layers import Input EOM
def model_branched_cnn_mixed_lstm_binary_functional PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
input1  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  EOM
input2  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
output1  EQUAL  branch1 PARELEFT  PARERIGHT  EOM
output2  EQUAL  branch2 PARELEFT  PARERIGHT  EOM
mergedInput  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_branched_cnn_mixed_lstm_regression_padding PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA  numUnitLSTM EQUAL  COMMA batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
input1  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  EOM
input2  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape1  EQUAL  branch1 DOT layers[] DOT output_shape EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape1[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nPadTo  EQUAL  int PARELEFT np DOT ceil PARELEFT  PARERIGHT  * ntOut PARERIGHT  EOM
nPadding  EQUAL   PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT ZeroPadding1D PARELEFT padding EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
output1  EQUAL  branch1 PARELEFT  PARERIGHT  EOM
output2  EQUAL  branch2 PARELEFT  PARERIGHT  EOM
mergedInput  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT numUnitLSTM COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT numUnitLSTM COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
from keras DOT layers import ZeroPadding1D EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT core import Reshape COMMA  Permute EOM
from keras DOT layers import Merge COMMA  concatenate COMMA  BatchNormalization EOM
from keras DOT layers DOT convolutional import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
def model_branched_cnn_mixed_lstm_regression_batchNorm PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA umUnitLSTM EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
input1  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  EOM
input2  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape1  EQUAL  branch1 DOT layers[] DOT output_shape EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape1[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nPadTo  EQUAL  int PARELEFT np DOT ceil PARELEFT  PARERIGHT  * ntOut PARERIGHT  EOM
nPadding  EQUAL   PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT ZeroPadding1D PARELEFT padding EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
output1  EQUAL  branch1 PARELEFT  PARERIGHT  EOM
output2  EQUAL  branch2 PARELEFT  PARERIGHT  EOM
mergedInput  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT numUnitLSTM COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  BatchNormalization PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT numUnitLSTM COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  BatchNormalization PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_branched_cnn_mixed_lstm_regression_functional PARELEFT input1Shape COMMA  input2Shape COMMA  outputShape COMMA  numFilter EQUAL  COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
loss  EQUAL  EOM
kernelSize1  EQUAL   PARELEFT  PARERIGHT  EOM
kernelSize2  EQUAL   PARELEFT  PARERIGHT  EOM
ntOut  EQUAL  outputShape[] EOM
input1  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  EOM
input2  EQUAL  Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize1 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  + input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT numFilter COMMA  kernelSize2 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
convOutShape2  EQUAL  branch2 DOT layers[] DOT output_shape EOM
branch2 DOT add PARELEFT Reshape PARELEFT  PARELEFT convOutShape2[] COMMA  np DOT prod PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
output1  EQUAL  branch1 PARELEFT  PARERIGHT  EOM
output2  EQUAL  branch2 PARELEFT  PARERIGHT  EOM
mergedInput  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
return model COMMA  optimizer COMMA  loss EOM
def model_cnn_cat_mixed_lstm_2predict PARELEFT input1Shape COMMA  input2Shape COMMA  numClasses COMMA  batchSize EQUAL  COMMA stateful EQUAL  COMMA dropout EQUAL  PARERIGHT : EOM
optimizer  EQUAL  EOM
loss  EQUAL  EOM
branch1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  1 COMMA  5 COMMA  border_mode EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +input1Shape PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  1 COMMA  5 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  1 COMMA  5 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  3 COMMA  5 COMMA  border_mode EQUAL  COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT +input2Shape PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Convolution2D PARELEFT 4 COMMA  3 COMMA  5 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
convOutShape  EQUAL  model DOT layers[] DOT output_shape EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT np DOT prod PARELEFT  PARERIGHT  COMMA  convOutShape[] PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 48 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model COMMA  optimizer COMMA  lossfrom keras DOT layers import Embedding COMMA  LSTM COMMA  TimeDistributed COMMA  Dense COMMA  Dropout EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
from keras DOT optimizers import Adam EOM
from keras DOT models import load_model as keras_load_model EOM
from  DOT  import constant EOM
class Model PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT constant DOT NUM_CHARS COMMA  constant DOT EMBEDDING_SIZE COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 128 COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT constant DOT NUM_TAGS COMMA  activation EQUAL  PARERIGHT  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model  EQUAL  model EOM
def save_model PARELEFT  PARERIGHT : EOM
model DOT save PARELEFT  PARERIGHT  EOM
def load_model PARELEFT  PARERIGHT : EOM
return keras_load_model PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT models import Model EOM
from keras DOT layers import Input EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT models import Model EOM
import keras DOT backend as K EOM
from keras import initializers EOM
from numpy import array EOM
import random EOM
import numpy as np EOM
def fun_1 PARELEFT  PARERIGHT : EOM
inputs1  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm1  EQUAL  LSTM PARELEFT 4 COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
data  EQUAL  array PARELEFT  PARERIGHT  DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
pass EOM
def fun_1_ex PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  COMMA kernel_initializer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_initializer EQUAL  PARELEFT  PARERIGHT  COMMA bias_initializer EQUAL  PARELEFT  PARERIGHT  COMMA use_bias EQUAL  PARERIGHT  PARERIGHT  EOM
data  EQUAL  array PARELEFT  PARERIGHT  DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
pass EOM
def fun_2 PARELEFT  PARERIGHT : EOM
inputs1  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm1 COMMA  state_h COMMA  state_c  EQUAL  LSTM PARELEFT 1 COMMA  return_state EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL [] PARERIGHT  EOM
data  EQUAL  array PARELEFT  PARERIGHT  DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
pass EOM
def fun_3 PARELEFT  PARERIGHT : EOM
inputs1  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm1 COMMA  state_h COMMA  state_c  EQUAL  LSTM PARELEFT 1 COMMA  return_sequences EQUAL  COMMA  return_state EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL [] PARERIGHT  EOM
data  EQUAL  array PARELEFT  PARERIGHT  DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
pass EOM
def fun_4 PARELEFT  PARERIGHT : EOM
number_of_dimensions  EQUAL  4 EOM
number_of_examples  EQUAL  1 EOM
input_  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm COMMA  hidden COMMA  cell  EQUAL  LSTM PARELEFT units EQUAL  COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
dense  EQUAL  Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
with K DOT get_session PARELEFT  PARERIGHT  as sess: EOM
x  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
cell_state  EQUAL  sess DOT run PARELEFT cell COMMA  feed_dict EQUAL  PARERIGHT  EOM
fun_1_ex PARELEFT  PARERIGHT  EOM
passimport numpy as np EOM
from tensorflow DOT keras DOT layers import Dense COMMA  Input COMMA  GlobalMaxPooling1D EOM
from tensorflow DOT keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding COMMA  LSTM EOM
from tensorflow DOT keras DOT models import Model COMMA  Sequential EOM
def getConvModel PARELEFT embedding_layer COMMA  numLabels COMMA  MAX_SEQUENCE_LENGTH EQUAL  PARERIGHT : EOM
sequence_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
embedded_sequences  EQUAL  embedding_layer PARELEFT  PARERIGHT  EOM
x  EQUAL  Conv1D PARELEFT 128 COMMA  5 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  MaxPooling1D PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Conv1D PARELEFT 128 COMMA  5 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  MaxPooling1D PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Conv1D PARELEFT 128 COMMA  5 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  GlobalMaxPooling1D PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT numLabels COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def getConvLSTMmodel PARELEFT embedding_layer COMMA  numLabels COMMA  lstmN EQUAL  COMMA  convFilters EQUAL  COMMA  MAX_SEQUENCE_LENGTH EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT numLabels COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def getLSTMmodel PARELEFT embedding_layer COMMA  numLabels COMMA   lstmN EQUAL  COMMA  MAX_SEQUENCE_LENGTH EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstmN COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT numLabels COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
from keras DOT layers DOT core import Dense COMMA  Activation EOM
from keras DOT layers import Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT optimizers import RMSprop EOM
from keras import optimizers EOM
from keras DOT models import Model EOM
from keras import backend as K EOM
import numpy as np EOM
import random EOM
import sys EOM
from Const import Const EOM
class Lstm PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT word_seq_num  EQUAL  1 EOM
def input_len_set PARELEFT  PARERIGHT : EOM
self DOT input_len  EQUAL  self DOT word_feat_len * self DOT word_seq_num EOM
self DOT output_len  EQUAL  EOM
self DOT hidden_neurons  EQUAL  EOM
def make_net PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT self DOT output_len COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA implementation EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT self DOT hidden_neurons COMMA return_sequences EQUAL  COMMA implementation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
loss  EQUAL  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
optimizer  EQUAL  EOM
optimizer  EQUAL  optimizers DOT Adam PARELEFT lr EQUAL  COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  COMMA  epsilon EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
self DOT model DOT summary PARELEFT  PARERIGHT  EOM
def train PARELEFT  PARERIGHT : EOM
self DOT hist  EQUAL  self DOT model DOT fit PARELEFT X_train COMMA Y_train COMMA nb_epoch EQUAL  COMMA tch_size  EQUAL  COMMA validation_split EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
def predict PARELEFT  PARERIGHT : EOM
inp  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
inp  EQUAL  inp DOT reshape PARELEFT  PARERIGHT  EOM
predict_list  EQUAL  self DOT model DOT predict_on_batch PARELEFT  PARERIGHT  EOM
return predict_list EOM
def netScore PARELEFT  PARERIGHT : EOM
self DOT score  EQUAL  self DOT model DOT evaluate PARELEFT X_train COMMA  Y_train COMMA  verbose EQUAL  PARERIGHT  EOM
def waitController PARELEFT  PARERIGHT : EOM
try: EOM
if flag  EQUAL  EQUAL  : EOM
self DOT model DOT save_weights PARELEFT  PARERIGHT  EOM
if flag  EQUAL  EQUAL  : EOM
self DOT model DOT load_weights PARELEFT  PARERIGHT  EOM
except : EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
def main PARELEFT  PARERIGHT : EOM
lstm  EQUAL  Lstm PARELEFT  PARERIGHT  EOM
lstm DOT input_len_set PARELEFT  PARERIGHT  EOM
lstm DOT make_net PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT from keras DOT layers DOT convolutional import Conv2DTranspose  COMMA  Conv1D COMMA  Conv2D COMMA Convolution3D COMMA  MaxPooling2D COMMA UpSampling1D COMMA UpSampling2D COMMA UpSampling3D EOM
from keras DOT layers import Input COMMA Embedding COMMA  Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA    Reshape COMMA  Flatten COMMA  Lambda EOM
from keras DOT layers DOT noise import GaussianDropout COMMA  GaussianNoise EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras import initializers EOM
from keras import regularizers EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
import numpy as np EOM
import pandas as pd EOM
import os EOM
def create_LSTM PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  PARERIGHT : EOM
embedding_vecor_length  EQUAL  32 EOM
model1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model1 DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model2 DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model3 DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model4  EQUAL  Model PARELEFT inputs EQUAL  PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  outputs EQUAL  PARERIGHT  EOM
education  EQUAL  [] EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
JD  EQUAL  JD_ls[] EOM
education DOT append PARELEFT  PARERIGHT  EOM
edu_types  EQUAL  list PARELEFT set PARELEFT sum PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
to_categorical PARELEFT  PARERIGHT  EOM
import pandas as pd EOM
s  EQUAL  pd DOT Series PARELEFT  PARERIGHT  EOM
pd DOT get_dummies PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
model_id  EQUAL  EOM
model  EQUAL  create_LSTM PARELEFT  PARERIGHT  EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM COMMA  Dropout EOM
from keras import backend as K EOM
from keras_tqdm import TQDMNotebookCallback EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
LSTM_history  EQUAL  LSTM_model DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  Activation EOM
from keras DOT layers import LSTM COMMA  Bidirectional EOM
from theano DOT scalar import float32 EOM
import numpy as np EOM
def lstm_embedding_empty PARELEFT number_of_classes COMMA  max_features EQUAL  COMMA  embedding_size EQUAL  COMMA  lstm_size EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_embedding_pretrained PARELEFT number_of_classes COMMA  index_to_embedding_mapping COMMA  padding_length COMMA tm_size EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT : EOM
embedding_dimension  EQUAL  len PARELEFT  PARERIGHT  EOM
number_of_words  EQUAL  len PARELEFT index_to_embedding_mapping DOT keys PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for index COMMA  embedding in index_to_embedding_mapping DOT items PARELEFT  PARERIGHT : EOM
embedding_matrix[]  EQUAL  embedding EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
embedding_layer  EQUAL  Embedding PARELEFT number_of_words COMMA embedding_dimension COMMA weights EQUAL [] COMMA input_length EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lst_stacked PARELEFT number_of_classes COMMA  index_to_embedding_mapping COMMA  padding_length COMMA  lstm_size_layer1 EQUAL  COMMA tm_size_layer2 EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT : EOM
embedding_dimension  EQUAL  len PARELEFT  PARERIGHT  EOM
number_of_words  EQUAL  len PARELEFT index_to_embedding_mapping DOT keys PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for index COMMA  embedding in index_to_embedding_mapping DOT items PARELEFT  PARERIGHT : EOM
embedding_matrix[]  EQUAL  embedding EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
embedding_layer  EQUAL  Embedding PARELEFT number_of_words COMMA embedding_dimension COMMA weights EQUAL [] COMMA input_length EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size_layer1 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT lstm_size_layer2 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def blstm PARELEFT number_of_classes COMMA  index_to_embedding_mapping COMMA  padding_length COMMA  lstm_size_layer1 EQUAL  COMMA stm_size_layer2 EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
embedding_dimension  EQUAL  len PARELEFT  PARERIGHT  EOM
number_of_words  EQUAL  len PARELEFT index_to_embedding_mapping DOT keys PARELEFT  PARERIGHT  PARERIGHT  EOM
embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for index COMMA  embedding in index_to_embedding_mapping DOT items PARELEFT  PARERIGHT : EOM
embedding_matrix[]  EQUAL  embedding EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
embedding_layer  EQUAL  Embedding PARELEFT number_of_words COMMA embedding_dimension COMMA weights EQUAL [] COMMA input_length EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_size_layer1 COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_size_layer2 COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT core import Activation COMMA  Dropout EOM
from keras DOT models import Sequential EOM
FEATURE_COUNT  EQUAL  6 EOM
MODEL_FILEPATH  EQUAL  EOM
def build_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA output_dim EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
model  EQUAL  build_model PARELEFT  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
import numpy as np EOM
from tensorflow DOT python import keras EOM
from tensorflow DOT python DOT framework import test_util as tf_test_util EOM
from tensorflow DOT python DOT keras import testing_utils EOM
from tensorflow DOT python DOT platform import test EOM
from tensorflow DOT python DOT training import adam EOM
from tensorflow DOT python DOT training import gradient_descent EOM
from tensorflow DOT python DOT training DOT rmsprop import RMSPropOptimizer EOM
class LSTMLayerTest PARELEFT  PARERIGHT : EOM
def test_return_sequences_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA return_sequences EOM
def test_static_shape_inference_LSTM PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
inputs  EQUAL  keras DOT layers DOT Dense PARELEFT embedding_dim COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
outputs  EQUAL  model DOT layers[] DOT output EOM
self DOT assertEquals PARELEFT outputs DOT get_shape PARELEFT  PARERIGHT  DOT as_list PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def test_dynamic_behavior_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT RMSPropOptimizer PARELEFT  PARERIGHT  COMMA   PARERIGHT  EOM
x  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_dropout_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA dropout: 0 DOT 1} COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_implementation_mode_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
for mode in []: EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA implementation EOM
def test_constraints_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
k_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
r_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
b_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  COMMA recurrent_constraint EQUAL  COMMA bias_constraint EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
def test_with_masking_layer_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layer_class PARELEFT units EQUAL  COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_masking_with_stacking_LSTM PARELEFT  PARERIGHT : EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_cells  EQUAL  [] EOM
model DOT add PARELEFT keras DOT layers DOT RNN PARELEFT lstm_cells COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_from_config_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
for stateful in  PARELEFT  PARERIGHT : EOM
l1  EQUAL  layer_class PARELEFT units EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
l2  EQUAL  layer_class DOT from_config PARELEFT l1 DOT get_config PARELEFT  PARERIGHT  PARERIGHT  EOM
assert l1 DOT get_config PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL  : EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL [] PARERIGHT  EOM
else: EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_non_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_reset_states_with_values PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  stateful EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
assert len PARELEFT  PARERIGHT   EQUAL  assert layer DOT states[] is not None EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT zeros PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
state_shapes  EQUAL  [] EOM
values  EQUAL  [] EOM
if len PARELEFT  PARERIGHT   EQUAL  : EOM
values  EQUAL  values[] EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT ones PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
with self DOT assertRaises PARELEFT  PARERIGHT : EOM
layer DOT reset_states PARELEFT [] *  PARELEFT len PARELEFT  PARERIGHT  + 1 PARERIGHT  PARERIGHT  EOM
def test_specify_state_with_masking PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
_  EQUAL  keras DOT layers DOT Masking PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_return_state PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
state  EQUAL  outputs[] EOM
assert len PARELEFT  PARERIGHT   EQUAL     model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
state  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA  state COMMA  atol EQUAL  PARERIGHT  EOM
def test_state_reuse PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
output COMMA  state  EQUAL  outputs[] COMMA  outputs[] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT output COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
outputs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def test_initial_states_as_other_inputs PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
num_states  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
main_inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
inputs  EQUAL  [] + initial_state EOM
layer  EQUAL  layer_class PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
main_inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
class LSTMLayerGraphOnlyTest PARELEFT  PARERIGHT : EOM
def test_statefulness_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT cached_session PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT 4 COMMA embedding_dim COMMA mask_zero EQUAL  COMMA input_length EQUAL  COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT ts COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  weights EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  PARELEFT  PARERIGHT  COMMA loss EQUAL  PARERIGHT  EOM
out1  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT out1 DOT shape COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
out2  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out1 DOT max PARELEFT  PARERIGHT  COMMA  out2 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
out3  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out2 DOT max PARELEFT  PARERIGHT  COMMA  out3 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
out4  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out3 COMMA  out4 COMMA  atol EQUAL  PARERIGHT  EOM
out5  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out4 DOT max PARELEFT  PARERIGHT  COMMA  out5 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
left_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
left_padded_input[]  EQUAL  0 EOM
left_padded_input[]  EQUAL  0 EOM
out6  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
right_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
right_padded_input[]  EQUAL  0 EOM
right_padded_input[]  EQUAL  0 EOM
out7  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out7 COMMA  out6 COMMA  atol EQUAL  PARERIGHT  EOM
def test_regularizers_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT cached_session PARELEFT  PARERIGHT : EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  COMMA activity_regularizer EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  3 PARERIGHT  EOM
x  EQUAL  keras DOT backend DOT variable PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT layer DOT get_losses_for PARELEFT  PARERIGHT  PARERIGHT  COMMA  1 PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
test DOT main PARELEFT  PARERIGHT import tensorflow as tf EOM
from tensorflow import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Lambda EOM
from keras DOT layers import Dropout EOM
from keras import backend as K EOM
def distributed_label PARELEFT  PARERIGHT : EOM
m  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 8 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 8 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
m DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return m EOM
def distributed_into_one PARELEFT  PARERIGHT : EOM
m  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 8 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Lambda PARELEFT lambda x: K DOT max PARELEFT x COMMA  keepdims EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return m EOM
def singleLabel_1 PARELEFT  PARERIGHT : EOM
m  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 8 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return m EOM
def singleLabel_2 PARELEFT  PARERIGHT : EOM
m  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 8 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return m EOM
def singleLabel_3 PARELEFT  PARERIGHT : EOM
m  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 8 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 8 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return m EOM
def singleLabel_HighNumber PARELEFT  PARERIGHT : EOM
m  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 8 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 50 COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
m DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
m DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return m EOM
modelDict  EQUAL  {: singleLabel_1 COMMA : singleLabel_2 COMMA : singleLabel_3 COMMA : singleLabel_HighNumber} EOM
from keras DOT layers import Dense COMMA  Flatten COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import Conv2D COMMA  MaxPooling3D COMMA  Conv3D COMMA MaxPooling2D EOM
from collections import deque EOM
class Research_Models PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA model_name COMMA seq_length COMMA saved_model EQUAL  COMMA feature_dim EQUAL  COMMA no_cls PARERIGHT : EOM
self DOT saved_model EQUAL saved_model EOM
self DOT no_cls EQUAL no_cls EOM
self DOT features_dim EQUAL features_dim EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics EQUAL [] EOM
if self DOT no_cls> EQUAL 20: EOM
metrics DOT append PARELEFT  PARERIGHT  EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model_name EQUAL  EQUAL : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model EQUAL self DOT cnn_lstm PARELEFT  PARERIGHT  EOM
else: EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model EQUAL self DOT lstm PARELEFT  PARERIGHT  EOM
def lstm PARELEFT  PARERIGHT : EOM
model EQUAL Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT feature_dim COMMA return_sequences EQUAL  COMMA input_shape EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT no_cls COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def cnn_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  COMMA  padding EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelimport os EOM
global_model_version  EQUAL  30 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT layers import Dense COMMA  Flatten COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
from collections import deque EOM
import sys EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  seq_length COMMA  features COMMA  saved_model EQUAL  PARERIGHT : EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
if self DOT nb_classes > EQUAL  10: EOM
metrics DOT append PARELEFT  PARERIGHT  EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm_hof PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  clipnorm EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def lstm_hof PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import division COMMA  print_function EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Dropout COMMA  RepeatVector EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT recurrent import SimpleRNN EOM
from keras DOT layers DOT recurrent import GRU EOM
from keras DOT models import Sequential EOM
import os EOM
import helper EOM
from argparse import ArgumentParser EOM
parser  EQUAL  ArgumentParser PARELEFT  PARERIGHT  EOM
parser DOT add_argument PARELEFT  PARERIGHT  EOM
args  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
BABI_DIR  EQUAL  EOM
TASK_NBR  EQUAL  5 EOM
EMBED_HIDDEN_SIZE  EQUAL  100 EOM
BATCH_SIZE  EQUAL  32 EOM
NBR_EPOCHS  EQUAL  50 EOM
train_file COMMA  test_file  EQUAL  helper DOT get_files_for_task PARELEFT  PARERIGHT  EOM
data_train  EQUAL  helper DOT get_stories PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
data_test  EQUAL  helper DOT get_stories PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT  EOM
word2idx  EQUAL  helper DOT build_vocab PARELEFT  PARERIGHT  EOM
vocab_size  EQUAL  len PARELEFT  PARERIGHT  + 1 EOM
story_maxlen COMMA  question_maxlen  EQUAL  helper DOT get_maxlens PARELEFT  PARERIGHT  EOM
Xs_train COMMA  Xq_train COMMA  Y_train  EQUAL  helper DOT vectorize_baseline PARELEFT  PARERIGHT  EOM
Xs_test COMMA  Xq_test COMMA  Y_test  EQUAL  helper DOT vectorize_baseline PARELEFT  PARERIGHT  EOM
story_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
story_lstm DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_HIDDEN_SIZE COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
story_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
question_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
question_lstm DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  EMBED_HIDDEN_SIZE COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
question_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
question_lstm DOT add PARELEFT LSTM PARELEFT EMBED_HIDDEN_SIZE COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
question_lstm DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT EMBED_HIDDEN_SIZE COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT vocab_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA  Y_train COMMA  tch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
loss COMMA  acc  EQUAL  model DOT evaluate PARELEFT [] COMMA  Y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Bidirectional EOM
from keras DOT layers import LSTM COMMA  Flatten COMMA  Conv1D COMMA  LocallyConnected1D COMMA  CuDNNLSTM COMMA  CuDNNGRU COMMA  MaxPooling1D COMMA  GlobalAveragePooling1D COMMA  GlobalMaxPooling1D EOM
from math import sqrt EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT callbacks import ModelCheckpoint EOM
import keras EOM
from sklearn DOT preprocessing import OneHotEncoder EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT advanced_activations import ELU EOM
import tensorflow as tf EOM
import numpy as np EOM
import argparse EOM
import os EOM
from keras DOT callbacks import CSVLogger EOM
from keras import backend as K EOM
def biGRU PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNGRU PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNGRU PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def biGRU_big PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNGRU PARELEFT 128 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNGRU PARELEFT 128 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def biGRU_16bit PARELEFT  PARERIGHT : EOM
K DOT set_floatx PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNGRU PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNGRU PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def biLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def biLSTM_16bit PARELEFT  PARERIGHT : EOM
K DOT set_floatx PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_multi PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_multi_big PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  64 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 64 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 64 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_multi_bn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_multi_16bit PARELEFT  PARERIGHT : EOM
K DOT set_floatx PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_multi_selu PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_multi_selu_16bit PARELEFT  PARERIGHT : EOM
K DOT set_floatx PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNLSTM PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
init  EQUAL  keras DOT initializers DOT lecun_uniform PARELEFT seed EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def GRU_multi PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNGRU PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNGRU PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def GRU_multi_big PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNGRU PARELEFT 128 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNGRU PARELEFT 128 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def GRU_multi_16bit PARELEFT  PARERIGHT : EOM
K DOT set_floatx PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNGRU PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT CuDNNGRU PARELEFT 32 COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def FC_4layer_16bit PARELEFT  PARERIGHT : EOM
K DOT set_floatx PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  5 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def FC_4layer PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  5 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def FC_4layer_big PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def FC_16bit PARELEFT  PARERIGHT : EOM
k DOT set_floatx PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
init  EQUAL  keras DOT initializers DOT lecun_uniform PARELEFT seed EQUAL  PARERIGHT  EOM
model DOT add PARELEFT embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT dense PARELEFT 1024 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def FC PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
init  EQUAL  keras DOT initializers DOT lecun_uniform PARELEFT seed EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT alphabet_size COMMA  32 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1024 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT alphabet_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
from __future__ import print_function EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT models import model_from_json EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT callbacks import EarlyStopping EOM
import keras DOT backend as K EOM
from keras DOT utils import plot_model EOM
import input_data EOM
import build_model EOM
from LSTM_config import * EOM
def rmse PARELEFT  PARERIGHT : EOM
return K DOT sqrt PARELEFT K DOT mean PARELEFT K DOT square PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  PARERIGHT  EOM
train COMMA  validation COMMA  test  EQUAL  input_data DOT read_data_sets PARELEFT  PARERIGHT  EOM
flow_train  EQUAL  train DOT flow EOM
labels_train  EQUAL  train DOT labels EOM
flow_test  EQUAL  test DOT flow EOM
labels_test  EQUAL  test DOT labels EOM
flow_validation  EQUAL  validation DOT flow EOM
labels_validation  EQUAL  validation DOT labels EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA output_dim EQUAL  COMMA eturn_sequences EQUAL  COMMA   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
checkpoint_callbacks  EQUAL  ModelCheckpoint PARELEFT filepath  EQUAL  COMMA monitor EQUAL  COMMA verbose EQUAL  COMMA save_best_only EQUAL  COMMA mode EQUAL  PARERIGHT  EOM
checkpoint_callbacks_list  EQUAL  [] EOM
tensorboard_callbacks  EQUAL  TensorBoard PARELEFT log_dir EQUAL  COMMA write_images EQUAL  COMMA histogram_freq EQUAL  PARERIGHT  EOM
tensorboard_callbacks_list  EQUAL  [] EOM
history  EQUAL  model DOT fit PARELEFT flow_train COMMA labels_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA verbose EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT flow_test COMMA  labels_test COMMA  verbose EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from keras DOT layers import Embedding COMMA  Dense COMMA  Activation COMMA  Input COMMA  LSTM COMMA  Dropout COMMA  Bidirectional COMMA  Merge EOM
from keras DOT optimizers import SGD COMMA  Adam COMMA  Adadelta EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT preprocessing DOT text import Tokenizer COMMA  text_to_word_sequence EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
import gensim EOM
word2vec  EQUAL  gensim DOT models DOT Word2Vec DOT load PARELEFT  PARERIGHT  EOM
max_len  EQUAL  40 EOM
labels  EQUAL  [] EOM
trainLabeled  EQUAL  [] EOM
trainUnlabeled  EQUAL  [] EOM
tests  EQUAL  [] EOM
labeled_data_path  EQUAL  EOM
text  EQUAL  open PARELEFT  PARERIGHT  EOM
rows  EQUAL  text DOT readlines PARELEFT  PARERIGHT  EOM
lens  EQUAL  [] EOM
for row in rows: EOM
labels DOT append PARELEFT int PARELEFT  PARERIGHT  PARERIGHT  EOM
trainLabeled DOT append PARELEFT  PARERIGHT  EOM
trainLabeled[]  EQUAL  text_to_word_sequence PARELEFT  PARERIGHT  EOM
lens DOT append PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
for idx in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
trainLabeled[][]  EQUAL  word2vec[][]] EOM
lens  EQUAL  [] EOM
unlabeled_data_path  EQUAL  EOM
text  EQUAL  open PARELEFT  PARERIGHT  EOM
rows  EQUAL  text DOT readlines PARELEFT  PARERIGHT  EOM
for row in rows: EOM
trainUnlabeled DOT append PARELEFT  PARERIGHT  EOM
trainUnlabeled[]  EQUAL  text_to_word_sequence PARELEFT  PARERIGHT  EOM
lens DOT append PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
lens  EQUAL  [] EOM
test_data_path  EQUAL  EOM
text  EQUAL  open PARELEFT  PARERIGHT  EOM
rows  EQUAL  text DOT readlines PARELEFT  PARERIGHT  EOM
for i COMMA row in enumerate PARELEFT  PARERIGHT : EOM
if i  EQUAL  EQUAL  0: EOM
continue EOM
for pivot in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
if row[]  EQUAL  EQUAL  : EOM
tests DOT append PARELEFT  PARERIGHT  EOM
tests[]  EQUAL  text_to_word_sequence PARELEFT  PARERIGHT  EOM
break EOM
lens DOT append PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
trainLabeled  EQUAL  pad_sequences PARELEFT trainLabeled COMMA  maxlen EQUAL  COMMA  dtype EQUAL  COMMA  padding EQUAL  COMMA  truncating EQUAL  COMMA  value EQUAL  PARERIGHT  EOM
labels  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
labels  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
deepLSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
deepLSTM DOT add PARELEFT LSTM PARELEFT 160 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
deepLSTM DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
deepLSTM DOT add PARELEFT LSTM PARELEFT 64 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
deepLSTM_b  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
deepLSTM_b DOT add PARELEFT LSTM PARELEFT 160 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
deepLSTM_b DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
deepLSTM_b DOT add PARELEFT LSTM PARELEFT 64 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT   PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 200 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 100 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 80 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
opt  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
filepath EQUAL  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
train_history  EQUAL  model DOT fit PARELEFT [] COMMA  labels COMMA  validation_split EQUAL  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  callbacks EQUAL  COMMA  shuffle  EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
loss  EQUAL  train_history DOT history[] EOM
val_loss  EQUAL  train_history DOT history[] EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT xlabel PARELEFT  PARERIGHT  EOM
plt DOT ylabel PARELEFT  PARERIGHT  EOM
plt DOT savefig PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
import pandas as pd EOM
import numpy as np EOM
import keras EOM
from tqdm import tqdm EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Merge EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT utils import np_utils EOM
from keras DOT layers import TimeDistributed COMMA  Lambda EOM
from keras DOT layers import Convolution1D COMMA  GlobalMaxPooling1D EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras import backend as K EOM
from keras DOT layers DOT advanced_activations import PReLU EOM
import pickle EOM
from sklearn import metrics EOM
from sklearn DOT model_selection import train_test_split EOM
from keras DOT layers import Layer EOM
from keras DOT models import Model EOM
from keras DOT layers DOT core import  Lambda COMMA Dropout COMMA Dense COMMA  Flatten COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT recurrent import GRU COMMA LSTM EOM
from keras DOT layers DOT pooling import MaxPooling2D EOM
from keras DOT layers import Concatenate COMMA  Input COMMA  concatenate COMMA dot EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras import initializers as initializations EOM
from keras import regularizers EOM
from keras import constraints EOM
from keras import backend as K EOM
from keras DOT callbacks import EarlyStopping COMMA  ModelCheckpoint EOM
import sys EOM
reload PARELEFT  PARERIGHT  EOM
sys DOT setdefaultencoding PARELEFT  PARERIGHT  EOM
import re EOM
import numpy as np EOM
import pandas as pd EOM
import csv EOM
import matplotlib DOT pyplot as plt EOM
import itertools EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA LSTM COMMA Embedding EOM
from keras DOT optimizers import Adam EOM
from keras DOT layers import SpatialDropout1D COMMA Dropout COMMA Conv1D COMMA GlobalMaxPooling1D COMMA MaxPooling1D EOM
from keras DOT callbacks import ModelCheckpoint COMMA  TensorBoard COMMA  Callback COMMA  EarlyStopping EOM
from keras DOT metrics import categorical_accuracy EOM
from keras DOT utils import np_utils EOM
from sklearn DOT model_selection import train_test_split EOM
from sklearn DOT metrics import confusion_matrix COMMA  f1_score COMMA  precision_score COMMA  recall_score EOM
from sklearn DOT metrics import classification_report COMMA  accuracy_score EOM
from sklearn DOT preprocessing import LabelEncoder EOM
seed EQUAL np DOT random DOT seed PARELEFT  PARERIGHT  EOM
phrase EQUAL [] EOM
labels EQUAL [] EOM
train EQUAL pd DOT DataFrame DOT from_csv PARELEFT  COMMA  sep EQUAL  COMMA  header EQUAL  PARERIGHT  EOM
def clean_text PARELEFT  PARERIGHT : EOM
words  EQUAL   PARELEFT re DOT sub PARELEFT  PARERIGHT  PARERIGHT  DOT lower PARELEFT  PARERIGHT  EOM
words  EQUAL  words DOT split PARELEFT  PARERIGHT  EOM
wordList  EQUAL  re DOT sub PARELEFT  PARERIGHT  DOT split PARELEFT  PARERIGHT  EOM
words  EQUAL  [] EOM
words  EQUAL  [] EOM
words EQUAL words DOT split PARELEFT  PARERIGHT  EOM
words EQUAL   DOT join PARELEFT  PARERIGHT  EOM
stemmer  EQUAL  SnowballStemmer PARELEFT  PARERIGHT  EOM
stemmed_words  EQUAL  [] EOM
text  EQUAL   DOT join PARELEFT  PARERIGHT  EOM
return text EOM
train[]  EQUAL  train[] DOT map PARELEFT lambda x: clean_text PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  train[] EOM
le  EQUAL  LabelEncoder PARELEFT  PARERIGHT  EOM
encoded_labels  EQUAL  le DOT fit_transform PARELEFT  PARERIGHT  EOM
y EQUAL encoded_labels EOM
X_train  COMMA  X_test  COMMA  Y_train  COMMA  Y_test  EQUAL  train_test_split PARELEFT train[] COMMA y COMMA test_size  EQUAL  PARERIGHT  EOM
length  EQUAL  [] EOM
for x in X_train: EOM
length DOT append PARELEFT len PARELEFT x DOT split PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
max_features  EQUAL  10000 EOM
max_words  EQUAL  700 EOM
batch_size  EQUAL  32 EOM
epochs  EQUAL  3 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT list PARELEFT  PARERIGHT  PARERIGHT  EOM
X_train  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
X_test  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
X_train  EQUAL pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model_CNN EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_CNN DOT add PARELEFT Embedding PARELEFT max_features COMMA 100 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_CNN DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_CNN DOT add PARELEFT Conv1D PARELEFT 32 COMMA kernel_size EQUAL  COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model_CNN DOT add PARELEFT GlobalMaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model_CNN DOT add PARELEFT Dense PARELEFT 128 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_CNN DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_CNN DOT add PARELEFT Dense PARELEFT 1 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_CNN DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model_CNN DOT summary PARELEFT  PARERIGHT  EOM
history EQUAL model_CNN DOT fit PARELEFT X_train COMMA  Y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
model_LSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT Embedding PARELEFT max_features COMMA  100 COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT LSTM PARELEFT 64 COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT LSTM PARELEFT 32 COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model_LSTM DOT summary PARELEFT  PARERIGHT  EOM
history EQUAL model_LSTM DOT fit PARELEFT X_train COMMA  Y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
model_LSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT Embedding PARELEFT max_features COMMA  100 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model_LSTM DOT fit PARELEFT X_train COMMA  Y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
embeddings_index  EQUAL  dict PARELEFT  PARERIGHT  EOM
f  EQUAL  open PARELEFT  COMMA encoding EQUAL  PARERIGHT  EOM
for line in f: EOM
values  EQUAL  line DOT split PARELEFT  PARERIGHT  EOM
word  EQUAL  values[] EOM
coefs  EQUAL  np DOT asarray PARELEFT values[] COMMA  dtype EQUAL  PARERIGHT  EOM
embeddings_index[]  EQUAL  coefs EOM
f DOT close PARELEFT  PARERIGHT  EOM
embedding_matrix  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for word COMMA  index in tokenizer DOT word_index DOT items PARELEFT  PARERIGHT : EOM
if index > max_features - 1: EOM
break EOM
else: EOM
embedding_vector  EQUAL  embeddings_index DOT get PARELEFT  PARERIGHT  EOM
if embedding_vector is not None: EOM
embedding_matrix[]  EQUAL  embedding_vector EOM
model_glove  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_glove DOT add PARELEFT Embedding PARELEFT max_features COMMA  100 COMMA  input_length EQUAL  COMMA  weights EQUAL [] COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model_glove DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_glove DOT add PARELEFT Conv1D PARELEFT 64 COMMA  5 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_glove DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model_glove DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model_glove DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_glove DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model_glove DOT fit PARELEFT X_train COMMA  Y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
def plot_confusion_matrix PARELEFT cm COMMA  classes COMMA normalize EQUAL  COMMA cmap EQUAL  PARERIGHT : EOM
cm  EQUAL  cm DOT astype PARELEFT  PARERIGHT  / cm DOT sum PARELEFT axis EQUAL  PARERIGHT [] EOM
title  EQUAL  EOM
else: EOM
title  EQUAL  EOM
plt DOT imshow PARELEFT cm COMMA  interpolation EQUAL  COMMA  cmap EQUAL  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT colorbar PARELEFT  PARERIGHT  EOM
tick_marks  EQUAL  np DOT arange PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT xticks PARELEFT tick_marks COMMA  classes COMMA  rotation EQUAL  PARERIGHT  EOM
plt DOT yticks PARELEFT  PARERIGHT  EOM
fmt  EQUAL   if normalize else EOM
thresh  EQUAL  cm DOT max PARELEFT  PARERIGHT  / 2 DOT  EOM
for i COMMA  j in itertools DOT product PARELEFT range PARELEFT  PARERIGHT  COMMA  range PARELEFT  PARERIGHT  PARERIGHT : EOM
plt DOT text PARELEFT j COMMA  i COMMA  format PARELEFT  PARERIGHT  COMMA horizontalalignment EQUAL  COMMA whiteblack EOM
plt DOT tight_layout PARELEFT  PARERIGHT  EOM
plt DOT ylabel PARELEFT  PARERIGHT  EOM
plt DOT xlabel PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
def full_multiclass_report PARELEFT model COMMA x COMMA y_true COMMA classes COMMA batch_size EQUAL  COMMA binary EQUAL  PARERIGHT : EOM
if not binary: EOM
y_true  EQUAL  np DOT argmax PARELEFT y_true COMMA  axis EQUAL  PARERIGHT  EOM
y_pred  EQUAL  model DOT predict_classes PARELEFT x COMMA  batch_size EQUAL  PARERIGHT  EOM
cnf_matrix  EQUAL  confusion_matrix PARELEFT  PARERIGHT  EOM
plot_confusion_matrix PARELEFT cnf_matrix COMMA  classes EQUAL  PARERIGHT  EOM
fig1  EQUAL  plt DOT figure PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  COMMA linewidth EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  COMMA linewidth EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT [] COMMA fontsize EQUAL  PARERIGHT  EOM
plt DOT xlabel PARELEFT  COMMA fontsize EQUAL  PARERIGHT  EOM
plt DOT ylabel PARELEFT  COMMA fontsize EQUAL  PARERIGHT  EOM
plt DOT title PARELEFT  COMMA fontsize EQUAL  PARERIGHT  EOM
fig1 DOT savefig PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
fig2 EQUAL plt DOT figure PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  COMMA linewidth EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  COMMA linewidth EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT [] COMMA fontsize EQUAL  PARERIGHT  EOM
plt DOT xlabel PARELEFT  COMMA fontsize EQUAL  PARERIGHT  EOM
plt DOT ylabel PARELEFT  COMMA fontsize EQUAL  PARERIGHT  EOM
plt DOT title PARELEFT  COMMA fontsize EQUAL  PARERIGHT  EOM
fig2 DOT savefig PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
le  EQUAL  LabelEncoder PARELEFT  PARERIGHT  EOM
encoded_labels  EQUAL  le DOT fit_transform PARELEFT  PARERIGHT  EOM
full_multiclass_report PARELEFT model3_LSTM COMMA X_test COMMA Y_test COMMA le DOT inverse_transform PARELEFT np DOT arange PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
scores  EQUAL  model_LSTM DOT evaluate PARELEFT X_test COMMA Y_test COMMA verbose EQUAL  PARERIGHT  EOM
import json EOM
import numpy as np EOM
import pandas as pd EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT models import Model EOM
from keras DOT layers import  PARELEFT  PARERIGHT  EOM
class MusicModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT n_vocab  EQUAL  n_vocab EOM
pass EOM
def OneLayerLSTM PARELEFT self COMMA  batch_input_shape EQUAL  COMMA  emb_dim EQUAL  COMMA  drop_rate EQUAL  PARERIGHT : EOM
self DOT model DOT add PARELEFT Embedding PARELEFT input_dim  EQUAL  COMMA  output_dim  EQUAL  COMMA  batch_input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences  EQUAL  COMMA  stateful  EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return self DOT model EOM
def TwoLayerLSTM PARELEFT self COMMA  batch_input_shape EQUAL  COMMA  emb_dim EQUAL  COMMA drop_rate EQUAL  PARERIGHT : EOM
return self DOT model EOM
def LayersRNNGeneric PARELEFT self COMMA  batch_input_shape EQUAL  COMMA  layers EQUAL [] COMMA  ers_size EQUAL [] COMMA  emb_dim EQUAL  COMMA drop_rate EQUAL  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT [] PARERIGHT  EOM
for idx COMMA  layer in enumerate PARELEFT  PARERIGHT : EOM
if layer is : EOM
self DOT model DOT add PARELEFT LSTM PARELEFT layers_size[] COMMA  return_sequences  EQUAL  COMMA  stateful  EQUAL  PARERIGHT  PARERIGHT  EOM
elif layer is : EOM
self DOT model DOT add PARELEFT GRU PARELEFT layers_size[] COMMA  return_sequences  EQUAL  COMMA  stateful  EQUAL  PARERIGHT  PARERIGHT  EOM
elif layer is : EOM
self DOT model DOT add PARELEFT RNN PARELEFT layers_size[] COMMA  return_sequences  EQUAL  COMMA  stateful  EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError  PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return self DOT model EOM
def LSTMSkipConnection PARELEFT self COMMA  layers EQUAL [] COMMA  batch_input_shape EQUAL  COMMA  emb_dim EQUAL  COMMA drop_rate EQUAL  PARERIGHT : EOM
embedded  EQUAL  Embedding PARELEFT input_dim  EQUAL  COMMA  tput_dim  EQUAL  COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
drop  EQUAL  Dropout PARELEFT drop_rate COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_layer1  EQUAL  LSTM PARELEFT 128 COMMA  return_sequences  EQUAL  COMMA  stateful  EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm_layer2  EQUAL  LSTM PARELEFT 128 COMMA  return_sequences  EQUAL  COMMA  stateful  EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
layer_output  EQUAL  [] EOM
prev_out  EQUAL  drop EOM
for idx COMMA  layer in enumerate PARELEFT  PARERIGHT : EOM
out  EQUAL  LSTM PARELEFT layer COMMA  return_sequences  EQUAL  COMMA  stateful  EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
layer_output DOT append PARELEFT  PARERIGHT  EOM
prev_out  EQUAL  out EOM
seq_concat  EQUAL  concatenate PARELEFT []+layer_output COMMA name EQUAL  PARERIGHT  EOM
output_layer  EQUAL  TimeDistributed PARELEFT Dense PARELEFT self DOT n_vocab COMMA  name EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL [] PARERIGHT  EOM
return self DOT model EOM
def OneLayerGru PARELEFT self COMMA  batch_input_shape EQUAL  COMMA  emb_dim EQUAL  COMMA drop_rate EQUAL  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT [] PARERIGHT  EOM
return self DOT model EOM
def OneLayerRNN PARELEFT self COMMA  batch_input_shape EQUAL  COMMA  emb_dim EQUAL  COMMA drop_rate EQUAL  PARERIGHT : EOM
self DOT model  EQUAL  Sequential PARELEFT [] PARERIGHT  EOM
return self DOT model EOM
from __future__ import print_function EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D EOM
from keras DOT datasets import imdb EOM
top_words  EQUAL  20000 EOM
maxlen  EQUAL  100 EOM
embedding_size  EQUAL  128 EOM
kernel_size  EQUAL  5 EOM
filters  EQUAL  64 EOM
pool_size  EQUAL  4 EOM
lstm_output_size  EQUAL  70 EOM
batch_size  EQUAL  30 EOM
epochs  EQUAL  2 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters COMMA kernel_size COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  EOM
import keras DOT backend as k EOM
from keras import layers EOM
from keras DOT layers import Input COMMA  Dense COMMA  Reshape COMMA  Flatten COMMA  Embedding COMMA  Dropout COMMA  LSTM EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
from keras DOT layers DOT convolutional import UpSampling2D COMMA  Conv2D EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT optimizers import Adam EOM
from keras DOT utils DOT generic_utils import Progbar EOM
import numpy as np EOM
import pickle EOM
import datetime EOM
from ml DOT public import * EOM
def ann_build_generator PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  activation EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  activation EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  activation EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def ann_train_test PARELEFT  PARERIGHT : EOM
st  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
model  EQUAL  ann_build_generator PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as handle: EOM
pickle DOT dump PARELEFT model COMMA  handle COMMA  protocol EQUAL  PARERIGHT  EOM
Y_pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
tp COMMA  tn COMMA  fp COMMA  fn  EQUAL  pred_test_lstm PARELEFT  PARERIGHT  EOM
ed  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
return  + gen_result_line PARELEFT  PARERIGHT  EOM
def dnn_build_generator PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 20 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 20 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def dnn_train_test PARELEFT  PARERIGHT : EOM
st  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
model  EQUAL  dnn_build_generator PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as handle: EOM
pickle DOT dump PARELEFT model COMMA  handle COMMA  protocol EQUAL  PARERIGHT  EOM
Y_pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
tp COMMA  tn COMMA  fp COMMA  fn  EQUAL  pred_test_lstm PARELEFT  PARERIGHT  EOM
ed  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
return  + gen_result_line PARELEFT  PARERIGHT  EOM
def lstm_build_generator PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_build_generator2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_data_gen PARELEFT  PARERIGHT : EOM
n_X_train  EQUAL  [] EOM
cur_X_train  EQUAL  [] EOM
n_Y_train  EQUAL  [] EOM
cur_Y_train  EQUAL  [] EOM
for i in range PARELEFT cnt COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
n_X_train DOT append PARELEFT  PARERIGHT  EOM
n_Y_train DOT append PARELEFT  PARERIGHT  EOM
return np DOT array PARELEFT  PARERIGHT  COMMA  np DOT array PARELEFT  PARERIGHT  EOM
def lstm_train_test PARELEFT  PARERIGHT : EOM
st  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
model  EQUAL  lstm_build_generator PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
n_X_train COMMA  n_Y_train  EQUAL  lstm_data_gen PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT n_X_train COMMA  n_Y_train COMMA  epochs EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
n_X_test COMMA  n_Y_test  EQUAL  lstm_data_gen PARELEFT  PARERIGHT  EOM
Y_pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
tp COMMA  tn COMMA  fp COMMA  fn  EQUAL  pred_test_lstm PARELEFT  PARERIGHT  EOM
return  + gen_result_line PARELEFT  PARERIGHT import sys EOM
import logging EOM
import re EOM
import os EOM
import dill EOM
import inspect EOM
import itertools EOM
from collections import OrderedDict EOM
import numpy as np EOM
from gensim DOT models DOT doc2vec import TaggedDocument EOM
from gensim DOT models import Doc2Vec COMMA  Word2Vec EOM
import fasttext EOM
import keras EOM
import keras DOT preprocessing EOM
import keras DOT preprocessing DOT text EOM
import keras DOT preprocessing DOT sequence EOM
from keras DOT utils DOT generic_utils import Progbar EOM
from datasets import TweetSentiment COMMA  Tweet EOM
_thismodule  EQUAL  sys DOT modules[] EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
import encoder as unsupervised_sentiment_neuron_encoder EOM
sys DOT path DOT pop PARELEFT  PARERIGHT  EOM
def grouper PARELEFT iterable COMMA  n COMMA  fillvalue EQUAL  PARERIGHT : EOM
args  EQUAL  [] * n EOM
return itertools DOT zip_longest PARELEFT *args COMMA  fillvalue EQUAL  PARERIGHT  EOM
def find_model_class_by_name PARELEFT  PARERIGHT : EOM
model_class  EQUAL  None EOM
for name COMMA  obj in inspect DOT getmembers PARELEFT  PARERIGHT : EOM
if inspect DOT isclass PARELEFT  PARERIGHT  and name  EQUAL  PARELEFT  PARERIGHT   EQUAL             model_class  EQUAL  obj EOM
if model_class is None: EOM
raise Exception PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
return model_class EOM
class TweetToFeaturesModel PARELEFT  PARERIGHT : EOM
def _check_features_range PARELEFT features COMMA  l EQUAL  COMMA  r EQUAL  PARERIGHT : EOM
if not all PARELEFT l < EQUAL  PARERIGHT : EOM
logging DOT warning PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
raise NotImplementedError PARELEFT  PARERIGHT  EOM
def save PARELEFT  PARERIGHT : EOM
raise NotImplementedError PARELEFT  PARERIGHT  EOM
def get_features PARELEFT  PARERIGHT : EOM
raise NotImplementedError PARELEFT  PARERIGHT  EOM
def get_features_shape PARELEFT  PARERIGHT : EOM
raise NotImplementedError PARELEFT  PARERIGHT  EOM
def batch_get_features PARELEFT self COMMA  tweets COMMA  verbose EQUAL  PARERIGHT : EOM
if verbose: EOM
progress  EQUAL  Progbar PARELEFT target EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
X  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  PARERIGHT  + self DOT get_features_shape PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
for i COMMA  tweet in enumerate PARELEFT  PARERIGHT : EOM
X[]  EQUAL  self DOT get_features PARELEFT  PARERIGHT  EOM
if verbose: EOM
progress DOT update PARELEFT  PARERIGHT  EOM
return X EOM
class FasttextEmbedding PARELEFT  PARERIGHT : EOM
def load PARELEFT  PARERIGHT : EOM
instance  EQUAL  cls PARELEFT  PARERIGHT  EOM
instance DOT model  EQUAL  fasttext DOT load_model PARELEFT  PARERIGHT  EOM
return instance EOM
def train PARELEFT  PARERIGHT : EOM
assert NotImplementedError PARELEFT  PARERIGHT  EOM
def get_features_number PARELEFT  PARERIGHT : EOM
class FasttextDocumentEmbedding PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def get_features PARELEFT  PARERIGHT : EOM
features  EQUAL  self DOT model[] EOM
self DOT _check_features_range PARELEFT  PARERIGHT  EOM
return features EOM
def get_features_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT self DOT get_features_number PARELEFT  PARERIGHT  COMMA   PARERIGHT  EOM
class FasttextWordEmbedding PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  max_words EQUAL  PARERIGHT : EOM
self DOT max_words  EQUAL  max_words EOM
def get_features PARELEFT  PARERIGHT : EOM
features  EQUAL  np DOT zeros PARELEFT  PARELEFT self DOT get_max_words PARELEFT  PARERIGHT  COMMA  self DOT get_features_number PARELEFT  PARERIGHT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
for i COMMA  word in enumerate PARELEFT tweet DOT get_words PARELEFT  PARERIGHT [] PARERIGHT : EOM
features[]  EQUAL  self DOT model[] EOM
return features EOM
def get_max_words PARELEFT  PARERIGHT : EOM
return self DOT max_words EOM
def get_features_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT self DOT max_words COMMA  self DOT get_features_number PARELEFT  PARERIGHT  PARERIGHT  EOM
class TweetSentimentModel PARELEFT  PARERIGHT : EOM
def _make_dirs_for_files PARELEFT  PARERIGHT : EOM
dirname  EQUAL  os DOT path DOT dirname PARELEFT  PARERIGHT  EOM
if dirname: EOM
os DOT makedirs PARELEFT dirname COMMA  exist_ok EQUAL  PARERIGHT  EOM
def save PARELEFT  PARERIGHT : EOM
self DOT _make_dirs_for_files PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
dill DOT dump PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
with open PARELEFT  PARERIGHT  as f: EOM
instance  EQUAL  dill DOT load PARELEFT  PARERIGHT  EOM
assert isinstance PARELEFT  PARERIGHT  EOM
return instance EOM
def predict_sentiment_real PARELEFT  PARERIGHT : EOM
raise NotImplementedError PARELEFT  PARERIGHT  EOM
def predict_sentiment_enum PARELEFT self COMMA  tweet COMMA  without_neutral EQUAL  PARERIGHT : EOM
real_value_of_sentiment  EQUAL  self DOT predict_sentiment_real PARELEFT  PARERIGHT  EOM
return TweetSentiment DOT from_real_value PARELEFT real_value_of_sentiment COMMA  without_neutral EQUAL  PARERIGHT  EOM
def is_positive PARELEFT  PARERIGHT : EOM
return self DOT get_sentiment PARELEFT  PARERIGHT  > self DOT NEUTRAL_THRESHOLD EOM
def is_negative PARELEFT  PARERIGHT : EOM
return self DOT get_sentiment PARELEFT  PARERIGHT  < -self DOT NEUTRAL_THRESHOLD EOM
def is_neutral PARELEFT  PARERIGHT : EOM
return not self DOT is_positive PARELEFT  PARERIGHT  and not self DOT is_negative PARELEFT  PARERIGHT  EOM
def train PARELEFT  PARERIGHT : EOM
raise NotImplementedError PARELEFT  PARERIGHT  EOM
def test PARELEFT self COMMA  tweets COMMA  without_neutral EQUAL  PARERIGHT : EOM
total  EQUAL  0 EOM
for tweet in tweets: EOM
assert tweet DOT polarity is not None EOM
if tweet DOT is_neutral PARELEFT  PARERIGHT  and without_neutral: EOM
continue EOM
if tweet DOT polarity  EQUAL  EQUAL  self DOT predict_sentiment_enum PARELEFT  PARERIGHT : EOM
correct + EQUAL  1 EOM
total + EQUAL  1 EOM
return correct / total EOM
class FeaturesToSentimentModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  tweet_to_features COMMA  features_to_sentiment EQUAL  PARERIGHT : EOM
self DOT tweet_to_features  EQUAL  tweet_to_features EOM
self DOT features_to_sentiment  EQUAL  features_to_sentiment EOM
def save PARELEFT  PARERIGHT : EOM
self DOT _make_dirs_for_files PARELEFT  PARERIGHT  EOM
self DOT save_features_to_sentiment PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
instance  EQUAL  cls PARELEFT  PARERIGHT  EOM
instance DOT load_features_to_sentiment PARELEFT  PARERIGHT  EOM
return instance EOM
class KerasFeaturesToSentimentModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  tweet_to_features COMMA  keras_model EQUAL  COMMA  batch_size EQUAL  COMMA  num_epochs EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT : EOM
FeaturesToSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT num_epochs  EQUAL  num_epochs EOM
self DOT batch_size  EQUAL  batch_size EOM
self DOT dropout  EQUAL  dropout EOM
self DOT recurrent_dropout  EQUAL  recurrent_dropout EOM
def save_features_to_sentiment PARELEFT  PARERIGHT : EOM
self DOT features_to_sentiment DOT save PARELEFT  PARERIGHT  EOM
def load_features_to_sentiment PARELEFT  PARERIGHT : EOM
self DOT features_to_sentiment  EQUAL  keras DOT models DOT load_model PARELEFT  PARERIGHT  EOM
def predict_sentiment_real PARELEFT  PARERIGHT : EOM
if isinstance PARELEFT  PARERIGHT : EOM
tweets  EQUAL  [] EOM
single_instance  EQUAL  True EOM
else: EOM
single_instance  EQUAL  False EOM
X  EQUAL  self DOT tweet_to_features DOT batch_get_features PARELEFT tweets COMMA  verbose EQUAL  PARERIGHT  EOM
ys  EQUAL  self DOT features_to_sentiment DOT predict PARELEFT  PARERIGHT  EOM
if single_instance: EOM
return 2 * ys[][] - 1 EOM
else: EOM
return [] - 1 for y in ys] EOM
def _features_generator PARELEFT  PARERIGHT : EOM
for chunk in grouper PARELEFT itertools DOT cycle PARELEFT  PARERIGHT  COMMA  self DOT batch_size PARERIGHT : EOM
X  EQUAL  self DOT tweet_to_features DOT batch_get_features PARELEFT chunk COMMA  verbose EQUAL  PARERIGHT  EOM
y  EQUAL  [] EOM
yield X COMMA  y EOM
def train PARELEFT  PARERIGHT : EOM
self DOT features_to_sentiment DOT fit_generator PARELEFT self DOT _features_generator PARELEFT  PARERIGHT  COMMA s_per_epoch EQUAL  PARELEFT len PARELEFT  PARERIGHT  // self DOT batch_size PARERIGHT  - 1 COMMA epochs EQUAL  COMMA verbose EQUAL  PARERIGHT  EOM
class KerasLSTMFeaturesToSentimentModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  tweet_to_features COMMA  lstm_layer_sizes EQUAL [] COMMA  **kwargs PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
KerasFeaturesToSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
assert len PARELEFT tweet_to_features DOT get_features_shape PARELEFT  PARERIGHT  PARERIGHT   EQUAL  COMMA  EOM
if len PARELEFT  PARERIGHT  > 1: EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT lstm_layer_sizes[] COMMA return_sequences EQUAL  COMMA dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for size in lstm_layer_sizes[]: EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT size COMMA return_sequences EQUAL  COMMA dropout EQUAL  COMMA recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT lstm_layer_sizes[] COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT lstm_layer_sizes[] COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
class KerasGRUFeaturesToSentimentModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  tweet_to_features COMMA  gru_layer_sizes EQUAL [] COMMA  **kwargs PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
KerasFeaturesToSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
assert len PARELEFT tweet_to_features DOT get_features_shape PARELEFT  PARERIGHT  PARERIGHT   EQUAL  COMMA  EOM
if len PARELEFT  PARERIGHT  > 1: EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT gru_layer_sizes[] COMMA return_sequences EQUAL  COMMA dropout EQUAL  COMMA recurrent_dropout EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for size in gru_layer_sizes[]: EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT size COMMA return_sequences EQUAL  COMMA dropout EQUAL  COMMA recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT gru_layer_sizes[] COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT gru_layer_sizes[] COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
class KerasCNNFeaturesToSentimentModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  tweet_to_features COMMA  conv_layer_sizes EQUAL [] COMMA  dense_layer_size EQUAL  COMMA  **kwargs PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
KerasFeaturesToSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Convolution1D PARELEFT conv_layer_sizes[] COMMA  3 COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for size in conv_layer_sizes[]: EOM
model DOT add PARELEFT keras DOT layers DOT Convolution1D PARELEFT size COMMA  3 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT dense_layer_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
class KerasCLSTMFeaturesToSentimentModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  tweet_to_features COMMA  conv_layer_size EQUAL  COMMA  lstm_layer_size EQUAL  COMMA  **kwargs PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
KerasFeaturesToSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Convolution1D PARELEFT conv_layer_size COMMA 5 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
class KerasDenseFeaturesToSentimentModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  tweet_to_features COMMA  hidden_dense_layer_sizes EQUAL [] COMMA  **kwargs PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
KerasFeaturesToSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
assert len PARELEFT tweet_to_features DOT get_features_shape PARELEFT  PARERIGHT  PARERIGHT   EQUAL  COMMA  EOM
if hidden_dense_layer_sizes: EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT hidden_dense_layer_sizes[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for size in hidden_dense_layer_sizes[]: EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
class KerasTweetSentimentModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  max_words EQUAL  COMMA  max_tweet_length EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA edding_vector_length EQUAL  COMMA  num_epochs EQUAL  COMMA  batch_size EQUAL  COMMA  model EQUAL  PARERIGHT : EOM
TweetSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT tokenizer  EQUAL  keras DOT preprocessing DOT text DOT Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
self DOT max_words  EQUAL  max_words EOM
self DOT max_tweet_length  EQUAL  max_tweet_length EOM
self DOT embedding_vector_length  EQUAL  embedding_vector_length EOM
self DOT num_epochs  EQUAL  num_epochs EOM
self DOT batch_size  EQUAL  batch_size EOM
self DOT dropout  EQUAL  dropout EOM
self DOT recurrent_dropout  EQUAL  recurrent_dropout EOM
self DOT model  EQUAL  model EOM
def save PARELEFT  PARERIGHT : EOM
self DOT _make_dirs_for_files PARELEFT  PARERIGHT  EOM
tokenizer_filename  EQUAL  file_prefix + EOM
model_params_filename  EQUAL  file_prefix + EOM
keras_model_file_name  EQUAL  file_prefix + EOM
with open PARELEFT  PARERIGHT  as tf: EOM
dill DOT dump PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as mpf: EOM
dill DOT dump PARELEFT  PARERIGHT  EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
tokenizer_filename  EQUAL  file_prefix + EOM
model_params_filename  EQUAL  file_prefix + EOM
keras_model_file_name  EQUAL  file_prefix + EOM
instance  EQUAL  cls PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as tf: EOM
instance DOT tokenizer  EQUAL  dill DOT load PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as mpf: EOM
instance DOT max_words COMMA  instance DOT max_tweet_length COMMA  instance DOT embedding_vector_length COMMA  instance DOT num_epochs COMMA  instance DOT batch_size  EQUAL  dill DOT load PARELEFT  PARERIGHT  EOM
instance DOT model  EQUAL  keras DOT models DOT load_model PARELEFT  PARERIGHT  EOM
return instance EOM
def _train_tokenizer PARELEFT  PARERIGHT : EOM
self DOT tokenizer DOT fit_on_texts PARELEFT t DOT get_text PARELEFT  PARERIGHT  for t in tweets PARERIGHT  EOM
def _tweets_to_xy_tensors PARELEFT  PARERIGHT : EOM
texts COMMA  y  EQUAL  zip PARELEFT *[] PARERIGHT  EOM
X  EQUAL  self DOT tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
X  EQUAL  keras DOT preprocessing DOT sequence DOT pad_sequences PARELEFT X COMMA  maxlen EQUAL  PARERIGHT  EOM
return X COMMA  list PARELEFT  PARERIGHT  EOM
def _tweets_to_x_tensor PARELEFT  PARERIGHT : EOM
X  EQUAL  self DOT tokenizer DOT texts_to_sequences PARELEFT t DOT get_text PARELEFT  PARERIGHT  for t in tweets PARERIGHT  EOM
X  EQUAL  keras DOT preprocessing DOT sequence DOT pad_sequences PARELEFT X COMMA  maxlen EQUAL  PARERIGHT  EOM
return X EOM
def train PARELEFT self COMMA  tweets COMMA  num_epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT : EOM
num_epochs  EQUAL  num_epochs or self DOT num_epochs EOM
batch_size  EQUAL  batch_size or self DOT batch_size EOM
self DOT _train_tokenizer PARELEFT  PARERIGHT  EOM
X_train COMMA  y_train  EQUAL  self DOT _tweets_to_xy_tensors PARELEFT  PARERIGHT  EOM
self DOT model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
def predict_sentiment_real PARELEFT  PARERIGHT : EOM
if isinstance PARELEFT  PARERIGHT : EOM
Xs  EQUAL  self DOT _tweets_to_x_tensor PARELEFT  PARERIGHT  EOM
ys  EQUAL  self DOT model DOT predict PARELEFT  PARERIGHT  EOM
return 2 * ys[][] - 1 EOM
else: EOM
Xs  EQUAL  self DOT _tweets_to_x_tensor PARELEFT  PARERIGHT  EOM
ys  EQUAL  self DOT model DOT predict PARELEFT  PARERIGHT  EOM
return [] - 1 for y in ys] EOM
class KerasCLSTMModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  conv_layer_size EQUAL  COMMA  lstm_layer_size EQUAL  COMMA  **kwargs PARERIGHT : EOM
KerasTweetSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT self DOT max_words COMMA  self DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Convolution1D PARELEFT conv_layer_size COMMA 5 COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
class KerasCNNModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  conv_layer_sizes EQUAL [] COMMA  dense_layer_size EQUAL  COMMA  **kwargs PARERIGHT : EOM
KerasTweetSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT embeddings DOT Embedding PARELEFT self DOT max_words COMMA  self DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
for size in conv_layer_sizes: EOM
model DOT add PARELEFT keras DOT layers DOT Convolution1D PARELEFT size COMMA  3 COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT dense_layer_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
class KerasLSTMModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  lstm_layer_sizes EQUAL [] COMMA  **kwargs PARERIGHT : EOM
KerasTweetSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT embeddings DOT Embedding PARELEFT self DOT max_words COMMA  self DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
for size in lstm_layer_sizes[]: EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT size COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT lstm_layer_sizes[] COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
class KerasGRUModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT self COMMA  gru_layer_sizes EQUAL [] COMMA  **kwargs PARERIGHT : EOM
KerasTweetSentimentModel DOT __init__ PARELEFT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT embeddings DOT Embedding PARELEFT self DOT max_words COMMA  self DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
for size in gru_layer_sizes[]: EOM
model DOT add PARELEFT keras DOT layers DOT GRU PARELEFT size COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT GRU PARELEFT gru_layer_sizes[] COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
class UnsupervisedSentimentNeuronSingle PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  unsupervised_sentiment_neuron_encoder DOT Model PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
return UnsupervisedSentimentNeuronSingle PARELEFT  PARERIGHT  EOM
def train PARELEFT  PARERIGHT : EOM
assert NotImplementedError PARELEFT  PARERIGHT  EOM
def predict_sentiment_real PARELEFT self COMMA  tweet COMMA  verbose EQUAL  PARERIGHT : EOM
features  EQUAL  self DOT model DOT transform PARELEFT [] PARERIGHT  EOM
return features[] EOM
class UnsupervisedSentimentNeuronEncoder PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  unsupervised_sentiment_neuron_encoder DOT Model PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
return UnsupervisedSentimentNeuronEncoder PARELEFT  PARERIGHT  EOM
def train PARELEFT  PARERIGHT : EOM
assert NotImplementedError PARELEFT  PARERIGHT  EOM
def batch_get_features PARELEFT self COMMA  tweets COMMA  verbose EQUAL  PARERIGHT : EOM
features  EQUAL  self DOT model DOT transform PARELEFT [] PARERIGHT  EOM
return features EOM
def get_features PARELEFT  PARERIGHT : EOM
features  EQUAL  self DOT model DOT transform PARELEFT tweet DOT get_text PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT _check_features_range PARELEFT  PARERIGHT  EOM
return features EOM
def get_features_number PARELEFT  PARERIGHT : EOM
def get_features_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT self DOT get_features_number PARELEFT  PARERIGHT  COMMA   PARERIGHT  EOM
class Doc2VecEmbedding PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def save PARELEFT  PARERIGHT : EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
new_instance  EQUAL  Doc2VecEmbedding PARELEFT  PARERIGHT  EOM
new_instance DOT model  EQUAL  Doc2Vec DOT load PARELEFT  PARERIGHT  EOM
return new_instance EOM
def __init__ PARELEFT self COMMA  epochs COMMA  min_count EQUAL  COMMA  window EQUAL  COMMA  size EQUAL  COMMA  sample EQUAL  COMMA  negative EQUAL  COMMA  workers EQUAL  COMMA  *args COMMA  **kwargs PARERIGHT : EOM
self DOT model  EQUAL  Doc2Vec PARELEFT iter EQUAL  COMMA  min_count EQUAL  COMMA  window EQUAL  COMMA  size EQUAL  COMMA  sample EQUAL  COMMA  negative EQUAL  COMMA  workers EQUAL  COMMA  *args COMMA  **kwargs PARERIGHT  EOM
self DOT _epochs  EQUAL  epochs EOM
self DOT _tweet_to_index  EQUAL  {} EOM
def train PARELEFT  PARERIGHT : EOM
logging DOT info PARELEFT  PARERIGHT  EOM
tagged_docs  EQUAL  [] EOM
for index COMMA  tweet in enumerate PARELEFT  PARERIGHT : EOM
tagged_docs DOT append PARELEFT TaggedDocument PARELEFT tweet DOT get_words PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  PARERIGHT  EOM
self DOT _tweet_to_index[]  EQUAL  index EOM
self DOT model DOT build_vocab PARELEFT  PARERIGHT  EOM
self DOT model DOT train PARELEFT tagged_docs COMMA  epochs EQUAL  COMMA  total_examples EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def get_features PARELEFT  PARERIGHT : EOM
features  EQUAL  self DOT model DOT infer_vector PARELEFT tweet DOT get_words PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT _check_features_range PARELEFT  PARERIGHT  EOM
return features EOM
def train_vector_by_index PARELEFT  PARERIGHT : EOM
return self DOT model[] EOM
def get_features_number PARELEFT  PARERIGHT : EOM
return self DOT model DOT vector_size EOM
def get_features_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT self DOT get_features_number PARELEFT  PARERIGHT  COMMA   PARERIGHT  EOM
def _train_item_tag PARELEFT  PARERIGHT : EOM
return  DOT format PARELEFT  PARERIGHT  EOM
class Word2VecEmbedding PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def save PARELEFT  PARERIGHT : EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
new_instance  EQUAL  Word2VecEmbedding PARELEFT  PARERIGHT  EOM
new_instance DOT model  EQUAL  Word2Vec DOT load PARELEFT  PARERIGHT  EOM
return new_instance EOM
def __init__ PARELEFT self COMMA  epochs COMMA  min_count EQUAL  COMMA  window EQUAL  COMMA  size EQUAL  COMMA  sample EQUAL  COMMA  negative EQUAL  COMMA  workers EQUAL  COMMA  *args COMMA  **kwargs PARERIGHT : EOM
self DOT model  EQUAL  Word2Vec PARELEFT iter EQUAL  COMMA  min_count EQUAL  COMMA  window EQUAL  COMMA  size EQUAL  COMMA  sample EQUAL  COMMA  negative EQUAL  COMMA  workers EQUAL  COMMA  *args COMMA  **kwargs PARERIGHT  EOM
self DOT _epochs  EQUAL  epochs EOM
self DOT max_words  EQUAL  25 EOM
def train PARELEFT  PARERIGHT : EOM
logging DOT info PARELEFT  PARERIGHT  EOM
texts  EQUAL  [] EOM
self DOT model DOT build_vocab PARELEFT  PARERIGHT  EOM
self DOT model DOT train PARELEFT texts COMMA  epochs EQUAL  COMMA  total_examples EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def get_features PARELEFT  PARERIGHT : EOM
features  EQUAL  np DOT zeros PARELEFT  PARELEFT self DOT get_max_words PARELEFT  PARERIGHT  COMMA  self DOT get_features_number PARELEFT  PARERIGHT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
for i COMMA  word in enumerate PARELEFT tweet DOT get_words PARELEFT  PARERIGHT [] PARERIGHT : EOM
features[]  EQUAL  self DOT model DOT infer_vector[] EOM
return features EOM
def get_features_number PARELEFT  PARERIGHT : EOM
return self DOT model DOT vector_size EOM
def get_features_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT self DOT model DOT vector_size PARELEFT  PARERIGHT  COMMA  self DOT max_words PARERIGHT  EOM
class RussianSentimentLexicon PARELEFT  PARERIGHT : EOM
word_to_prob  EQUAL  {} EOM
with open PARELEFT  PARERIGHT  as f: EOM
for line in f: EOM
m  EQUAL  re DOT match PARELEFT  PARERIGHT  EOM
if m: EOM
word  EQUAL  m DOT group PARELEFT  PARERIGHT  EOM
probability  EQUAL  float PARELEFT m DOT group PARELEFT  PARERIGHT  PARERIGHT  EOM
word_to_prob[]  EQUAL         self DOT _word_to_prob  EQUAL  OrderedDict PARELEFT  PARERIGHT  EOM
self DOT _word_to_index  EQUAL  {} EOM
for index COMMA  word in enumerate PARELEFT sorted PARELEFT word_to_prob DOT keys PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT : EOM
self DOT _word_to_prob[]  EQUAL  word_to_prob[] EOM
self DOT _word_to_index[]  EQUAL  index EOM
def size PARELEFT  PARERIGHT : EOM
return len PARELEFT  PARERIGHT  EOM
def word_pos PARELEFT  PARERIGHT : EOM
return self DOT _word_to_index DOT get PARELEFT word DOT upper PARELEFT  PARERIGHT  PARERIGHT  EOM
def words PARELEFT  PARERIGHT : EOM
return self DOT _word_to_prob DOT keys PARELEFT  PARERIGHT  EOM
def sentiment_probability PARELEFT  PARERIGHT : EOM
return self DOT _word_to_prob DOT get PARELEFT word DOT upper PARELEFT  PARERIGHT  COMMA  0 DOT 0 PARERIGHT  EOM
def has_sentiment PARELEFT  PARERIGHT : EOM
return self DOT sentiment_probability PARELEFT  PARERIGHT  > 0 EOM
def __contains__ PARELEFT  PARERIGHT : EOM
return self DOT has_sentiment PARELEFT  PARERIGHT  EOM
class SimpleUnigramModel PARELEFT  PARERIGHT : EOM
model_name  EQUAL  EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT lexicon  EQUAL  RussianSentimentLexicon PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
return SimpleUnigramModel PARELEFT  PARERIGHT  EOM
def train PARELEFT  PARERIGHT : EOM
assert NotImplementedError PARELEFT  EOM
def get_features_number PARELEFT  PARERIGHT : EOM
return self DOT lexicon DOT size PARELEFT  PARERIGHT  EOM
def get_features PARELEFT  PARERIGHT : EOM
features  EQUAL  [] * self DOT get_features_number PARELEFT  PARERIGHT  EOM
for word in tweet DOT get_words PARELEFT  PARERIGHT : EOM
idx  EQUAL  self DOT lexicon DOT word_pos PARELEFT  PARERIGHT  EOM
if idx is not None: EOM
features[]  EQUAL  1 EOM
return featuresimport numpy as np EOM
from keras DOT callbacks import TensorBoard COMMA  ModelCheckpoint EOM
from keras DOT layers import Dense COMMA  LSTM COMMA  Merge EOM
from keras DOT models import Sequential COMMA  model_from_json EOM
from keras DOT optimizers import RMSprop EOM
import keras EOM
BATCH_SIZE  EQUAL  1000 EOM
import Formatter EOM
period_sample  EQUAL  Formatter DOT PeriodSample PARELEFT  PARERIGHT  EOM
INPUT_SIZE  EQUAL  24 EOM
def createModel PARELEFT  PARERIGHT : EOM
cost  EQUAL  RMSprop PARELEFT lr EQUAL  COMMA  rho EQUAL  COMMA  epsilon EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
EMA_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
EMA_lstm DOT add PARELEFT LSTM PARELEFT INPUT_SIZE COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA   batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
K_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
K_lstm DOT add PARELEFT LSTM PARELEFT INPUT_SIZE COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
D_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
D_lstm DOT add PARELEFT LSTM PARELEFT INPUT_SIZE COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
RSI_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
RSI_lstm DOT add PARELEFT LSTM PARELEFT INPUT_SIZE COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
OBV_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
OBV_lstm DOT add PARELEFT LSTM PARELEFT INPUT_SIZE COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
network_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
network_model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
network_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
network_model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
train_period COMMA target  EQUAL  getBatch PARELEFT  PARERIGHT  EOM
network_model DOT fit PARELEFT train_period COMMA  target COMMA batch_size EQUAL  COMMA  epochs EQUAL  COMMA  verbose EQUAL  COMMA  validation_split EQUAL  COMMA  shuffle EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
def getBatch PARELEFT  PARERIGHT : EOM
out  EQUAL  [] EOM
for i in range PARELEFT  PARERIGHT : EOM
data  EQUAL  period_sample DOT getIndicatorData PARELEFT  PARERIGHT  EOM
features  EQUAL  data[] EOM
features  EQUAL  np DOT transpose PARELEFT  PARERIGHT  EOM
output_bin  EQUAL  keras DOT utils DOT to_categorical PARELEFT data[] COMMA  num_classes EQUAL  PARERIGHT  EOM
out DOT append PARELEFT [] COMMA np DOT asarray PARELEFT  PARERIGHT  DOT reshape PARELEFT  PARERIGHT ] PARERIGHT  EOM
out  EQUAL  np DOT asarray PARELEFT  PARERIGHT  EOM
return out[] COMMA out[] EOM
def main PARELEFT  PARERIGHT : EOM
createModel PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import Callback EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
def on_batch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def neural_net PARELEFT num_sensors COMMA  params COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT rams[] COMMA  init EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if load: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def lstm_net PARELEFT num_sensors COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT tput_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelimport numpy as np EOM
def splitscalewindow PARELEFT df COMMA  t_steps EQUAL  COMMA  split EQUAL  PARERIGHT : EOM
X  EQUAL  np DOT array PARELEFT df DOT iloc[] DOT copy PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT df DOT iloc[] DOT copy PARELEFT  PARERIGHT  PARERIGHT  EOM
train_n  EQUAL  int PARELEFT len PARELEFT  PARERIGHT  * split PARERIGHT  EOM
import sys EOM
eps  EQUAL  sys DOT float_info DOT epsilon EOM
mu  EQUAL  X[] DOT mean PARELEFT axis EQUAL  PARERIGHT  EOM
st  EQUAL  X[] DOT std PARELEFT axis EQUAL  PARERIGHT  EOM
X - EQUAL  mu EOM
X  EQUAL   PARELEFT  PARERIGHT  /  PARELEFT  PARERIGHT  EOM
X_slices  EQUAL  [] EOM
y_slices  EQUAL  [] EOM
for i in range PARELEFT t_steps COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
X_slices DOT append PARELEFT  PARERIGHT  EOM
y_slices DOT append PARELEFT  PARERIGHT  EOM
X_slices  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_slices  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X_train  EQUAL  X_slices[] EOM
y_train  EQUAL  y_slices[] EOM
X_test  EQUAL  X_slices[] EOM
y_test  EQUAL  y_slices[] EOM
y_train  EQUAL  pd DOT get_dummies PARELEFT  PARERIGHT  EOM
y_test  EQUAL  pd DOT get_dummies PARELEFT  PARERIGHT  EOM
return PARELEFT  PARERIGHT  EOM
import itertools EOM
import pandas as pd EOM
import matplotlib DOT pyplot as plt EOM
def plot_confusion_matrix PARELEFT cm COMMA  classes COMMA normalize EQUAL  COMMA itle EQUAL  COMMA cmap EQUAL  PARERIGHT : EOM
cm  EQUAL  cm DOT astype PARELEFT  PARERIGHT  / cm DOT sum PARELEFT axis EQUAL  PARERIGHT [] EOM
else: EOM
pass EOM
plt DOT imshow PARELEFT cm COMMA  interpolation EQUAL  COMMA  cmap EQUAL  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT colorbar PARELEFT  PARERIGHT  EOM
tick_marks  EQUAL  np DOT arange PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT xticks PARELEFT tick_marks COMMA  classes COMMA  rotation EQUAL  PARERIGHT  EOM
plt DOT yticks PARELEFT  PARERIGHT  EOM
fmt  EQUAL   if normalize else EOM
thresh  EQUAL  cm DOT max PARELEFT  PARERIGHT  / 2 DOT  EOM
for i COMMA  j in itertools DOT product PARELEFT range PARELEFT  PARERIGHT  COMMA  range PARELEFT  PARERIGHT  PARERIGHT : EOM
plt DOT text PARELEFT j COMMA  i COMMA  format PARELEFT  PARERIGHT  COMMA horizontalalignment EQUAL  COMMA whiteblack EOM
plt DOT ylabel PARELEFT  PARERIGHT  EOM
plt DOT xlabel PARELEFT  PARERIGHT  EOM
plt DOT tight_layout PARELEFT  PARERIGHT  EOM
def applyPtSl PARELEFT  PARERIGHT : EOM
out  EQUAL  pd DOT DataFrame PARELEFT close DOT index + pd DOT Timedelta PARELEFT days EQUAL [] PARERIGHT  COMMA index EQUAL  COMMA columns EQUAL [] PARERIGHT  EOM
vol  EQUAL  close DOT pct_change PARELEFT  PARERIGHT  DOT ewm PARELEFT  PARERIGHT  DOT std PARELEFT  PARERIGHT  EOM
pt  EQUAL  ptSlTs[]*vol EOM
sl  EQUAL  -ptSlTs[]*vol EOM
for loc COMMA t1 in out[] DOT fillna PARELEFT  PARERIGHT  DOT iteritems PARELEFT  PARERIGHT : EOM
df0 EQUAL close DOT loc[] EOM
df0 EQUAL df0/df0 DOT loc[]-1 EOM
out DOT loc[] EQUAL df0[]] DOT dropna PARELEFT axis EQUAL  COMMA how EQUAL  PARERIGHT  DOT index DOT min PARELEFT  PARERIGHT  EOM
out DOT loc[] EQUAL df0[]] DOT dropna PARELEFT axis EQUAL  COMMA how EQUAL  PARERIGHT  DOT index DOT min PARELEFT  PARERIGHT  EOM
return PARELEFT out DOT idxmin PARELEFT axis EQUAL  PARERIGHT  PARERIGHT  EOM
def build_LSTM PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras import regularizers EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA turn_sequences  EQUAL  COMMA activation EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ut_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA turn_sequences  EQUAL  COMMA activation EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA turn_sequences  EQUAL  COMMA activation EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units  EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer  EQUAL  COMMA  loss  EQUAL  PARERIGHT  EOM
return PARELEFT  PARERIGHT  EOM
def class_report PARELEFT  PARERIGHT : EOM
from sklearn DOT metrics import classification_report EOM
y_preds  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
y_preds_flat  EQUAL  pd DOT DataFrame PARELEFT y_preds COMMA  columns EQUAL [] PARERIGHT  DOT idxmax PARELEFT  PARERIGHT  EOM
y_test_flat  EQUAL  pd DOT DataFrame PARELEFT y_test COMMA  columns EQUAL [] PARERIGHT  DOT idxmax PARELEFT  PARERIGHT  EOM
rep  EQUAL  classification_report PARELEFT  PARERIGHT  EOM
return PARELEFT  PARERIGHT  EOM
def getWeights_FFD PARELEFT  PARERIGHT : EOM
w COMMA k  EQUAL  [] COMMA 1 EOM
while True: EOM
w_  EQUAL  -w[]/k* PARELEFT  PARERIGHT  EOM
if abs PARELEFT  PARERIGHT <thres:break EOM
w DOT append PARELEFT  PARERIGHT  EOM
k+ EQUAL 1 EOM
w  EQUAL  np DOT array PARELEFT  PARERIGHT  DOT reshape PARELEFT  PARERIGHT  EOM
return PARELEFT  PARERIGHT  EOM
def fracDiff_FFD PARELEFT series COMMA d COMMA thres EQUAL  PARERIGHT : EOM
width  EQUAL  len PARELEFT  PARERIGHT -1 EOM
df  EQUAL  {} EOM
for name in series DOT columns: EOM
seriesF COMMA  df_  EQUAL  series[]] DOT fillna PARELEFT method EQUAL  PARERIGHT  DOT dropna PARELEFT  PARERIGHT  COMMA pd DOT Series PARELEFT  PARERIGHT  EOM
for iloc1 in range PARELEFT  PARERIGHT : EOM
loc0 COMMA  loc1 EQUAL seriesF DOT index[] COMMA  seriesF DOT index[] EOM
if not np DOT isfinite PARELEFT  PARERIGHT :continue EOM
df_[]  EQUAL  np DOT dot PARELEFT  PARERIGHT [] EOM
df[]  EQUAL df_ DOT copy PARELEFT deep EQUAL  PARERIGHT  EOM
df EQUAL pd DOT concat PARELEFT df COMMA axis EQUAL  PARERIGHT  EOM
return PARELEFT  PARERIGHT  EOM
def plotMinFFD PARELEFT  PARERIGHT : EOM
from statsmodels DOT tsa DOT stattools import adfuller EOM
import matplotlib DOT pyplot as plt EOM
import numpy as np EOM
df0  EQUAL  df DOT copy PARELEFT  PARERIGHT  EOM
out  EQUAL  pd DOT DataFrame PARELEFT columns EQUAL [] PARERIGHT  EOM
for d in np DOT linspace PARELEFT  PARERIGHT : EOM
df1  EQUAL  np DOT log PARELEFT  PARERIGHT  DOT resample PARELEFT  PARERIGHT  DOT last PARELEFT  PARERIGHT  EOM
df2 EQUAL fracDiff_FFD PARELEFT df1 COMMA d COMMA thres EQUAL  PARERIGHT  EOM
corr  EQUAL  np DOT corrcoef PARELEFT  PARERIGHT [] EOM
df2 EQUAL adfuller PARELEFT df2[] COMMA  maxlag EQUAL  COMMA regression EQUAL  COMMA autolag EQUAL  PARERIGHT  EOM
out DOT loc[] EQUAL list PARELEFT  PARERIGHT +[][]]+[] EOM
out[]] DOT plot PARELEFT secondary_y EQUAL  PARERIGHT  EOM
plt DOT axhline PARELEFT out[] DOT mean PARELEFT  PARERIGHT  COMMA linewidth EQUAL  COMMA color EQUAL  COMMA linestyle EQUAL  PARERIGHT  EOM
return EOM
def getbalclassweights PARELEFT  PARERIGHT : EOM
class_weights_bal  EQUAL  dict PARELEFT  PARELEFT 1/ PARELEFT y_train DOT sum PARELEFT  PARERIGHT /len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  DOT reset_index PARELEFT drop EQUAL  PARERIGHT  PARERIGHT  EOM
return PARELEFT  PARERIGHT  EOM
def build_CNNLSTM PARELEFT  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D EOM
from keras DOT layers import Dropout EOM
from keras import regularizers EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA ut_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA turn_sequences  EQUAL  COMMA activation EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT units  EQUAL  COMMA turn_sequences  EQUAL  COMMA activation EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units  EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer  EQUAL  COMMA  loss  EQUAL  PARERIGHT  EOM
return PARELEFT  PARERIGHT from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class nuRobotPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from utility DOT enums import Processor COMMA  RnnType EOM
def CreateModel PARELEFT  PARERIGHT : EOM
keras_impl  EQUAL  __getKerasImplementation PARELEFT  PARERIGHT  EOM
if PARELEFT args[]  EQUAL  PARERIGHT : EOM
else: EOM
if args[]  EQUAL  EQUAL  RnnType DOT LSTM : EOM
if args[]  EQUAL  EQUAL  Processor DOT GPU and args[]  EQUAL  EQUAL  True: EOM
return __createCUDNN_LSTM_Stateless PARELEFT  PARERIGHT  EOM
else: EOM
return __createLSTM_Stateless PARELEFT  PARERIGHT  EOM
elif args[]  EQUAL  EQUAL  RnnType DOT GRU: EOM
if args[]  EQUAL  EQUAL  Processor DOT GPU and args[]  EQUAL  EQUAL  True: EOM
return __createCUDNN_GRU_Stateless PARELEFT  PARERIGHT  EOM
else: EOM
return __createGRU_Stateless PARELEFT  PARERIGHT  EOM
elif args[]  EQUAL  EQUAL  RnnType DOT RNN: EOM
return __createRNN_Stateless PARELEFT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT  PARERIGHT  EOM
return model EOM
def CreateCallbacks PARELEFT  PARERIGHT : EOM
callbacks  EQUAL  [] EOM
keras_impl  EQUAL  __getKerasImplementation PARELEFT  PARERIGHT  EOM
callbacks DOT append PARELEFT keras_impl DOT callbacks DOT EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL [] PARERIGHT  PARERIGHT  EOM
if PARELEFT args[]  EQUAL  PARERIGHT : EOM
callbacks DOT append PARELEFT keras_impl DOT callbacks DOT ModelCheckpoint PARELEFT  DOT format PARELEFT  PARERIGHT  COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
if PARELEFT args[] ! EQUAL  PARERIGHT : EOM
callbacks DOT append PARELEFT keras_impl DOT callbacks DOT ReduceLROnPlateau PARELEFT monitor EQUAL  COMMA  factor EQUAL  COMMA  patience EQUAL [] COMMA  verbose EQUAL  COMMA  mode EQUAL  COMMA  min_delta EQUAL  COMMA  cooldown EQUAL  COMMA  min_lr EQUAL  PARERIGHT  PARERIGHT  EOM
callbacks DOT append PARELEFT keras_impl DOT callbacks DOT CSVLogger PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  True: EOM
callsbacks DOT append PARELEFT tensorboard_cb  EQUAL  PARELEFT log_dir EQUAL  COMMA  histogram_freq EQUAL  COMMA  write_graph EQUAL  COMMA  write_images EQUAL  PARERIGHT  PARERIGHT  EOM
if args[] is not None : EOM
callbacks DOT append PARELEFT  PARERIGHT  EOM
return callbacks EOM
def CreateOptimizer PARELEFT  PARERIGHT : EOM
if args[]  EQUAL  EQUAL  Processor DOT TPU: EOM
import tensorflow as tf EOM
return tf DOT contrib DOT opt DOT NadamOptimizer PARELEFT learning_rate EQUAL [] COMMA  beta1 EQUAL  COMMA  beta2 EQUAL  COMMA  epsilon EQUAL  PARERIGHT  EOM
else: EOM
return keras_impl DOT optimizers DOT Nadam PARELEFT lr EQUAL [] COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  COMMA  epsilon EQUAL  COMMA  schedule_decay EQUAL  COMMA  clipvalue EQUAL [] PARERIGHT  EOM
def __getKerasImplementation PARELEFT  PARERIGHT : EOM
if PARELEFT processor  EQUAL  PARERIGHT : EOM
import tensorflow EOM
from tensorflow DOT python import keras as keras_impl EOM
else: EOM
import keras as keras_impl EOM
return keras_impl EOM
def __createCUDNN_LSTM_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA  return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def __createLSTM_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def __createCUDNN_GRU_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def __createGRU_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def __createRNN_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelimport numpy as np EOM
import pandas as pd EOM
from keras DOT layers import Dense COMMA  Input COMMA  merge COMMA  LSTM COMMA  Dropout COMMA  Bidirectional COMMA  Embedding COMMA  Activation COMMA  Merge COMMA  Reshape COMMA  TimeDistributed EOM
from keras DOT models import Model COMMA Sequential EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT callbacks import EarlyStopping COMMA  ModelCheckpoint EOM
re_weight  EQUAL  True EOM
BASE_DIR  EQUAL  EOM
GLOVE_DIR  EQUAL  EOM
TRAIN_DATA_FILE  EQUAL  BASE_DIR + EOM
TEST_DATA_FILE  EQUAL  BASE_DIR + EOM
MAX_NB_WORDS  EQUAL  110000 EOM
EMBEDDING_DIM  EQUAL  300 EOM
VALIDATION_SPLIT  EQUAL  0 DOT 1 EOM
MAX_SEQUENCE_LENGTH  EQUAL  32 EOM
num_lstm  EQUAL  32 EOM
num_dense  EQUAL  64 EOM
rate_drop_lstm  EQUAL  0 DOT 10 + np DOT random DOT rand PARELEFT  PARERIGHT  * 0 DOT 05 EOM
rate_drop_dense  EQUAL  0 DOT 10 + np DOT random DOT rand PARELEFT  PARERIGHT  * 0 DOT 05 EOM
act  EQUAL  EOM
STAMP  EQUAL  % PARELEFT  PARERIGHT  EOM
shared_lstm  EQUAL  LSTM PARELEFT  PARERIGHT  EOM
x1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
x1 DOT add PARELEFT Embedding PARELEFT nb_words COMMA  EMBEDDING_DIM COMMA  weights EQUAL [] COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
x1 DOT add PARELEFT  PARERIGHT  EOM
x1 DOT build PARELEFT  PARERIGHT  EOM
y1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
y1 DOT add PARELEFT Embedding PARELEFT nb_words COMMA  EMBEDDING_DIM COMMA  weights EQUAL [] COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
y1 DOT add PARELEFT  PARERIGHT  EOM
y1 DOT build PARELEFT  PARERIGHT  EOM
merged_lstm  EQUAL  Merge PARELEFT [] COMMA mode EQUAL  PARERIGHT  EOM
z1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
z1 DOT add PARELEFT  PARERIGHT  EOM
z1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
z1 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
z1 DOT build PARELEFT  PARERIGHT  EOM
auxiliary_input  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
auxiliary_input DOT add PARELEFT Dense PARELEFT 128 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
auxiliary_input DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
auxiliary_input DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
auxiliary_input DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
auxiliary_input DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
auxiliary_input DOT build PARELEFT  PARERIGHT  EOM
merged  EQUAL  Merge PARELEFT [] COMMA mode EQUAL  PARERIGHT  EOM
model EQUAL Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_dense COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_dense COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
early_stopping  EQUAL EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL  PARERIGHT  EOM
bst_model_path  EQUAL  STAMP + EOM
model_checkpoint  EQUAL  ModelCheckpoint PARELEFT bst_model_path COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT [] COMMA  labels_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  COMMA  shuffle EQUAL  COMMA class_weight EQUAL  COMMA callbacks EQUAL [] PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
bst_val_score EQUAL min PARELEFT  PARERIGHT  EOM
preds  EQUAL  model DOT predict PARELEFT [] COMMA batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
preds + EQUAL  model DOT predict PARELEFT [] COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
preds / EQUAL  2 DOT 0 EOM
out_df  EQUAL  pd DOT DataFrame PARELEFT {:test_labels COMMA  :preds DOT ravel PARELEFT  PARERIGHT } PARERIGHT  EOM
out_df DOT to_csv PARELEFT % PARELEFT  PARERIGHT +STAMP+ COMMA  index EQUAL  PARERIGHT  EOM
del out_dffrom __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader1  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list1  EQUAL  list PARELEFT  PARERIGHT  EOM
testX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y1  EQUAL  testdata DOT iloc[] EOM
y_test1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
testX  EQUAL  sequence DOT pad_sequences PARELEFT testX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  2 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA nb_epoch EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  import numpy as np EOM
from keras DOT layers import LSTM EOM
from keras DOT models import Sequential EOM
from phased_lstm_keras DOT PhasedLSTM import PhasedLSTM EOM
def main PARELEFT  PARERIGHT : EOM
X  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
Y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT 10 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT summary PARELEFT  PARERIGHT  EOM
model_lstm DOT compile PARELEFT  PARERIGHT  EOM
model_plstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_plstm DOT add PARELEFT PhasedLSTM PARELEFT 10 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_plstm DOT summary PARELEFT  PARERIGHT  EOM
model_plstm DOT compile PARELEFT  PARERIGHT  EOM
model_lstm DOT fit PARELEFT  PARERIGHT  EOM
model_plstm DOT fit PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
main PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  LSTM EOM
from data_utils import * EOM
import numpy as np EOM
from sklearn DOT metrics import roc_curve EOM
from sklearn DOT metrics import auc EOM
import matplotlib DOT pyplot as plt EOM
X_test COMMA  Y_test  EQUAL  read_expanded_test_data_glove PARELEFT  PARERIGHT  EOM
max_len  EQUAL  100 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 100 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 6 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA   metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
Y_pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
names  EQUAL  [] EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
y_pred_keras  EQUAL  Y_pred[] EOM
fpr_keras COMMA  tpr_keras COMMA  thresholds_keras  EQUAL  roc_curve PARELEFT  PARERIGHT  EOM
auc_keras  EQUAL  auc PARELEFT  PARERIGHT  EOM
plt DOT figure PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  62 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import keras EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Input COMMA  Dropout COMMA  Activation EOM
from keras DOT datasets import mnist EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT optimizers import Adam EOM
from keras DOT callbacks import TensorBoard EOM
learning_rate  EQUAL  0 DOT 001 EOM
training_iters  EQUAL  3 EOM
batch_size  EQUAL  128 EOM
display_step  EQUAL  10 EOM
n_input  EQUAL  28 EOM
n_step  EQUAL  28 EOM
n_hidden  EQUAL  128 EOM
n_classes  EQUAL  10 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
x_train  EQUAL  x_train DOT reshape PARELEFT  PARERIGHT  EOM
x_test  EQUAL  x_test DOT reshape PARELEFT  PARERIGHT  EOM
x_train  EQUAL  x_train DOT astype PARELEFT  PARERIGHT  EOM
x_test  EQUAL  x_test DOT astype PARELEFT  PARERIGHT  EOM
x_train / EQUAL  255 EOM
x_test / EQUAL  255 EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT  PARERIGHT  EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT n_hidden COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  LSTM PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
X  EQUAL  Dense PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
predictions  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
adam  EQUAL  Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA   ss EQUAL  COMMA   trics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA   tch_size EQUAL  COMMA   ochs EQUAL  COMMA   rbose EQUAL  COMMA   alidation_data EQUAL  PARELEFT  PARERIGHT  COMMA llbacks EQUAL [] PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import tensorflow as tf EOM
from keras import optimizers EOM
from keras import losses EOM
from keras import metrics EOM
from keras import models EOM
from keras import layers EOM
from keras import callbacks EOM
from keras import regularizers EOM
from keras import initializers EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT models import Model EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import GRU EOM
from keras DOT layers import Masking EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Activation EOM
from keras DOT layers import Lambda EOM
from keras DOT layers import Bidirectional EOM
from keras DOT layers import BatchNormalization EOM
from keras DOT layers import Input EOM
from keras DOT constraints import max_norm EOM
def basic_dense_model PARELEFT  PARERIGHT : EOM
model  EQUAL  models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 16 COMMA  activation EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT 16 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_model_1_gen PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  activation EQUAL  COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_model_1 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  activation EQUAL  COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM_model_2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT Var DOT dropout COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_3_LSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT Var DOT dropout COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Bidirectional PARELEFT layers DOT LSTM PARELEFT Var DOT hidden_units COMMA  activation EQUAL  COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  EOM
model DOT add PARELEFT layers DOT Bidirectional PARELEFT layers DOT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced PARELEFT  PARERIGHT : EOM
maxnorm EQUAL 3 DOT  EOM
iniT EQUAL keras DOT initializers DOT RandomUniform PARELEFT  PARERIGHT  EOM
batch_size EQUAL X_train DOT shape[] EOM
n_frames EQUAL X_train DOT shape[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA                         kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  pout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA                         kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  opout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA                         kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ut EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3b_LSTM_advanced PARELEFT  PARERIGHT : EOM
maxnorm EQUAL 3 DOT  EOM
iniT EQUAL keras DOT initializers DOT RandomUniform PARELEFT  PARERIGHT  EOM
batch_size EQUAL X_train DOT shape[] EOM
n_frames EQUAL X_train DOT shape[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA Freturn_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA                         kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  pout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA                         kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  out EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced_seq PARELEFT  PARERIGHT : EOM
inp  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
maxnorm EQUAL 3 DOT  EOM
batch_size EQUAL X_train DOT shape[] EOM
n_frames EQUAL X_train DOT shape[] EOM
x EQUAL Masking PARELEFT mask_value EQUAL  PARERIGHT  PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x EQUAL Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARELEFT  PARERIGHT  EOM
x EQUAL Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x EQUAL Bidirectional PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x EQUAL Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
predictions EQUAL Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model EQUAL Model PARELEFT inputs EQUAL  COMMA  output EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_3_LSTM_advanced_no_bi PARELEFT  PARERIGHT : EOM
maxnorm EQUAL 3 DOT  EOM
batch_size EQUAL X_train DOT shape[] EOM
n_frames EQUAL X_train DOT shape[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_4_GRU PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA rnel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA rnel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_4_GRU_advanced PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Var DOT Dense_Unit COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT GRU PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA    kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT GRU PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT GRU PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  pout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT GRU PARELEFT Var DOT hidden_units COMMA  return_sequences EQUAL  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA ernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  ut EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def model_5_CNN PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT Var DOT hidden_units COMMA  activation EQUAL  COMMA strides EQUAL  COMMA  data_format EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT Var DOT hidden_units COMMA  activation EQUAL  COMMA strides EQUAL  COMMA  data_format EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA activity_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA nel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT Y_train DOT shape[] COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def LSTM_model_3_original PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 2 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT max_value EQUAL  PARERIGHT  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT 0 DOT 5 COMMA  noise_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT n_classes COMMA  activation EQUAL  COMMA  kernel_constraint EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
import time EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA  Merge EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
from keras DOT utils DOT visualize_util import plot COMMA  to_graph EOM
from keras DOT regularizers import l2 COMMA  activity_l2 EOM
import copy EOM
def design_model PARELEFT  PARERIGHT : EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT  EOM
return model_Combine EOM
def design_model_A PARELEFT  PARERIGHT : EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
reg  EQUAL  [] EOM
areg  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
nn_reg  EQUAL  [] EOM
nn_areg  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT  EOM
return model_Combine EOM
def design_model_nn PARELEFT  PARERIGHT : EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
nn_reg  EQUAL  [] EOM
nn_areg  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
graph  EQUAL  to_graph PARELEFT model_B COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT  EOM
return model_B EOM
def design_model_lstm PARELEFT  PARERIGHT : EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
reg  EQUAL  [] EOM
areg  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  COMMA  W_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA  activity_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
graph  EQUAL  to_graph PARELEFT model_A COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT  EOM
return model_Afrom tensorflow DOT keras DOT layers import LSTM COMMA  GRU EOM
from tensorflow DOT keras DOT models import Sequential EOM
def get_lstm PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT units[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_gru PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT GRU PARELEFT units[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def _get_sae PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT hidden COMMA  input_dim EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_saes PARELEFT  PARERIGHT : EOM
sae2  EQUAL  _get_sae PARELEFT  PARERIGHT  EOM
sae3  EQUAL  _get_sae PARELEFT  PARERIGHT  EOM
saes  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  input_dim EQUAL [] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
models  EQUAL  [] EOM
return modelsfrom keras DOT models import Sequential EOM
from keras DOT models import model_from_json EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA   Dropout COMMA  Reshape EOM
from keras DOT layers import Merge COMMA  Lambda EOM
from keras DOT layers DOT merge import _Merge EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT optimizers import Adam EOM
from keras DOT engine DOT topology import Layer EOM
from sklearn import preprocessing EOM
from sklearn DOT externals import joblib EOM
import numpy as np EOM
import spacy EOM
import tensorflow as tf EOM
config_proto  EQUAL  tf DOT ConfigProto PARELEFT  PARERIGHT  EOM
config_proto DOT gpu_options DOT allow_growth EQUAL True EOM
sess  EQUAL  tf DOT Session PARELEFT config EQUAL  PARERIGHT  EOM
img_dim  EQUAL  2048 EOM
word_vec_dim  EQUAL  300 EOM
max_len  EQUAL  50 EOM
import keras DOT backend as K EOM
_sketch_op  EQUAL  tf DOT load_op_library PARELEFT  PARERIGHT  EOM
class MCB PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT output_dim  EQUAL  output_dim EOM
self DOT img_dim  EQUAL  2048 EOM
self DOT word_vec_dim  EQUAL  300 EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
def build PARELEFT  PARERIGHT : EOM
h  EQUAL  self DOT add_weight PARELEFT shape  EQUAL  PARELEFT  PARERIGHT  COMMA  initializer  EQUAL  PARELEFT  PARERIGHT  COMMA  trainable  EQUAL  PARERIGHT  EOM
self DOT h1  EQUAL  tf DOT cast PARELEFT  PARERIGHT  EOM
h  EQUAL  self DOT add_weight PARELEFT shape  EQUAL  PARELEFT  PARERIGHT  COMMA  initializer  EQUAL  PARELEFT  PARERIGHT  COMMA  trainable  EQUAL  PARERIGHT  EOM
self DOT h2  EQUAL  tf DOT cast PARELEFT  PARERIGHT  EOM
s  EQUAL  self DOT add_weight PARELEFT shape  EQUAL  PARELEFT  PARERIGHT  COMMA  initializer  EQUAL  PARELEFT  PARERIGHT  COMMA  trainable  EQUAL  PARERIGHT  EOM
s  EQUAL  self DOT add_weight PARELEFT shape  EQUAL  PARELEFT  PARERIGHT  COMMA  initializer  EQUAL  PARELEFT  PARERIGHT  COMMA  trainable  EQUAL  PARERIGHT  EOM
super PARELEFT  PARERIGHT  DOT build PARELEFT  PARERIGHT  EOM
def count_sketch PARELEFT  PARERIGHT : EOM
with tf DOT variable_scope PARELEFT +probs DOT name DOT replace PARELEFT  PARERIGHT  PARERIGHT  as scope: EOM
input_size  EQUAL  int PARELEFT probs DOT get_shape PARELEFT  PARERIGHT [] PARERIGHT  EOM
history  EQUAL  tf DOT get_collection PARELEFT  PARERIGHT  EOM
if scope DOT name in history: EOM
scope DOT reuse_variables PARELEFT  PARERIGHT  EOM
tf DOT add_to_collection PARELEFT  PARERIGHT  EOM
sk  EQUAL  _sketch_op DOT count_sketch PARELEFT  PARERIGHT  EOM
sk DOT set_shape PARELEFT [] COMMA  project_size] PARERIGHT  EOM
return sk EOM
def call PARELEFT  PARERIGHT : EOM
p1  EQUAL  self DOT count_sketch PARELEFT  PARERIGHT  EOM
p2  EQUAL  self DOT count_sketch PARELEFT  PARERIGHT  EOM
pc1  EQUAL  tf DOT complex PARELEFT p1 COMMA  tf DOT zeros_like PARELEFT  PARERIGHT  PARERIGHT  EOM
pc2  EQUAL  tf DOT complex PARELEFT p2 COMMA  tf DOT zeros_like PARELEFT  PARERIGHT  PARERIGHT  EOM
conved  EQUAL  tf DOT ifft PARELEFT tf DOT fft PARELEFT  PARERIGHT  * tf DOT fft PARELEFT  PARERIGHT  PARERIGHT  EOM
return tf DOT real PARELEFT  PARERIGHT  EOM
def compute_output_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT  PARERIGHT  EOM
class BOW_QI: EOM
def __init__ PARELEFT self COMMA  joint_method  EQUAL  COMMA  lr  EQUAL  PARERIGHT : EOM
self DOT joint_method  EQUAL  joint_method EOM
self DOT lr  EQUAL  lr EOM
self DOT name  EQUAL   + self DOT joint_method + str PARELEFT  PARERIGHT  EOM
def build PARELEFT self COMMA  num_classes COMMA  num_hiddens  EQUAL  COMMA  num_layers  EQUAL  COMMA  dropout  EQUAL  COMMA  activation  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if self DOT joint_method  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  input_dim EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT joint_method  EQUAL  EQUAL  : EOM
model DOT add PARELEFT MCB PARELEFT output_dim  EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT joint_method  EQUAL  EQUAL  : EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  input_dim EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
language_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
language_model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  input_dim EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
json_string  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
open PARELEFT  PARERIGHT  DOT write PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr  EQUAL  PARERIGHT  COMMA  metrics  EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
def extract_question_feature PARELEFT  PARERIGHT : EOM
return nlp PARELEFT  PARERIGHT  DOT vector*len PARELEFT nlp PARELEFT  PARERIGHT  PARERIGHT  EOM
def train_on_batch PARELEFT  PARERIGHT : EOM
if self DOT joint_method ! EQUAL   : EOM
return self DOT model DOT train_on_batch PARELEFT np DOT hstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  A PARERIGHT  EOM
else: EOM
return self DOT model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def save_weights PARELEFT  PARERIGHT : EOM
self DOT model DOT save_weights PARELEFT  PARERIGHT  EOM
def load PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  model_from_json PARELEFT open PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT load_weights PARELEFT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr  EQUAL  PARERIGHT  COMMA  metrics  EQUAL [] PARERIGHT  EOM
def predict PARELEFT  PARERIGHT : EOM
if self DOT joint_method ! EQUAL   : EOM
return self DOT model DOT predict_classes PARELEFT np DOT hstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  verbose EQUAL  PARERIGHT  EOM
else: EOM
return self DOT model DOT predict_classes PARELEFT [] COMMA  verbose EQUAL  PARERIGHT  EOM
class LSTM_QI: EOM
def __init__ PARELEFT self COMMA  joint_method  EQUAL  COMMA  lr  EQUAL  PARERIGHT : EOM
self DOT joint_method  EQUAL  joint_method EOM
self DOT lr  EQUAL  lr EOM
self DOT name  EQUAL   + self DOT joint_method + str PARELEFT  PARERIGHT  EOM
def build PARELEFT self COMMA  num_classes COMMA  num_layers_lstm  EQUAL  COMMA  num_hiddens_lstm  EQUAL  COMMA   EQUAL  COMMA  num_layers  EQUAL  COMMA  dropout  EQUAL  COMMA  activation  EQUAL  PARERIGHT : EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  input_dim EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
language_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if num_layers_lstm  EQUAL  EQUAL  1: EOM
language_model DOT add PARELEFT LSTM PARELEFT output_dim  EQUAL  COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
language_model DOT add PARELEFT LSTM PARELEFT output_dim  EQUAL  COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
language_model DOT add PARELEFT LSTM PARELEFT output_dim  EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT LSTM PARELEFT output_dim  EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if self DOT joint_method  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
elif self DOT joint_method  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MCB PARELEFT output_dim  EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
elif self DOT joint_method  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT num_hiddens COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
json_string  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
open PARELEFT  PARERIGHT  DOT write PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr  EQUAL  PARERIGHT  COMMA  metrics  EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
def extract_question_feature PARELEFT  PARERIGHT : EOM
X  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
tokens  EQUAL  nlp PARELEFT  PARERIGHT  EOM
for i COMMA  token in enumerate PARELEFT  PARERIGHT : EOM
if i > EQUAL  max_len: EOM
break EOM
x[]  EQUAL  tokens[] DOT vector EOM
return x EOM
def train_on_batch PARELEFT  PARERIGHT : EOM
return self DOT model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def save_weights PARELEFT  PARERIGHT : EOM
self DOT model DOT save_weights PARELEFT  PARERIGHT  EOM
def load PARELEFT self COMMA  suffix  EQUAL  PARERIGHT : EOM
self DOT model  EQUAL  model_from_json PARELEFT open PARELEFT  PARERIGHT  DOT read PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model DOT load_weights PARELEFT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr  EQUAL  PARERIGHT  COMMA  metrics  EQUAL [] PARERIGHT  EOM
def predict PARELEFT  PARERIGHT : EOM
return self DOT model DOT predict_classes PARELEFT [] COMMA  verbose EQUAL  PARERIGHT import pandas as pd EOM
import numpy as np EOM
from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
f EQUAL open PARELEFT  COMMA  COMMA encoding  EQUAL  PARERIGHT  EOM
ftest EQUAL open PARELEFT  COMMA  COMMA encoding  EQUAL  PARERIGHT  EOM
lines EQUAL f DOT readlines PARELEFT  PARERIGHT  EOM
lines_test EQUAL ftest DOT readlines PARELEFT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA len PARELEFT  PARERIGHT  PARERIGHT : EOM
lines[] EQUAL lines[] DOT split PARELEFT  PARERIGHT  EOM
for j in range PARELEFT 0 COMMA len PARELEFT  PARERIGHT  PARERIGHT : EOM
s EQUAL [] ! EQUAL   ] EOM
dftest EQUAL pd DOT DataFrame PARELEFT  PARERIGHT  EOM
y_train EQUAL df DOT iloc[] EOM
test_txt EQUAL dftest DOT iloc[] EOM
y_test EQUAL dftest DOT iloc[] EOM
token  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
token DOT fit_on_texts PARELEFT  PARERIGHT  EOM
A EQUAL token DOT word_index EOM
x_train_seq  EQUAL  token DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
x_test_seq  EQUAL  token DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train_seq COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test_seq COMMA  maxlen EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA Dropout COMMA Activation COMMA Flatten EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import SimpleRNN EOM
modelRNN DOT add PARELEFT SimpleRNN PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
modelRNN DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
modelRNN DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
modelRNN DOT summary PARELEFT  PARERIGHT  EOM
modelRNN DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
train_history1_1  EQUAL  modelRNN DOT fit PARELEFT x_train COMMA y_train COMMA  pochs EQUAL  COMMA  batch_size EQUAL  COMMA verbose EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
scores1_1  EQUAL  modelRNN DOT evaluate PARELEFT x_test COMMA  y_test COMMA verbose EQUAL  PARERIGHT  EOM
train_history1_1 DOT history DOT values PARELEFT  PARERIGHT  EOM
modelRNN1 DOT add PARELEFT SimpleRNN PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
modelRNN1 DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
modelRNN1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
modelRNN1 DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
modelRNN1 DOT summary PARELEFT  PARERIGHT  EOM
modelRNN1 DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
train_history1_2  EQUAL  modelRNN1 DOT fit PARELEFT x_train COMMA y_train COMMA  pochs EQUAL  COMMA  batch_size EQUAL  COMMA verbose EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
scores1_2  EQUAL  modelRNN1 DOT evaluate PARELEFT x_test COMMA  y_test COMMA verbose EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA Dropout COMMA Activation COMMA Flatten EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import History EOM
history  EQUAL  History PARELEFT  PARERIGHT  EOM
modelLSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelLSTM DOT add PARELEFT Embedding  PARELEFT output_dim EQUAL  COMMA input_dim EQUAL  COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM  DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM  DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM  DOT summary PARELEFT  PARERIGHT  EOM
modelLSTM DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
train_history2_1  EQUAL  modelLSTM DOT fit PARELEFT x_train COMMA y_train COMMA  pochs EQUAL  COMMA  batch_size EQUAL  COMMA verbose EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
scores2_1  EQUAL  modelLSTM  DOT evaluate PARELEFT x_test COMMA  y_test COMMA verbose EQUAL  PARERIGHT  EOM
modelLSTM1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelLSTM1 DOT add PARELEFT Embedding  PARELEFT output_dim EQUAL  COMMA input_dim EQUAL  COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM1 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM1  DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM1  DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM1  DOT summary PARELEFT  PARERIGHT  EOM
modelLSTM1 DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
train_history2_2  EQUAL  modelLSTM1 DOT fit PARELEFT x_train COMMA y_train COMMA  pochs EQUAL  COMMA  batch_size EQUAL  COMMA verbose EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
scores2_2  EQUAL  modelLSTM1  DOT evaluate PARELEFT x_test COMMA  y_test COMMA verbose EQUAL  PARERIGHT  EOM
train_history1_1 DOT history DOT values PARELEFT  PARERIGHT  EOM
train_history1_1 DOT history DOT keys PARELEFT  PARERIGHT  EOM
train_history1_1 DOT history[] EOM
train_history2_1 DOT history DOT values PARELEFT  PARERIGHT  EOM
train_history2_2 DOT history DOT values PARELEFT  PARERIGHT  EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
graphpath EQUAL  EOM
x  EQUAL  list PARELEFT range PARELEFT  PARERIGHT  PARERIGHT  EOM
y1  EQUAL  train_history1_1 DOT history[] EOM
y2  EQUAL  train_history1_1 DOT history[] EOM
y  EQUAL  np DOT column_stack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT figure PARELEFT  PARERIGHT  EOM
plt DOT clf PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT xlabel PARELEFT  PARERIGHT  EOM
plt DOT ylabel PARELEFT  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT savefig PARELEFT  PARERIGHT  EOM
x  EQUAL  list PARELEFT range PARELEFT  PARERIGHT  PARERIGHT  EOM
lines[] EOM
a EQUAL lines[] DOT split PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
 EQUAL lines[] DOT split PARELEFT  PARERIGHT  EOM
big EQUAL lines DOT split PARELEFT  PARERIGHT  EOM
a EQUAL [] EOM
for line in f: EOM
a DOT append PARELEFT  PARERIGHT  EOM
for EOM
for i in rane EOM
for i in lines: EOM
a DOT append PARELEFT  PARERIGHT  EOM
A EQUAL [] EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import SGD EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from keras DOT utils DOT visualize_util import model_to_dot EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Activation EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Merge EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Convolution2D EOM
from keras DOT layers import MaxPooling2D EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import GRU EOM
from keras DOT layers import RepeatVector EOM
from keras DOT layers import TimeDistributed EOM
def model_binary PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT data COMMA  labels COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
return model EOM
def model_multiple PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
return model EOM
def model_merged PARELEFT  PARERIGHT : EOM
left_branch  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
left_branch DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
right_branch  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
right_branch DOT add PARELEFT Dense PARELEFT 32 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
merged  EQUAL  Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
data_left  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
data_right  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
labels  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA  labels COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
return model EOM
def model_mlp PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  input_dim EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def model_vggnet PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  3 COMMA  border_mode EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 64 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
return model EOM
def model_image_caption PARELEFT  PARERIGHT : EOM
max_caption_len  EQUAL  16 EOM
vocab_size  EQUAL  10000 EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Convolution2D PARELEFT  3 COMMA  border_mode EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Convolution2D PARELEFT 64 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Convolution2D PARELEFT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
language_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
language_model DOT add PARELEFT bedding PARELEFT vocab_size COMMA  256 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT GRU PARELEFT output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
language_model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
image_model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT age_model COMMA  language_model] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
return model EOM
def model_lstm PARELEFT  PARERIGHT : EOM
max_len  EQUAL  10 EOM
max_features  EQUAL  10000 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  256 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT utput_dim EQUAL  COMMA  activation EQUAL  COMMA inner_activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def model_lstm_stacked PARELEFT  PARERIGHT : EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
nb_classes  EQUAL  10 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
train_data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_labels  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
val_data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
val_labels  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT in_data COMMA  train_labels COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_lstm_stateful PARELEFT  PARERIGHT : EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
nb_classes  EQUAL  10 EOM
batch_size  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
train_data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_labels  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
val_data  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
val_labels  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT in_data COMMA  train_labels COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def model_lstm_merged PARELEFT  PARERIGHT : EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
nb_classes  EQUAL  10 EOM
encoder_left  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
encoder_left DOT add PARELEFT LSTM PARELEFT 32 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
encoder_right  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
encoder_right DOT add PARELEFT LSTM PARELEFT 32 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
train_data_left  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_data_right  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
train_labels  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
val_data_left  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
val_data_right  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
val_labels  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT rain_data_left COMMA  train_data_right] COMMA  train_labels COMMA atch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA lidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def viz_model PARELEFT  PARERIGHT : EOM
dot  EQUAL  model_to_dot PARELEFT model COMMA  show_shapes EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
dot DOT write_pdf PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
model  EQUAL  model_binary PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_multiple PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_merged PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_mlp PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_vggnet PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_image_caption PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_lstm PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_lstm_stacked PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_lstm_stateful PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT  EOM
model  EQUAL  model_lstm_merged PARELEFT  PARERIGHT  EOM
viz_model PARELEFT  PARERIGHT from __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
import numpy as np EOM
import pandas as pd EOM
from process import get_price_inputs COMMA  Trainer EOM
from lambo DOT transformations import range_deviation_ema EOM
from lstm_categorical_rgd import LSTMTrainer COMMA  INPUT_DIM EOM
from common import training_files COMMA  test_files EOM
import copy EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
from keras DOT models import load_model EOM
labels  EQUAL  [] EOM
EPOCHS_ARR  EQUAL  range PARELEFT  PARERIGHT  EOM
BATCH_SIZE  EQUAL  128 EOM
ofile  EQUAL  open PARELEFT  PARERIGHT  EOM
for EPOCHS in EPOCHS_ARR: EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
trainer  EQUAL  LSTMTrainer PARELEFT  PARERIGHT  EOM
trainer DOT train PARELEFT training_files COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
score COMMA  acc  EQUAL  trainer DOT evaluate PARELEFT  PARERIGHT  EOM
ofile DOT write PARELEFT % PARELEFT  PARERIGHT  PARERIGHT  EOM
ofile DOT flush PARELEFT  PARERIGHT  EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  Dropout EOM
from keras import backend as K EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT SimpleRNN PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
LSTM_history  EQUAL  LSTM_model DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense COMMA  Embedding EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  54 EOM
word_feature_size  EQUAL  300 EOM
nb_classes  EQUAL  430 EOM
def model PARELEFT  PARERIGHT : EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model_image DOT add PARELEFT Dense PARELEFT 4096 COMMA  activation  EQUAL  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D EOM
from keras DOT layers import MaxPooling1D EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import Dropout EOM
from keras DOT models import load_model EOM
from keras DOT utils import plot_model EOM
from prepare_data import PrepareData as prep_data EOM
class Models: EOM
def __init__ PARELEFT self COMMA  train_X COMMA  train_y COMMA  test_X COMMA  test_y COMMA  model EQUAL  PARERIGHT : EOM
if model  EQUAL  EQUAL  : EOM
self DOT lstm_model PARELEFT  PARERIGHT  EOM
if model  EQUAL  EQUAL  : EOM
self DOT cnn_model PARELEFT  PARERIGHT  EOM
def get_history PARELEFT  PARERIGHT : EOM
return self DOT history EOM
def lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA ctivation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
def cnn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 32 COMMA  kernel_size EQUAL  COMMA  strides EQUAL  COMMA  activation EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1000 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 7 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT train_X COMMA  train_y COMMA  epochs EQUAL  COMMA lidation_data EQUAL  PARELEFT  PARERIGHT  COMMA  batch_size EQUAL  COMMA erbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
self DOT history  EQUAL  history EOM
model DOT save PARELEFT  PARERIGHT  EOM
import os EOM
import re EOM
import tarfile EOM
import requests EOM
from pugnlp DOT futil import path_status COMMA  find_files EOM
BIG_URLS  EQUAL  {:  PARELEFT  PARERIGHT  COMMA :  PARELEFT  PARERIGHT  COMMA :  PARELEFT  PARERIGHT  COMMA :  PARELEFT  PARERIGHT  COMMA :  PARELEFT  PARERIGHT  COMMA } EOM
def dropbox_basename PARELEFT  PARERIGHT : EOM
filename  EQUAL  os DOT path DOT basename PARELEFT  PARERIGHT  EOM
match  EQUAL  re DOT findall PARELEFT  PARERIGHT  EOM
if match: EOM
return filename[] EOM
return filename EOM
def download_file PARELEFT url COMMA  data_path EQUAL  COMMA  filename EQUAL  COMMA  size EQUAL  COMMA  chunk_size EQUAL  COMMA  verbose EQUAL  PARERIGHT : EOM
if filename is None: EOM
filename  EQUAL  dropbox_basename PARELEFT  PARERIGHT  EOM
file_path  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
if url DOT endswith PARELEFT  PARERIGHT : EOM
if verbose: EOM
tqdm_prog  EQUAL  tqdm EOM
else: EOM
tqdm_prog  EQUAL  no_tqdm EOM
r  EQUAL  requests DOT get PARELEFT url COMMA  stream EQUAL  COMMA  allow_redirects EQUAL  COMMA  timeout EQUAL  PARERIGHT  EOM
size  EQUAL  r DOT headers DOT get PARELEFT  PARERIGHT  if size is None else size EOM
stat  EQUAL  path_status PARELEFT  PARERIGHT  EOM
r DOT close PARELEFT  PARERIGHT  EOM
return file_path EOM
with open PARELEFT  PARERIGHT  as f: EOM
for chunk in r DOT iter_content PARELEFT chunk_size EQUAL  PARERIGHT : EOM
f DOT write PARELEFT  PARERIGHT  EOM
r DOT close PARELEFT  PARERIGHT  EOM
return file_path EOM
def untar PARELEFT  PARERIGHT : EOM
if fname DOT endswith PARELEFT  PARERIGHT : EOM
with tarfile DOT open PARELEFT  PARERIGHT  as tf: EOM
tf DOT extractall PARELEFT  PARERIGHT  EOM
else: EOM
maxlen  EQUAL  400 EOM
batch_size  EQUAL  32 EOM
embedding_dims  EQUAL  300 EOM
epochs  EQUAL  2 EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten COMMA  LSTM EOM
num_neurons  EQUAL  50 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_neurons COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
import glob EOM
import os EOM
from random import shuffle EOM
def pre_process_data PARELEFT  PARERIGHT : EOM
negative_path  EQUAL  os DOT path DOT join PARELEFT  PARERIGHT  EOM
pos_label  EQUAL  1 EOM
neg_label  EQUAL  0 EOM
dataset  EQUAL  [] EOM
for filename in glob DOT glob PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT : EOM
with open PARELEFT  PARERIGHT  as f: EOM
dataset DOT append PARELEFT  PARELEFT pos_label COMMA  f DOT read PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for filename in glob DOT glob PARELEFT os DOT path DOT join PARELEFT  PARERIGHT  PARERIGHT : EOM
with open PARELEFT  PARERIGHT  as f: EOM
dataset DOT append PARELEFT  PARELEFT neg_label COMMA  f DOT read PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
shuffle PARELEFT  PARERIGHT  EOM
return dataset EOM
from nltk DOT tokenize import TreebankWordTokenizer EOM
from gensim DOT models import KeyedVectors EOM
word_vectors  EQUAL  KeyedVectors DOT load_word2vec_format PARELEFT  COMMA  binary EQUAL  COMMA  limit EQUAL  PARERIGHT  EOM
def tokenize_and_vectorize PARELEFT  PARERIGHT : EOM
tokenizer  EQUAL  TreebankWordTokenizer PARELEFT  PARERIGHT  EOM
vectorized_data  EQUAL  [] EOM
expected  EQUAL  [] EOM
for sample in dataset: EOM
tokens  EQUAL  tokenizer DOT tokenize PARELEFT  PARERIGHT  EOM
sample_vecs  EQUAL  [] EOM
for token in tokens: EOM
try: EOM
sample_vecs DOT append PARELEFT  PARERIGHT  EOM
except KeyError: EOM
vectorized_data DOT append PARELEFT  PARERIGHT  EOM
return vectorized_data EOM
def collect_expected PARELEFT  PARERIGHT : EOM
expected  EQUAL  [] EOM
for sample in dataset: EOM
expected DOT append PARELEFT  PARERIGHT  EOM
return expected EOM
def pad_trunc PARELEFT  PARERIGHT : EOM
new_data  EQUAL  [] EOM
zero_vector  EQUAL  [] EOM
for _ in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
zero_vector DOT append PARELEFT  PARERIGHT  EOM
for sample in data: EOM
if len PARELEFT  PARERIGHT  > maxlen: EOM
temp  EQUAL  sample[] EOM
elif len PARELEFT  PARERIGHT  < maxlen: EOM
temp  EQUAL  sample EOM
additional_elems  EQUAL  maxlen - len PARELEFT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
temp DOT append PARELEFT  PARERIGHT  EOM
else: EOM
temp  EQUAL  sample EOM
new_data DOT append PARELEFT  PARERIGHT  EOM
return new_data EOM
import numpy as np EOM
dataset  EQUAL  pre_process_data PARELEFT  PARERIGHT  EOM
vectorized_data  EQUAL  tokenize_and_vectorize PARELEFT  PARERIGHT  EOM
expected  EQUAL  collect_expected PARELEFT  PARERIGHT  EOM
split_point  EQUAL  int PARELEFT len PARELEFT  PARERIGHT  *  DOT 8 PARERIGHT  EOM
x_train  EQUAL  vectorized_data[] EOM
y_train  EQUAL  expected[] EOM
x_test  EQUAL  vectorized_data[] EOM
y_test  EQUAL  expected[] EOM
maxlen  EQUAL  400 EOM
epochs  EQUAL  2 EOM
x_train  EQUAL  pad_trunc PARELEFT  PARERIGHT  EOM
x_test  EQUAL  pad_trunc PARELEFT  PARERIGHT  EOM
x_train  EQUAL  np DOT reshape PARELEFT x_train COMMA   PARELEFT len PARELEFT  PARERIGHT  COMMA  maxlen COMMA  embedding_dims PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
x_test  EQUAL  np DOT reshape PARELEFT x_test COMMA   PARELEFT len PARELEFT  PARERIGHT  COMMA  maxlen COMMA  embedding_dims PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten COMMA  LSTM EOM
num_neurons  EQUAL  50 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_neurons COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model_structure  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
from keras DOT models import model_from_json EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_string  EQUAL  json_file DOT read PARELEFT  PARERIGHT  EOM
model  EQUAL  model_from_json PARELEFT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
sample_1  EQUAL  EOM
vec_list  EQUAL  tokenize_and_vectorize PARELEFT [] PARERIGHT  EOM
test_vec_list  EQUAL  pad_trunc PARELEFT  PARERIGHT  EOM
test_vec  EQUAL  np DOT reshape PARELEFT test_vec_list COMMA   PARELEFT len PARELEFT  PARERIGHT  COMMA  maxlen COMMA  embedding_dims PARERIGHT  PARERIGHT  EOM
def test_len PARELEFT  PARERIGHT : EOM
total_len  EQUAL  truncated  EQUAL  exact  EQUAL  padded  EQUAL  0 EOM
for sample in data: EOM
total_len + EQUAL  len PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT  > maxlen: EOM
truncated + EQUAL  1 EOM
elif len PARELEFT  PARERIGHT  < maxlen: EOM
padded + EQUAL  1 EOM
else: EOM
exact + EQUAL  1 EOM
dataset  EQUAL  pre_process_data PARELEFT  PARERIGHT  EOM
vectorized_data  EQUAL  tokenize_and_vectorize PARELEFT  PARERIGHT  EOM
test_len PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten COMMA  LSTM EOM
maxlen  EQUAL  200 EOM
epochs  EQUAL  2 EOM
dataset  EQUAL  pre_process_data PARELEFT  PARERIGHT  EOM
vectorized_data  EQUAL  tokenize_and_vectorize PARELEFT  PARERIGHT  EOM
expected  EQUAL  collect_expected PARELEFT  PARERIGHT  EOM
split_point  EQUAL  int PARELEFT len PARELEFT  PARERIGHT  *  DOT 8 PARERIGHT  EOM
x_train  EQUAL  vectorized_data[] EOM
y_train  EQUAL  expected[] EOM
x_test  EQUAL  vectorized_data[] EOM
y_test  EQUAL  expected[] EOM
x_train  EQUAL  pad_trunc PARELEFT  PARERIGHT  EOM
x_test  EQUAL  pad_trunc PARELEFT  PARERIGHT  EOM
x_train  EQUAL  np DOT reshape PARELEFT x_train COMMA   PARELEFT len PARELEFT  PARERIGHT  COMMA  maxlen COMMA  embedding_dims PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
x_test  EQUAL  np DOT reshape PARELEFT x_test COMMA   PARELEFT len PARELEFT  PARERIGHT  COMMA  maxlen COMMA  embedding_dims PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
num_neurons  EQUAL  50 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_neurons COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model_structure  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
dataset  EQUAL  pre_process_data PARELEFT  PARERIGHT  EOM
expected  EQUAL  collect_expected PARELEFT  PARERIGHT  EOM
def avg_len PARELEFT  PARERIGHT : EOM
total_len  EQUAL  0 EOM
for sample in data: EOM
total_len + EQUAL  len PARELEFT  PARERIGHT  EOM
def clean_data PARELEFT  PARERIGHT : EOM
new_data  EQUAL  [] EOM
VALID  EQUAL  EOM
for sample in data: EOM
new_sample  EQUAL  [] EOM
if char in VALID: EOM
new_sample DOT append PARELEFT  PARERIGHT  EOM
else: EOM
new_sample DOT append PARELEFT  PARERIGHT  EOM
new_data DOT append PARELEFT  PARERIGHT  EOM
return new_data EOM
listified_data  EQUAL  clean_data PARELEFT  PARERIGHT  EOM
def char_pad_trunc PARELEFT  PARERIGHT : EOM
new_dataset  EQUAL  [] EOM
for sample in data: EOM
if len PARELEFT  PARERIGHT  > maxlen: EOM
new_data  EQUAL  sample[] EOM
elif len PARELEFT  PARERIGHT  < maxlen: EOM
pads  EQUAL  maxlen - len PARELEFT  PARERIGHT  EOM
new_data  EQUAL  sample + [] * pads EOM
else: EOM
new_data  EQUAL  sample EOM
new_dataset DOT append PARELEFT  PARERIGHT  EOM
return new_dataset EOM
maxlen  EQUAL  1500 EOM
def create_dicts PARELEFT  PARERIGHT : EOM
chars  EQUAL  set PARELEFT  PARERIGHT  EOM
for sample in data: EOM
chars DOT update PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  EOM
char_indices  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
indices_char  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
return char_indices COMMA  indices_char EOM
import numpy as np EOM
def onehot_encode PARELEFT  PARERIGHT : EOM
for i COMMA  sentence in enumerate PARELEFT  PARERIGHT : EOM
for t COMMA  char in enumerate PARELEFT  PARERIGHT : EOM
X[]]  EQUAL  1 EOM
return X EOM
dataset  EQUAL  pre_process_data PARELEFT  PARERIGHT  EOM
expected  EQUAL  collect_expected PARELEFT  PARERIGHT  EOM
listified_data  EQUAL  clean_data PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  1500 EOM
common_length_data  EQUAL  char_pad_trunc PARELEFT  PARERIGHT  EOM
char_indices COMMA  indices_char  EQUAL  create_dicts PARELEFT  PARERIGHT  EOM
encoded_data  EQUAL  onehot_encode PARELEFT  PARERIGHT  EOM
split_point  EQUAL  int PARELEFT len PARELEFT  PARERIGHT  *  DOT 8 PARERIGHT  EOM
x_train  EQUAL  encoded_data[] EOM
y_train  EQUAL  expected[] EOM
x_test  EQUAL  encoded_data[] EOM
y_test  EQUAL  expected[] EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Embedding COMMA  Flatten COMMA  LSTM EOM
num_neurons  EQUAL  40 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_neurons COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT maxlen COMMA  len PARELEFT char_indices DOT keys PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
batch_size  EQUAL  32 EOM
epochs  EQUAL  10 EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model_structure  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
from nltk DOT corpus import gutenberg EOM
text  EQUAL  EOM
for txt in gutenberg DOT fileids PARELEFT  PARERIGHT : EOM
if  in txt: EOM
text + EQUAL  gutenberg DOT raw PARELEFT  PARERIGHT  DOT lower PARELEFT  PARERIGHT  EOM
chars  EQUAL  sorted PARELEFT list PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
char_indices  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
indices_char  EQUAL  dict PARELEFT  PARELEFT  PARERIGHT  for i COMMA  c in enumerate PARELEFT  PARERIGHT  PARERIGHT  EOM
maxlen  EQUAL  40 EOM
step  EQUAL  3 EOM
sentences  EQUAL  [] EOM
next_chars  EQUAL  [] EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - maxlen COMMA  step PARERIGHT : EOM
sentences DOT append PARELEFT  PARERIGHT  EOM
next_chars DOT append PARELEFT  PARERIGHT  EOM
X  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  maxlen COMMA  len PARELEFT  PARERIGHT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
y  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  len PARELEFT  PARERIGHT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
for i COMMA  sentence in enumerate PARELEFT  PARERIGHT : EOM
for t COMMA  char in enumerate PARELEFT  PARERIGHT : EOM
X[]]  EQUAL  1 EOM
y[]]]  EQUAL  1 EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Activation EOM
from keras DOT layers import LSTM EOM
from keras DOT optimizers import RMSprop EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT maxlen COMMA  len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
epochs  EQUAL  6 EOM
batch_size  EQUAL  128 EOM
model_structure  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT fit PARELEFT X COMMA  y COMMA batch_size EQUAL  COMMA epochs EQUAL  PARERIGHT  EOM
model DOT save_weights PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  EOM
from keras DOT models import model_from_json EOM
with open PARELEFT  PARERIGHT  as f: EOM
model_json  EQUAL  f DOT read PARELEFT  PARERIGHT  EOM
model  EQUAL  model_from_json PARELEFT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
import random EOM
def sample PARELEFT preds COMMA  temperature EQUAL  PARERIGHT : EOM
preds  EQUAL  np DOT asarray PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
preds  EQUAL  np DOT log PARELEFT  PARERIGHT  / temperature EOM
exp_preds  EQUAL  np DOT exp PARELEFT  PARERIGHT  EOM
preds  EQUAL  exp_preds / np DOT sum PARELEFT  PARERIGHT  EOM
probas  EQUAL  np DOT random DOT multinomial PARELEFT  PARERIGHT  EOM
return np DOT argmax PARELEFT  PARERIGHT  EOM
import sys EOM
start_index  EQUAL  random DOT randint PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - maxlen - 1 PARERIGHT  EOM
for diversity in []: EOM
generated  EQUAL  EOM
sentence  EQUAL  text[] EOM
generated + EQUAL  sentence EOM
sys DOT stdout DOT write PARELEFT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
x  EQUAL  np DOT zeros PARELEFT  PARELEFT 1 COMMA  maxlen COMMA  len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
for t COMMA  char in enumerate PARELEFT  PARERIGHT : EOM
x[]]  EQUAL  1 DOT  EOM
preds  EQUAL  model DOT predict PARELEFT x COMMA  verbose EQUAL  PARERIGHT [] EOM
next_index  EQUAL  sample PARELEFT  PARERIGHT  EOM
next_char  EQUAL  indices_char[] EOM
generated + EQUAL  next_char EOM
sentence  EQUAL  sentence[] + next_char EOM
sys DOT stdout DOT write PARELEFT  PARERIGHT  EOM
sys DOT stdout DOT flush PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import GRU EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT num_neurons COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL [] DOT shape PARERIGHT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_neurons COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL [] DOT shape PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT num_neurons_2 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
from __future__ import print_function EOM
from keras import optimizers EOM
from keras DOT layers import Dense COMMA  Input COMMA  Embedding COMMA  TimeDistributed COMMA  GlobalMaxPooling1D COMMA  Bidirectional\ EOM
 COMMA  RepeatVector COMMA  Conv1D COMMA  LSTM EOM
from keras DOT models import Model COMMA  Sequential EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT convolutional import Conv2D COMMA  MaxPooling2D EOM
from keras DOT layers import Flatten COMMA  Lambda EOM
from keras DOT layers DOT core import Dropout COMMA  Activation COMMA  Permute EOM
from keras DOT layers DOT merge import concatenate COMMA  multiply EOM
from keras import backend as K EOM
import numpy as np EOM
def mlp1 PARELEFT sample_dim COMMA  class_count EQUAL  PARERIGHT : EOM
feature_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 256 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 128 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 64 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 32 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT class_count COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA outputs EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def cnn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def BiLSTM_Attention PARELEFT  PARERIGHT : EOM
char_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
char_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA tch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA mask_zero EQUAL  COMMA trainable EQUAL  COMMA weights EQUAL [] PARERIGHT  EOM
char_embedding2  EQUAL  TimeDistributed PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
char_cnn  EQUAL  TimeDistributed PARELEFT Conv1D PARELEFT 100 COMMA  2 COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
char_macpool  EQUAL  TimeDistributed PARELEFT GlobalMaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
char_macpool  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
word_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
word_embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA input_length EQUAL  COMMA mask_zero EQUAL  COMMA trainable EQUAL  COMMA weights EQUAL [] PARERIGHT  PARELEFT  PARERIGHT  EOM
word_embedding  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
embedding  EQUAL  concatenate PARELEFT [] COMMA  axis EQUAL  PARERIGHT  EOM
BiLSTM0  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 100 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
BiLSTM0  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
BiLSTM  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 100 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
BiLSTM  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  RepeatVector PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Permute PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
representation  EQUAL  multiply PARELEFT  PARERIGHT  EOM
representation  EQUAL  BatchNormalization PARELEFT axis EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
representation  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
representation  EQUAL  Lambda PARELEFT lambda xin: K DOT sum PARELEFT xin COMMA  axis EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT targetvocabsize COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
Models  EQUAL  Model PARELEFT  PARERIGHT  EOM
Models DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  COMMA  metrics EQUAL [] PARERIGHT  EOM
return Models EOM
def lstm_attention_model PARELEFT  PARERIGHT : EOM
input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
embedding  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  input_length EQUAL  COMMA ask_zero EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
BiLSTM0  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
BiLSTM0  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
BiLSTM  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
BiLSTM  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Flatten PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  RepeatVector PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention  EQUAL  Permute PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
representation  EQUAL  multiply PARELEFT  PARERIGHT  EOM
representation  EQUAL  BatchNormalization PARELEFT axis EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
representation  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
representation  EQUAL  Lambda PARELEFT lambda xin: K DOT sum PARELEFT xin COMMA  axis EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 256 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 128 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 64 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  Dense PARELEFT 32 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT output_dim COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA outputs EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 89483 COMMA  256 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_mul_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  256 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_mul_model_all PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  256 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 32 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
batch_size  EQUAL  128 EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import GlobalAveragePooling1D EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
return model EOM
def LSTM_Dropout_Sentence_Classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
return model EOM
def CNN_LSTM_Sentence_Classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
return model EOM
def CNN_Sentence_Classifier PARELEFT  PARERIGHT : EOM
seq_length  EQUAL  max_review_length EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
return model EOM
def Stacked_LSTM_Sentence_Classifier PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT layers import Dropout EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
from collections import deque EOM
import sys EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  seq_length COMMA aved_model EQUAL  COMMA  features_length EQUAL  PARERIGHT : EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
if self DOT nb_classes > EQUAL  10: EOM
metrics DOT append PARELEFT  PARERIGHT  EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lrcn PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT mlp PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT conv_3d PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT c3d PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2048 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lrcn PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA tivation EQUAL  COMMA  padding EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA ernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Conv2D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA adding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT MaxPooling2D PARELEFT  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def mlp PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def conv_3d PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def c3d PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  COMMA input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA  3 COMMA  3 COMMA  3 COMMA  activation EQUAL  COMMA order_mode EQUAL  COMMA  name EQUAL  COMMA bsample EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT ZeroPadding3D PARELEFT padding EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  COMMA order_mode EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4096 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4096 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom kerasImpl import data EOM
from numpy import argmax EOM
from random import randint EOM
from pickle import load EOM
from numpy import array EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT utils import to_categorical EOM
from keras DOT utils DOT vis_utils import plot_model EOM
from keras DOT models import Sequential EOM
from keras DOT models import Model EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import RepeatVector EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Input EOM
from keras DOT callbacks import ModelCheckpoint EOM
from nltk DOT translate DOT bleu_score import corpus_bleu EOM
import numpy as np EOM
import random EOM
def define_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT src_vocab COMMA  latent_dim COMMA  input_length EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_units COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_units COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT tar_vocab COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def define_model_powerful PARELEFT  PARERIGHT : EOM
encoder_embedding  EQUAL  Embedding PARELEFT src_vocab COMMA  latent_dim COMMA  input_length EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  EOM
encoder_embedding  EQUAL  encoder_embedding PARELEFT  PARERIGHT  EOM
encoder_lstm1  EQUAL  LSTM PARELEFT n_units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  COMMA  dropout EQUAL  PARERIGHT  EOM
encoder_lstm2  EQUAL  LSTM PARELEFT n_units COMMA  return_state EQUAL  COMMA  dropout EQUAL  PARERIGHT  EOM
encoder_outputs COMMA  state_h COMMA  state_c  EQUAL  encoder_lstm2 PARELEFT  PARERIGHT  EOM
encoder_dropout  EQUAL  Dropout PARELEFT  PARERIGHT  EOM
encoder_outputs  EQUAL  encoder_dropout PARELEFT  PARERIGHT  EOM
encoder_states  EQUAL  [] EOM
decoder_inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
decoder_lstm1  EQUAL  LSTM PARELEFT n_units COMMA  return_sequences EQUAL  COMMA  return_state EQUAL  COMMA  dropout EQUAL  PARERIGHT  EOM
lstm_output  EQUAL  decoder_lstm1 PARELEFT decoder_inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
decoder_lstm2  EQUAL  LSTM PARELEFT n_units COMMA  return_sequences EQUAL  COMMA  return_state EQUAL  COMMA  dropout EQUAL  PARERIGHT  EOM
decoder_outputs COMMA  _ COMMA  _  EQUAL  decoder_lstm2 PARELEFT  PARERIGHT  EOM
decoder_dropout  EQUAL  Dropout PARELEFT  PARERIGHT  EOM
decoder_outputs  EQUAL  decoder_dropout PARELEFT  PARERIGHT  EOM
decoder_dense  EQUAL  Dense PARELEFT tar_vocab COMMA  activation EQUAL  PARERIGHT  EOM
decoder_outputs  EQUAL  decoder_dense PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
encoder_model  EQUAL  Model PARELEFT  PARERIGHT  EOM
decoder_state_input_h  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
decoder_state_input_c  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
decoder_states_inputs  EQUAL  [] EOM
temporary_output  EQUAL  decoder_lstm1 PARELEFT decoder_inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
decoder_outputs COMMA  state_h COMMA  state_c  EQUAL  decoder_lstm2 PARELEFT  PARERIGHT  EOM
decoder_states  EQUAL  [] EOM
decoder_outputs  EQUAL  decoder_dense PARELEFT  PARERIGHT  EOM
decoder_model  EQUAL  Model PARELEFT  PARERIGHT  EOM
return model COMMA  encoder_model COMMA  decoder_model EOM
def predict_sequence PARELEFT  PARERIGHT : EOM
prediction  EQUAL  model DOT predict PARELEFT source COMMA  verbose EQUAL  PARERIGHT [] EOM
integers  EQUAL  [] EOM
target  EQUAL  list PARELEFT  PARERIGHT  EOM
for i in integers: EOM
word  EQUAL  data DOT word_for_id PARELEFT  PARERIGHT  EOM
if word is None: EOM
break EOM
target DOT append PARELEFT  PARERIGHT  EOM
return  DOT join PARELEFT  PARERIGHT  EOM
def evaluate_model PARELEFT  PARERIGHT : EOM
actual COMMA  predicted  EQUAL  list PARELEFT  PARERIGHT  COMMA  list PARELEFT  PARERIGHT  EOM
for i COMMA  source in enumerate PARELEFT  PARERIGHT : EOM
source  EQUAL  source DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
translation  EQUAL  predict_sequence PARELEFT  PARERIGHT  EOM
raw_target COMMA  raw_src  EQUAL  raw_dataset[] EOM
if i < 10: EOM
actual DOT append PARELEFT raw_target DOT split PARELEFT  PARERIGHT  PARERIGHT  EOM
predicted DOT append PARELEFT translation DOT split PARELEFT  PARERIGHT  PARERIGHT  EOM
def generate_sequence PARELEFT  PARERIGHT : EOM
return [] EOM
def get_dataset PARELEFT  PARERIGHT : EOM
X1 COMMA  X2 COMMA  y  EQUAL  list PARELEFT  PARERIGHT  COMMA  list PARELEFT  PARERIGHT  COMMA  list PARELEFT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
source  EQUAL  generate_sequence PARELEFT  PARERIGHT  EOM
target  EQUAL  generate_sequence PARELEFT  PARERIGHT  EOM
target DOT reverse PARELEFT  PARERIGHT  EOM
target_in  EQUAL  [] + target[] EOM
src_encoded  EQUAL  to_categorical PARELEFT [] COMMA  num_classes EQUAL  PARERIGHT  EOM
tar_encoded  EQUAL  to_categorical PARELEFT [] COMMA  num_classes EQUAL  PARERIGHT  EOM
tar2_encoded  EQUAL  to_categorical PARELEFT [] COMMA  num_classes EQUAL  PARERIGHT  EOM
X1 DOT append PARELEFT  PARERIGHT  EOM
X2 DOT append PARELEFT  PARERIGHT  EOM
y DOT append PARELEFT  PARERIGHT  EOM
X1  EQUAL  np DOT squeeze PARELEFT array PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  EOM
X2  EQUAL  np DOT squeeze PARELEFT array PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  EOM
y  EQUAL  np DOT squeeze PARELEFT array PARELEFT  PARERIGHT  COMMA  axis EQUAL  PARERIGHT  EOM
return X1 COMMA  X2 COMMA  yimport pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def build_improved_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_basic_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def build_lstm_model PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  1000 EOM
word_feature_size  EQUAL  4096 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_lstm  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  2 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_lstm COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Embedding COMMA  Input EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  GRU COMMA  Merge COMMA  merge COMMA  Masking EOM
from keras DOT models import Model EOM
from keras DOT callbacks import Callback EOM
from keras DOT callbacks import EarlyStopping EOM
from keras import backend as K EOM
from keras DOT layers DOT wrappers import Bidirectional EOM
import numpy as np EOM
from numpy DOT random import RandomState EOM
from random import shuffle EOM
import datetime EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
self DOT val_losses  EQUAL  [] EOM
def on_epoch_end PARELEFT self COMMA  epoch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT val_losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def train_Bi_LSTM PARELEFT X COMMA  Y COMMA  epochs  EQUAL  COMMA  validation_split  EQUAL  COMMA  patience EQUAL  PARERIGHT : EOM
speed_input  EQUAL  Input PARELEFT shape  EQUAL  PARELEFT  PARERIGHT  COMMA  name  EQUAL  PARERIGHT  EOM
main_output  EQUAL  Bidirectional PARELEFT LSTM PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  output_dim  EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
final_model  EQUAL  Model PARELEFT input  EQUAL [] COMMA  output  EQUAL [] PARERIGHT  EOM
final_model DOT summary PARELEFT  PARERIGHT  EOM
final_model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
history  EQUAL  LossHistory PARELEFT  PARERIGHT  EOM
earlyStopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  min_delta EQUAL  COMMA  patience EQUAL  COMMA  verbose EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
final_model DOT fit PARELEFT [] COMMA  Y COMMA  validation_split  EQUAL  COMMA  nb_epoch  EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
return final_model COMMA  history EOM
def train_2_Bi_LSTM_mask PARELEFT X COMMA  Y COMMA  epochs  EQUAL  COMMA  validation_split  EQUAL  COMMA  patience EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim  EQUAL [] COMMA  return_sequences EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim  EQUAL [] COMMA  return_sequences EQUAL  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
history  EQUAL  LossHistory PARELEFT  PARERIGHT  EOM
earlyStopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  min_delta EQUAL  COMMA  patience EQUAL  COMMA  verbose EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X COMMA  Y COMMA  validation_split  EQUAL  COMMA  nb_epoch  EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
return model COMMA  history EOM
def train_2_Bi_LSTM PARELEFT X COMMA  Y COMMA  epochs  EQUAL  COMMA  validation_split  EQUAL  COMMA  patience EQUAL  PARERIGHT : EOM
speed_input  EQUAL  Input PARELEFT shape  EQUAL  PARELEFT  PARERIGHT  COMMA  name  EQUAL  PARERIGHT  EOM
lstm_output  EQUAL  Bidirectional PARELEFT LSTM PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  output_dim  EQUAL [] COMMA  return_sequences EQUAL  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
main_output  EQUAL  LSTM PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  output_dim  EQUAL [] PARERIGHT  PARELEFT  PARERIGHT  EOM
final_model  EQUAL  Model PARELEFT input  EQUAL [] COMMA  output  EQUAL [] PARERIGHT  EOM
final_model DOT summary PARELEFT  PARERIGHT  EOM
final_model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
history  EQUAL  LossHistory PARELEFT  PARERIGHT  EOM
earlyStopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  min_delta EQUAL  COMMA  patience EQUAL  COMMA  verbose EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
final_model DOT fit PARELEFT [] COMMA  Y COMMA  validation_split  EQUAL  COMMA  nb_epoch  EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
return final_model COMMA  historyimport pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM COMMA  Dropout EOM
from keras import backend as K EOM
from keras_tqdm import TQDMNotebookCallback EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT num_words COMMA 12 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
LSTM_history  EQUAL  LSTM_model DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL import tflearn EOM
import numpy as np EOM
from sklearn DOT manifold import TSNE EOM
import matplotlib DOT pyplot as plt EOM
from tflearn DOT layers DOT core import input_data COMMA  dropout COMMA  fully_connected EOM
from tflearn DOT layers DOT conv import conv_1d COMMA  global_max_pool EOM
from tflearn DOT layers DOT merge_ops import merge EOM
from tflearn DOT layers DOT estimator import regression EOM
import tensorflow as tf EOM
import os EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Dropout COMMA  Embedding COMMA  Flatten COMMA  Input COMMA  Convolution1D COMMA  MaxPooling1D COMMA  GlobalMaxPooling1D EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Dense COMMA  Input COMMA  Flatten EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding COMMA  Dropout COMMA  LSTM COMMA  GRU COMMA  Bidirectional EOM
from keras DOT models import Model COMMA Sequential EOM
from keras import backend as K EOM
from keras DOT engine DOT topology import Layer COMMA  InputSpec EOM
from keras import initializers COMMA  optimizers EOM
def lstm_model_bin PARELEFT  PARERIGHT : EOM
model_variation  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT len PARELEFT  PARERIGHT +1 COMMA  embedding_dim COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_model PARELEFT  PARERIGHT : EOM
model_variation  EQUAL  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT len PARELEFT  PARERIGHT +1 COMMA  embedding_dim COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelimport os EOM
from keras DOT layers import Dense COMMA  Flatten COMMA  Dropout COMMA  Activation EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam COMMA  RMSprop COMMA  Adadelta EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D COMMA  GlobalAveragePooling2D EOM
from keras DOT layers import LSTM COMMA  Embedding EOM
class DeepLearningModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  saved_model EQUAL  PARERIGHT : EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
if self DOT saved_model is not None and os DOT path DOT isfile PARELEFT  PARERIGHT : EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT mlp_mnist PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT cnn_mnist PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT cnn_cifar10 PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT cnn_cifar100 PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT lstm_imdb PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT model  EQUAL  self DOT lstm_ucf101 PARELEFT  PARERIGHT  EOM
else: EOM
sys DOT exit PARELEFT  PARERIGHT  EOM
def mlp_mnist PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA etrics EQUAL [] PARERIGHT  EOM
return model EOM
def cnn_mnist PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA etrics EQUAL [] PARERIGHT  EOM
return model EOM
def cnn_cifar10 PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
return model EOM
def cnn_cifar10_big PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Conv2D PARELEFT 96 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 96 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 96 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 192 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 192 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 192 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 192 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 192 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 10 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling2D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
return model EOM
def cnn_cifar100 PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA etrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_imdb PARELEFT  PARERIGHT : EOM
max_features  EQUAL  20000 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_ucf101 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2048 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
import numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
from theano DOT tensor DOT shared_randomstreams import RandomStreams EOM
srng  EQUAL  RandomStreams PARELEFT  PARERIGHT  EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  LSTM COMMA  Dropout EOM
from keras DOT layers DOT embeddings import Embedding EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from keras_helper import load_keras_model as load EOM
from keras_helper import save_keras_model as save EOM
base_dir  EQUAL  EOM
def generate_model PARELEFT top_words COMMA  embedding_length COMMA  n_lstm_units EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
if dropout is not None: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
if dropout is not None: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
if __name__ EQUAL  EQUAL : EOM
n_lstm_units  EQUAL  int PARELEFT  PARERIGHT  EOM
embedding_length  EQUAL  EOM
top_words  EQUAL  EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  COMMA  seed EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_lstm_units COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT int PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
save PARELEFT model COMMA   DOT format PARELEFT  PARERIGHT  COMMA  base_dir EQUAL  PARERIGHT  EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
def get_simple_net PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Embedding PARELEFT dictionary_length + 1 COMMA  32 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def get_dropout_net PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Embedding PARELEFT dictionary_length + 1 COMMA  32 COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelimport pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM EOM
from keras import backend as K EOM
from keras_tqdm import TQDMNotebookCallback EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA test_size EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
modelLSTM_2a  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT summary PARELEFT  PARERIGHT  EOM
modelLSTM_2a DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
LSTM_history  EQUAL  modelLSTM_2a DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL from keras DOT models import Sequential EOM
from keras DOT layers import Flatten COMMA  Dense COMMA  Dropout COMMA  Embedding COMMA  LSTM COMMA  Bidirectional EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
def base PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT params[] COMMA  params[] COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 250 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def conv PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT params[] COMMA  params[] COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 250 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def conv2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT params[] COMMA  params[] COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT 64 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT 32 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT 16 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 180 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT params[] COMMA  params[] COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lstm2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT params[] COMMA  params[] COMMA  input_length EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT convolutional import Convolution1D COMMA  MaxPooling1D EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT models import Graph EOM
from recurrent import Bidirectional EOM
def cnn PARELEFT  PARERIGHT : EOM
nb_filter  EQUAL  250 EOM
filter_length  EQUAL  3 EOM
hidden_dims  EQUAL  250 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  input_length EQUAL  COMMA  weights EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def gru PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def bidirectional_lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Graph PARELEFT  PARERIGHT  EOM
model DOT add_input PARELEFT name EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  weights EQUAL [] COMMA  input_length EQUAL  PARERIGHT  COMMA ame EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT LSTM PARELEFT  PARERIGHT  COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT LSTM PARELEFT 64 COMMA  go_backwards EQUAL  PARERIGHT  COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT Dropout PARELEFT  PARERIGHT  COMMA  name EQUAL  COMMA  inputs EQUAL [] PARERIGHT  EOM
model DOT add_node PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
model DOT add_output PARELEFT name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
return model EOM
def cnn_lstm PARELEFT  PARERIGHT : EOM
nb_filter  EQUAL  64 EOM
filter_length  EQUAL  3 EOM
pool_length  EQUAL  2 EOM
lstm_output_size  EQUAL  64 EOM
p  EQUAL  0 DOT 25 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  input_length EQUAL  COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def cnn_gru PARELEFT  PARERIGHT : EOM
nb_filter  EQUAL  64 EOM
filter_length  EQUAL  3 EOM
pool_length  EQUAL  2 EOM
lstm_output_size  EQUAL  70 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def b_rnn PARELEFT  PARERIGHT : EOM
lstm_output_size  EQUAL  64 EOM
lstm  EQUAL  LSTM PARELEFT output_dim EQUAL  PARERIGHT  EOM
gru  EQUAL  GRU PARELEFT output_dim EQUAL  PARERIGHT  EOM
brnn  EQUAL  Bidirectional PARELEFT forward EQUAL  COMMA  backward EQUAL  PARERIGHT  EOM
nb_filter  EQUAL  64 EOM
filter_length  EQUAL  3 EOM
pool_length  EQUAL  2 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT W DOT shape[] COMMA  W DOT shape[] COMMA  input_length EQUAL  COMMA  weights EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
passfrom numpy DOT random import permutation EOM
from keras DOT models import Sequential COMMA  Graph EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Reshape COMMA  Merge EOM
from keras DOT optimizers import SGD EOM
from keras DOT utils import np_utils EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT recurrent import LSTM EOM
from Utils DOT FileProcess import generate_w2i_i2w_dict COMMA  sentence2sequence EOM
from birnn import BiDirectionLSTM EOM
from Utils DOT statistics import * EOM
from LSTM import get_class EOM
def get_data PARELEFT  PARERIGHT : EOM
X  EQUAL  [] EOM
y  EQUAL  [] EOM
w2i COMMA  i2w  EQUAL  generate_w2i_i2w_dict PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as fr: EOM
for line in fr: EOM
query1 COMMA  query2 COMMA  label  EQUAL  line DOT split PARELEFT  PARERIGHT [] EOM
query  EQUAL   PARELEFT sentence2sequence PARELEFT  PARERIGHT  COMMA  sentence2sequence PARELEFT  PARERIGHT  PARERIGHT  EOM
X DOT append PARELEFT  PARERIGHT  EOM
y DOT append PARELEFT int PARELEFT  PARERIGHT  PARERIGHT  EOM
X  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
return X COMMA  y EOM
def blstm_I PARELEFT X COMMA  y COMMA  word_vec_len EQUAL  COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  threshold EQUAL  PARERIGHT : EOM
words_size  EQUAL  13033 EOM
X  EQUAL  X[] EOM
y  EQUAL  y[] EOM
X1  EQUAL  [] for t in X] EOM
X2  EQUAL  [] for t in X] EOM
X1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X2  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X1_train COMMA  X1_test  EQUAL  X1[] COMMA  X1[] EOM
X2_train COMMA  X2_test  EQUAL  X2[] COMMA  X2[] EOM
y_train COMMA  y_test  EQUAL  y[] COMMA  y[] EOM
X1_train  EQUAL  sequence DOT pad_sequences PARELEFT X1_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X1_test  EQUAL  sequence DOT pad_sequences PARELEFT X1_test COMMA  maxlen EQUAL  PARERIGHT  EOM
X2_train  EQUAL  sequence DOT pad_sequences PARELEFT X2_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X2_test  EQUAL  sequence DOT pad_sequences PARELEFT X2_test COMMA  maxlen EQUAL  PARERIGHT  EOM
left  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
left DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
left DOT add PARELEFT BiDirectionLSTM PARELEFT word_vec_len COMMA  100 COMMA  output_mode EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
right  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
right DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
right DOT add PARELEFT BiDirectionLSTM PARELEFT word_vec_len COMMA  100 COMMA  output_mode EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 100 * max_sentence_length COMMA  50 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 50 COMMA  1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  class_mode EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA  y_train COMMA  shuffle EQUAL  COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  COMMA  show_accuracy EQUAL  PARERIGHT  EOM
probas  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
for threshold in []: EOM
classes  EQUAL  get_class PARELEFT  PARERIGHT  EOM
accuracy  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
precision  EQUAL  precision_score PARELEFT  PARERIGHT  EOM
recall  EQUAL  recall_score PARELEFT  PARERIGHT  EOM
f1  EQUAL  f1_score PARELEFT  PARERIGHT  EOM
def blstm_I_2layers PARELEFT X COMMA  y COMMA  word_vec_len EQUAL  COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  threshold EQUAL  PARERIGHT : EOM
words_size  EQUAL  13033 EOM
X  EQUAL  X[] EOM
y  EQUAL  y[] EOM
X1  EQUAL  [] for t in X] EOM
X2  EQUAL  [] for t in X] EOM
X1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X2  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X1_train COMMA  X1_test  EQUAL  X1[] COMMA  X1[] EOM
X2_train COMMA  X2_test  EQUAL  X2[] COMMA  X2[] EOM
y_train COMMA  y_test  EQUAL  y[] COMMA  y[] EOM
X1_train  EQUAL  sequence DOT pad_sequences PARELEFT X1_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X1_test  EQUAL  sequence DOT pad_sequences PARELEFT X1_test COMMA  maxlen EQUAL  PARERIGHT  EOM
X2_train  EQUAL  sequence DOT pad_sequences PARELEFT X2_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X2_test  EQUAL  sequence DOT pad_sequences PARELEFT X2_test COMMA  maxlen EQUAL  PARERIGHT  EOM
left  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
left DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
left DOT add PARELEFT BiDirectionLSTM PARELEFT word_vec_len COMMA  100 COMMA  output_mode EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
left DOT add PARELEFT BiDirectionLSTM PARELEFT 100*2 COMMA  100 COMMA  output_mode EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
right  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
right DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
right DOT add PARELEFT BiDirectionLSTM PARELEFT word_vec_len COMMA  100 COMMA  output_mode EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
right DOT add PARELEFT BiDirectionLSTM PARELEFT 100*2 COMMA  100 COMMA  output_mode EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 100 * max_sentence_length COMMA  50 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 50 COMMA  1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  class_mode EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA  y_train COMMA  shuffle EQUAL  COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  COMMA  validation_split EQUAL  COMMA  show_accuracy EQUAL  PARERIGHT  EOM
probas  EQUAL  model DOT predict_proba PARELEFT  PARERIGHT  EOM
classes  EQUAL  get_class PARELEFT  PARERIGHT  EOM
accuracy  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
precision  EQUAL  precision_score PARELEFT  PARERIGHT  EOM
recall  EQUAL  recall_score PARELEFT  PARERIGHT  EOM
f1  EQUAL  f1_score PARELEFT  PARERIGHT  EOM
return accuracy COMMA  precision COMMA  recall COMMA  f1 EOM
if __name__  EQUAL  EQUAL  : EOM
thresholds  EQUAL  [] EOM
X COMMA  y  EQUAL  get_data PARELEFT  PARERIGHT  EOM
blstm_I PARELEFT  PARERIGHT import tensorflow as tf EOM
import keras EOM
from keras import backend as K EOM
from keras DOT layers import Dense COMMA Flatten COMMA Dropout COMMA Activation COMMA Input COMMA  GlobalAveragePooling3D EOM
from keras DOT layers import Conv3D COMMA  MaxPooling3D COMMA BatchNormalization COMMA  MaxPool3D EOM
from keras DOT layers import RepeatVector COMMA Permute COMMA Lambda COMMA merge COMMA multiply COMMA Dot EOM
from keras DOT layers DOT recurrent import LSTM COMMA GRU EOM
from keras DOT models import Sequential COMMA  load_model COMMA Model EOM
from keras DOT optimizers import Adam COMMA  RMSprop COMMA  SGD EOM
from keras DOT layers DOT wrappers import TimeDistributed COMMA  Bidirectional EOM
from keras DOT layers DOT advanced_activations import ELU COMMA  LeakyReLU EOM
from surportsPG DOT custom_recurrents import AttentionDecoder EOM
def conv3D PARELEFT  PARERIGHT : EOM
input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 84 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def Conv3D_Classes PARELEFT  PARERIGHT : EOM
input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling3D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
class Models PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT n_hidden   EQUAL  1024 EOM
self DOT n_hidden2  EQUAL  512 EOM
self DOT feature_length  EQUAL  args DOT featurelength EOM
self DOT seq_length  EQUAL  args DOT seqlength EOM
self DOT dropout  EQUAL  args DOT dropout EOM
self DOT units  EQUAL  64 EOM
def LSTM PARELEFT  PARERIGHT : EOM
with tf DOT name_scope PARELEFT  PARERIGHT  as scope: EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
with tf DOT name_scope PARELEFT  PARERIGHT  as scope: EOM
model DOT add PARELEFT LSTM PARELEFT self DOT n_hidden COMMA input_dim EQUAL  COMMA nput_length EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
with tf DOT name_scope PARELEFT  PARERIGHT  as scope: EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model EOM
def LSTM2 PARELEFT  PARERIGHT : EOM
with tf DOT name_scope PARELEFT  PARERIGHT  as scope: EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
with tf DOT name_scope PARELEFT  PARERIGHT  as scope: EOM
model DOT add PARELEFT LSTM PARELEFT self DOT n_hidden COMMA input_dim EQUAL  COMMA nput_length EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
with tf DOT name_scope PARELEFT  PARERIGHT  as scope: EOM
model DOT add PARELEFT LSTM PARELEFT self DOT n_hidden COMMA input_dim EQUAL  COMMA nput_length EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
with tf DOT name_scope PARELEFT  PARERIGHT  as scope: EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
return model EOM
def attention_3d_block PARELEFT  PARERIGHT : EOM
input_dim  EQUAL  int PARELEFT  PARERIGHT  EOM
a  EQUAL  Permute PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
a  EQUAL  TimeDistributed PARELEFT Dense PARELEFT self DOT seq_length COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
a_probs  EQUAL  Permute PARELEFT  PARELEFT  PARERIGHT  COMMA  name  EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
output_attention_mul  EQUAL  multiply PARELEFT [] COMMA  name EQUAL  PARERIGHT  EOM
return output_attention_mul EOM
def Attention_before_LSTM PARELEFT  PARERIGHT : EOM
_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
drop1  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention_mul  EQUAL  self DOT attention_3d_block PARELEFT  PARERIGHT  EOM
attention_mul  EQUAL  LSTM PARELEFT self DOT n_hidden COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT input EQUAL [] COMMA  output EQUAL  PARERIGHT  EOM
return model EOM
def Attention_after_LSTM PARELEFT  PARERIGHT : EOM
_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
drop  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
LSTM_layer  EQUAL  LSTM PARELEFT self DOT n_hidden COMMA  return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention_mul  EQUAL  self DOT attention_3d_block PARELEFT  PARERIGHT  EOM
drop2  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT input EQUAL [] COMMA  output EQUAL  PARERIGHT  EOM
return model EOM
def Attention_LSTM PARELEFT  PARERIGHT : EOM
_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
dropout  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
LSTM_layer  EQUAL  Bidirectional PARELEFT LSTM PARELEFT self DOT n_hidden COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
attention_mul  EQUAL  self DOT attention_3d_block PARELEFT  PARERIGHT  EOM
dropout2  EQUAL  Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
output  EQUAL  TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT input EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
return model EOM
def simpleNMT PARELEFT  PARERIGHT : EOM
input_  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT self DOT n_hidden COMMA  return_sequences EQUAL  PARERIGHT  COMMA name EQUAL  COMMA rge_mode  EQUAL  COMMA trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
y_hat  EQUAL   TimeDistributed PARELEFT AttentionDecoder PARELEFT self DOT n_hidden COMMA name EQUAL  COMMA tput_dim  EQUAL  COMMA return_probabilities EQUAL  COMMA trainable EQUAL  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT models import load_model EOM
from config import * EOM
from MIDIprocessing import loadTrainingData EOM
def generateModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 256 COMMA  20 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 20 COMMA activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
def generateTModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 6 COMMA activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
def trainModel PARELEFT  PARERIGHT : EOM
for i in range PARELEFT  PARERIGHT : EOM
model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
X COMMA  Y  EQUAL  loadTrainingData PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT X COMMA  Y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT import os EOM
import time EOM
import numpy as np EOM
from functools import wraps EOM
from sklearn DOT externals import joblib EOM
from sklearn DOT preprocessing import LabelBinarizer EOM
from sklearn DOT model_selection import cross_val_score EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT models import load_model COMMA  Sequential EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  LSTM EOM
N_FEATURES  EQUAL  10000 EOM
DOC_LEN  EQUAL  60 EOM
N_CLASSES  EQUAL  2 EOM
def timeit PARELEFT  PARERIGHT : EOM
def wrapper PARELEFT  PARERIGHT : EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
result  EQUAL  func PARELEFT  PARERIGHT  EOM
return result COMMA  time DOT time PARELEFT  PARERIGHT  - start EOM
return wrapper EOM
def documents PARELEFT  PARERIGHT : EOM
return list PARELEFT corpus DOT reviews PARELEFT  PARERIGHT  PARERIGHT  EOM
def continuous PARELEFT  PARERIGHT : EOM
return list PARELEFT corpus DOT scores PARELEFT  PARERIGHT  PARERIGHT  EOM
def make_categorical PARELEFT  PARERIGHT : EOM
return np DOT digitize PARELEFT continuous PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def binarize PARELEFT  PARERIGHT : EOM
return np DOT digitize PARELEFT continuous PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def build_nn PARELEFT  PARERIGHT : EOM
nn DOT add PARELEFT Dense PARELEFT 500 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
nn DOT add PARELEFT Dense PARELEFT 150 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
nn DOT add PARELEFT Dense PARELEFT N_CLASSES COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
nn DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return nn EOM
def build_lstm PARELEFT  PARERIGHT : EOM
lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm DOT add PARELEFT Embedding PARELEFT N_FEATURES+1 COMMA  128 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT LSTM PARELEFT units EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
lstm DOT add PARELEFT Dense PARELEFT N_CLASSES COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
lstm DOT compile PARELEFT optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return lstm EOM
def train_model PARELEFT path COMMA  model COMMA  reader COMMA  saveto EQUAL  COMMA  cv EQUAL  COMMA  **kwargs PARERIGHT : EOM
corpus  EQUAL  PickledAmazonReviewsReader PARELEFT  PARERIGHT  EOM
X  EQUAL  documents PARELEFT  PARERIGHT  EOM
y  EQUAL  binarize PARELEFT  PARERIGHT  EOM
scores  EQUAL  cross_val_score PARELEFT model COMMA  X COMMA  y COMMA  cv EQUAL  COMMA  scoring EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT  PARERIGHT  EOM
if saveto: EOM
model DOT steps[][] DOT model DOT save PARELEFT  PARERIGHT  EOM
model DOT steps DOT pop PARELEFT  PARERIGHT  EOM
joblib DOT dump PARELEFT  PARERIGHT  EOM
return scores EOM
if __name__  EQUAL  EQUAL  : EOM
from sklearn DOT pipeline import Pipeline EOM
from sklearn DOT feature_extraction DOT text import TfidfVectorizer EOM
from reader import PickledReviewsReader EOM
from am_reader import PickledAmazonReviewsReader EOM
from transformer import TextNormalizer COMMA  GensimDoc2Vectorizer EOM
from transformer import KeyphraseExtractor COMMA  GensimTfidfVectorizer EOM
cpath  EQUAL  EOM
mpath  EQUAL  {:  COMMA : } EOM
from  DOT  DOT  DOT model import KerasModel EOM
from  DOT  DOT window_model import FrameModel EOM
class RecurrentModel PARELEFT  PARERIGHT : EOM
def _create_model PARELEFT  PARERIGHT : EOM
from keras DOT layers DOT core import Activation COMMA  Dense COMMA  Dropout COMMA  Reshape EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT recurrent import LSTM EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA input_shape EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA return_sequences EQUAL  COMMA go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
from theano DOT tensor DOT shared_randomstreams import RandomStreams EOM
srng  EQUAL  RandomStreams PARELEFT  PARERIGHT  EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  LSTM COMMA  Dropout EOM
from keras DOT layers DOT embeddings import Embedding EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from keras_helper import load_keras_model as load EOM
from keras_helper import save_keras_model as save EOM
base_dir  EQUAL  EOM
def generate_model PARELEFT top_words COMMA  embedding_length COMMA  n_lstm_units EQUAL  COMMA  dropout EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
if dropout is not None: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
if dropout is not None: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
if __name__ EQUAL  EQUAL : EOM
n_lstm_units  EQUAL  int PARELEFT  PARERIGHT  EOM
embedding_length  EQUAL  16 EOM
top_words  EQUAL  EOM
dropout  EQUAL  0 DOT 2 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  COMMA  seed EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT n_lstm_units COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT int PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
save PARELEFT model COMMA   DOT format PARELEFT  PARERIGHT  COMMA  base_dir EQUAL  PARERIGHT  EOM
import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT import pandas as pd EOM
train  EQUAL pd DOT read_csv PARELEFT  PARERIGHT  EOM
test EQUAL pd DOT read_csv PARELEFT  PARERIGHT  EOM
train DOT head PARELEFT  PARERIGHT  EOM
train EQUAL train DOT drop PARELEFT train DOT columns[]] COMMA  axis EQUAL  PARERIGHT  EOM
test EQUAL test DOT drop PARELEFT test DOT columns[]] COMMA axis EQUAL  PARERIGHT  EOM
ytest EQUAL test DOT iloc[] EOM
ytrain EQUAL train DOT iloc[] EOM
y_train EQUAL ytrain DOT values EOM
y_test EQUAL ytest DOT values EOM
from keras DOT utils import to_categorical EOM
y_train  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
y_test EQUAL to_categorical PARELEFT  PARERIGHT  EOM
xtrain EQUAL train DOT iloc[] EOM
xtest EQUAL test DOT iloc[] EOM
xtrain EQUAL xtrain DOT values EOM
xtest EQUAL xtest DOT values EOM
x_train  EQUAL xtrain DOT reshape PARELEFT  PARERIGHT  EOM
x_test EQUAL xtest DOT reshape PARELEFT  PARERIGHT  EOM
import tensorflow as tf EOM
import keras as ks EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  LSTM EOM
from numpy DOT random import seed EOM
seed PARELEFT  PARERIGHT  EOM
from tensorflow import set_random_seed EOM
set_random_seed PARELEFT  PARERIGHT  EOM
model EQUAL Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 61 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
y EQUAL model DOT predict_proba PARELEFT  PARERIGHT  EOM
from sklearn import  metrics EOM
j EQUAL metrics DOT roc_auc_score PARELEFT  PARERIGHT  EOM
j EQUAL np DOT array PARELEFT  PARERIGHT  EOM
model EQUAL Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 61 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
model1 EQUAL Sequential PARELEFT  PARERIGHT  EOM
model1 DOT add PARELEFT LSTM PARELEFT 61 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model1 DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model1 DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
score  EQUAL  model1 DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
y EQUAL model1 DOT predict_proba PARELEFT  PARERIGHT  EOM
j EQUAL metrics DOT roc_auc_score PARELEFT  PARERIGHT  EOM
j EQUAL np DOT array PARELEFT  PARERIGHT  EOM
model2 EQUAL Sequential PARELEFT  PARERIGHT  EOM
model2 DOT add PARELEFT LSTM PARELEFT 61 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model2 DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
score  EQUAL  model2 DOT evaluate PARELEFT x_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
y EQUAL model2 DOT predict_proba PARELEFT  PARERIGHT  EOM
j EQUAL metrics DOT roc_auc_score PARELEFT  PARERIGHT  EOM
j EQUAL np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT models import model_from_json EOM
model2_json  EQUAL  model2 DOT to_json PARELEFT  PARERIGHT  EOM
import h5py EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
json_file  EQUAL  open PARELEFT  PARERIGHT  EOM
loaded_model_json  EQUAL  json_file DOT read PARELEFT  PARERIGHT  EOM
json_file DOT close PARELEFT  PARERIGHT  EOM
loaded_model  EQUAL  model_from_json PARELEFT  PARERIGHT  EOM
loaded_model DOT load_weights PARELEFT  PARERIGHT  EOM
filepath EQUAL  EOM
heckpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
model DOT fit PARELEFT X COMMA  Y COMMA  validation_split EQUAL  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  callbacks EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 12 COMMA  input_dim EQUAL  COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 8 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 30 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT from keras DOT layers import Dense COMMA  Activation COMMA  Conv1D COMMA  MaxPooling1D COMMA  GlobalAveragePooling1D COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM COMMA  SimpleRNN EOM
from keras DOT utils DOT np_utils import to_categorical EOM
class ANNModels: EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT num_features  EQUAL  num_features EOM
self DOT num_samples  EQUAL  num_samples EOM
def create_mlp_model PARELEFT  PARERIGHT : EOM
mlp_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
mlp_model DOT add PARELEFT Dense PARELEFT units EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
mlp_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
mlp_model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
mlp_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
mlp_model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return mlp_model EOM
def create_simple_rnn_model PARELEFT  PARERIGHT : EOM
simple_rnn_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
from __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  5 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA input_dim EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 2024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  LSTM COMMA  Flatten COMMA  TimeDistributed EOM
from keras import optimizers EOM
import numpy as np EOM
import keras DOT backend as K EOM
import os EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  recurrent_activation EQUAL  COMMA activation EQUAL  COMMA  return_sequences EQUAL  COMMA  units EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT int PARELEFT  PARERIGHT  COMMA  use_bias EQUAL  COMMA  recurrent_activation EQUAL  COMMA activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT int PARELEFT  PARERIGHT  COMMA  use_bias EQUAL  COMMA  recurrent_activation EQUAL  COMMA activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  clipvalue EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
class Brain2 PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  recurrent_activation EQUAL  COMMA  activation EQUAL  COMMA  use_bias EQUAL  COMMA  return_sequences EQUAL  COMMA  units EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim COMMA  activation EQUAL  COMMA  use_bias EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  clipvalue EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
self DOT model  EQUAL  model EOM
if __name__  EQUAL  EQUAL  : EOM
passfrom keras DOT utils DOT visualize_util import plot EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Lambda EOM
from keras DOT layers DOT pooling import GlobalMaxPooling1D EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
import numpy as np EOM
from keras import backend as K EOM
from keras DOT engine DOT topology import Layer EOM
from DSTC2 DOT traindev DOT scripts import myLogger EOM
__author__  EQUAL  EOM
def get_LSTM PARELEFT  PARERIGHT : EOM
logger DOT info PARELEFT  PARERIGHT  EOM
hidden_size  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  input_dim EQUAL  COMMA  input_length EQUAL  COMMA  dropout_U EQUAL  COMMA  dropout_W EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  dropout_W EQUAL  COMMA  dropout_U EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalMaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
plot PARELEFT model COMMA  to_file EQUAL  PARERIGHT  EOM
logger DOT info PARELEFT  PARERIGHT  EOM
return model EOM
def get_basic_LSTM PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT output_dimension COMMA  input_dim EQUAL  COMMA  input_length EQUAL  COMMA  dropout_U EQUAL  COMMA  dropout_W EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
plot PARELEFT model COMMA  to_file EQUAL  PARERIGHT  EOM
return model EOM
def basic_LSTM_init PARELEFT  PARERIGHT : EOM
input_mtr  EQUAL  reduce PARELEFT lambda session1 COMMA  session2: np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  input_mtr PARERIGHT  EOM
input_mtr  EQUAL  np DOT array PARELEFT map PARELEFT lambda sentence: np DOT array PARELEFT map PARELEFT lambda word: np DOT array PARELEFT  PARERIGHT  COMMA  sentence PARERIGHT  PARERIGHT  COMMA  input_mtr PARERIGHT  PARERIGHT  EOM
output_mtr  EQUAL  reduce PARELEFT lambda session1 COMMA  session2: np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  output_mtr PARERIGHT  EOM
bad_input  EQUAL  np DOT zeros PARELEFT [] PARERIGHT  EOM
bad_output  EQUAL  np DOT zeros PARELEFT [] PARERIGHT  EOM
bad_input_index  EQUAL  [] EOM
for n in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
if  PARELEFT input_mtr[]  EQUAL  PARERIGHT  DOT all PARELEFT  PARERIGHT : EOM
bad_input_index DOT append PARELEFT  PARERIGHT  EOM
input_mtr  EQUAL  np DOT delete PARELEFT  PARERIGHT  EOM
output_mtr  EQUAL  np DOT delete PARELEFT  PARERIGHT  EOM
return input_mtr COMMA  output_mtr EOM
class Thresholded PARELEFT  PARERIGHT : EOM
self DOT supports_masking  EQUAL  True EOM
self DOT theta  EQUAL  K DOT cast_to_floatx PARELEFT  PARERIGHT  EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
def call PARELEFT self COMMA  x COMMA  mask EQUAL  PARERIGHT : EOM
return 1 * K DOT cast PARELEFT x > self DOT theta COMMA  K DOT floatx PARELEFT  PARERIGHT  PARERIGHT  EOM
def get_config PARELEFT  PARERIGHT : EOM
config  EQUAL  {: float PARELEFT  PARERIGHT } EOM
base_config  EQUAL  super PARELEFT  PARERIGHT  DOT get_config PARELEFT  PARERIGHT  EOM
return dict PARELEFT list PARELEFT base_config DOT items PARELEFT  PARERIGHT  PARERIGHT  + list PARELEFT config DOT items PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT from __future__ import print_function EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D EOM
from keras DOT datasets import imdb EOM
import pickle EOM
import pandas as pd EOM
max_features  EQUAL  20000 EOM
maxlen  EQUAL  100 EOM
embedding_size  EQUAL  128 EOM
kernel_size  EQUAL  5 EOM
filters  EQUAL  64 EOM
pool_size  EQUAL  4 EOM
lstm_output_size  EQUAL  70 EOM
batch_size  EQUAL  30 EOM
epochs  EQUAL  2 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test COMMA  maxlen EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters COMMA kernel_size COMMA padding EQUAL  COMMA activation EQUAL  COMMA strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
score COMMA  acc  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
filename  EQUAL  EOM
pickle DOT dump PARELEFT model COMMA  open PARELEFT  PARERIGHT  PARERIGHT from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Input EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
import numpy as np EOM
import keras DOT preprocessing DOT text as prep EOM
import keras DOT preprocessing DOT sequence as seq EOM
from keras import backend as K EOM
import  sklearn DOT cluster as clu EOM
from matplotlib import pyplot as plt EOM
from keras DOT utils DOT visualize_util import plot EOM
file EQUAL open PARELEFT  PARERIGHT  EOM
text EQUAL file DOT readlines PARELEFT  PARERIGHT  EOM
t1 EQUAL prep DOT Tokenizer PARELEFT  PARERIGHT  EOM
t1 DOT fit_on_texts PARELEFT  PARERIGHT  EOM
words EQUAL t1 DOT word_index DOT keys PARELEFT  PARERIGHT  EOM
wordsReverse EQUAL [] for i in words] EOM
import numpy as np EOM
from random import random EOM
from matplotlib import pyplot EOM
from pandas import DataFrame EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Bidirectional EOM
def get_sequence PARELEFT  PARERIGHT : EOM
limit  EQUAL  n_timesteps / 4 DOT 0 EOM
X  EQUAL  np DOT random DOT uniform PARELEFT low EQUAL  COMMA  high EQUAL  COMMA  size EQUAL  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT [] PARERIGHT  EOM
X  EQUAL  X DOT reshape PARELEFT  PARERIGHT  EOM
y  EQUAL  y DOT reshape PARELEFT  PARERIGHT  EOM
return  PARELEFT  PARERIGHT  EOM
def get_lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 20 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  COMMA  go_backwards EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def get_bi_lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 20 COMMA  return_sequences EQUAL  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  merge_mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def train_model PARELEFT  PARERIGHT : EOM
loss  EQUAL  list PARELEFT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
X COMMA  y  EQUAL  get_sequence PARELEFT  PARERIGHT  EOM
hist  EQUAL  model DOT fit PARELEFT X COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
loss DOT append PARELEFT  PARERIGHT  EOM
return loss EOM
X COMMA  y  EQUAL  get_sequence PARELEFT  PARERIGHT  EOM
n_timesteps  EQUAL  10 EOM
results  EQUAL  DataFrame PARELEFT  PARERIGHT  EOM
model  EQUAL  get_bi_lstm_model PARELEFT  PARERIGHT  EOM
results[]  EQUAL  train_model PARELEFT  PARERIGHT  EOM
model  EQUAL  get_bi_lstm_model PARELEFT  PARERIGHT  EOM
results[]  EQUAL  train_model PARELEFT  PARERIGHT  EOM
model  EQUAL  get_bi_lstm_model PARELEFT  PARERIGHT  EOM
results[]  EQUAL  train_model PARELEFT  PARERIGHT  EOM
model  EQUAL  get_bi_lstm_model PARELEFT  PARERIGHT  EOM
results[]  EQUAL  train_model PARELEFT  PARERIGHT  EOM
results DOT plot PARELEFT  PARERIGHT  EOM
pyplot DOT show PARELEFT  PARERIGHT from __future__ import division EOM
from __future__ import absolute_import EOM
from __future__ import print_function EOM
import pandas as pd EOM
import numpy as np EOM
from tensorflow DOT contrib DOT keras DOT api DOT keras DOT models import Sequential EOM
from tensorflow DOT contrib DOT keras DOT api DOT keras DOT layers import LSTM as _LSTM EOM
from tensorflow DOT contrib DOT keras DOT api DOT keras DOT layers import Dropout EOM
from tensorflow DOT contrib DOT keras DOT api DOT keras DOT layers import Dense EOM
class LSTM PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  layers COMMA  pct_dropout EQUAL  PARERIGHT : EOM
raise TypeError PARELEFT  %  PARELEFT type PARELEFT  PARERIGHT  COMMA  type PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT  ! EQUAL             raise ValueError PARELEFT  % len PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT model DOT add PARELEFT _LSTM PARELEFT layers[] COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA pct_dropout PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT _LSTM PARELEFT layers[] COMMA return_sequences EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT add PARELEFT Dense PARELEFT layers[] COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
def fit PARELEFT  PARERIGHT : EOM
self DOT model DOT fit PARELEFT  PARERIGHT  EOM
def predict PARELEFT  PARERIGHT : EOM
return self DOT model DOT predict PARELEFT  PARERIGHT import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Convolution1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from theano DOT tensor DOT shared_randomstreams import RandomStreams EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
srng  EQUAL  RandomStreams PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
test_split  EQUAL  0 DOT 33 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT nb_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA  filter_length EQUAL  COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
from utils DOT ml_utils import MLModel EOM
class SimpleLSTM PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT hid_dim COMMA  dropout EQUAL  COMMA recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT class_dim COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
def network_model PARELEFT inputs COMMA  num_pitch COMMA  weights_file EQUAL  PARERIGHT : EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT tf DOT keras DOT layers DOT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return modelfrom sklearn DOT model_selection import train_test_split EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT models import Sequential COMMA Model EOM
from keras DOT layers import Dense COMMA LSTM COMMA Embedding EOM
from keras DOT optimizers import Adam EOM
from keras DOT layers import Bidirectional COMMA Conv1D COMMA GlobalMaxPooling1D COMMA MaxPooling1D COMMA Flatten EOM
from keras DOT callbacks import ModelCheckpoint COMMA  TensorBoard COMMA  Callback COMMA  EarlyStopping EOM
from keras DOT utils import to_categorical EOM
train  EQUAL  load_train_data PARELEFT  PARERIGHT [] EOM
y  EQUAL  train[] EOM
test  EQUAL  load_test_data PARELEFT  PARERIGHT  EOM
max_features  EQUAL  EOM
max_words  EQUAL  50 EOM
batch_size  EQUAL  16 EOM
epochs  EQUAL  5 EOM
num_classes EQUAL 5 EOM
X_train  COMMA  X_val  COMMA  Y_train  COMMA  Y_val  EQUAL  train_test_split PARELEFT train[] COMMA y DOT values COMMA st_size  EQUAL  PARERIGHT  EOM
Y_train  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
Y_val  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT list PARELEFT  PARERIGHT  PARERIGHT  EOM
X_train  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
X_val  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
X_test  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
X_test  EQUAL pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_val  EQUAL  pad_sequences PARELEFT X_val COMMA  maxlen EQUAL  PARERIGHT  EOM
model_LSTM EQUAL Sequential PARELEFT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT Embedding PARELEFT max_features COMMA 100 COMMA mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT LSTM PARELEFT 64 COMMA dropout EQUAL  COMMA return_sequences EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT LSTM PARELEFT 32 COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT add PARELEFT Dense PARELEFT num_classes COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_LSTM DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT lr  EQUAL  PARERIGHT  COMMA metrics EQUAL [] PARERIGHT  EOM
model_LSTM DOT summary PARELEFT  PARERIGHT  EOM
layer_name  EQUAL  EOM
int_layer_model  EQUAL  Model PARELEFT inputs EQUAL  COMMA outputs EQUAL  PARELEFT  PARERIGHT  DOT output PARERIGHT  EOM
int_out  EQUAL  int_layer_model DOT predict PARELEFT  PARERIGHT  EOM
history EQUAL model_LSTM DOT fit PARELEFT X_train COMMA  Y_train COMMA  alidation_data EQUAL  PARELEFT  PARERIGHT  COMMA pochs EQUAL  COMMA  atch_size EQUAL  COMMA  verbose EQUAL from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def build_improved_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_basic_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
import sys EOM
sys DOT dont_write_bytecode  EQUAL  True EOM
import sklearn as sk EOM
from sklearn DOT metrics import f1_score EOM
import keras as k EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import LSTM COMMA  Merge EOM
import dataset EOM
import ConfigParser EOM
if __name__  EQUAL  EQUAL  : EOM
cfg  EQUAL  ConfigParser DOT ConfigParser PARELEFT  PARERIGHT  EOM
dataset  EQUAL  \ EOM
dataset DOT DatasetProvider PARELEFT [] PARERIGHT  EOM
train_x COMMA  train_y  EQUAL  dataset DOT load PARELEFT cfg DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
test_x COMMA  test_y  EQUAL  dataset DOT load PARELEFT cfg DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
maxlen  EQUAL  max PARELEFT [] PARERIGHT  EOM
train_x  EQUAL  pad_sequences PARELEFT train_x COMMA  maxlen EQUAL  PARERIGHT  EOM
train_y  EQUAL  pad_sequences PARELEFT train_y COMMA  maxlen EQUAL  PARERIGHT  EOM
test_x  EQUAL  pad_sequences PARELEFT test_x COMMA  maxlen EQUAL  PARERIGHT  EOM
test_y  EQUAL  pad_sequences PARELEFT test_y COMMA  maxlen EQUAL  PARERIGHT  EOM
train_y  EQUAL   np DOT array PARELEFT [] PARERIGHT  EOM
test_y  EQUAL   np DOT array PARELEFT [] PARERIGHT  EOM
left  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
left DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  PARELEFT  PARERIGHT  COMMA utput_dim EQUAL  PARELEFT  PARERIGHT  COMMA input_length EQUAL  COMMA ropout EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
left DOT add PARELEFT LSTM PARELEFT cfg DOT getint PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA go_backwards EQUAL  COMMA pout_W  EQUAL  PARELEFT  PARERIGHT  COMMA pout_U  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
right  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
right DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  PARELEFT  PARERIGHT  COMMA utput_dim EQUAL  PARELEFT  PARERIGHT  COMMA input_length EQUAL  COMMA ropout EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
right DOT add PARELEFT LSTM PARELEFT cfg DOT getint PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA go_backwards EQUAL  COMMA pout_W  EQUAL  PARELEFT  PARERIGHT  COMMA pout_U  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT cfg DOT getfloat PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARELEFT  PARERIGHT  COMMA ho EQUAL  COMMA  epsilon EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT [] COMMA train_y COMMA b_epoch EQUAL  PARELEFT  PARERIGHT  COMMA atch_size EQUAL  PARELEFT  PARERIGHT  COMMA verbose EQUAL  COMMA validation_split EQUAL  PARERIGHT  EOM
distribution  EQUAL  \ EOM
model DOT predict PARELEFT [] COMMA atch_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
predictions  EQUAL  np DOT argmax PARELEFT distribution COMMA  axis EQUAL  PARERIGHT  EOM
gold  EQUAL  np DOT argmax PARELEFT test_y COMMA  axis EQUAL  PARERIGHT  EOM
total_labels  EQUAL  gold DOT shape[] * gold DOT shape[] EOM
predictions  EQUAL  predictions DOT reshape PARELEFT  PARERIGHT  EOM
gold  EQUAL  gold DOT reshape PARELEFT  PARERIGHT  EOM
label_f1  EQUAL  f1_score PARELEFT gold COMMA  predictions COMMA  average EQUAL  PARERIGHT  EOM
positive_class_index  EQUAL  1 EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM COMMA  Dropout EOM
from keras import backend as K EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
import tensorflow as tf EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
tensorboard  EQUAL  TensorBoard PARELEFT log_dir EQUAL  COMMA histogram_freq EQUAL  COMMA  write_graph EQUAL  COMMA  write_images EQUAL  PARERIGHT  EOM
rnn_history  EQUAL  LSTM_model DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA callbacks EQUAL [] COMMA validation_split EQUAL  PARERIGHT  EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def build_improved_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_basic_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT models import load_model EOM
import h5py EOM
from keras DOT callbacks import ModelCheckpoint EOM
y_train  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
x_train  EQUAL  np DOT load PARELEFT  PARERIGHT  EOM
in_shape  EQUAL  x_train DOT shape[] EOM
model   EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA input_shape EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y_train DOT shape[] COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARERIGHT  EOM
filepath  EQUAL  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT path COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
mini_batch_size  EQUAL  64 EOM
model DOT fit PARELEFT x_train COMMA y_train COMMA epochs EQUAL  COMMA verbose EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL  COMMA callbacks EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM EOM
from keras import backend as K EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
modelLSTM_2a  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM_2a DOT summary PARELEFT  PARERIGHT  EOM
modelLSTM_2a DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
tensorboard  EQUAL  TensorBoard PARELEFT log_dir EQUAL  COMMA histogram_freq EQUAL  COMMA  write_graph EQUAL  COMMA  write_images EQUAL  PARERIGHT  EOM
LSTM_history  EQUAL  modelLSTM_2a DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL  COMMA callbacks EQUAL [] EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM COMMA  Dropout EOM
from keras import backend as K EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
import tensorflow as tf EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
tensorboard  EQUAL  TensorBoard PARELEFT log_dir EQUAL  COMMA histogram_freq EQUAL  COMMA  write_graph EQUAL  COMMA  write_images EQUAL  PARERIGHT  EOM
rnn_history  EQUAL  LSTM_model DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA callbacks EQUAL [] COMMA validation_split EQUAL import os EOM
global_model_version  EQUAL  53 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
adam  EQUAL  keras DOT optimizers DOT Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from random import random EOM
from numpy import array EOM
from numpy import cumsum EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT layers import Bidirectional EOM
from keras DOT utils import np_utils EOM
from keras DOT layers import Embedding EOM
from keras DOT optimizers import SGD EOM
from keras DOT layers import Conv1D EOM
from keras DOT layers import MaxPooling1D EOM
import sys EOM
if __name__  EQUAL  EQUAL  : EOM
X  EQUAL  X DOT astype PARELEFT  PARERIGHT  EOM
y_init   EQUAL  np DOT genfromtxt PARELEFT  PARERIGHT  EOM
y  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
num_classes  EQUAL  y DOT shape[] EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 16 COMMA  128 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  SGD PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X COMMA  y COMMA validation_split EQUAL  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
X_test  EQUAL  np DOT genfromtxt PARELEFT sys DOT argv[] COMMA  delimiter EQUAL  PARERIGHT  EOM
X_test  EQUAL  X_test DOT astype PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np DOT genfromtxt PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np_utils DOT to_categorical PARELEFT  PARERIGHT  EOM
yhat  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
acc  EQUAL  0 DOT  EOM
count  EQUAL  0 EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
if  PARELEFT int PARELEFT np DOT argmax PARELEFT  PARERIGHT  PARERIGHT   EQUAL  PARELEFT np DOT argmax PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT : EOM
count+ EQUAL 1 EOM
acc  EQUAL  float PARELEFT  PARERIGHT  / len PARELEFT  PARERIGHT  EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT optimizers import Adam COMMA  RMSprop EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from keras DOT layers DOT convolutional import  PARELEFT  PARERIGHT  EOM
from collections import deque EOM
import sys EOM
class ResearchModels PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  nb_classes COMMA  model COMMA  seq_length COMMA aved_model EQUAL  COMMA  features_length EQUAL  PARERIGHT : EOM
self DOT seq_length  EQUAL  seq_length EOM
self DOT load_model  EQUAL  load_model EOM
self DOT saved_model  EQUAL  saved_model EOM
self DOT nb_classes  EQUAL  nb_classes EOM
self DOT feature_queue  EQUAL  deque PARELEFT  PARERIGHT  EOM
metrics  EQUAL  [] EOM
if self DOT saved_model is not None: EOM
self DOT model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
elif model  EQUAL  EQUAL  : EOM
self DOT input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
self DOT model  EQUAL  self DOT lstm PARELEFT  PARERIGHT  EOM
optimizer  EQUAL  Adam PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
self DOT model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL  PARERIGHT  EOM
def lstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def mlp PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def threedconvolution PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv3D PARELEFT 512 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling3D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import LSTM COMMA  Dense COMMA  Dropout COMMA  Input EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D COMMA  Flatten EOM
from keras DOT layers import concatenate EOM
from keras DOT layers import BatchNormalization EOM
from keras import optimizers EOM
class ThreeLayerLSTM PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  L1 EQUAL  COMMA  L2 EQUAL  COMMA  L3 EQUAL  COMMA  t EQUAL  COMMA um_classes EQUAL  COMMA  data_dim EQUAL  PARERIGHT : EOM
self DOT L1  EQUAL  L1 EOM
self DOT L2  EQUAL  L2 EOM
self DOT L3  EQUAL  L3 EOM
self DOT data_dim  EQUAL  data_dim EOM
self DOT t  EQUAL  t EOM
self DOT num_classes  EQUAL  num_classes EOM
def build_network PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT L1 COMMA  return_sequences EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA activation EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT L2 COMMA  return_sequences EQUAL  COMMA  activation EQUAL  COMMA dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT L3 COMMA  activation EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
class ThreeLayerLSTMandCNN PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT self COMMA  L1 EQUAL  COMMA  L2 EQUAL  COMMA  L3 EQUAL  COMMA  t EQUAL  COMMA _classes EQUAL  COMMA  data_dim EQUAL  COMMA  imgHeight EQUAL  COMMA  imgWidth EQUAL  PARERIGHT : EOM
self DOT L1  EQUAL  L1 EOM
self DOT L2  EQUAL  L2 EOM
self DOT L3  EQUAL  L3 EOM
self DOT data_dim  EQUAL  data_dim EOM
self DOT t  EQUAL  t EOM
self DOT num_classes  EQUAL  num_classes EOM
self DOT imgWidth  EQUAL  imgWidth EOM
self DOT imgHeight  EQUAL  imgHeight EOM
def build_network PARELEFT  PARERIGHT : EOM
temporal_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
temporal_model DOT add PARELEFT LSTM PARELEFT self DOT L1 COMMA  return_sequences EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA ctivation EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
temporal_model DOT add PARELEFT LSTM PARELEFT self DOT L2 COMMA  return_sequences EQUAL  COMMA ctivation EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
temporal_model DOT add PARELEFT LSTM PARELEFT self DOT L3 COMMA  activation EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
temporal_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
temporal_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
temporal_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
encoded_temp  EQUAL  temporal_model PARELEFT  PARERIGHT  EOM
spat_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
spat_model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT MaxPooling2D PARELEFT  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT Conv2D PARELEFT 128 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT MaxPooling2D PARELEFT  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  padding EQUAL  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT Conv2D PARELEFT 256 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT MaxPooling2D PARELEFT  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
spat_model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
spat_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
encoded_spat  EQUAL  spat_model PARELEFT  PARERIGHT  EOM
merged  EQUAL  concatenate PARELEFT  PARERIGHT  EOM
output  EQUAL  Dense PARELEFT self DOT num_classes COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT inputs EQUAL [] COMMA  outputs EQUAL  PARERIGHT  EOM
adam  EQUAL  optimizers DOT adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM COMMA  Dropout EOM
from time import time EOM
from keras DOT callbacks import TensorBoard EOM
import numpy as np EOM
from data import * EOM
import matplotlib DOT pyplot as plt EOM
def build_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT 120 COMMA eturn_sequences EQUAL  COMMA activation EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 80 COMMA return_sequences EQUAL  COMMA tivation  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 60 COMMA return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 20 COMMA return_sequences EQUAL  COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 10 COMMA activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
tensorboard  EQUAL  TensorBoard PARELEFT log_dir EQUAL  PARELEFT time PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  epochs EQUAL  COMMA tch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA erbose EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
vc COMMA  vl COMMA  rpm COMMA  va COMMA  ia  EQUAL  loadData PARELEFT  PARERIGHT  EOM
data  EQUAL  createFrames PARELEFT  PARERIGHT  EOM
x_train COMMA  x_test COMMA  y_train COMMA  y_test  EQUAL  dataPreparation PARELEFT  PARERIGHT  EOM
model  EQUAL  build_model PARELEFT  PARERIGHT  EOM
yhat  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
y_test  EQUAL  y_test DOT reshape PARELEFT len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Reshape COMMA  Merge COMMA  Dropout COMMA  Input COMMA  SimpleRNN EOM
from keras DOT layers DOT embeddings import Embedding EOM
from dictionary import Dictionary EOM
from constants import * EOM
from model_base import ModelBase EOM
class RNN PARELEFT  PARERIGHT : EOM
rnn_hiden_units  EQUAL  None EOM
deeper_lstm  EQUAL  None EOM
dropout  EQUAL  None EOM
recurrent_dropout  EQUAL  None EOM
def __init__ PARELEFT self COMMA  dictionary : Dictionary COMMA  question_maxlen EQUAL  COMMA  embedding_vector_length EQUAL  COMMA  visual_model EQUAL  COMMA  rnn_hidden_units  EQUAL  COMMA  dropout  EQUAL  COMMA  recurrent_dropout  EQUAL  COMMA  deeper_lstm  EQUAL  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
self DOT rnn_hiden_units  EQUAL  rnn_hidden_units EOM
self DOT deeper_lstm  EQUAL  deeper_lstm EOM
self DOT dropout  EQUAL  dropout EOM
self DOT recurrent_dropout  EQUAL  recurrent_dropout EOM
self DOT model_name  EQUAL   + str PARELEFT  PARERIGHT  +  + str PARELEFT  PARERIGHT  + EOM
self DOT model_type  EQUAL  EOM
def build_visual_model PARELEFT  PARERIGHT : EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_dimension  EQUAL  self DOT dictionary DOT pp_data DOT calculateImageDimension PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
language_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
language_model DOT add PARELEFT Embedding PARELEFT self DOT top_words COMMA  self DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT dictionary DOT max_labels COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def build_language_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT self DOT top_words COMMA  self DOT embedding_vector_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT self DOT rnn_hiden_units COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT self DOT dictionary DOT max_labels COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelimport numpy as np EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Embedding COMMA  LSTM COMMA  Bidirectional EOM
from keras DOT datasets import imdb EOM
from keras DOT callbacks import TensorBoard EOM
max_features  EQUAL  5000 EOM
no_classes  EQUAL  1 EOM
max_length  EQUAL  100 EOM
batch_size  EQUAL  32 EOM
embedding_size  EQUAL  64 EOM
dropout_rate  EQUAL  0 DOT 5 EOM
no_epochs  EQUAL  5 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
x_train  EQUAL  sequence DOT pad_sequences PARELEFT x_train COMMA  maxlen EQUAL  PARERIGHT  EOM
x_test  EQUAL  sequence DOT pad_sequences PARELEFT x_test COMMA  maxlen EQUAL  PARERIGHT  EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT max_features COMMA  embedding_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT no_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
tensorboard  EQUAL  TensorBoard PARELEFT  PARERIGHT  EOM
LSTM_model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  epochs EQUAL  COMMA  validation_data EQUAL [] COMMA  callbacks  EQUAL [] PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
Multilayer Perceptron  PARELEFT  PARERIGHT  for multi-class softmax classification EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT optimizers import SGD EOM
import numpy as np EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  np DOT random DOT randint PARELEFT 2 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
VGG-like convnet EOM
import numpy as np EOM
import keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD EOM
x_train  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_train  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
x_test  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y_test  EQUAL  keras DOT utils DOT to_categorical PARELEFT np DOT random DOT randint PARELEFT 10 COMMA  size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  num_classes EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 64 COMMA   PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  decay EQUAL  COMMA  momentum EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
Sequence classification with 1D convolutions EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Conv1D COMMA  GlobalAveragePooling1D COMMA  MaxPooling1D EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 64 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 128 COMMA  3 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GlobalAveragePooling1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
Sequence classification with LSTM EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT max_features COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT x_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  PARERIGHT  EOM
score  EQUAL  model DOT evaluate PARELEFT x_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
data_dim  EQUAL  16 EOM
timesteps  EQUAL  8 EOM
num_classes  EQUAL  10 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Activation EOM
from keras DOT utils import np_utils EOM
from keras DOT callbacks import ModelCheckpoint EOM
def LSTM_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 1024 COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 1024 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import Callback EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
def on_batch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def neural_net PARELEFT num_sensors COMMA  params COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT rams[] COMMA  init EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if load: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def lstm_net PARELEFT num_sensors COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT tput_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom __future__ import print_function EOM
import numpy as np EOM
from sklearn DOT metrics import  PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader1  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list1  EQUAL  list PARELEFT  PARERIGHT  EOM
testX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y1  EQUAL  testdata DOT iloc[] EOM
y_test1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
testX  EQUAL  sequence DOT pad_sequences PARELEFT testX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  2 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
import os EOM
for file in os DOT listdir PARELEFT  PARERIGHT : EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
y_pred  EQUAL  model DOT predict_classes PARELEFT  PARERIGHT  EOM
accuracy  EQUAL  accuracy_score PARELEFT  PARERIGHT  EOM
recall  EQUAL  recall_score PARELEFT y_test1 COMMA  y_pred  COMMA  average EQUAL  PARERIGHT  EOM
precision  EQUAL  precision_score PARELEFT y_test1 COMMA  y_pred  COMMA  average EQUAL  PARERIGHT  EOM
f1  EQUAL  f1_score PARELEFT y_test1 COMMA  y_pred COMMA  average EQUAL  PARERIGHT  EOM
from __future__ import division EOM
from __future__ import print_function EOM
import numpy as np EOM
from tensorflow DOT python DOT framework import test_util as tf_test_util EOM
from tensorflow DOT python DOT keras DOT _impl import keras EOM
from tensorflow DOT python DOT keras DOT _impl DOT keras import testing_utils EOM
from tensorflow DOT python DOT platform import test EOM
from tensorflow DOT python DOT training DOT rmsprop import RMSPropOptimizer EOM
class LSTMLayerTest PARELEFT  PARERIGHT : EOM
def test_return_sequences_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA return_sequences EOM
def test_static_shape_inference_LSTM PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
inputs  EQUAL  keras DOT layers DOT Dense PARELEFT embedding_dim COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
outputs  EQUAL  model DOT layers[] DOT output EOM
self DOT assertEquals PARELEFT outputs DOT get_shape PARELEFT  PARERIGHT  DOT as_list PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def test_dynamic_behavior_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT RMSPropOptimizer PARELEFT  PARERIGHT  COMMA   PARERIGHT  EOM
x  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_dropout_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA dropout: 0 DOT 1} COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_implementation_mode_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
for mode in []: EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA implementation EOM
def test_statefulness_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT 4 COMMA embedding_dim COMMA mask_zero EQUAL  COMMA input_length EQUAL  COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT ts COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  weights EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  PARERIGHT  EOM
out1  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT out1 DOT shape COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
out2  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out1 DOT max PARELEFT  PARERIGHT  COMMA  out2 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
out3  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out2 DOT max PARELEFT  PARERIGHT  COMMA  out3 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
out4  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out3 COMMA  out4 COMMA  atol EQUAL  PARERIGHT  EOM
out5  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out4 DOT max PARELEFT  PARERIGHT  COMMA  out5 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
left_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
left_padded_input[]  EQUAL  0 EOM
left_padded_input[]  EQUAL  0 EOM
out6  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
right_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
right_padded_input[]  EQUAL  0 EOM
right_padded_input[]  EQUAL  0 EOM
out7  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out7 COMMA  out6 COMMA  atol EQUAL  PARERIGHT  EOM
def test_regularizers_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  COMMA activity_regularizer EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  3 PARERIGHT  EOM
x  EQUAL  keras DOT backend DOT variable PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT layer DOT get_losses_for PARELEFT  PARERIGHT  PARERIGHT  COMMA  1 PARERIGHT  EOM
def test_constraints_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
k_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
r_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
b_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  COMMA recurrent_constraint EQUAL  COMMA bias_constraint EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
def test_with_masking_layer_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layer_class PARELEFT units EQUAL  COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_from_config_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
for stateful in  PARELEFT  PARERIGHT : EOM
l1  EQUAL  layer_class PARELEFT units EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
l2  EQUAL  layer_class DOT from_config PARELEFT l1 DOT get_config PARELEFT  PARERIGHT  PARERIGHT  EOM
assert l1 DOT get_config PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL         output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL [] PARERIGHT  EOM
else: EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_non_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [keras DOT backend DOT random_normal_variable PARELEFT  PARERIGHT  COMMA  0 COMMA  1 PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_reset_states_with_values PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  stateful EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
assert len PARELEFT  PARERIGHT   EQUAL  assert layer DOT states[] is not None EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT zeros PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
state_shapes  EQUAL  [] EOM
values  EQUAL  [] EOM
if len PARELEFT  PARERIGHT   EQUAL  values  EQUAL  values[] EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT ones PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
with self DOT assertRaises PARELEFT  PARERIGHT : EOM
layer DOT reset_states PARELEFT [] *  PARELEFT len PARELEFT  PARERIGHT  + 1 PARERIGHT  PARERIGHT  EOM
def test_specify_state_with_masking PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
_  EQUAL  keras DOT layers DOT Masking PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_return_state PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
state  EQUAL  outputs[] EOM
assert len PARELEFT  PARERIGHT   EQUAL       model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
state  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA  state COMMA  atol EQUAL  PARERIGHT  EOM
def test_state_reuse PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
output COMMA  state  EQUAL  outputs[] COMMA  outputs[] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT output COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
outputs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def test_initial_states_as_other_inputs PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
num_states  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
with self DOT test_session PARELEFT  PARERIGHT : EOM
main_inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
inputs  EQUAL  [] + initial_state EOM
layer  EQUAL  layer_class PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
main_inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
test DOT main PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense EOM
from keras DOT optimizers import RMSprop EOM
def lstm_basic PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT vocab_size COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def lstm_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA put_dim EQUAL  COMMA output_dim EQUAL  COMMA mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT vocab_size + 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT lr EQUAL  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
import keras EOM
from keras DOT layers import Dropout COMMA  LSTM COMMA  Dense COMMA  Activation EOM
from keras DOT models import Sequential EOM
from keras DOT regularizers import l2 EOM
from commons import * EOM
__author__  EQUAL  EOM
__version__  EQUAL  EOM
if __name__  EQUAL  EQUAL  : EOM
number_of_time_stamps  EQUAL  50 EOM
data  EQUAL  get_data_list_on_folder PARELEFT folder EQUAL  COMMA  complete_set EQUAL  PARERIGHT  EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT data COMMA  fold_size EQUAL  COMMA  time_steps EQUAL  PARERIGHT  EOM
hidden_neurons  EQUAL  64 EOM
batch_size  EQUAL  32 EOM
model_lstm  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_lstm DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  batch_input_shape EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model_lstm DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
predicted  EQUAL  model_lstm DOT predict PARELEFT  PARERIGHT  EOM
else: EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dense COMMA  Activation EOM
number_epochs  EQUAL  10 EOM
batch_size  EQUAL  1 EOM
verbose  EQUAL  2 EOM
step_size  EQUAL  1 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
def model2 PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT 	return_sequences EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def model1 PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT 	return_sequences EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
import soundlib EOM
X  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
filepath EQUAL  EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
model DOT fit PARELEFT X COMMA  y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  callbacks EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  46 EOM
global_batch_size  EQUAL  16 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import yaml EOM
import numpy as np EOM
import pandas as pd EOM
from sklearn DOT cross_validation import KFold EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  LSTM COMMA  Bidirectional COMMA  Convolution1D COMMA  MaxPooling1D EOM
from keras DOT layers DOT advanced_activations import PReLU EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping EOM
from sklearn DOT metrics import f1_score COMMA  confusion_matrix EOM
nfolds  EQUAL  10 EOM
nb_epoch  EQUAL  100 EOM
batch_size  EQUAL  512 EOM
nlabels  EQUAL  8 EOM
nb_filter  EQUAL  512 EOM
filter_length  EQUAL  5 EOM
lstm_timesteps  EQUAL  5 EOM
lstm_input_dim  EQUAL  50 EOM
lstm_units  EQUAL  150 EOM
cfg  EQUAL  yaml DOT load PARELEFT open PARELEFT  PARERIGHT  PARERIGHT  EOM
if cfg[]: EOM
lstm_timesteps  EQUAL  cfg[] EOM
if cfg[]: EOM
lstm_input_dim  EQUAL  cfg[] EOM
if cfg[]: EOM
nlabels  EQUAL  cfg[] EOM
def nn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT nb_filter EQUAL  COMMA filter_length EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT PReLU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT lstm_units COMMA  activation EQUAL  COMMA  inner_activation EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT nlabels COMMA  activation EQUAL  COMMA  init  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  optimizer  EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return PARELEFT  PARERIGHT  EOM
df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  COMMA  header  EQUAL  PARERIGHT  EOM
X  EQUAL  df DOT iloc[] DOT values EOM
X  EQUAL  X DOT reshape PARELEFT  PARERIGHT  DOT astype PARELEFT  PARERIGHT  EOM
y  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
folds  EQUAL  KFold PARELEFT len PARELEFT  PARERIGHT  COMMA  n_folds  EQUAL  COMMA  shuffle  EQUAL  PARERIGHT  EOM
currentFold  EQUAL  0 EOM
foldScores  EQUAL  [] EOM
for  PARELEFT  PARERIGHT  in folds: EOM
xtr  EQUAL  X[] EOM
ytr  EQUAL  y[] EOM
xte  EQUAL  X[] EOM
yte  EQUAL  y[] EOM
model  EQUAL  nn_model PARELEFT  PARERIGHT  EOM
callbacks  EQUAL  [] EOM
model DOT fit PARELEFT xtr COMMA  ytr COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA rbose EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA callbacks EQUAL  PARERIGHT  EOM
ypred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
ypred_max  EQUAL  ypred DOT argmax PARELEFT axis EQUAL  PARERIGHT  EOM
yte_max  EQUAL  yte DOT argmax PARELEFT axis EQUAL  PARERIGHT  EOM
score  EQUAL  f1_score PARELEFT yte_max COMMA  ypred_max COMMA  average  EQUAL  PARERIGHT  EOM
foldScores DOT append PARELEFT  PARERIGHT  EOM
currentFold + EQUAL  1 EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA  BatchNormalization EOM
from keras DOT layers import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT utils import np_utils EOM
from keras DOT optimizers import adagrad COMMA  adadelta EOM
from keras import regularizers EOM
from keras DOT layers import LSTM EOM
from keras DOT regularizers import l2 EOM
class LSTM_M2: EOM
def __init__ PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 1000 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 600 COMMA  dropout_W EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
self DOT Model  EQUAL  modelimport os EOM
global_model_version  EQUAL  47 EOM
global_batch_size  EQUAL  16 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import os EOM
global_model_version  EQUAL  50 EOM
global_batch_size  EQUAL  16 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_8 DOT add PARELEFT  PARERIGHT  EOM
branch_8 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_10 DOT add PARELEFT  PARERIGHT  EOM
branch_10 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import load_model EOM
import numpy as np EOM
import data_proc EOM
import os EOM
def lstm_with_generator PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit_generator PARELEFT data_proc DOT generator_from_path PARELEFT  COMMA  file_set  EQUAL [] PARERIGHT  COMMA  steps_per_epoch EQUAL  COMMA  epochs EQUAL  COMMA  validation_data  EQUAL  PARELEFT  PARERIGHT  COMMA  validation_steps  EQUAL  PARERIGHT  EOM
model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
res  EQUAL  model DOT evaluate_generator PARELEFT data_proc DOT generator_from_path PARELEFT  PARERIGHT  COMMA  steps EQUAL  PARERIGHT  EOM
def lstm_train PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  batch_size EQUAL  COMMA  epochs EQUAL  COMMA validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
res  EQUAL  model DOT evaluate PARELEFT X_test COMMA  Y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
def lstm_predict PARELEFT  PARERIGHT : EOM
model  EQUAL  load_model PARELEFT  PARERIGHT  EOM
return res EOM
if __name__ EQUAL  EQUAL : EOM
lstm_with_generator PARELEFT  PARERIGHT  EOM
from __future__ import absolute_import COMMA  division COMMA  print_function EOM
import tensorflow as tf EOM
from tensorflow import keras EOM
from keras DOT layers import LSTM EOM
def build_basic_model PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT Sequential PARELEFT [] PARERIGHT  EOM
optimizer  EQUAL  tf DOT train DOT RMSPropOptimizer PARELEFT learning_rate EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def build_lstm_model PARELEFT  PARERIGHT : EOM
model  EQUAL  keras DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT nn_nodes COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
optimizer  EQUAL  keras DOT optimizers DOT Adam PARELEFT lr EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
import json EOM
from collections import defaultdict EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT optimizers import SGD EOM
from keras DOT callbacks import LearningRateScheduler EOM
from keras DOT callbacks import EarlyStopping EOM
from keras DOT callbacks import ModelCheckpoint EOM
maxlen  EQUAL  50 EOM
PATH_PN  EQUAL  EOM
PATH_TOKENIZER  EQUAL  EOM
tokenizer  EQUAL  defaultdict PARELEFT  PARERIGHT  EOM
tokenizer DOT update PARELEFT json DOT load PARELEFT open PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
tokens  EQUAL  list PARELEFT set PARELEFT  PARERIGHT  PARERIGHT  EOM
token_min  EQUAL  min PARELEFT  PARERIGHT  EOM
token_max  EQUAL  max PARELEFT  PARERIGHT  EOM
def tokenize PARELEFT  PARERIGHT : EOM
return list PARELEFT map PARELEFT  PARERIGHT  PARERIGHT  EOM
pn  EQUAL  pd DOT read_csv PARELEFT  PARERIGHT  EOM
pn[]  EQUAL  pn[] DOT apply PARELEFT lambda line: list PARELEFT jieba DOT cut PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
pn[]  EQUAL  list PARELEFT sequence DOT pad_sequences PARELEFT pn[] COMMA  maxlen EQUAL  PARERIGHT  PARERIGHT  EOM
x  EQUAL  np DOT array PARELEFT list PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT list PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT name EQUAL  COMMA put_dim EQUAL  COMMA  output_dim EQUAL  COMMA  input_length EQUAL  COMMA  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
MODEL_LSTM_PATH  EQUAL  EOM
model_checkpoint_better_path  EQUAL  MODEL_LSTM_PATH + EOM
model_checkpoint_best_path  EQUAL  MODEL_LSTM_PATH + EOM
sgd  EQUAL  SGD PARELEFT lr EQUAL  COMMA  momentum EQUAL  COMMA  decay EQUAL  COMMA  nesterov EQUAL  PARERIGHT  EOM
early_stopping  EQUAL  EarlyStopping PARELEFT monitor EQUAL  COMMA  min_delta EQUAL  COMMA  mode EQUAL  COMMA  patience EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
checkpoint_better  EQUAL  ModelCheckpoint PARELEFT _checkpoint_better_path COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  COMMA   mode EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
checkpoint_best  EQUAL  ModelCheckpoint PARELEFT _checkpoint_best_path COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  COMMA   mode EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA   metrics EQUAL [] PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function  EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import Callback EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
def on_batch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def neural_net PARELEFT num_sensors COMMA  params COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT rams[] COMMA  init EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 3 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if load: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def lstm_net PARELEFT num_sensors COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT tput_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT models import Sequential EOM
def get_lstm PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT units[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_gru PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT GRU PARELEFT units[] COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def _get_sae PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT hidden COMMA  input_dim EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def get_saes PARELEFT  PARERIGHT : EOM
sae2  EQUAL  _get_sae PARELEFT  PARERIGHT  EOM
sae3  EQUAL  _get_sae PARELEFT  PARERIGHT  EOM
saes  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  input_dim EQUAL [] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
saes DOT add PARELEFT Dense PARELEFT layers[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
models  EQUAL  [] EOM
return modelsimport keras DOT backend as k EOM
from keras import layers EOM
from keras DOT layers import Input COMMA  Dense COMMA  Reshape COMMA  Flatten COMMA  Embedding COMMA  Dropout COMMA  LSTM EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
from keras DOT layers DOT convolutional import UpSampling2D COMMA  Conv2D EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT optimizers import Adam EOM
from keras DOT utils DOT generic_utils import Progbar EOM
import numpy as np EOM
import pickle EOM
import datetime EOM
from ml DOT public import * EOM
def ann_build_generator PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  activation EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  activation EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  activation EQUAL  COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
def ann_train_test PARELEFT  PARERIGHT : EOM
st  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
model  EQUAL  ann_build_generator PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as handle: EOM
pickle DOT dump PARELEFT model COMMA  handle COMMA  protocol EQUAL  PARERIGHT  EOM
Y_pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
tp COMMA  tn COMMA  fp COMMA  fn  EQUAL  pred_test_lstm PARELEFT  PARERIGHT  EOM
ed  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
return  + gen_result_line PARELEFT  PARERIGHT  EOM
def dnn_build_generator PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 20 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 20 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 10 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  input_dim EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def dnn_train_test PARELEFT  PARERIGHT : EOM
st  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
model  EQUAL  dnn_build_generator PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  Y_train COMMA  epochs EQUAL  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as handle: EOM
pickle DOT dump PARELEFT model COMMA  handle COMMA  protocol EQUAL  PARERIGHT  EOM
Y_pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
tp COMMA  tn COMMA  fp COMMA  fn  EQUAL  pred_test_lstm PARELEFT  PARERIGHT  EOM
ed  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
return  + gen_result_line PARELEFT  PARERIGHT  EOM
def lstm_build_generator PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_build_generator2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def lstm_data_gen PARELEFT  PARERIGHT : EOM
n_X_train  EQUAL  [] EOM
cur_X_train  EQUAL  [] EOM
n_Y_train  EQUAL  [] EOM
cur_Y_train  EQUAL  [] EOM
for i in range PARELEFT cnt COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
n_X_train DOT append PARELEFT  PARERIGHT  EOM
n_Y_train DOT append PARELEFT  PARERIGHT  EOM
return np DOT array PARELEFT  PARERIGHT  COMMA  np DOT array PARELEFT  PARERIGHT  EOM
def lstm_train_test PARELEFT  PARERIGHT : EOM
st  EQUAL  datetime DOT datetime DOT now PARELEFT  PARERIGHT  EOM
model  EQUAL  lstm_build_generator PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
n_X_train COMMA  n_Y_train  EQUAL  lstm_data_gen PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT n_X_train COMMA  n_Y_train COMMA  epochs EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
n_X_test COMMA  n_Y_test  EQUAL  lstm_data_gen PARELEFT  PARERIGHT  EOM
Y_pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
tp COMMA  tn COMMA  fp COMMA  fn  EQUAL  pred_test_lstm PARELEFT  PARERIGHT  EOM
return  + gen_result_line PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import LSTM COMMA  Dense EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
import numpy as np EOM
import time EOM
import csv EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout COMMA Merge EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
import copy EOM
data_dim  EQUAL  1 EOM
timesteps  EQUAL  13 EOM
model_A  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_B  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_Combine  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
lstm_hidden_size  EQUAL  [] EOM
drop_out_rate  EQUAL  [] EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT LSTM PARELEFT lstm_hidden_size[] COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_A DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
in_dimension  EQUAL  3 EOM
nn_hidden_size  EQUAL  [] EOM
nn_drop_rate  EQUAL  [] EOM
model_B DOT add PARELEFT Dense PARELEFT nn_hidden_size[] COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model_B DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model_Combine DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
from keras DOT utils DOT visualize_util import plot COMMA  to_graph EOM
graph  EQUAL  to_graph PARELEFT model_Combine COMMA  show_shape EQUAL  PARERIGHT  EOM
graph DOT write_png PARELEFT  PARERIGHT from utility DOT enums import Processor COMMA  RnnType EOM
def CreateModel PARELEFT  PARERIGHT : EOM
keras_impl  EQUAL  __getKerasImplementation PARELEFT  PARERIGHT  EOM
if PARELEFT args[]  EQUAL  PARERIGHT : EOM
else: EOM
if args[]  EQUAL  EQUAL  RnnType DOT LSTM : EOM
if args[]  EQUAL  EQUAL  Processor DOT GPU and args[]  EQUAL  EQUAL  True: EOM
return __createCUDNN_LSTM_Stateless PARELEFT  PARERIGHT  EOM
else: EOM
return __createLSTM_Stateless PARELEFT  PARERIGHT  EOM
elif args[]  EQUAL  EQUAL  RnnType DOT GRU: EOM
if args[]  EQUAL  EQUAL  Processor DOT GPU and args[]  EQUAL  EQUAL  True: EOM
return __createCUDNN_GRU_Stateless PARELEFT  PARERIGHT  EOM
else: EOM
return __createGRU_Stateless PARELEFT  PARERIGHT  EOM
elif args[]  EQUAL  EQUAL  RnnType DOT RNN: EOM
return __createRNN_Stateless PARELEFT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT  PARERIGHT  EOM
def CreateCallbacks PARELEFT  PARERIGHT : EOM
callbacks  EQUAL  [] EOM
keras_impl  EQUAL  __getKerasImplementation PARELEFT  PARERIGHT  EOM
callbacks DOT append PARELEFT keras_impl DOT callbacks DOT EarlyStopping PARELEFT monitor EQUAL  COMMA  patience EQUAL [] PARERIGHT  PARERIGHT  EOM
if PARELEFT args[]  EQUAL  PARERIGHT : EOM
callbacks DOT append PARELEFT keras_impl DOT callbacks DOT ModelCheckpoint PARELEFT args[] COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  save_weights_only EQUAL  COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
if PARELEFT args[] ! EQUAL  PARERIGHT : EOM
callbacks DOT append PARELEFT keras_impl DOT callbacks DOT ReduceLROnPlateau PARELEFT monitor EQUAL  COMMA  factor EQUAL  COMMA  patience EQUAL [] COMMA  verbose EQUAL  COMMA  mode EQUAL  COMMA  min_delta EQUAL  COMMA  cooldown EQUAL  COMMA  min_lr EQUAL  PARERIGHT  PARERIGHT  EOM
callbacks DOT append PARELEFT keras_impl DOT callbacks DOT CSVLogger PARELEFT  DOT format PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  True: EOM
callsbacks DOT append PARELEFT tensorboard_cb  EQUAL  PARELEFT log_dir EQUAL  COMMA  histogram_freq EQUAL  COMMA  write_graph EQUAL  COMMA  write_images EQUAL  PARERIGHT  PARERIGHT  EOM
return callbacks EOM
def CreateOptimizer PARELEFT  PARERIGHT : EOM
if args[]  EQUAL  EQUAL  Processor DOT TPU: EOM
import tensorflow as tf EOM
return tf DOT contrib DOT opt DOT NadamOptimizer PARELEFT learning_rate EQUAL [] COMMA  beta1 EQUAL  COMMA  beta2 EQUAL  COMMA  epsilon EQUAL  PARERIGHT  EOM
else: EOM
return keras_impl DOT optimizers DOT Nadam PARELEFT lr EQUAL [] COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  COMMA  epsilon EQUAL  COMMA  schedule_decay EQUAL  COMMA  clipvalue EQUAL [] PARERIGHT  EOM
def __getKerasImplementation PARELEFT  PARERIGHT : EOM
if PARELEFT processor  EQUAL  PARERIGHT : EOM
import tensorflow EOM
from tensorflow DOT python import keras as keras_impl EOM
else: EOM
import keras as keras_impl EOM
return keras_impl EOM
def __createCUDNN_LSTM_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA  return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNLSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def __createLSTM_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT LSTM PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def __createCUDNN_GRU_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT CuDNNGRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def __createGRU_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT GRU PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def __createRNN_Stateless PARELEFT  PARERIGHT : EOM
model  EQUAL  keras_impl DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
if args[]  EQUAL  EQUAL  1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
if args[] > 1: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA input_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
if i  EQUAL  EQUAL  args[] - 2: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
else: EOM
if args[]  EQUAL  EQUAL  True: EOM
model DOT add PARELEFT keras_impl DOT layers DOT Bidirectional PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT keras_impl DOT layers DOT SimpleRNN PARELEFT args[] COMMA return_sequences EQUAL  COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT keras_impl DOT layers DOT Dense PARELEFT 1 COMMA  kernel_initializer EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  CreateOptimizer PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelimport os EOM
global_model_version  EQUAL  42 EOM
global_batch_size  EQUAL  32 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT recurrent import SimpleRNN  COMMA  LSTM EOM
from keras DOT optimizers import SGD  COMMA  Adagrad EOM
def keras_model PARELEFT  batch_dim  COMMA  image_vector EQUAL  COMMA  word_vector EQUAL  PARERIGHT : EOM
batch_dim  EQUAL  30 EOM
LSTM_layers  EQUAL  1 EOM
LSTM_units   EQUAL  300 EOM
DNN_units    EQUAL  [] EOM
question_LSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_q  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
question_LSTM DOT add PARELEFT  PARERIGHT  EOM
question_LSTM DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_1  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_1  EQUAL  LSTM PARELEFT output_dim EQUAL  PARERIGHT  EOM
opt_LSTM_1 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_1 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_2  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_2  EQUAL  LSTM PARELEFT output_dim EQUAL  PARERIGHT  EOM
opt_LSTM_2 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_2 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_3  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_3  EQUAL  LSTM PARELEFT output_dim EQUAL  PARERIGHT  EOM
opt_LSTM_3 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_3 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_4  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_4  EQUAL  LSTM PARELEFT output_dim EQUAL  PARERIGHT  EOM
opt_LSTM_4 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_4 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
layer_Mask_5  EQUAL  Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer_LSTM_5  EQUAL  LSTM PARELEFT output_dim EQUAL  PARERIGHT  EOM
opt_LSTM_5 DOT add PARELEFT  PARERIGHT  EOM
opt_LSTM_5 DOT add PARELEFT  PARERIGHT  EOM
image_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
image_model DOT add PARELEFT Reshape PARELEFT input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  dims  EQUAL  PARELEFT  PARERIGHT   PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  ode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
layer_pre_DNN  EQUAL  Dense PARELEFT DNN_units[]  COMMA  init  EQUAL  PARERIGHT  EOM
layer_pre_DNN_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_pre_DNN_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_DNN_1  EQUAL  Dense PARELEFT DNN_units[]  COMMA  init  EQUAL  PARERIGHT  EOM
layer_DNN_1_act  EQUAL  Activation PARELEFT  PARERIGHT  EOM
layer_DNN_1_dro  EQUAL  Dropout PARELEFT p EQUAL  PARERIGHT  EOM
layer_softmax  EQUAL  Activation PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
X  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
Y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
my_model  EQUAL  keras_model PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout COMMA  Highway EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense COMMA  Embedding EOM
def model PARELEFT  PARERIGHT : EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT Embedding PARELEFT args DOT vocabulary_size COMMA  args DOT word_emb_dim COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT args DOT num_hidden_units_lstm COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for i in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
numpy DOT random DOT seed PARELEFT  PARERIGHT  EOM
top_words  EQUAL  5000 EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT num_words EQUAL  PARERIGHT  EOM
max_review_length  EQUAL  500 EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
embedding_vecor_length  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
import numpy EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
max_epoch  EQUAL  100 EOM
features  EQUAL  32 EOM
MAX_FEATURE_LEN  EQUAL  32 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 30 COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
X  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
Y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X2  EQUAL  np DOT reshape PARELEFT X COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
Y2  EQUAL  np DOT reshape PARELEFT Y COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X2 COMMA  Y2 COMMA  validation_split EQUAL  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
plt DOT subplot PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT ylabel PARELEFT  PARERIGHT  EOM
plt DOT xlabel PARELEFT  PARERIGHT  EOM
plt DOT legend PARELEFT [] COMMA  loc EQUAL  PARERIGHT  EOM
plt DOT grid PARELEFT  COMMA  linestyle EQUAL  COMMA  color EQUAL  PARERIGHT  EOM
plt DOT xlim PARELEFT  PARERIGHT  EOM
plt DOT ylim PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Embedding COMMA  LSTM COMMA  Dense COMMA  Dropout COMMA  Bidirectional COMMA  TimeDistributed COMMA  Activation COMMA  Convolution1D COMMA MaxPool1D COMMA  GRU COMMA  Permute COMMA  Reshape COMMA  Lambda COMMA  RepeatVector COMMA  merge COMMA  K EOM
from keras DOT models import Model EOM
from keras DOT preprocessing import sequence EOM
use_dropout  EQUAL  True EOM
def LSTM_Model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def LSTM2Layer_Model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def BiLSTM_Model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def CLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT 128 COMMA  3 COMMA  padding EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def CBiLSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution1D PARELEFT 128 COMMA  3 COMMA  padding EQUAL  COMMA  strides EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT hidden_size COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
if use_dropout: EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
CBiLSTM PARELEFT  PARERIGHT from __future__ import print_function EOM
from keras DOT models import Sequential COMMA  Graph EOM
from keras DOT layers DOT core import Dense COMMA  TimeDistributedDense COMMA  Dropout EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
class nntools PARELEFT  PARERIGHT : EOM
def get_current_model PARELEFT  PARERIGHT : EOM
return nntools DOT build_lstm_network PARELEFT  PARERIGHT  EOM
def build_lstm_network PARELEFT freq_dim COMMA  hidden_dim EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributedDense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_bidirectional_lstm_network PARELEFT freq_dim COMMA  hidden_dim EQUAL  PARERIGHT : EOM
model  EQUAL  Graph PARELEFT  PARERIGHT  EOM
model DOT add_input PARELEFT name EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add_node PARELEFT Embedding PARELEFT freq_dim COMMA  128 COMMA  input_shape EQUAL  PARERIGHT  COMMA  input EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT LSTM PARELEFT  PARERIGHT  COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT LSTM PARELEFT hidden_dim COMMA  go_backwards EQUAL  PARERIGHT  COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
model DOT add_node PARELEFT Dropout PARELEFT  PARERIGHT  COMMA  name EQUAL  COMMA  inputs EQUAL [] PARERIGHT  EOM
model DOT add_node PARELEFT Dense PARELEFT freq_dim COMMA  activation EQUAL  PARERIGHT  COMMA  name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
model DOT add_output PARELEFT name EQUAL  COMMA  input EQUAL  PARERIGHT  EOM
return modelfrom keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import LSTM COMMA  Embedding COMMA  Dense EOM
from keras DOT optimizers import Adam EOM
def _lstm_model PARELEFT  PARERIGHT : EOM
output_dim  EQUAL  16 EOM
optimizer  EQUAL  Adam PARELEFT lr  EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT output_dim COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 9 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  optimizer  EQUAL  COMMA  metrics  EQUAL [] PARERIGHT  EOM
return model EOM
def _tokenizer_model PARELEFT  PARERIGHT : EOM
output_dim  EQUAL  32 EOM
optimizer  EQUAL  Adam PARELEFT lr  EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim COMMA  output_dim COMMA  input_length  EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT output_dim COMMA  return_sequences  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 9 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss  EQUAL  COMMA  optimizer  EQUAL  COMMA  metrics  EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Flatten COMMA  RepeatVector EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Convolution2D COMMA  MaxPooling2D EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers DOT wrappers import TimeDistributed EOM
from util import categorical_accuracy_per_sequence EOM
from keras DOT regularizers import l2 EOM
def build_CNN_LSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 64 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  COMMA  activation EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT mode EQUAL  COMMA  axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 64 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT mode EQUAL  COMMA  axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 128 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT mode EQUAL  COMMA  axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Convolution2D PARELEFT 128 COMMA  3 COMMA  3 COMMA  border_mode EQUAL  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT mode EQUAL  COMMA  axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  COMMA  strides EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
a  EQUAL  model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT RepeatVector PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT nb_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] COMMA sample_weight_mode EQUAL  PARERIGHT  EOM
return modelimport tensorflow as tf EOM
import numpy as np EOM
def network_model PARELEFT inputs COMMA  num_pitch COMMA  weights_file EQUAL  PARERIGHT : EOM
model  EQUAL  tf DOT keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import Callback EOM
import tensorflow as tf EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
def on_batch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def neural_net PARELEFT num_sensors COMMA  params COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if load: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
import pandas as pd EOM
import numpy as np EOM
import os EOM
from keras DOT models import load_model EOM
import math EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import GRU EOM
from keras DOT layers import ConvLSTM2D EOM
from keras DOT layers import Conv2D EOM
from keras DOT layers import Reshape EOM
from keras DOT layers import Conv1D EOM
from keras DOT layers import Multiply EOM
from keras DOT layers import Input EOM
from keras import Model EOM
from sklearn import preprocessing EOM
from sklearn import metrics EOM
from sklearn DOT metrics import mean_absolute_error EOM
from sklearn import svm EOM
import xgboost as xgb EOM
import data_processing EOM
os DOT chdir PARELEFT  PARERIGHT  EOM
string EQUAL [] EOM
class Price_prediction: EOM
def read_data PARELEFT  PARERIGHT : EOM
data  EQUAL  pd DOT read_csv PARELEFT  PARERIGHT  EOM
return data EOM
def load_data PARELEFT  PARERIGHT : EOM
data  EQUAL  self DOT read_data PARELEFT  PARERIGHT  EOM
data  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
train_data  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for row in data: EOM
cut_data  EQUAL  row[] EOM
train_data  EQUAL  np DOT vstack PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
return train_data EOM
y  EQUAL  data_processing DOT close_price PARELEFT  PARERIGHT  EOM
r  EQUAL  len PARELEFT  PARERIGHT  // 10 EOM
c  EQUAL  0 EOM
train_input  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
for u in range PARELEFT  PARERIGHT : EOM
t  EQUAL  x[][] EOM
if x[][] ! EQUAL  0: EOM
s  EQUAL  t / x[][] EOM
else: EOM
s  EQUAL  1 EOM
s  EQUAL  s - 1 EOM
train_input[][][]  EQUAL  s EOM
test_input  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  - 2 * win - r * p COMMA  win COMMA  x DOT shape[] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT r * p + win COMMA  len PARELEFT  PARERIGHT  - win PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
for u in range PARELEFT  PARERIGHT : EOM
t  EQUAL  x[][] EOM
if x[][] ! EQUAL  0: EOM
s  EQUAL  t / x[][] EOM
else: EOM
s  EQUAL  1 EOM
s  EQUAL  s - 1 EOM
test_input[][][]  EQUAL  s EOM
c  EQUAL  c + 1 EOM
z  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - win PARERIGHT : EOM
z[][]  EQUAL  y[][] / y[][] - 1 EOM
train_output  EQUAL  z[] EOM
test_output  EQUAL  z[] EOM
trainx  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  win * x DOT shape[] PARERIGHT  PARERIGHT  EOM
testx  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  win * x DOT shape[] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
trainx[]  EQUAL  train_input[] DOT flatten PARELEFT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
testx[]  EQUAL  test_input[] DOT flatten PARELEFT  PARERIGHT  EOM
return trainx COMMA  testx COMMA  train_output COMMA  test_output EOM
y  EQUAL  data_processing DOT close_price PARELEFT  PARERIGHT  EOM
r  EQUAL  len PARELEFT  PARERIGHT  // 10 EOM
c  EQUAL  0 EOM
train_input  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
for u in range PARELEFT  PARERIGHT : EOM
t  EQUAL  x[][] EOM
if x[][] ! EQUAL  0: EOM
s  EQUAL  t / x[][] EOM
else: EOM
s  EQUAL  1 EOM
s  EQUAL  s - 1 EOM
train_input[][][]  EQUAL  s EOM
test_input  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  - 2 * win - r * p COMMA  win COMMA  x DOT shape[] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT r * p + win COMMA  len PARELEFT  PARERIGHT  - win PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
for u in range PARELEFT  PARERIGHT : EOM
t  EQUAL  x[][] EOM
if x[][] ! EQUAL  0: EOM
s  EQUAL  t / x[][] EOM
else: EOM
s  EQUAL  1 EOM
s  EQUAL  s - 1 EOM
test_input[][][]  EQUAL  s EOM
c  EQUAL  c + 1 EOM
z  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - win PARERIGHT : EOM
z[][]  EQUAL  y[][] / y[][] - 1 EOM
train_output  EQUAL  z[] EOM
test_output  EQUAL  z[] EOM
trainx  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  win * x DOT shape[] PARERIGHT  PARERIGHT  EOM
testx  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  win * x DOT shape[] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
trainx[]  EQUAL  train_input[] DOT flatten PARELEFT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  PARERIGHT : EOM
testx[]  EQUAL  test_input[] DOT flatten PARELEFT  PARERIGHT  EOM
return trainx COMMA  testx COMMA  train_output COMMA  test_output EOM
y  EQUAL  data_processing DOT close_price PARELEFT  PARERIGHT  EOM
r  EQUAL  len PARELEFT  PARERIGHT  EOM
c  EQUAL  0 EOM
train_input  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
for u in range PARELEFT  PARERIGHT : EOM
t  EQUAL  x[][] EOM
if x[][] ! EQUAL  0: EOM
s  EQUAL  t / x[][] EOM
else: EOM
s  EQUAL  1 EOM
s  EQUAL  s - 1 EOM
train_input[][][]  EQUAL  s EOM
test_input  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  - 2 * win - r * p COMMA  win COMMA  x DOT shape[] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT r * p + win COMMA  len PARELEFT  PARERIGHT  - win PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
for u in range PARELEFT  PARERIGHT : EOM
t  EQUAL  x[][] EOM
if x[][] ! EQUAL  0: EOM
s  EQUAL  t / x[][] EOM
else: EOM
s  EQUAL  1 EOM
s  EQUAL  s - 1 EOM
test_input[][][]  EQUAL  s EOM
c  EQUAL  c + 1 EOM
z  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - win PARERIGHT : EOM
z[][]  EQUAL  y[][] / y[][] - 1 EOM
train_output  EQUAL  z[] EOM
test_output  EQUAL  z[] EOM
return train_input COMMA  test_input COMMA  train_output COMMA  test_output EOM
y  EQUAL  data_processing DOT close_price PARELEFT  PARERIGHT  EOM
r  EQUAL  len PARELEFT  PARERIGHT  // 10 EOM
c  EQUAL  0 EOM
train_input  EQUAL  np DOT zeros PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
for u in range PARELEFT  PARERIGHT : EOM
t  EQUAL  x[][] EOM
if x[][] ! EQUAL  0: EOM
s  EQUAL  t / x[][] EOM
else: EOM
s  EQUAL  1 EOM
s  EQUAL  s - 1 EOM
train_input[][][]  EQUAL  s EOM
test_input  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  - 2 * win - r * p COMMA  win COMMA  x DOT shape[] PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT r * p + win COMMA  len PARELEFT  PARERIGHT  - win PARERIGHT : EOM
for j in range PARELEFT  PARERIGHT : EOM
for u in range PARELEFT  PARERIGHT : EOM
t  EQUAL  x[][] EOM
if x[][] ! EQUAL  0: EOM
s  EQUAL  t / x[][] EOM
else: EOM
s  EQUAL  1 EOM
s  EQUAL  s - 1 EOM
test_input[][][]  EQUAL  s EOM
c  EQUAL  c + 1 EOM
z  EQUAL  np DOT zeros PARELEFT  PARELEFT len PARELEFT  PARERIGHT  COMMA  1 PARERIGHT  PARERIGHT  EOM
for i in range PARELEFT 0 COMMA  len PARELEFT  PARERIGHT  - win PARERIGHT : EOM
z[][]  EQUAL  y[][] / y[][] - 1 EOM
train_output  EQUAL  z[] EOM
test_output  EQUAL  z[] EOM
return train_input COMMA  test_input COMMA  train_output COMMA  test_output EOM
def LSTM_model PARELEFT self COMMA inputs COMMA  activ_func EQUAL  COMMA opout EQUAL  COMMA  loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def GRU PARELEFT self COMMA traini COMMA  act EQUAL  COMMA  dropout EQUAL  COMMA  loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def DEEPSENSE PARELEFT self COMMA traini COMMA  act EQUAL  COMMA  dropout EQUAL  COMMA  loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 16 COMMA   PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA data_format EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 8 COMMA  3 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def DEEPSENSE2 PARELEFT self COMMA traini COMMA  act EQUAL  COMMA  dropout EQUAL  COMMA  loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT : EOM
inputs  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x  EQUAL  Conv2D PARELEFT 16 COMMA   PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA dding EQUAL  COMMA  data_format EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
y1  EQUAL  Conv2D PARELEFT 16 COMMA   PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA dding EQUAL  COMMA  data_format EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
y2  EQUAL  Conv2D PARELEFT 16 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
y3  EQUAL  Conv2D PARELEFT 16 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
y  EQUAL  Conv2D PARELEFT 16 COMMA   PARELEFT  PARERIGHT  COMMA  padding EQUAL  COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
out  EQUAL  Multiply PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
models  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT 8 COMMA  3 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
dtrain  EQUAL  xgb DOT DMatrix PARELEFT traini COMMA  label EQUAL  PARERIGHT  EOM
dtest  EQUAL  xgb DOT DMatrix PARELEFT  PARERIGHT  EOM
bst  EQUAL  xgb DOT XGBRegressor PARELEFT base_score EQUAL  COMMA  colsample_bylevel EQUAL  COMMA  colsample_bytree EQUAL  COMMA ma EQUAL  COMMA  learning_rate EQUAL  COMMA  max_delta_step EQUAL  COMMA  max_depth EQUAL  COMMA _child_weight EQUAL  COMMA  missing EQUAL  COMMA  n_estimators EQUAL  COMMA  nthread EQUAL  COMMA jective EQUAL  COMMA  reg_alpha EQUAL  COMMA  reg_lambda EQUAL  COMMA le_pos_weight EQUAL  COMMA  seed EQUAL  COMMA  silent EQUAL  COMMA  subsample EQUAL  PARERIGHT  EOM
bst DOT fit PARELEFT traini COMMA  traino COMMA  verbose EQUAL  PARERIGHT  EOM
pred  EQUAL  bst DOT predict PARELEFT  PARERIGHT  EOM
plt DOT figure PARELEFT figsize EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT plot PARELEFT testo COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT pred COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
clf  EQUAL  svm DOT SVR PARELEFT  PARERIGHT  EOM
clf DOT fit PARELEFT  PARERIGHT  EOM
pred  EQUAL  clf DOT predict PARELEFT  PARERIGHT  EOM
plt DOT figure PARELEFT figsize EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT plot PARELEFT testo COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT pred COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
def LSTM_RUN PARELEFT  PARERIGHT : EOM
nn_model  EQUAL  self DOT LSTM_model PARELEFT  PARERIGHT  EOM
nn_history  EQUAL  nn_model DOT fit PARELEFT train_input COMMA  train_output COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
plt DOT figure PARELEFT figsize EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT plot PARELEFT test_output COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT nn_model DOT predict PARELEFT  PARERIGHT  COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
MAE  EQUAL  mean_absolute_error PARELEFT test_output COMMA  nn_model DOT predict PARELEFT  PARERIGHT  PARERIGHT  EOM
def GRU_RUN PARELEFT self COMMA name COMMA  traini COMMA  traino COMMA  testi COMMA  testo COMMA  neurons COMMA  epoch COMMA  batch COMMA  act EQUAL  COMMA  dropout EQUAL  COMMA  loss EQUAL  COMMA optimizer EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT neurons COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT traini COMMA  traino COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
plt DOT figure PARELEFT figsize EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT plot PARELEFT testo COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT pred COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
def DEEPSENSE_RUN PARELEFT self COMMA traini COMMA  traino COMMA  testi COMMA  testo COMMA  epochs COMMA  batch COMMA  act EQUAL  COMMA  dropout EQUAL  COMMA  loss EQUAL  COMMA optimizer EQUAL  PARERIGHT : EOM
model  EQUAL  self DOT DEEPSENSE PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT traini COMMA  traino COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
plt DOT figure PARELEFT figsize EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT plot PARELEFT testo COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT pred COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
MAE  EQUAL  mean_absolute_error PARELEFT  PARERIGHT  EOM
def DEEPSENSE2_RUN PARELEFT self COMMA traini COMMA  traino COMMA  testi COMMA  testo COMMA  epochs COMMA  batch COMMA  act EQUAL  COMMA  dropout EQUAL  COMMA  loss EQUAL  COMMA optimizer EQUAL  PARERIGHT : EOM
model  EQUAL  self DOT DEEPSENSE2 PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT traini COMMA  traino COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
pred  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
plt DOT figure PARELEFT figsize EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT plot PARELEFT testo COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT pred COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
plt DOT show PARELEFT  PARERIGHT  EOM
MAE  EQUAL  mean_absolute_error PARELEFT  PARERIGHT  EOM
def LSTM_model_stacking PARELEFT self COMMA inputs COMMA  activ_func EQUAL  COMMA opout EQUAL  COMMA  loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def stacking_pre PARELEFT self COMMA trainic COMMA trainoc COMMA batch  EQUAL  PARERIGHT : EOM
epochs  EQUAL  500 EOM
lstm  EQUAL  self DOT LSTM_model_stacking PARELEFT  PARERIGHT  EOM
cnn_lstm  EQUAL  self DOT DEEPSENSE PARELEFT  PARERIGHT  EOM
cnn_am_lstm  EQUAL  self DOT DEEPSENSE2 PARELEFT  PARERIGHT  EOM
lstm DOT fit PARELEFT trainic COMMA  trainoc COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
cnn_lstm DOT fit PARELEFT trainic COMMA  trainoc COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
cnn_am_lstm DOT fit PARELEFT trainic COMMA  trainoc COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
lstm DOT save_weights PARELEFT  PARERIGHT  EOM
cnn_lstm DOT save_weights PARELEFT  PARERIGHT  EOM
cnn_am_lstm DOT save_weights PARELEFT  PARERIGHT  EOM
lstm_model  EQUAL  self DOT LSTM_model PARELEFT  PARERIGHT  EOM
cnn_lstm_model  EQUAL  self DOT DEEPSENSE PARELEFT  PARERIGHT  EOM
cnn_am_lstm_model  EQUAL  self DOT DEEPSENSE2 PARELEFT  PARERIGHT  EOM
lstm_model DOT load_weights PARELEFT  PARERIGHT  EOM
cnn_lstm_model DOT load_weights PARELEFT  PARERIGHT  EOM
cnn_am_lstm_model DOT load_weights PARELEFT  PARERIGHT  EOM
models  EQUAL  [] EOM
return models EOM
def stacking PARELEFT  PARERIGHT : EOM
outputs  EQUAL  [] for model in models] EOM
y  EQUAL  np DOT mean PARELEFT  PARERIGHT [] EOM
model  EQUAL  Model PARELEFT inputs EQUAL  COMMA  outputs EQUAL  PARERIGHT  EOM
return model EOM
import itertools EOM
import unittest EOM
import numpy as np EOM
import os COMMA  shutil EOM
import tempfile EOM
import pytest EOM
from coremltools DOT _deps import HAS_KERAS_TF EOM
from coremltools DOT models DOT utils import macos_version EOM
if HAS_KERAS_TF: EOM
import keras DOT backend EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Dense COMMA  Activation COMMA  Convolution2D COMMA  AtrousConvolution2D COMMA  LSTM COMMA  ZeroPadding2D COMMA  Deconvolution2D COMMA  Permute COMMA  Convolution1D COMMA  AtrousConvolution1D COMMA  MaxPooling2D COMMA  AveragePooling2D COMMA  Flatten COMMA  Dropout COMMA  UpSampling2D COMMA  merge COMMA  Merge COMMA  Input COMMA  GRU COMMA  GlobalMaxPooling2D COMMA  GlobalMaxPooling1D COMMA  GlobalAveragePooling2D COMMA  GlobalAveragePooling1D COMMA Cropping1D COMMA  Cropping2D COMMA  Reshape COMMA  AveragePooling1D COMMA  MaxPooling1D COMMA  RepeatVector COMMA  ELU COMMA SimpleRNN COMMA  BatchNormalization COMMA  Embedding COMMA  ZeroPadding1D COMMA  UpSampling1D EOM
from keras DOT layers DOT wrappers import Bidirectional COMMA  TimeDistributed EOM
from keras DOT optimizers import SGD EOM
from coremltools DOT converters import keras as kerasConverter EOM
def _keras_transpose PARELEFT x COMMA  is_sequence EQUAL  PARERIGHT : EOM
if len PARELEFT  PARERIGHT   EQUAL         x  EQUAL  np DOT transpose PARELEFT  PARERIGHT  EOM
return np DOT expand_dims PARELEFT x COMMA  axis EQUAL  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL  return np DOT transpose PARELEFT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL  return x DOT reshape PARELEFT x DOT shape[] +  PARELEFT  PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL  return x DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
else: EOM
return x EOM
else: EOM
return x EOM
def _get_coreml_model PARELEFT  PARERIGHT : EOM
from coremltools DOT converters import keras as keras_converter EOM
model  EQUAL  keras_converter DOT convert PARELEFT  PARERIGHT  EOM
return model EOM
def _generate_data PARELEFT input_shape COMMA  mode  EQUAL  PARERIGHT : EOM
X  EQUAL  np DOT zeros PARELEFT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
X  EQUAL  np DOT ones PARELEFT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
X  EQUAL  np DOT array PARELEFT range PARELEFT np DOT product PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  DOT reshape PARELEFT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
X  EQUAL  np DOT random DOT rand PARELEFT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
X  EQUAL  np DOT random DOT rand PARELEFT  PARERIGHT -0 DOT 5 EOM
return X EOM
def conv2d_bn PARELEFT x COMMA  nb_filter COMMA  nb_row COMMA  nb_col COMMA  border_mode EQUAL  COMMA  subsample EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT : EOM
bn_name  EQUAL  name + EOM
conv_name  EQUAL  name + EOM
else: EOM
bn_name  EQUAL  None EOM
conv_name  EQUAL  None EOM
bn_axis  EQUAL  3 EOM
x  EQUAL  Convolution2D PARELEFT nb_filter COMMA  nb_row COMMA  nb_col COMMA subsample EQUAL  COMMA activation EQUAL  COMMA border_mode EQUAL  COMMA name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x  EQUAL  BatchNormalization PARELEFT axis EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
return x EOM
from keras DOT models import Sequential COMMA  Input COMMA  Model EOM
from keras DOT layers import Dense COMMA  Flatten COMMA  Embedding COMMA  Average COMMA  Activation COMMA  Lambda COMMA  Dropout COMMA  LSTM COMMA  Bidirectional EOM
from keras DOT initializers import Constant EOM
import numpy as np EOM
import keras DOT backend as K EOM
from keras import regularizers EOM
def create_baseline_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT embedding_matrix DOT shape[] COMMA  embedding_matrix DOT shape[] COMMA mbeddings_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_length EQUAL  COMMA rainable EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Lambda PARELEFT lambda x: K DOT mean PARELEFT x COMMA  axis EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_rnn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT embedding_matrix DOT shape[] COMMA  embedding_matrix DOT shape[] COMMA mbeddings_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_length EQUAL  COMMA rainable EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_bidir_rnn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT embedding_matrix DOT shape[] COMMA  embedding_matrix DOT shape[] COMMA mbeddings_initializer EQUAL  PARELEFT  PARERIGHT  COMMA  input_length EQUAL  COMMA rainable EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_train_emb_rnn_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT embedding_matrix DOT shape[] COMMA  embedding_matrix DOT shape[] COMMA  input_length EQUAL  COMMA  mask_zero EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA  return_sequences EQUAL  COMMA  recurrent_dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 64 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelimport numpy as np EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from utils import transform EOM
class LstmModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT scaler  EQUAL  MinMaxScaler PARELEFT feature_range EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT series  EQUAL  self DOT scaler DOT fit_transform PARELEFT series DOT reshape PARELEFT  PARERIGHT  PARERIGHT  EOM
def transform_split PARELEFT self COMMA  look_back EQUAL  COMMA  train_composition EQUAL  COMMA  use_time_step EQUAL  PARERIGHT : EOM
raise Exception PARELEFT  PARERIGHT  EOM
train_size  EQUAL  int PARELEFT len PARELEFT  PARERIGHT  * train_composition PARERIGHT  EOM
train  EQUAL  self DOT series[] EOM
test  EQUAL  self DOT series[] EOM
train_x COMMA  train_y  EQUAL  transform DOT series_to_features_matrix PARELEFT  PARERIGHT  EOM
test_x COMMA  test_y  EQUAL  transform DOT series_to_features_matrix PARELEFT  PARERIGHT  EOM
train_x  EQUAL  transform DOT features_matrix_to_rnn_matrix PARELEFT  PARERIGHT  EOM
test_x  EQUAL  transform DOT features_matrix_to_rnn_matrix PARELEFT  PARERIGHT  EOM
return train_x COMMA  train_y COMMA  test_x COMMA  test_y COMMA  train_size EOM
def build_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA output_dim EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_model2 PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def build_model3 PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT input_dim EQUAL [] COMMA output_dim EQUAL [] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT layers[] COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return model EOM
def fit PARELEFT model COMMA  train_x COMMA  train_y COMMA  nb_epoch EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT : EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import CuDNNLSTM EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import GRU EOM
from keras DOT layers import CuDNNGRU EOM
from keras DOT layers import Activation EOM
from keras DOT layers import Bidirectional COMMA  Flatten EOM
def create_network PARELEFT network_input COMMA  n_vocab COMMA  mode COMMA  weights EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if mode  EQUAL  EQUAL  : EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
elif mode  EQUAL  EQUAL  : EOM
model DOT add PARELEFT GRU PARELEFT 256 COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT 256 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT GRU PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if weights: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return modelimport utils EOM
import numpy as np EOM
import matplotlib DOT pyplot as plt EOM
import seaborn as sns EOM
DATASET_DIR  EQUAL  EOM
audioFiles  EQUAL  [] EOM
from keras DOT utils import to_categorical EOM
audioFiles  EQUAL  utils DOT findMusic PARELEFT  PARERIGHT  EOM
np DOT random DOT shuffle PARELEFT  PARERIGHT  EOM
labels  EQUAL  []  PARERIGHT  for af in audioFiles ] EOM
labels  EQUAL  np DOT array PARELEFT  np DOT array PARELEFT  PARERIGHT   EQUAL  COMMA  dtype EQUAL  PARERIGHT  EOM
labels  EQUAL  labels DOT reshape PARELEFT  PARERIGHT  EOM
matrixAudioData  EQUAL  utils DOT getAudioData PARELEFT  PARERIGHT  EOM
cantTrain  EQUAL  int PARELEFT  np DOT round PARELEFT  len PARELEFT  PARERIGHT  * 0 DOT 7  PARERIGHT   PARERIGHT  EOM
X_train  EQUAL  matrixAudioData[] EOM
X_test  EQUAL  matrixAudioData[] EOM
y_train  EQUAL  labels[] EOM
y_test  EQUAL  labels[] EOM
from librosa DOT display import specshow EOM
unMFCC  EQUAL  X_train[] DOT reshape PARELEFT   PARELEFT 20 COMMA  int PARELEFT  PARERIGHT  PARERIGHT   PARERIGHT  EOM
plt DOT figure PARELEFT figsize EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
specshow PARELEFT unMFCC COMMA  x_axis EQUAL  PARERIGHT  EOM
plt DOT colorbar PARELEFT  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT tight_layout PARELEFT  PARERIGHT  EOM
matrixAudioDataReshaped  EQUAL  matrixAudioData DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
matrixAudioDataReshaped[] DOT shape EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT optimizers import RMSprop EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  Dense PARELEFT 500 COMMA  input_dim  EQUAL []  PARERIGHT   PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
epochs  EQUAL  1000 EOM
batch_size  EQUAL  100 EOM
history  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA  epochs  EQUAL  COMMA  batch_size  EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT   PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Input EOM
matrixAudioDataReshaped  EQUAL  matrixAudioData DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
cantTrain  EQUAL  int PARELEFT  np DOT round PARELEFT  len PARELEFT  PARERIGHT  * 0 DOT 7  PARERIGHT   PARERIGHT  EOM
X_train_RNN  EQUAL  matrixAudioDataReshaped[] EOM
X_test_RNN  EQUAL  matrixAudioDataReshaped[] EOM
y_train_RNN  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
y_test_RNN  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
modelLSTM  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelLSTM DOT add PARELEFT  LSTM PARELEFT 500 COMMA  input_shape  EQUAL  PARELEFT  PARERIGHT  COMMA  dropout EQUAL  COMMA  recurrent_dropout EQUAL  COMMA  return_sequences EQUAL  PARERIGHT   PARERIGHT  EOM
modelLSTM DOT add PARELEFT  LSTM PARELEFT 300 COMMA  dropout EQUAL  PARERIGHT   PARERIGHT  EOM
modelLSTM DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modelLSTM DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
modelLSTM DOT summary PARELEFT  PARERIGHT  EOM
batch_size  EQUAL  100 EOM
modelLSTM DOT fit PARELEFT X_train_RNN COMMA  y_train_RNN COMMA  epochs  EQUAL  COMMA  batch_size  EQUAL  COMMA  alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
scores  EQUAL  modelLSTM DOT evaluate PARELEFT  PARERIGHT  EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D EOM
matrixAudioDataConv2D  EQUAL  matrixAudioData DOT reshape PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
X_train_Conv2D  EQUAL  matrixAudioDataConv2D[] EOM
X_test_Conv2D  EQUAL  matrixAudioDataConv2D[] EOM
y_train_Conv2D  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
y_test_Conv2D  EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
modelConv2D  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
modelConv2D DOT add PARELEFT  Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT   PARERIGHT   PARERIGHT  EOM
modelConv2D DOT add PARELEFT  Activation PARELEFT  PARERIGHT   PARERIGHT  EOM
modelConv2D DOT add PARELEFT Conv2D PARELEFT 32 COMMA   PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
modelConv2D DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modelConv2D DOT add PARELEFT MaxPooling2D PARELEFT pool_size EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
modelConv2D DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
modelConv2D DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
modelConv2D DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
modelConv2D DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
modelConv2D DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
epochs  EQUAL  200 EOM
batch_size  EQUAL  128 EOM
history  EQUAL  modelConv2D DOT fit PARELEFT X_train_Conv2D COMMA  y_train_Conv2D COMMA  epochs  EQUAL  COMMA  batch_size  EQUAL  COMMA  alidation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT plot PARELEFT history DOT history[] COMMA  label EQUAL  PARERIGHT  EOM
plt DOT legend PARELEFT  PARERIGHT  EOM
scores  EQUAL  modelConv2D DOT evaluate PARELEFT  PARERIGHT  EOM
global_model_version  EQUAL  45 EOM
global_batch_size  EQUAL  16 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def build_improved_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_basic_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelfrom keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
X_train COMMA  y_train COMMA  X_test COMMA  y_test  EQUAL  lstm DOT load_data PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT input_dim  EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 100 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
start  EQUAL  time DOT time PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  validation_split EQUAL  PARERIGHT  EOM
predictions  EQUAL  lstm DOT predict_sequences_multiple PARELEFT  PARERIGHT  EOM
lstm DOT plot_results_multiple PARELEFT  PARERIGHT import tensorflow as tf EOM
import pandas as pd EOM
import numpy as np EOM
import matplotlib EOM
matplotlib DOT use PARELEFT  PARERIGHT  EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  LSTM COMMA  Embedding COMMA  Activation COMMA  Lambda COMMA  Bidirectional EOM
from keras DOT engine import Input COMMA  Model COMMA  InputSpec EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Conv1D EOM
from keras DOT models import Model COMMA  Sequential EOM
from keras DOT utils import to_categorical EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Concatenate COMMA  LeakyReLU COMMA  concatenate COMMA  MaxPool1D COMMA GlobalMaxPool1D COMMA add EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  Input COMMA  Masking COMMA  Dropout COMMA  MaxPooling1D COMMA Lambda COMMA  BatchNormalization EOM
from keras DOT layers import LSTM COMMA  TimeDistributed COMMA  AveragePooling1D COMMA  Flatten COMMA Activation COMMA ZeroPadding1D COMMA  UpSampling1D EOM
from keras DOT optimizers import Adam COMMA  rmsprop EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA ModelCheckpoint COMMA  CSVLogger EOM
from keras DOT layers import Conv1D COMMA  GlobalMaxPooling1D COMMA  ConvLSTM2D COMMA  Bidirectional COMMA RepeatVector EOM
from keras import regularizers EOM
from keras DOT utils import plot_model COMMA  to_categorical EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT utils import plot_model EOM
from keras DOT utils DOT data_utils import get_file EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import Adam EOM
from keras DOT callbacks import ModelCheckpoint EOM
from sklearn DOT utils import class_weight EOM
from keras import backend as K EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import model_from_json EOM
import os EOM
import pydot EOM
import graphviz EOM
RNN_HIDDEN_DIM  EQUAL  62 EOM
checkpoint_dir  EQUAL  EOM
os DOT path DOT exists PARELEFT  PARERIGHT  EOM
input_file  EQUAL  EOM
input_file  EQUAL  EOM
def letter_to_index PARELEFT  PARERIGHT : EOM
_alphabet  EQUAL  EOM
return next PARELEFT  PARELEFT i for i COMMA  _letter in enumerate PARELEFT  PARERIGHT  if _letter  EQUAL  PARERIGHT  COMMA  None PARERIGHT  EOM
def load_data PARELEFT test_split  EQUAL  COMMA  maxlen  EQUAL  PARERIGHT : EOM
df  EQUAL  pd DOT read_csv PARELEFT  PARERIGHT  EOM
df DOT columns  EQUAL  [] EOM
df[]  EQUAL  df[] DOT apply PARELEFT lambda x: [] PARERIGHT  EOM
df  EQUAL  df DOT reindex PARELEFT np DOT random DOT permutation PARELEFT  PARERIGHT  PARERIGHT  EOM
train_size  EQUAL  int PARELEFT len PARELEFT  PARERIGHT  *  PARELEFT  PARERIGHT  PARERIGHT  EOM
X_train  EQUAL  df[] DOT values[] EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
return pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  COMMA  y_train COMMA  pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  COMMA  y_test EOM
def create_lstm_rna_seq PARELEFT input_length COMMA  rnn_hidden_dim  EQUAL  COMMA  output_dim  EQUAL  COMMA  input_dim  EQUAL  COMMA  dropout  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim  EQUAL  COMMA  output_dim  EQUAL  COMMA  input_length  EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT rnn_hidden_dim COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_plots PARELEFT  PARERIGHT : EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT ylabel PARELEFT  PARERIGHT  EOM
plt DOT xlabel PARELEFT  PARERIGHT  EOM
plt DOT legend PARELEFT [] COMMA  loc EQUAL  PARERIGHT  EOM
plt DOT savefig PARELEFT  PARERIGHT  EOM
plt DOT clf PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
X_train COMMA  y_train COMMA  X_test COMMA  y_test  EQUAL  load_data PARELEFT  PARERIGHT  EOM
model  EQUAL  create_lstm_rna_seq PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
filepath EQUAL  checkpoint_dir + EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
class_weight  EQUAL  class_weight DOT compute_class_weight PARELEFT  COMMA  np DOT unique PARELEFT  PARERIGHT  COMMA  y_train PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  class_weight EQUAL  COMMA EPCOHS COMMA  callbacks EQUAL  COMMA  validation_split  EQUAL  COMMA  verbose  EQUAL  PARERIGHT  EOM
model_json  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
create_plots PARELEFT  PARERIGHT  EOM
plot_model PARELEFT model COMMA  to_file EQUAL  PARERIGHT  EOM
score COMMA  acc  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  SimpleRNN COMMA  RNN EOM
import numpy as np EOM
import pickle EOM
import load_sherlock as sh EOM
import read_write_helpers as rw EOM
import midi_to_data as md EOM
from custom_rnns import MinimalLSTMCell COMMA  MinimalRNNCell EOM
[]  EQUAL  sh DOT load PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT RNN PARELEFT MinimalRNNCell PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
rw DOT save PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT RNN PARELEFT MinimalLSTMCell PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
rw DOT save PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
rw DOT save PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
rw DOT save PARELEFT  PARERIGHT  EOM
[]  EQUAL  md DOT load_midi_prediction PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT RNN PARELEFT MinimalRNNCell PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
rw DOT save PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT RNN PARELEFT MinimalLSTMCell PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
rw DOT save PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT SimpleRNN PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
rw DOT save PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT y DOT shape[] COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X COMMA y COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
rw DOT save PARELEFT  PARERIGHT from keras DOT layers DOT convolutional import Conv2DTranspose  COMMA  Conv1D COMMA  Conv2D COMMA Convolution3D COMMA  MaxPooling2D COMMA UpSampling1D COMMA UpSampling2D COMMA UpSampling3D EOM
from keras DOT layers import Input COMMA Embedding COMMA  Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA Reshape COMMA  Flatten COMMA  Lambda EOM
from keras DOT layers DOT noise import GaussianDropout COMMA  GaussianNoise EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras import initializers EOM
from keras import regularizers EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
import numpy as np EOM
import pandas as pd EOM
import os EOM
def create_LSTM PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  PARERIGHT : EOM
embedding_vecor_length  EQUAL  32 EOM
model1  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model1 DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model1 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model2 DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model3 DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model4  EQUAL  Model PARELEFT inputs EQUAL  PARELEFT shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  COMMA  outputs EQUAL  PARERIGHT  EOM
education  EQUAL  [] EOM
for i in range PARELEFT len PARELEFT  PARERIGHT  PARERIGHT : EOM
JD  EQUAL  JD_ls[] EOM
education DOT append PARELEFT  PARERIGHT  EOM
edu_types  EQUAL  list PARELEFT set PARELEFT sum PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
to_categorical PARELEFT  PARERIGHT  EOM
import pandas as pd EOM
s  EQUAL  pd DOT Series PARELEFT  PARERIGHT  EOM
pd DOT get_dummies PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
model_id  EQUAL  EOM
model  EQUAL  create_LSTM PARELEFT  PARERIGHT  EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout EOM
from keras DOT layers DOT recurrent import SimpleRNN COMMA  LSTM COMMA  GRU EOM
import keras EOM
import pandas as pd EOM
from keras DOT models import load_model EOM
from shutil import copyfile EOM
from datetime import datetime EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense EOM
if len PARELEFT  PARERIGHT  EQUAL  PARELEFT  PARERIGHT  EOM
out_neurons  EQUAL  1 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
for i COMMA  dimx in enumerate PARELEFT  PARERIGHT : EOM
if i EQUAL  EQUAL 0: EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT dimx COMMA  return_sequences EQUAL  PARELEFT  PARERIGHT ! EQUAL  PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT out_neurons COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
if len PARELEFT  PARERIGHT  EQUAL  PARELEFT  PARERIGHT  EOM
out_neurons  EQUAL  1 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
for i COMMA  dimx in enumerate PARELEFT  PARERIGHT : EOM
if i EQUAL  EQUAL 0: EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT dimx COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT out_neurons COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
if len PARELEFT  PARERIGHT  EQUAL  PARELEFT  PARERIGHT  EOM
out_neurons  EQUAL  1 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
for i COMMA  dimx in enumerate PARELEFT  PARERIGHT : EOM
if i EQUAL  EQUAL 0: EOM
model DOT add PARELEFT LSTM PARELEFT dimx COMMA return_sequences EQUAL  COMMA activation EQUAL  COMMA batch_input_shape EQUAL  COMMA stateful EQUAL  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT Dense PARELEFT dimx COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT out_neurons COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT utils import np_utils EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers DOT recurrent import LSTM EOM
def get_simple_net PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Embedding PARELEFT dictionary_length + 1 COMMA  32 COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def get_dropout_net PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Embedding PARELEFT dictionary_length + 1 COMMA  32 COMMA  input_length EQUAL  COMMA  dropout EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelfrom keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
import numpy as np EOM
from keras DOT callbacks import EarlyStopping EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import LSTM EOM
from keras DOT models import Sequential EOM
from keras DOT models import load_model EOM
from LSTM_for_Stock DOT unit import get_param_default_value as def_val EOM
import os EOM
from keras DOT backend import clear_session EOM
from keras DOT layers import CuDNNLSTM EOM
class Model PARELEFT  PARERIGHT : EOM
pass EOM
class SequentialModel PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT __model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
self DOT __history  EQUAL  None EOM
def model PARELEFT  PARERIGHT : EOM
return self DOT __model EOM
def history PARELEFT  PARERIGHT : EOM
return self DOT __history EOM
def build_model PARELEFT self COMMA  layers COMMA  compile EQUAL  PARERIGHT : EOM
t  EQUAL  layer DOT pop PARELEFT  PARERIGHT  EOM
if t  EQUAL  EQUAL  : EOM
self DOT __model DOT add PARELEFT Dense DOT from_config PARELEFT  PARERIGHT  PARERIGHT  EOM
elif t  EQUAL  EQUAL  : EOM
self DOT __model DOT add PARELEFT LSTM DOT from_config PARELEFT  PARERIGHT  PARERIGHT  EOM
elif t  EQUAL  EQUAL  : EOM
self DOT __model DOT add PARELEFT Dropout DOT from_config PARELEFT  PARERIGHT  PARERIGHT  EOM
elif t  EQUAL  EQUAL  : EOM
self DOT __model DOT add PARELEFT CuDNNLSTM DOT from_config PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT __model DOT compile PARELEFT  PARERIGHT  EOM
def train PARELEFT self COMMA X COMMA Y COMMA train EQUAL  COMMA callbacks EQUAL [] PARERIGHT : EOM
batch_size  EQUAL  train DOT pop PARELEFT  COMMA ef_val PARELEFT  PARERIGHT  PARERIGHT  EOM
verbose  EQUAL  train DOT pop PARELEFT  COMMA  def_val PARELEFT  PARERIGHT  PARERIGHT  EOM
validation_split  EQUAL  train DOT pop PARELEFT alidation_splitvalidation_split EOM
validation_data  EQUAL  train DOT pop PARELEFT alidation_datavalidation_data EOM
shuffle  EQUAL  train DOT pop PARELEFT  COMMA  def_val PARELEFT  PARERIGHT  PARERIGHT  EOM
class_weight  EQUAL  train DOT pop PARELEFT  COMMA ef_val PARELEFT  PARERIGHT  PARERIGHT  EOM
sample_weight  EQUAL  train DOT pop PARELEFT  COMMA ef_val PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_epoch  EQUAL  train DOT pop PARELEFT  COMMA ef_val PARELEFT  PARERIGHT  PARERIGHT  EOM
steps_per_epoch  EQUAL  train DOT pop PARELEFT teps_per_epochsteps_per_epoch EOM
validation_steps  EQUAL  train DOT pop PARELEFT alidation_stepsvalidation_steps EOM
self DOT __history  EQUAL  self DOT __model DOT fit PARELEFT X COMMA Y COMMA epochs EQUAL  COMMA callbacks EQUAL  COMMA batch_size EQUAL  COMMA verbose EQUAL  COMMA validation_data EQUAL  COMMA validation_split EQUAL  COMMA shuffle EQUAL  COMMA class_weight EQUAL  COMMA sample_weight EQUAL  COMMA initial_epoch EQUAL  COMMA steps_per_epoch EQUAL  COMMA validation_steps EQUAL  PARERIGHT  EOM
return self DOT __history EOM
def predict PARELEFT self COMMA  X COMMA  predict EQUAL  PARERIGHT : EOM
batch_size  EQUAL  predict DOT pop PARELEFT  COMMA ef_val PARELEFT  PARERIGHT  PARERIGHT  EOM
verbose  EQUAL  predict DOT pop PARELEFT  COMMA ef_val PARELEFT  PARERIGHT  PARERIGHT  EOM
return self DOT __model DOT predict PARELEFT batch_size EQUAL  COMMA  verbose EQUAL  COMMA  steps EQUAL  PARERIGHT  EOM
def evaluate PARELEFT self COMMA  X COMMA  Y COMMA  evaluate EQUAL  PARERIGHT : EOM
sample_weight  EQUAL  evaluate DOT pop PARELEFT ample_weightsample_weight EOM
batch_size  EQUAL  evaluate DOT pop PARELEFT  COMMA ef_val PARELEFT  PARERIGHT  PARERIGHT  EOM
verbose  EQUAL  evaluate DOT pop PARELEFT  COMMA ef_val PARELEFT  PARERIGHT  PARERIGHT  EOM
return self DOT __model DOT evaluate PARELEFT X COMMA Y COMMA batch_size EQUAL  COMMA verbose EQUAL  COMMA steps EQUAL  COMMA sample_weight EQUAL  PARERIGHT  EOM
def save PARELEFT  PARERIGHT : EOM
os DOT makedirs PARELEFT os DOT path DOT dirname PARELEFT  PARERIGHT  COMMA  exist_ok EQUAL  PARERIGHT  EOM
self DOT model DOT save PARELEFT  PARERIGHT  EOM
def load PARELEFT self COMMA  filepath COMMA  clear EQUAL  PARERIGHT : EOM
if clear: EOM
clear_session PARELEFT  PARERIGHT  EOM
self DOT __model  EQUAL  load_model PARELEFT  PARERIGHT from keras DOT models import Sequential EOM
from keras DOT layers import Embedding COMMA  Conv1D COMMA  Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT core import Flatten EOM
def get_simple_cnn PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA embeddings_initializer EQUAL  COMMA trainable EQUAL  COMMA put_shape  EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT activation EQUAL  COMMA filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT activation EQUAL  COMMA filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT activation EQUAL  COMMA filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT activation EQUAL  COMMA filters EQUAL  COMMA kernel_size EQUAL  COMMA padding EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2048 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 512 COMMA   activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def get_RNN PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA embeddings_initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 256 COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
from keras DOT engine import Input EOM
from keras import backend as K EOM
from keras DOT layers import Concatenate EOM
from keras DOT models import Model EOM
def mix_cnn_rnn PARELEFT  PARERIGHT : EOM
input_text  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  PARERIGHT  EOM
embedding_vec  EQUAL  Embedding PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA embeddings_initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
cnn_config EQUAL [] EOM
data_aug  EQUAL  [] EOM
for i COMMA  c_conf in enumerate PARELEFT  PARERIGHT : EOM
data_aug DOT append PARELEFT Conv1D PARELEFT kernel_size  EQUAL [] COMMA lters  EQUAL [] COMMA dding  EQUAL [] COMMA name EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARELEFT  PARERIGHT  PARERIGHT  EOM
concat_data  EQUAL  Concatenate PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
rnn_result  EQUAL  LSTM PARELEFT 256 COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
rnn_result  EQUAL  LSTM PARELEFT 256 COMMA dropout EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
logist  EQUAL  Dense PARELEFT 19 COMMA  activation EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT input EQUAL  COMMA  output EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelimport numpy as np EOM
from sklearn DOT manifold import TSNE EOM
import matplotlib DOT pyplot as plt EOM
import tensorflow as tf EOM
import os EOM
os DOT environ[] EQUAL  EOM
from tensorflow DOT keras DOT layers import Embedding EOM
from tensorflow DOT keras DOT layers import Dense COMMA  Input COMMA  Flatten EOM
from tensorflow DOT keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding COMMA  Dropout COMMA  LSTM COMMA  GRU COMMA  Bidirectional EOM
from tensorflow DOT keras DOT models import Model COMMA Sequential EOM
from tensorflow DOT keras import backend as K EOM
from tensorflow DOT keras DOT layers import Layer EOM
from tensorflow DOT keras import initializers COMMA  optimizers EOM
def lstm_keras PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embed_size COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def blstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embed_size COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
class AttLayer PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
def build PARELEFT  PARERIGHT : EOM
self DOT W  EQUAL  self DOT add_weight PARELEFT name EQUAL  COMMA  shape EQUAL  PARELEFT  PARERIGHT  COMMA initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  EOM
def call PARELEFT self COMMA  x COMMA  mask EQUAL  PARERIGHT : EOM
eij  EQUAL  K DOT tanh PARELEFT K DOT dot PARELEFT  PARERIGHT  PARERIGHT  EOM
ai  EQUAL  K DOT exp PARELEFT  PARERIGHT  EOM
weights  EQUAL  ai/K DOT sum PARELEFT ai COMMA  axis EQUAL  PARERIGHT  DOT dimshuffle PARELEFT  PARERIGHT  EOM
weighted_input  EQUAL  x*weights DOT dimshuffle PARELEFT  PARERIGHT  EOM
return weighted_input DOT sum PARELEFT axis EQUAL  PARERIGHT  EOM
def compute_output_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT  PARERIGHT  EOM
def blstm_atten PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embed_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT embed_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT AttLayer PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
adam  EQUAL  optimizers DOT Adam PARELEFT lr EQUAL  COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def get_model PARELEFT  PARERIGHT : EOM
if m_type  EQUAL  EQUAL  : EOM
model  EQUAL  lstm_keras PARELEFT  PARERIGHT  EOM
elif m_type  EQUAL  EQUAL  : EOM
model  EQUAL  blstm PARELEFT  PARERIGHT  EOM
elif m_type  EQUAL  EQUAL  : EOM
model  EQUAL  blstm_atten PARELEFT  PARERIGHT  EOM
else: EOM
return None EOM
return modelfrom __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from __future__ import unicode_literals EOM
import logging EOM
from rasa_core DOT policies DOT keras_policy import KerasPolicy EOM
logger  EQUAL  logging DOT getLogger PARELEFT  PARERIGHT  EOM
class RestaurantPolicy PARELEFT  PARERIGHT : EOM
def model_architecture PARELEFT  PARERIGHT : EOM
from keras DOT layers import LSTM COMMA  Activation COMMA  Masking COMMA  Dense EOM
from keras DOT models import Sequential EOM
from keras DOT models import Sequential EOM
from keras DOT layers import \ EOM
Masking COMMA  LSTM COMMA  Dense COMMA  TimeDistributed COMMA  Activation EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA  input_shape EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  units EQUAL [] PARERIGHT  PARERIGHT  EOM
elif len PARELEFT  PARERIGHT   EQUAL             model DOT add PARELEFT Masking PARELEFT mask_value EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT self DOT rnn_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT units EQUAL [] PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
raise ValueError PARELEFT th of output_shape  EQUAL  PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
logger DOT debug PARELEFT model DOT summary PARELEFT  PARERIGHT  PARERIGHT  EOM
return modelimport keras EOM
import numpy as np EOM
from keras DOT datasets import imdb EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential COMMA  load_model EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import Dropout EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
np DOT random DOT seed PARELEFT  PARERIGHT  EOM
 PARELEFT  PARERIGHT  COMMA   PARELEFT  PARERIGHT   EQUAL  PARELEFT path EQUAL  COMMA  num_words EQUAL  COMMA  seed EQUAL  PARERIGHT  EOM
X_train  EQUAL  sequence DOT pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  sequence DOT pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  EOM
TOP_WORDS  EQUAL  EOM
EVL  EQUAL  32 EOM
MAX_WORDS  EQUAL  500 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT TOP_WORDS COMMA  EVL COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  validation_data EQUAL  PARELEFT  PARERIGHT  COMMA  epochs EQUAL  COMMA  batch_size EQUAL  PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  EOM
scores  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  verbose EQUAL  PARERIGHT  EOM
global_model_version  EQUAL  67 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
import pandas as pd EOM
import numpy as np EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Activation COMMA  Dense COMMA  Embedding COMMA  SimpleRNN COMMA  LSTM COMMA  Dropout EOM
from keras import backend as K EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA  ModelCheckpoint EOM
from keras DOT callbacks import TensorBoard EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
imdb_df  EQUAL  pd DOT read_csv PARELEFT  COMMA  sep  EQUAL  PARERIGHT  EOM
pd DOT set_option PARELEFT  PARERIGHT  EOM
num_words  EQUAL  10000 EOM
tokenizer  EQUAL  Tokenizer PARELEFT num_words  EQUAL  PARERIGHT  EOM
tokenizer DOT fit_on_texts PARELEFT  PARERIGHT  EOM
sequences  EQUAL  tokenizer DOT texts_to_sequences PARELEFT  PARERIGHT  EOM
y  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
max_review_length  EQUAL  552 EOM
pad  EQUAL  EOM
X  EQUAL  pad_sequences PARELEFT sequences COMMA max_review_length COMMA padding EQUAL  COMMA truncating EQUAL  PARERIGHT  EOM
from sklearn DOT model_selection import train_test_split EOM
X_train COMMA  X_test COMMA  y_train COMMA  y_test  EQUAL  train_test_split PARELEFT X COMMA y COMMA st_size  EQUAL  PARERIGHT  EOM
input_shape  EQUAL  X_train DOT shape EOM
K DOT clear_session PARELEFT  PARERIGHT  EOM
LSTM_model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Embedding PARELEFT num_words COMMA 8 COMMA input_length EQUAL  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
LSTM_model DOT summary PARELEFT  PARERIGHT  EOM
LSTM_model DOT compile PARELEFT optimizer EQUAL  COMMA loss EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
LSTM_history  EQUAL  LSTM_model DOT fit PARELEFT X_train COMMA y_train COMMA epochs EQUAL  COMMA batch_size EQUAL  COMMA validation_split EQUAL import pytest EOM
import os EOM
import sys EOM
import numpy as np EOM
from keras import Input COMMA  Model EOM
from keras DOT layers import Conv2D COMMA  Bidirectional EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers import TimeDistributed EOM
from keras DOT models import Sequential EOM
from keras DOT utils import vis_utils EOM
def test_plot_model PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Conv2D PARELEFT 2 COMMA  kernel_size EQUAL  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 16 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT TimeDistributed PARELEFT Dense PARELEFT 5 COMMA  name EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
inner_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_lstm  EQUAL  Bidirectional PARELEFT LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
encoder  EQUAL  Model PARELEFT inner_input COMMA  inner_lstm COMMA  name EQUAL  PARERIGHT  EOM
outer_input  EQUAL  Input PARELEFT shape EQUAL  PARELEFT  PARERIGHT  COMMA  dtype EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
inner_encoder  EQUAL  TimeDistributed PARELEFT encoder COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
lstm  EQUAL  LSTM PARELEFT 16 COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
preds  EQUAL  Dense PARELEFT 5 COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
model  EQUAL  Model PARELEFT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA  to_file EQUAL  COMMA  show_shapes EQUAL  COMMA xpand_nested EQUAL  COMMA  dpi EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
def test_plot_sequential_embedding PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT 10000 COMMA  256 COMMA  input_length EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
vis_utils DOT plot_model PARELEFT model COMMA to_file EQUAL  COMMA show_shapes EQUAL  COMMA show_layer_names EQUAL  PARERIGHT  EOM
os DOT remove PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
pytest DOT main PARELEFT  PARERIGHT from __future__ import absolute_import EOM
from __future__ import division EOM
from __future__ import print_function EOM
from absl DOT testing import parameterized EOM
import numpy as np EOM
from tensorflow DOT python import keras EOM
from tensorflow DOT python DOT eager import context EOM
from tensorflow DOT python DOT framework import test_util EOM
from tensorflow DOT python DOT keras import keras_parameterized EOM
from tensorflow DOT python DOT keras import testing_utils EOM
from tensorflow DOT python DOT platform import test EOM
from tensorflow DOT python DOT training import adam EOM
from tensorflow DOT python DOT training import gradient_descent EOM
from tensorflow DOT python DOT training DOT rmsprop import RMSPropOptimizer EOM
class LSTMLayerTest PARELEFT  PARERIGHT : EOM
def test_return_sequences_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA return_sequences EOM
def test_static_shape_inference_LSTM PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
inputs  EQUAL  keras DOT layers DOT Dense PARELEFT embedding_dim COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
outputs  EQUAL  model DOT layers[] DOT output EOM
self DOT assertEqual PARELEFT outputs DOT get_shape PARELEFT  PARERIGHT  DOT as_list PARELEFT  PARERIGHT  COMMA  [] PARERIGHT  EOM
def test_dynamic_behavior_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT RMSPropOptimizer PARELEFT  PARERIGHT  COMMA   COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
x  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
y  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_dropout_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA dropout: 0 DOT 1} COMMA put_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
def test_implementation_mode_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
testing_utils DOT layer_test PARELEFT keras DOT layers DOT LSTM COMMA wargs EQUAL  COMMA implementation EOM
def test_constraints_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
k_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
r_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
b_constraint  EQUAL  keras DOT constraints DOT max_norm PARELEFT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_constraint EQUAL  COMMA recurrent_constraint EQUAL  COMMA bias_constraint EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
self DOT assertEqual PARELEFT  PARERIGHT  EOM
def test_with_masking_layer_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT layer_class PARELEFT units EQUAL  COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_masking_with_stacking_LSTM PARELEFT  PARERIGHT : EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT abs PARELEFT np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
targets / EQUAL  targets DOT sum PARELEFT axis EQUAL  COMMA  keepdims EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Masking PARELEFT input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
lstm_cells  EQUAL  [] EOM
model DOT add PARELEFT keras DOT layers DOT RNN PARELEFT lstm_cells COMMA  return_sequences EQUAL  COMMA  unroll EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT fit PARELEFT inputs COMMA  targets COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
def test_from_config_LSTM PARELEFT  PARERIGHT : EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
for stateful in  PARELEFT  PARERIGHT : EOM
l1  EQUAL  layer_class PARELEFT units EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
l2  EQUAL  layer_class DOT from_config PARELEFT l1 DOT get_config PARELEFT  PARERIGHT  PARERIGHT  EOM
assert l1 DOT get_config PARELEFT  PARERIGHT   EQUAL  PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
if len PARELEFT  PARERIGHT   EQUAL       output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL [] PARERIGHT  EOM
else: EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_specify_initial_state_non_keras_tensor PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_reset_states_with_values PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  stateful EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
assert len PARELEFT  PARERIGHT   EQUAL  assert layer DOT states[] is not None EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT zeros PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
state_shapes  EQUAL  [] EOM
values  EQUAL  [] EOM
if len PARELEFT  PARERIGHT   EQUAL  : EOM
values  EQUAL  values[] EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA np DOT ones PARELEFT keras DOT backend DOT int_shape PARELEFT  PARERIGHT  PARERIGHT  COMMA atol EQUAL  PARERIGHT  EOM
with self DOT assertRaises PARELEFT  PARERIGHT : EOM
layer DOT reset_states PARELEFT [] *  PARELEFT len PARELEFT  PARERIGHT  + 1 PARERIGHT  PARERIGHT  EOM
def test_specify_state_with_masking PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
_  EQUAL  keras DOT layers DOT Masking PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT inputs COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_return_state PARELEFT  PARERIGHT : EOM
num_states  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  stateful EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
state  EQUAL  outputs[] EOM
assert len PARELEFT  PARERIGHT   EQUAL  model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
state  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT keras DOT backend DOT eval PARELEFT  PARERIGHT  COMMA  state COMMA  atol EQUAL  PARERIGHT  EOM
def test_state_reuse PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
inputs  EQUAL  keras DOT Input PARELEFT batch_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  keras DOT layers DOT LSTM PARELEFT units COMMA  return_state EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
outputs  EQUAL  layer PARELEFT  PARERIGHT  EOM
output COMMA  state  EQUAL  outputs[] COMMA  outputs[] EOM
output  EQUAL  keras DOT layers DOT LSTM PARELEFT  PARERIGHT  PARELEFT output COMMA  initial_state EQUAL  PARERIGHT  EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
outputs  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
def test_initial_states_as_other_inputs PARELEFT  PARERIGHT : EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  3 EOM
num_samples  EQUAL  2 EOM
num_states  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
main_inputs  EQUAL  keras DOT Input PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [] EOM
inputs  EQUAL  [] + initial_state EOM
layer  EQUAL  layer_class PARELEFT  PARERIGHT  EOM
output  EQUAL  layer PARELEFT  PARERIGHT  EOM
assert initial_state[] in layer DOT _inbound_nodes[] DOT input_tensors EOM
model  EQUAL  keras DOT models DOT Model PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  PARELEFT  PARERIGHT  COMMA run_eagerly EQUAL  PARELEFT  PARERIGHT  PARERIGHT  EOM
main_inputs  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
initial_state  EQUAL  [np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
for _ in range PARELEFT  PARERIGHT ] EOM
targets  EQUAL  np DOT random DOT random PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT  PARERIGHT  EOM
def test_regularizers_LSTM PARELEFT  PARERIGHT : EOM
embedding_dim  EQUAL  4 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
layer  EQUAL  layer_class PARELEFT 5 COMMA return_sequences EQUAL  COMMA weights EQUAL  COMMA nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA kernel_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA recurrent_regularizer EQUAL  PARELEFT  PARERIGHT  COMMA bias_regularizer EQUAL  COMMA activity_regularizer EQUAL  PARERIGHT  EOM
layer DOT build PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  3 PARERIGHT  EOM
x  EQUAL  keras DOT backend DOT variable PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer PARELEFT  PARERIGHT  EOM
if context DOT executing_eagerly PARELEFT  PARERIGHT : EOM
self DOT assertEqual PARELEFT len PARELEFT  PARERIGHT  COMMA  4 PARERIGHT  EOM
else: EOM
self DOT assertEqual PARELEFT len PARELEFT layer DOT get_losses_for PARELEFT  PARERIGHT  PARERIGHT  COMMA  1 PARERIGHT  EOM
class LSTMLayerV1OnlyTest PARELEFT  PARERIGHT : EOM
def test_statefulness_LSTM PARELEFT  PARERIGHT : EOM
num_samples  EQUAL  2 EOM
timesteps  EQUAL  3 EOM
embedding_dim  EQUAL  4 EOM
units  EQUAL  2 EOM
layer_class  EQUAL  keras DOT layers DOT LSTM EOM
model  EQUAL  keras DOT models DOT Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT keras DOT layers DOT Embedding PARELEFT 4 COMMA embedding_dim COMMA mask_zero EQUAL  COMMA input_length EQUAL  COMMA atch_input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
layer  EQUAL  layer_class PARELEFT ts COMMA  return_sequences EQUAL  COMMA  stateful EQUAL  COMMA  weights EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  PARELEFT  PARERIGHT  COMMA loss EQUAL  PARERIGHT  EOM
out1  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertEqual PARELEFT out1 DOT shape COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT train_on_batch PARELEFT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  COMMA  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
out2  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out1 DOT max PARELEFT  PARERIGHT  COMMA  out2 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
out3  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out2 DOT max PARELEFT  PARERIGHT  COMMA  out3 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
out4  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out3 COMMA  out4 COMMA  atol EQUAL  PARERIGHT  EOM
out5  EQUAL  model DOT predict PARELEFT np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
self DOT assertNotEqual PARELEFT out4 DOT max PARELEFT  PARERIGHT  COMMA  out5 DOT max PARELEFT  PARERIGHT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
left_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
left_padded_input[]  EQUAL  0 EOM
left_padded_input[]  EQUAL  0 EOM
out6  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
layer DOT reset_states PARELEFT  PARERIGHT  EOM
right_padded_input  EQUAL  np DOT ones PARELEFT  PARELEFT  PARERIGHT  PARERIGHT  EOM
right_padded_input[]  EQUAL  0 EOM
right_padded_input[]  EQUAL  0 EOM
out7  EQUAL  model DOT predict PARELEFT  PARERIGHT  EOM
self DOT assertAllClose PARELEFT out7 COMMA  out6 COMMA  atol EQUAL  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
test DOT main PARELEFT  PARERIGHT import numpy as np EOM
from readData import * EOM
import keras COMMA os EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Flatten COMMA Input COMMA LSTM COMMA Convolution1D COMMA MaxPooling1D COMMA Merge EOM
from keras DOT layers import Conv2D COMMA  MaxPooling2D EOM
from keras DOT optimizers import SGD EOM
from keras DOT models import Model EOM
from keras DOT utils DOT np_utils import to_categorical EOM
def LSTMModel PARELEFT  PARERIGHT : EOM
QA_EMBED_SIZE  EQUAL  64 EOM
BATCH_SIZE  EQUAL  32 EOM
NBR_EPOCHS  EQUAL  20 EOM
qenc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
qenc DOT add PARELEFT LSTM PARELEFT QA_EMBED_SIZE COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
qenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
qenc DOT add PARELEFT Convolution1D PARELEFT QA_EMBED_SIZE // 2 COMMA  5 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
qenc DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
qenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
qenc DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
aenc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
aenc DOT add PARELEFT LSTM PARELEFT QA_EMBED_SIZE COMMA  return_sequences EQUAL  COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
aenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
aenc DOT add PARELEFT Convolution1D PARELEFT QA_EMBED_SIZE // 2 COMMA  3 COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
aenc DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  COMMA  border_mode EQUAL  PARERIGHT  PARERIGHT  EOM
aenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
aenc DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
import tensorflow as tf EOM
import pandas as pd EOM
import numpy as np EOM
import matplotlib EOM
matplotlib DOT use PARELEFT  PARERIGHT  EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  LSTM COMMA  Embedding COMMA  Activation COMMA  Lambda COMMA  Bidirectional EOM
from keras DOT engine import Input COMMA  Model COMMA  InputSpec EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Conv1D EOM
from keras DOT models import Model COMMA  Sequential EOM
from keras DOT utils import to_categorical EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers import Concatenate COMMA  LeakyReLU COMMA  concatenate COMMA  MaxPool1D COMMA GlobalMaxPool1D COMMA add EOM
from keras DOT layers import Dense COMMA  Embedding COMMA  Input COMMA  Masking COMMA  Dropout COMMA  MaxPooling1D COMMA Lambda COMMA  BatchNormalization EOM
from keras DOT layers import LSTM COMMA  TimeDistributed COMMA  AveragePooling1D COMMA  Flatten COMMA Activation COMMA ZeroPadding1D COMMA  UpSampling1D EOM
from keras DOT optimizers import Adam COMMA  rmsprop EOM
from keras DOT callbacks import ReduceLROnPlateau COMMA  EarlyStopping COMMA ModelCheckpoint COMMA  CSVLogger EOM
from keras DOT layers import Conv1D COMMA  GlobalMaxPooling1D COMMA  ConvLSTM2D COMMA  Bidirectional COMMA RepeatVector EOM
from keras import regularizers EOM
from keras DOT utils import plot_model COMMA  to_categorical EOM
from keras DOT preprocessing DOT text import Tokenizer EOM
from keras DOT preprocessing DOT sequence import pad_sequences EOM
from keras DOT utils import plot_model EOM
from keras DOT utils DOT data_utils import get_file EOM
from keras DOT models import Sequential EOM
from keras DOT optimizers import Adam EOM
from keras DOT callbacks import ModelCheckpoint EOM
from sklearn DOT utils import class_weight EOM
from keras import backend as K EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import model_from_json EOM
import os EOM
import pydot EOM
import graphviz EOM
RNN_HIDDEN_DIM  EQUAL  62 EOM
checkpoint_dir  EQUAL  EOM
os DOT path DOT exists PARELEFT  PARERIGHT  EOM
def letter_to_index PARELEFT  PARERIGHT : EOM
_alphabet  EQUAL  EOM
return next PARELEFT  PARELEFT i for i COMMA  _letter in enumerate PARELEFT  PARERIGHT  if _letter  EQUAL  PARERIGHT  COMMA  None PARERIGHT  EOM
def load_data PARELEFT input_file COMMA  test_split  EQUAL  COMMA  maxlen  EQUAL  PARERIGHT : EOM
df  EQUAL  pd DOT read_csv PARELEFT  PARERIGHT  EOM
df DOT columns  EQUAL  [] EOM
df[]  EQUAL  df[] DOT apply PARELEFT lambda x: [] PARERIGHT  EOM
df  EQUAL  df DOT reindex PARELEFT np DOT random DOT permutation PARELEFT  PARERIGHT  PARERIGHT  EOM
train_size  EQUAL  int PARELEFT len PARELEFT  PARERIGHT  *  PARELEFT  PARERIGHT  PARERIGHT  EOM
X_train  EQUAL  df[] DOT values[] EOM
y_train  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
X_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
return pad_sequences PARELEFT X_train COMMA  maxlen EQUAL  PARERIGHT  COMMA  y_train COMMA  pad_sequences PARELEFT X_test COMMA  maxlen EQUAL  PARERIGHT  COMMA  y_test EOM
def create_lstm_rna_seq PARELEFT input_length COMMA  rnn_hidden_dim  EQUAL  COMMA  output_dim  EQUAL  COMMA  input_dim  EQUAL  COMMA  dropout  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT input_dim  EQUAL  COMMA  output_dim  EQUAL  COMMA  input_length  EQUAL  COMMA  name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT rnn_hidden_dim COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT  COMMA   COMMA  metrics EQUAL [] PARERIGHT  EOM
return model EOM
def create_conv_rna_seq PARELEFT input_length COMMA  rnn_hidden_dim  EQUAL  COMMA  output_dim  EQUAL  COMMA  input_dim  EQUAL  COMMA  dropout  EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
forward_lstm  EQUAL  LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
backward_lstm  EQUAL  LSTM PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
brnn  EQUAL  Bidirectional PARELEFT forward EQUAL  COMMA  backward EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  EOM
model DOT add PARELEFT Conv1D PARELEFT input_dim EQUAL  COMMA input_length EQUAL  COMMA nb_filter EQUAL  COMMA filter_length EQUAL  COMMA border_mode EQUAL  COMMA activation EQUAL  COMMA subsample_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT MaxPooling1D PARELEFT pool_length EQUAL  COMMA  stride EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT input_dim EQUAL  COMMA  output_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  class_mode EQUAL  PARERIGHT  EOM
return model EOM
def create_plots PARELEFT  PARERIGHT : EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT plot PARELEFT  PARERIGHT  EOM
plt DOT title PARELEFT  PARERIGHT  EOM
plt DOT ylabel PARELEFT  PARERIGHT  EOM
plt DOT xlabel PARELEFT  PARERIGHT  EOM
plt DOT legend PARELEFT [] COMMA  loc EQUAL  PARERIGHT  EOM
plt DOT savefig PARELEFT  PARERIGHT  EOM
plt DOT clf PARELEFT  PARERIGHT  EOM
if __name__  EQUAL  EQUAL  : EOM
input_file  EQUAL  EOM
X_train COMMA  y_train COMMA  X_test COMMA  y_test  EQUAL  load_data PARELEFT  PARERIGHT  EOM
model  EQUAL  create_lstm_rna_seq PARELEFT len PARELEFT  PARERIGHT  PARERIGHT  EOM
filepath EQUAL  checkpoint_dir + EOM
checkpoint  EQUAL  ModelCheckpoint PARELEFT filepath COMMA  monitor EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  mode EQUAL  PARERIGHT  EOM
callbacks_list  EQUAL  [] EOM
class_weight  EQUAL  class_weight DOT compute_class_weight PARELEFT  COMMA  np DOT unique PARELEFT  PARERIGHT  COMMA  y_train PARERIGHT  EOM
history  EQUAL  model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  class_weight EQUAL  COMMA EPCOHS COMMA  callbacks EQUAL  COMMA  validation_split  EQUAL  COMMA  verbose  EQUAL  PARERIGHT  EOM
model_json  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
model DOT save_weights PARELEFT  PARERIGHT  EOM
create_plots PARELEFT  PARERIGHT  EOM
plot_model PARELEFT model COMMA  to_file EQUAL  PARERIGHT  EOM
score COMMA  acc  EQUAL  model DOT evaluate PARELEFT X_test COMMA  y_test COMMA  batch_size EQUAL  PARERIGHT  EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT wrappers import TimeDistributed COMMA  Bidirectional EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT import numpy as np EOM
from loop import make_generator EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Dropout COMMA  Flatten EOM
EMBEDDING_DIMS  EQUAL  300 EOM
CONTEXT_LENGTH  EQUAL  700 EOM
QUESTION_LENGTH  EQUAL  40 EOM
ANSWER_LENGTH  EQUAL  1 EOM
cenc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
cenc DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
cenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
qenc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
qenc DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
qenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
aenc  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
aenc DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
aenc DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
facts  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
facts DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  dot_axes EQUAL [] PARERIGHT  PARERIGHT  EOM
attn  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
attn DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  dot_axes EQUAL [] PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 2 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT optimizer EQUAL  COMMA  loss EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
dev_gen  EQUAL  make_generator PARELEFT mode EQUAL  PARERIGHT  EOM
train_gen  EQUAL  make_generator PARELEFT mode EQUAL  PARERIGHT  EOM
for cycle in range PARELEFT  PARERIGHT : EOM
model DOT save_weights PARELEFT  + str PARELEFT  PARERIGHT  +  PARERIGHT  EOM
model DOT fit_generator PARELEFT train_gen COMMA  87599 COMMA  3 COMMA  validation_data EQUAL  COMMA  nb_val_samples EQUAL  PARERIGHT import os EOM
global_model_version  EQUAL  49 EOM
global_batch_size  EQUAL  16 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_2  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_2 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_4 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_6 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_8 DOT add PARELEFT  PARERIGHT  EOM
branch_8 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_8 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_10 DOT add PARELEFT  PARERIGHT  EOM
branch_10 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_10 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense  COMMA  Concatenate EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function          EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  COMMA  concat_axis EQUAL  PARERIGHT  PARERIGHT  EOM
for _ in xrange PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Reshape COMMA  Activation COMMA  Dropout EOM
from keras DOT layers import LSTM COMMA  Merge COMMA  Dense EOM
from keras DOT layers import concatenate COMMA Concatenate COMMA Dot EOM
from keras DOT layers import Add EOM
from keras DOT models import Model EOM
def VQA_MODEL PARELEFT  PARERIGHT : EOM
image_feature_size  EQUAL  4096 EOM
word_feature_size  EQUAL  300 EOM
number_of_LSTM  EQUAL  3 EOM
number_of_hidden_units_LSTM  EQUAL  512 EOM
max_length_questions  EQUAL  30 EOM
number_of_dense_layers  EQUAL  3 EOM
number_of_hidden_units  EQUAL  1024 EOM
activation_function          EQUAL  EOM
dropout_pct  EQUAL  0 DOT 5 EOM
model_image  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_image DOT add PARELEFT Reshape PARELEFT  PARELEFT  PARERIGHT  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model_language DOT add PARELEFT LSTM PARELEFT number_of_hidden_units_LSTM COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
x EQUAL concatenate PARELEFT [] COMMA axis EQUAL  PARERIGHT  EOM
for _ in xrange PARELEFT  PARERIGHT : EOM
x EQUAL Dense PARELEFT number_of_hidden_units COMMA  kernel_initializer EQUAL  PARERIGHT  PARELEFT  PARERIGHT  EOM
x EQUAL Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
x EQUAL Dropout PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model_output EQUAL Dense PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
model_output EQUAL Activation PARELEFT  PARERIGHT  PARELEFT  PARERIGHT  EOM
final EQUAL Model PARELEFT  PARERIGHT  EOM
return final EOM
model EQUAL VQA_MODEL PARELEFT  PARERIGHT  EOM
model_json  EQUAL  model DOT to_json PARELEFT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as json_file: EOM
json_file DOT write PARELEFT  PARERIGHT  EOM
from __future__ import print_function EOM
import numpy as np EOM
from keras DOT preprocessing import sequence EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Dropout COMMA  Activation COMMA  Lambda EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Convolution1D COMMA MaxPooling1D COMMA  Flatten EOM
from keras DOT datasets import imdb EOM
from keras import backend as K EOM
from sklearn DOT cross_validation import train_test_split EOM
import pandas as pd EOM
from keras DOT utils DOT np_utils import to_categorical EOM
from sklearn DOT preprocessing import Normalizer EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Convolution1D COMMA  Dense COMMA  Dropout COMMA  Flatten COMMA  MaxPooling1D EOM
from keras DOT utils import np_utils EOM
import numpy as np EOM
import h5py EOM
from keras import callbacks EOM
from keras DOT layers import LSTM COMMA  GRU COMMA  SimpleRNN EOM
from keras DOT callbacks import CSVLogger EOM
from keras DOT callbacks import ModelCheckpoint COMMA  EarlyStopping COMMA  ReduceLROnPlateau COMMA  CSVLogger EOM
import csv EOM
from sklearn DOT cross_validation import StratifiedKFold EOM
from sklearn DOT cross_validation import cross_val_score EOM
from keras DOT wrappers DOT scikit_learn import KerasClassifier EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list  EQUAL  list PARELEFT  PARERIGHT  EOM
trainX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
traindata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y  EQUAL  traindata DOT iloc[] EOM
y_train1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_train EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
trainX  EQUAL  sequence DOT pad_sequences PARELEFT trainX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_train  EQUAL  np DOT reshape PARELEFT trainX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
with open PARELEFT  PARERIGHT  as f: EOM
reader1  EQUAL  csv DOT reader PARELEFT  PARERIGHT  EOM
your_list1  EQUAL  list PARELEFT  PARERIGHT  EOM
testX  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
testdata  EQUAL  pd DOT read_csv PARELEFT  COMMA  header EQUAL  PARERIGHT  EOM
Y1  EQUAL  testdata DOT iloc[] EOM
y_test1  EQUAL  np DOT array PARELEFT  PARERIGHT  EOM
y_test EQUAL  to_categorical PARELEFT  PARERIGHT  EOM
maxlen  EQUAL  44100 EOM
testX  EQUAL  sequence DOT pad_sequences PARELEFT testX COMMA  maxlen EQUAL  PARERIGHT  EOM
X_test  EQUAL  np DOT reshape PARELEFT testX COMMA   PARELEFT  PARERIGHT  PARERIGHT  EOM
batch_size  EQUAL  2 EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 32 COMMA input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
checkpointer  EQUAL  callbacks DOT ModelCheckpoint PARELEFT filepath EQUAL  COMMA  verbose EQUAL  COMMA  save_best_only EQUAL  COMMA  monitor EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT X_train COMMA  y_train COMMA  batch_size EQUAL  COMMA  nb_epoch EQUAL  COMMA  callbacks EQUAL [] PARERIGHT  EOM
model DOT save PARELEFT  PARERIGHT  import tflearn EOM
import numpy as np EOM
from sklearn DOT manifold import TSNE EOM
import matplotlib DOT pyplot as plt EOM
from tflearn DOT layers DOT core import input_data COMMA  dropout COMMA  fully_connected EOM
from tflearn DOT layers DOT conv import conv_1d COMMA  global_max_pool EOM
from tflearn DOT layers DOT merge_ops import merge EOM
from tflearn DOT layers DOT estimator import regression EOM
import tensorflow as tf EOM
import os EOM
os DOT environ[] EQUAL  EOM
from keras DOT layers import Embedding EOM
from keras DOT layers import Dense COMMA  Input COMMA  Flatten EOM
from keras DOT layers import Conv1D COMMA  MaxPooling1D COMMA  Embedding COMMA  Merge COMMA  Dropout COMMA  LSTM COMMA  GRU COMMA  Bidirectional EOM
from keras DOT models import Model COMMA Sequential EOM
from keras import backend as K EOM
from keras DOT engine DOT topology import Layer COMMA  InputSpec EOM
from keras import initializers COMMA  optimizers EOM
def lstm_keras PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embed_size COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
def cnn PARELEFT  PARERIGHT : EOM
tf DOT reset_default_graph PARELEFT  PARERIGHT  EOM
network  EQUAL  input_data PARELEFT shape EQUAL [] COMMA  name EQUAL  PARERIGHT  EOM
network  EQUAL  tflearn DOT embedding PARELEFT network COMMA  input_dim EQUAL  COMMA  output_dim EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
network  EQUAL  dropout PARELEFT  PARERIGHT  EOM
branch1  EQUAL  conv_1d PARELEFT network COMMA  embed_size COMMA  3 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  regularizer EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
branch2  EQUAL  conv_1d PARELEFT network COMMA  embed_size COMMA  4 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  regularizer EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
branch3  EQUAL  conv_1d PARELEFT network COMMA  embed_size COMMA  5 COMMA  padding EQUAL  COMMA  activation EQUAL  COMMA  regularizer EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
network  EQUAL  merge PARELEFT [] COMMA  mode EQUAL  COMMA  axis EQUAL  PARERIGHT  EOM
network  EQUAL  tf DOT expand_dims PARELEFT  PARERIGHT  EOM
network  EQUAL  global_max_pool PARELEFT  PARERIGHT  EOM
network  EQUAL  dropout PARELEFT  PARERIGHT  EOM
network  EQUAL  fully_connected PARELEFT network COMMA  num_classes COMMA  activation EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
network  EQUAL  regression PARELEFT network COMMA  optimizer EQUAL  COMMA  learning_rate EQUAL  COMMA oss EQUAL  COMMA  name EQUAL  PARERIGHT  EOM
model  EQUAL  tflearn DOT DNN PARELEFT network COMMA  tensorboard_verbose EQUAL  PARERIGHT  EOM
return model EOM
def blstm PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embed_size COMMA  input_length EQUAL  COMMA  trainable EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
return model EOM
class AttLayer PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
super PARELEFT  PARERIGHT  DOT __init__ PARELEFT  PARERIGHT  EOM
def build PARELEFT  PARERIGHT : EOM
self DOT W  EQUAL  self DOT add_weight PARELEFT name EQUAL  COMMA  shape EQUAL  PARELEFT  PARERIGHT  COMMA initializer EQUAL  COMMA trainable EQUAL  PARERIGHT  EOM
def call PARELEFT self COMMA  x COMMA  mask EQUAL  PARERIGHT : EOM
eij  EQUAL  K DOT tanh PARELEFT K DOT dot PARELEFT  PARERIGHT  PARERIGHT  EOM
ai  EQUAL  K DOT exp PARELEFT  PARERIGHT  EOM
weights  EQUAL  ai/K DOT sum PARELEFT ai COMMA  axis EQUAL  PARERIGHT  DOT dimshuffle PARELEFT  PARERIGHT  EOM
weighted_input  EQUAL  x*weights DOT dimshuffle PARELEFT  PARERIGHT  EOM
return weighted_input DOT sum PARELEFT axis EQUAL  PARERIGHT  EOM
def compute_output_shape PARELEFT  PARERIGHT : EOM
return  PARELEFT  PARERIGHT  EOM
def blstm_atten PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  embed_size COMMA  input_length EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT embed_size COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT AttLayer PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT num_classes COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
adam  EQUAL  optimizers DOT Adam PARELEFT lr EQUAL  COMMA  beta_1 EQUAL  COMMA  beta_2 EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA optimizer EQUAL  COMMA metrics EQUAL [] PARERIGHT  EOM
model DOT summary PARELEFT  PARERIGHT  EOM
return model EOM
def get_model PARELEFT  PARERIGHT : EOM
if m_type  EQUAL  EQUAL  : EOM
model  EQUAL  cnn PARELEFT  PARERIGHT  EOM
elif m_type  EQUAL  EQUAL  : EOM
model  EQUAL  lstm_keras PARELEFT  PARERIGHT  EOM
elif m_type  EQUAL  EQUAL  : EOM
model  EQUAL  blstm PARELEFT  PARERIGHT  EOM
elif m_type  EQUAL  EQUAL  : EOM
model  EQUAL  blstm_atten PARELEFT  PARERIGHT  EOM
else: EOM
return None EOM
return modelimport pandas as pd EOM
import numpy as np EOM
import datetime EOM
import os EOM
from keras DOT models import Sequential EOM
from keras DOT layers DOT core import Dense COMMA  Dropout COMMA  Activation COMMA  Flatten EOM
from keras DOT layers DOT recurrent import LSTM COMMA  GRU EOM
from keras DOT layers import Convolution1D COMMA  MaxPooling1D EOM
from keras DOT callbacks import Callback EOM
from sklearn DOT preprocessing import MinMaxScaler EOM
from sklearn DOT metrics import mean_squared_error EOM
def prepare_data PARELEFT  PARERIGHT : EOM
df__  EQUAL  df[] EOM
dataset  EQUAL  df__ DOT values EOM
dataset  EQUAL  dataset DOT astype PARELEFT  PARERIGHT  EOM
return dataset EOM
def create_dataset PARELEFT dataset COMMA  look_back EQUAL  PARERIGHT : EOM
for i in range PARELEFT len PARELEFT  PARERIGHT -look_back-1 PARERIGHT : EOM
a  EQUAL  dataset[] EOM
dataX DOT append PARELEFT  PARERIGHT  EOM
dataY DOT append PARELEFT  PARERIGHT  EOM
return np DOT array PARELEFT  PARERIGHT  COMMA  np DOT array PARELEFT  PARERIGHT  EOM
def reshape_dataset PARELEFT data_ COMMA time_series EQUAL  PARERIGHT : EOM
if time_series EQUAL False: EOM
else: EOM
return data_reshape EOM
class LSTM_model EOM
def __init__ PARELEFT self COMMA trainX COMMA trainY COMMA look_back COMMA batch_size EQUAL  COMMA  epoch EQUAL  COMMA  PARERIGHT : EOM
self DOT trainX  EQUAL  trainX EOM
self DOT trainY  EQUAL  trainY EOM
self DOT look_back  EQUAL  look_back EOM
def simple_LSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT self DOT trainX COMMA  self DOT trainY COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
return model EOM
def LSTM_model_memory_batch PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT fit PARELEFT self DOT trainX COMMA  self DOT trainY COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
return model EOM
def Stacked_LSTM_model_memory_batch PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT fit PARELEFT self DOT trainX COMMA  self DOT trainY COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
return model EOM
def Simple_LSTM PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
model DOT fit PARELEFT trainX COMMA  trainY COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  PARERIGHT  EOM
return model EOM
def LSTM_model_memory_batch PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT fit PARELEFT trainX COMMA  trainY COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
return model EOM
def Stacked_LSTM_model_memory_batch PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 4 COMMA  batch_input_shape EQUAL  PARELEFT  PARERIGHT  COMMA  stateful EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
for i in range PARELEFT  PARERIGHT : EOM
model DOT fit PARELEFT trainX COMMA  trainY COMMA  epochs EQUAL  COMMA  batch_size EQUAL  COMMA  verbose EQUAL  COMMA  shuffle EQUAL  PARERIGHT  EOM
model DOT reset_states PARELEFT  PARERIGHT  EOM
return model EOM
import os EOM
global_model_version  EQUAL  63 EOM
global_batch_size  EQUAL  128 EOM
global_top_words  EQUAL  5000 EOM
global_max_review_length  EQUAL  500 EOM
global_dir_name  EQUAL  os DOT path DOT dirname PARELEFT os DOT path DOT realpath PARELEFT  PARERIGHT  PARERIGHT  EOM
global_embedding_vecor_length  EQUAL  32 EOM
global_model_description  EQUAL  EOM
import sys EOM
sys DOT path DOT append PARELEFT  PARERIGHT  EOM
from master import run_model COMMA  generate_read_me COMMA  get_text_data COMMA  load_word2vec EOM
import time EOM
import numpy as np EOM
import matplotlib EOM
import argparse EOM
import keras EOM
import csv EOM
from keras DOT datasets import imdb EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense COMMA  Merge COMMA  Input COMMA  Reshape COMMA  Activation COMMA  Dropout COMMA  Flatten EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT convolutional import Conv1D EOM
from keras DOT layers DOT convolutional import MaxPooling1D EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import plot_model EOM
import matplotlib DOT pyplot as plt EOM
from keras DOT regularizers import l2 EOM
def build_model PARELEFT top_words COMMA  embedding_vecor_length COMMA  max_review_length COMMA  show_summaries EQUAL  PARERIGHT : EOM
input_layer  EQUAL  Embedding PARELEFT top_words COMMA  embedding_vecor_length COMMA  input_length EQUAL  PARERIGHT  EOM
branch_3  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_3 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_5 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_7 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Conv1D PARELEFT filters EQUAL  COMMA  kernel_size EQUAL  COMMA  padding EQUAL  COMMA  kernel_regularizer EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT MaxPooling1D PARELEFT pool_size EQUAL  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
branch_9 DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Merge PARELEFT [] COMMA  mode EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 1 COMMA  activation EQUAL  PARERIGHT  PARERIGHT  EOM
opt  EQUAL  keras DOT optimizers DOT RMSprop PARELEFT lr EQUAL  COMMA  decay EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
if show_summaries: EOM
return model EOM
os DOT environ[] EQUAL  EOM
parser  EQUAL  argparse DOT ArgumentParser PARELEFT description EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  dest EQUAL  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  PARERIGHT  EOM
parser DOT add_argument PARELEFT  COMMA  action EQUAL  COMMA  default EQUAL  COMMA  help EQUAL  COMMA  type EQUAL  PARERIGHT  EOM
inputs  EQUAL  parser DOT parse_args PARELEFT  PARERIGHT  EOM
generate_read_me PARELEFT  PARERIGHT  EOM
run_model PARELEFT build_model PARELEFT  PARERIGHT  COMMA  global_model_version COMMA  global_batch_size COMMA  inputs DOT num_epochs COMMA  global_top_words COMMA  global_max_review_length COMMA  global_dir_name PARERIGHT  EOM
from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT models import Sequential EOM
def build_improved_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
def build_basic_model PARELEFT  PARERIGHT : EOM
model DOT add PARELEFT LSTM PARELEFT nput_shape EQUAL  PARELEFT  PARERIGHT  COMMA units EQUAL  COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 64 COMMA return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT units EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
from keras DOT callbacks import ModelCheckpoint EOM
from keras DOT layers import Dense EOM
from keras DOT layers import Dropout EOM
from keras DOT layers import Flatten EOM
from keras DOT layers import LSTM EOM
from keras DOT layers DOT embeddings import Embedding EOM
from keras DOT models import Sequential EOM
from keras DOT models import load_model EOM
from keras DOT models import model_from_json EOM
from keras DOT preprocessing import sequence EOM
from keras DOT utils import np_utils EOM
def baseModel PARELEFT  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Embedding PARELEFT vocab_size COMMA  vec_len COMMA  input_length  EQUAL  COMMA  weights  EQUAL [] PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 512 COMMA  kernel_initializer EQUAL  COMMA  dropout EQUAL  COMMA  activation EQUAL  COMMA  name  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 256 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 128 COMMA  kernel_initializer EQUAL  COMMA  activation EQUAL  COMMA name EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 4 COMMA  activation EQUAL  COMMA  name  EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  COMMA  metrics EQUAL [] PARERIGHT  EOM
return modelimport keras EOM
from keras DOT models import Sequential EOM
from keras DOT layers import Dense EOM
from keras DOT layers import LSTM EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT utils import multi_gpu_model EOM
from models import timehistory EOM
from data_generator import generate_text_input_data EOM
if keras DOT backend DOT backend PARELEFT  PARERIGHT   EQUAL   from gpu_mode import cntk_gpu_mode_config EOM
class LstmBenchmark PARELEFT  PARERIGHT : EOM
def __init__ PARELEFT  PARERIGHT : EOM
self DOT test_name  EQUAL  EOM
self DOT sample_type  EQUAL  EOM
self DOT total_time  EQUAL  0 EOM
self DOT batch_size  EQUAL  128 EOM
self DOT epochs  EQUAL  2 EOM
self DOT num_samples  EQUAL  1000 EOM
def run_benchmark PARELEFT self COMMA  gpus EQUAL  PARERIGHT : EOM
input_dim_1  EQUAL  40 EOM
input_dim_2  EQUAL  60 EOM
input_shape  EQUAL   PARELEFT  PARERIGHT  EOM
x COMMA  y  EQUAL  generate_text_input_data PARELEFT  PARERIGHT  EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT 128 COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  COMMA  activation EQUAL  PARERIGHT  EOM
optimizer  EQUAL  RMSprop PARELEFT lr EQUAL  PARERIGHT  EOM
if keras DOT backend DOT backend PARELEFT  PARERIGHT  is  and gpus > 1: EOM
model  EQUAL  multi_gpu_model PARELEFT model COMMA  gpus EQUAL  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if keras DOT backend DOT backend PARELEFT  PARERIGHT  is  and gpus > 1: EOM
start COMMA  end  EQUAL  cntk_gpu_mode_config PARELEFT  PARERIGHT  EOM
x  EQUAL  x[] EOM
y  EQUAL  y[] EOM
time_callback  EQUAL  timehistory DOT TimeHistory PARELEFT  PARERIGHT  EOM
model DOT fit PARELEFT x COMMA  y COMMA batch_size EQUAL  COMMA epochs EQUAL  COMMA callbacks EQUAL [] PARERIGHT  EOM
self DOT total_time  EQUAL  0 EOM
for i in range PARELEFT  PARERIGHT : EOM
self DOT total_time + EQUAL  time_callback DOT times[]from keras DOT layers DOT core import Dense COMMA  Activation COMMA  Dropout EOM
from keras DOT optimizers import RMSprop EOM
from keras DOT layers DOT recurrent import LSTM EOM
from keras DOT callbacks import Callback EOM
import tensorflow as tf EOM
class LossHistory PARELEFT  PARERIGHT : EOM
def on_train_begin PARELEFT self COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses  EQUAL  [] EOM
def on_batch_end PARELEFT self COMMA  batch COMMA  logs EQUAL  PARERIGHT : EOM
self DOT losses DOT append PARELEFT logs DOT get PARELEFT  PARERIGHT  PARERIGHT  EOM
def neural_net PARELEFT num_sensors COMMA  params COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT rams[] COMMA  init EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT params[] COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT 7 COMMA  init EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
rms  EQUAL  RMSprop PARELEFT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
if load: EOM
model DOT load_weights PARELEFT  PARERIGHT  EOM
return model EOM
def lstm_net PARELEFT num_sensors COMMA  load EQUAL  PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT tput_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dropout PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT output_dim EQUAL  COMMA  input_dim EQUAL  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT compile PARELEFT loss EQUAL  COMMA  optimizer EQUAL  PARERIGHT  EOM
return modelfrom keras DOT layers DOT convolutional import Conv2DTranspose  COMMA  Conv1D COMMA  Conv2D COMMA Convolution3D COMMA  MaxPooling2D COMMA UpSampling1D COMMA UpSampling2D COMMA UpSampling3D EOM
from keras DOT layers import Input COMMA LSTM COMMA Bidirectional COMMA TimeDistributed COMMA Embedding COMMA  Dense COMMA  Dropout COMMA  Activation COMMA  Flatten COMMA    Reshape COMMA  Flatten COMMA  Lambda EOM
from keras DOT layers DOT noise import GaussianDropout COMMA  GaussianNoise EOM
from keras DOT layers DOT normalization import BatchNormalization EOM
from keras import initializers EOM
from keras import regularizers EOM
from keras DOT models import Sequential COMMA  Model EOM
from keras DOT layers DOT advanced_activations import LeakyReLU EOM
import numpy as np EOM
import pandas as pd EOM
import os EOM
def create_LSTM PARELEFT input_dim COMMA output_dim COMMA embedding_matrix EQUAL [] PARERIGHT : EOM
model  EQUAL  Sequential PARELEFT  PARERIGHT  EOM
if embedding_matrix ! EQUAL  []: EOM
embedding_layer  EQUAL  Embedding PARELEFT embedding_matrix DOT shape[] COMMA embedding_matrix DOT shape[] COMMA weights EQUAL [] COMMA input_length EQUAL  COMMA trainable EQUAL  PARERIGHT  EOM
model DOT add PARELEFT  PARERIGHT  EOM
model DOT add PARELEFT LSTM PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 150 COMMA  return_sequences EQUAL  PARERIGHT  PARERIGHT  PARERIGHT  EOM
else: EOM
model DOT add PARELEFT LSTM PARELEFT 150 COMMA input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Bidirectional PARELEFT LSTM PARELEFT 150 COMMA  return_sequences EQUAL  COMMA  input_shape EQUAL  PARELEFT  PARERIGHT  PARERIGHT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Flatten PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Dense PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT BatchNormalization PARELEFT  PARERIGHT  PARERIGHT  EOM
model DOT add PARELEFT Activation PARELEFT  PARERIGHT  PARERIGHT  EOM
return model EOM
if __name__  EQUAL  EQUAL  : EOM
model_id  EQUAL  EOM
model  EQUAL  create_LSTM PARELEFT input_dim EQUAL  COMMA output_dim EQUAL  COMMA embedding_matrix EQUAL [] PARERIGHT  EOM
